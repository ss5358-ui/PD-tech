function XO(e,t){for(var r=0;r<t.length;r++){const n=t[r];if(typeof n!="string"&&!Array.isArray(n)){for(const a in n)if(a!=="default"&&!(a in e)){const s=Object.getOwnPropertyDescriptor(n,a);s&&Object.defineProperty(e,a,s.get?s:{enumerable:!0,get:()=>n[a]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))n(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const i of s.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&n(i)}).observe(document,{childList:!0,subtree:!0});function r(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerPolicy&&(s.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?s.credentials="include":a.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function n(a){if(a.ep)return;a.ep=!0;const s=r(a);fetch(a.href,s)}})();var wt=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Er(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function QO(e){if(e.__esModule)return e;var t=e.default;if(typeof t=="function"){var r=function n(){return this instanceof n?Reflect.construct(t,arguments,this.constructor):t.apply(this,arguments)};r.prototype=t.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(e).forEach(function(n){var a=Object.getOwnPropertyDescriptor(e,n);Object.defineProperty(r,n,a.get?a:{enumerable:!0,get:function(){return e[n]}})}),r}var AE={exports:{}},ih={},OE={exports:{}},Me={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var rf=Symbol.for("react.element"),JO=Symbol.for("react.portal"),ZO=Symbol.for("react.fragment"),eD=Symbol.for("react.strict_mode"),tD=Symbol.for("react.profiler"),rD=Symbol.for("react.provider"),nD=Symbol.for("react.context"),aD=Symbol.for("react.forward_ref"),sD=Symbol.for("react.suspense"),iD=Symbol.for("react.memo"),oD=Symbol.for("react.lazy"),Ry=Symbol.iterator;function lD(e){return e===null||typeof e!="object"?null:(e=Ry&&e[Ry]||e["@@iterator"],typeof e=="function"?e:null)}var DE={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},jE=Object.assign,PE={};function Ol(e,t,r){this.props=e,this.context=t,this.refs=PE,this.updater=r||DE}Ol.prototype.isReactComponent={};Ol.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Ol.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function FE(){}FE.prototype=Ol.prototype;function Mg(e,t,r){this.props=e,this.context=t,this.refs=PE,this.updater=r||DE}var Ig=Mg.prototype=new FE;Ig.constructor=Mg;jE(Ig,Ol.prototype);Ig.isPureReactComponent=!0;var My=Array.isArray,RE=Object.prototype.hasOwnProperty,Lg={current:null},ME={key:!0,ref:!0,__self:!0,__source:!0};function IE(e,t,r){var n,a={},s=null,i=null;if(t!=null)for(n in t.ref!==void 0&&(i=t.ref),t.key!==void 0&&(s=""+t.key),t)RE.call(t,n)&&!ME.hasOwnProperty(n)&&(a[n]=t[n]);var o=arguments.length-2;if(o===1)a.children=r;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];a.children=l}if(e&&e.defaultProps)for(n in o=e.defaultProps,o)a[n]===void 0&&(a[n]=o[n]);return{$$typeof:rf,type:e,key:s,ref:i,props:a,_owner:Lg.current}}function cD(e,t){return{$$typeof:rf,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function $g(e){return typeof e=="object"&&e!==null&&e.$$typeof===rf}function uD(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(r){return t[r]})}var Iy=/\/+/g;function Np(e,t){return typeof e=="object"&&e!==null&&e.key!=null?uD(""+e.key):t.toString(36)}function Td(e,t,r,n,a){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var i=!1;if(e===null)i=!0;else switch(s){case"string":case"number":i=!0;break;case"object":switch(e.$$typeof){case rf:case JO:i=!0}}if(i)return i=e,a=a(i),e=n===""?"."+Np(i,0):n,My(a)?(r="",e!=null&&(r=e.replace(Iy,"$&/")+"/"),Td(a,t,r,"",function(c){return c})):a!=null&&($g(a)&&(a=cD(a,r+(!a.key||i&&i.key===a.key?"":(""+a.key).replace(Iy,"$&/")+"/")+e)),t.push(a)),1;if(i=0,n=n===""?".":n+":",My(e))for(var o=0;o<e.length;o++){s=e[o];var l=n+Np(s,o);i+=Td(s,t,r,l,a)}else if(l=lD(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=n+Np(s,o++),i+=Td(s,t,r,l,a);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return i}function $f(e,t,r){if(e==null)return e;var n=[],a=0;return Td(e,n,"","",function(s){return t.call(r,s,a++)}),n}function fD(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(r){(e._status===0||e._status===-1)&&(e._status=1,e._result=r)},function(r){(e._status===0||e._status===-1)&&(e._status=2,e._result=r)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Rr={current:null},Cd={transition:null},dD={ReactCurrentDispatcher:Rr,ReactCurrentBatchConfig:Cd,ReactCurrentOwner:Lg};function LE(){throw Error("act(...) is not supported in production builds of React.")}Me.Children={map:$f,forEach:function(e,t,r){$f(e,function(){t.apply(this,arguments)},r)},count:function(e){var t=0;return $f(e,function(){t++}),t},toArray:function(e){return $f(e,function(t){return t})||[]},only:function(e){if(!$g(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};Me.Component=Ol;Me.Fragment=ZO;Me.Profiler=tD;Me.PureComponent=Mg;Me.StrictMode=eD;Me.Suspense=sD;Me.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=dD;Me.act=LE;Me.cloneElement=function(e,t,r){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=jE({},e.props),a=e.key,s=e.ref,i=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,i=Lg.current),t.key!==void 0&&(a=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)RE.call(t,l)&&!ME.hasOwnProperty(l)&&(n[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)n.children=r;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];n.children=o}return{$$typeof:rf,type:e.type,key:a,ref:s,props:n,_owner:i}};Me.createContext=function(e){return e={$$typeof:nD,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:rD,_context:e},e.Consumer=e};Me.createElement=IE;Me.createFactory=function(e){var t=IE.bind(null,e);return t.type=e,t};Me.createRef=function(){return{current:null}};Me.forwardRef=function(e){return{$$typeof:aD,render:e}};Me.isValidElement=$g;Me.lazy=function(e){return{$$typeof:oD,_payload:{_status:-1,_result:e},_init:fD}};Me.memo=function(e,t){return{$$typeof:iD,type:e,compare:t===void 0?null:t}};Me.startTransition=function(e){var t=Cd.transition;Cd.transition={};try{e()}finally{Cd.transition=t}};Me.unstable_act=LE;Me.useCallback=function(e,t){return Rr.current.useCallback(e,t)};Me.useContext=function(e){return Rr.current.useContext(e)};Me.useDebugValue=function(){};Me.useDeferredValue=function(e){return Rr.current.useDeferredValue(e)};Me.useEffect=function(e,t){return Rr.current.useEffect(e,t)};Me.useId=function(){return Rr.current.useId()};Me.useImperativeHandle=function(e,t,r){return Rr.current.useImperativeHandle(e,t,r)};Me.useInsertionEffect=function(e,t){return Rr.current.useInsertionEffect(e,t)};Me.useLayoutEffect=function(e,t){return Rr.current.useLayoutEffect(e,t)};Me.useMemo=function(e,t){return Rr.current.useMemo(e,t)};Me.useReducer=function(e,t,r){return Rr.current.useReducer(e,t,r)};Me.useRef=function(e){return Rr.current.useRef(e)};Me.useState=function(e){return Rr.current.useState(e)};Me.useSyncExternalStore=function(e,t,r){return Rr.current.useSyncExternalStore(e,t,r)};Me.useTransition=function(){return Rr.current.useTransition()};Me.version="18.3.1";OE.exports=Me;var O=OE.exports;const Z=Er(O),hD=XO({__proto__:null,default:Z},[O]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pD=O,mD=Symbol.for("react.element"),vD=Symbol.for("react.fragment"),gD=Object.prototype.hasOwnProperty,xD=pD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,yD={key:!0,ref:!0,__self:!0,__source:!0};function $E(e,t,r){var n,a={},s=null,i=null;r!==void 0&&(s=""+r),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(i=t.ref);for(n in t)gD.call(t,n)&&!yD.hasOwnProperty(n)&&(a[n]=t[n]);if(e&&e.defaultProps)for(n in t=e.defaultProps,t)a[n]===void 0&&(a[n]=t[n]);return{$$typeof:mD,type:e,key:s,ref:i,props:a,_owner:xD.current}}ih.Fragment=vD;ih.jsx=$E;ih.jsxs=$E;AE.exports=ih;var u=AE.exports,BE={exports:{}},cn={},UE={exports:{}},WE={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ee,H){var ce=ee.length;ee.push(H);e:for(;0<ce;){var J=ce-1>>>1,N=ee[J];if(0<a(N,H))ee[J]=H,ee[ce]=N,ce=J;else break e}}function r(ee){return ee.length===0?null:ee[0]}function n(ee){if(ee.length===0)return null;var H=ee[0],ce=ee.pop();if(ce!==H){ee[0]=ce;e:for(var J=0,N=ee.length,F=N>>>1;J<F;){var T=2*(J+1)-1,R=ee[T],G=T+1,X=ee[G];if(0>a(R,ce))G<N&&0>a(X,R)?(ee[J]=X,ee[G]=ce,J=G):(ee[J]=R,ee[T]=ce,J=T);else if(G<N&&0>a(X,ce))ee[J]=X,ee[G]=ce,J=G;else break e}}return H}function a(ee,H){var ce=ee.sortIndex-H.sortIndex;return ce!==0?ce:ee.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var i=Date,o=i.now();e.unstable_now=function(){return i.now()-o}}var l=[],c=[],f=1,d=null,h=3,p=!1,v=!1,m=!1,_=typeof setTimeout=="function"?setTimeout:null,g=typeof clearTimeout=="function"?clearTimeout:null,y=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function x(ee){for(var H=r(c);H!==null;){if(H.callback===null)n(c);else if(H.startTime<=ee)n(c),H.sortIndex=H.expirationTime,t(l,H);else break;H=r(c)}}function w(ee){if(m=!1,x(ee),!v)if(r(l)!==null)v=!0,z(E);else{var H=r(c);H!==null&&q(w,H.startTime-ee)}}function E(ee,H){v=!1,m&&(m=!1,g(j),j=-1),p=!0;var ce=h;try{for(x(H),d=r(l);d!==null&&(!(d.expirationTime>H)||ee&&!P());){var J=d.callback;if(typeof J=="function"){d.callback=null,h=d.priorityLevel;var N=J(d.expirationTime<=H);H=e.unstable_now(),typeof N=="function"?d.callback=N:d===r(l)&&n(l),x(H)}else n(l);d=r(l)}if(d!==null)var F=!0;else{var T=r(c);T!==null&&q(w,T.startTime-H),F=!1}return F}finally{d=null,h=ce,p=!1}}var S=!1,b=null,j=-1,k=5,C=-1;function P(){return!(e.unstable_now()-C<k)}function I(){if(b!==null){var ee=e.unstable_now();C=ee;var H=!0;try{H=b(!0,ee)}finally{H?D():(S=!1,b=null)}}else S=!1}var D;if(typeof y=="function")D=function(){y(I)};else if(typeof MessageChannel<"u"){var K=new MessageChannel,Q=K.port2;K.port1.onmessage=I,D=function(){Q.postMessage(null)}}else D=function(){_(I,0)};function z(ee){b=ee,S||(S=!0,D())}function q(ee,H){j=_(function(){ee(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ee){ee.callback=null},e.unstable_continueExecution=function(){v||p||(v=!0,z(E))},e.unstable_forceFrameRate=function(ee){0>ee||125<ee?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):k=0<ee?Math.floor(1e3/ee):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_getFirstCallbackNode=function(){return r(l)},e.unstable_next=function(ee){switch(h){case 1:case 2:case 3:var H=3;break;default:H=h}var ce=h;h=H;try{return ee()}finally{h=ce}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ee,H){switch(ee){case 1:case 2:case 3:case 4:case 5:break;default:ee=3}var ce=h;h=ee;try{return H()}finally{h=ce}},e.unstable_scheduleCallback=function(ee,H,ce){var J=e.unstable_now();switch(typeof ce=="object"&&ce!==null?(ce=ce.delay,ce=typeof ce=="number"&&0<ce?J+ce:J):ce=J,ee){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=ce+N,ee={id:f++,callback:H,priorityLevel:ee,startTime:ce,expirationTime:N,sortIndex:-1},ce>J?(ee.sortIndex=ce,t(c,ee),r(l)===null&&ee===r(c)&&(m?(g(j),j=-1):m=!0,q(w,ce-J))):(ee.sortIndex=N,t(l,ee),v||p||(v=!0,z(E))),ee},e.unstable_shouldYield=P,e.unstable_wrapCallback=function(ee){var H=h;return function(){var ce=h;h=H;try{return ee.apply(this,arguments)}finally{h=ce}}}})(WE);UE.exports=WE;var _D=UE.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var wD=O,sn=_D;function de(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,r=1;r<arguments.length;r++)t+="&args[]="+encodeURIComponent(arguments[r]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var VE=new Set,ou={};function oo(e,t){fl(e,t),fl(e+"Capture",t)}function fl(e,t){for(ou[e]=t,e=0;e<t.length;e++)VE.add(t[e])}var is=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),$m=Object.prototype.hasOwnProperty,bD=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Ly={},$y={};function ED(e){return $m.call($y,e)?!0:$m.call(Ly,e)?!1:bD.test(e)?$y[e]=!0:(Ly[e]=!0,!1)}function SD(e,t,r,n){if(r!==null&&r.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return n?!1:r!==null?!r.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function kD(e,t,r,n){if(t===null||typeof t>"u"||SD(e,t,r,n))return!0;if(n)return!1;if(r!==null)switch(r.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function Mr(e,t,r,n,a,s,i){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=n,this.attributeNamespace=a,this.mustUseProperty=r,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=i}var lr={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){lr[e]=new Mr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];lr[t]=new Mr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){lr[e]=new Mr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){lr[e]=new Mr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){lr[e]=new Mr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){lr[e]=new Mr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){lr[e]=new Mr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){lr[e]=new Mr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){lr[e]=new Mr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Bg=/[\-:]([a-z])/g;function Ug(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Bg,Ug);lr[t]=new Mr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Bg,Ug);lr[t]=new Mr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Bg,Ug);lr[t]=new Mr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){lr[e]=new Mr(e,1,!1,e.toLowerCase(),null,!1,!1)});lr.xlinkHref=new Mr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){lr[e]=new Mr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Wg(e,t,r,n){var a=lr.hasOwnProperty(t)?lr[t]:null;(a!==null?a.type!==0:n||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(kD(t,r,a,n)&&(r=null),n||a===null?ED(t)&&(r===null?e.removeAttribute(t):e.setAttribute(t,""+r)):a.mustUseProperty?e[a.propertyName]=r===null?a.type===3?!1:"":r:(t=a.attributeName,n=a.attributeNamespace,r===null?e.removeAttribute(t):(a=a.type,r=a===3||a===4&&r===!0?"":""+r,n?e.setAttributeNS(n,t,r):e.setAttribute(t,r))))}var vs=wD.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Bf=Symbol.for("react.element"),Fo=Symbol.for("react.portal"),Ro=Symbol.for("react.fragment"),Vg=Symbol.for("react.strict_mode"),Bm=Symbol.for("react.profiler"),HE=Symbol.for("react.provider"),zE=Symbol.for("react.context"),Hg=Symbol.for("react.forward_ref"),Um=Symbol.for("react.suspense"),Wm=Symbol.for("react.suspense_list"),zg=Symbol.for("react.memo"),Ns=Symbol.for("react.lazy"),YE=Symbol.for("react.offscreen"),By=Symbol.iterator;function cc(e){return e===null||typeof e!="object"?null:(e=By&&e[By]||e["@@iterator"],typeof e=="function"?e:null)}var Et=Object.assign,Ap;function Sc(e){if(Ap===void 0)try{throw Error()}catch(r){var t=r.stack.trim().match(/\n( *(at )?)/);Ap=t&&t[1]||""}return`
`+Ap+e}var Op=!1;function Dp(e,t){if(!e||Op)return"";Op=!0;var r=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var n=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){n=c}e.call(t.prototype)}else{try{throw Error()}catch(c){n=c}e()}}catch(c){if(c&&n&&typeof c.stack=="string"){for(var a=c.stack.split(`
`),s=n.stack.split(`
`),i=a.length-1,o=s.length-1;1<=i&&0<=o&&a[i]!==s[o];)o--;for(;1<=i&&0<=o;i--,o--)if(a[i]!==s[o]){if(i!==1||o!==1)do if(i--,o--,0>o||a[i]!==s[o]){var l=`
`+a[i].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=i&&0<=o);break}}}finally{Op=!1,Error.prepareStackTrace=r}return(e=e?e.displayName||e.name:"")?Sc(e):""}function TD(e){switch(e.tag){case 5:return Sc(e.type);case 16:return Sc("Lazy");case 13:return Sc("Suspense");case 19:return Sc("SuspenseList");case 0:case 2:case 15:return e=Dp(e.type,!1),e;case 11:return e=Dp(e.type.render,!1),e;case 1:return e=Dp(e.type,!0),e;default:return""}}function Vm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case Ro:return"Fragment";case Fo:return"Portal";case Bm:return"Profiler";case Vg:return"StrictMode";case Um:return"Suspense";case Wm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case zE:return(e.displayName||"Context")+".Consumer";case HE:return(e._context.displayName||"Context")+".Provider";case Hg:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case zg:return t=e.displayName||null,t!==null?t:Vm(e.type)||"Memo";case Ns:t=e._payload,e=e._init;try{return Vm(e(t))}catch{}}return null}function CD(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Vm(t);case 8:return t===Vg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function ei(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function GE(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function ND(e){var t=GE(e)?"checked":"value",r=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),n=""+e[t];if(!e.hasOwnProperty(t)&&typeof r<"u"&&typeof r.get=="function"&&typeof r.set=="function"){var a=r.get,s=r.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return a.call(this)},set:function(i){n=""+i,s.call(this,i)}}),Object.defineProperty(e,t,{enumerable:r.enumerable}),{getValue:function(){return n},setValue:function(i){n=""+i},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function Uf(e){e._valueTracker||(e._valueTracker=ND(e))}function KE(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var r=t.getValue(),n="";return e&&(n=GE(e)?e.checked?"true":"false":e.value),e=n,e!==r?(t.setValue(e),!0):!1}function qd(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Hm(e,t){var r=t.checked;return Et({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:r??e._wrapperState.initialChecked})}function Uy(e,t){var r=t.defaultValue==null?"":t.defaultValue,n=t.checked!=null?t.checked:t.defaultChecked;r=ei(t.value!=null?t.value:r),e._wrapperState={initialChecked:n,initialValue:r,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function qE(e,t){t=t.checked,t!=null&&Wg(e,"checked",t,!1)}function zm(e,t){qE(e,t);var r=ei(t.value),n=t.type;if(r!=null)n==="number"?(r===0&&e.value===""||e.value!=r)&&(e.value=""+r):e.value!==""+r&&(e.value=""+r);else if(n==="submit"||n==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Ym(e,t.type,r):t.hasOwnProperty("defaultValue")&&Ym(e,t.type,ei(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function Wy(e,t,r){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var n=t.type;if(!(n!=="submit"&&n!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,r||t===e.value||(e.value=t),e.defaultValue=t}r=e.name,r!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,r!==""&&(e.name=r)}function Ym(e,t,r){(t!=="number"||qd(e.ownerDocument)!==e)&&(r==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+r&&(e.defaultValue=""+r))}var kc=Array.isArray;function Qo(e,t,r,n){if(e=e.options,t){t={};for(var a=0;a<r.length;a++)t["$"+r[a]]=!0;for(r=0;r<e.length;r++)a=t.hasOwnProperty("$"+e[r].value),e[r].selected!==a&&(e[r].selected=a),a&&n&&(e[r].defaultSelected=!0)}else{for(r=""+ei(r),t=null,a=0;a<e.length;a++){if(e[a].value===r){e[a].selected=!0,n&&(e[a].defaultSelected=!0);return}t!==null||e[a].disabled||(t=e[a])}t!==null&&(t.selected=!0)}}function Gm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(de(91));return Et({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Vy(e,t){var r=t.value;if(r==null){if(r=t.children,t=t.defaultValue,r!=null){if(t!=null)throw Error(de(92));if(kc(r)){if(1<r.length)throw Error(de(93));r=r[0]}t=r}t==null&&(t=""),r=t}e._wrapperState={initialValue:ei(r)}}function XE(e,t){var r=ei(t.value),n=ei(t.defaultValue);r!=null&&(r=""+r,r!==e.value&&(e.value=r),t.defaultValue==null&&e.defaultValue!==r&&(e.defaultValue=r)),n!=null&&(e.defaultValue=""+n)}function Hy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function QE(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Km(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?QE(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var Wf,JE=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,r,n,a){MSApp.execUnsafeLocalFunction(function(){return e(t,r,n,a)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(Wf=Wf||document.createElement("div"),Wf.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=Wf.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function lu(e,t){if(t){var r=e.firstChild;if(r&&r===e.lastChild&&r.nodeType===3){r.nodeValue=t;return}}e.textContent=t}var Fc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},AD=["Webkit","ms","Moz","O"];Object.keys(Fc).forEach(function(e){AD.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Fc[t]=Fc[e]})});function ZE(e,t,r){return t==null||typeof t=="boolean"||t===""?"":r||typeof t!="number"||t===0||Fc.hasOwnProperty(e)&&Fc[e]?(""+t).trim():t+"px"}function eS(e,t){e=e.style;for(var r in t)if(t.hasOwnProperty(r)){var n=r.indexOf("--")===0,a=ZE(r,t[r],n);r==="float"&&(r="cssFloat"),n?e.setProperty(r,a):e[r]=a}}var OD=Et({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function qm(e,t){if(t){if(OD[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(de(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(de(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(de(61))}if(t.style!=null&&typeof t.style!="object")throw Error(de(62))}}function Xm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Qm=null;function Yg(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Jm=null,Jo=null,Zo=null;function zy(e){if(e=sf(e)){if(typeof Jm!="function")throw Error(de(280));var t=e.stateNode;t&&(t=fh(t),Jm(e.stateNode,e.type,t))}}function tS(e){Jo?Zo?Zo.push(e):Zo=[e]:Jo=e}function rS(){if(Jo){var e=Jo,t=Zo;if(Zo=Jo=null,zy(e),t)for(e=0;e<t.length;e++)zy(t[e])}}function nS(e,t){return e(t)}function aS(){}var jp=!1;function sS(e,t,r){if(jp)return e(t,r);jp=!0;try{return nS(e,t,r)}finally{jp=!1,(Jo!==null||Zo!==null)&&(aS(),rS())}}function cu(e,t){var r=e.stateNode;if(r===null)return null;var n=fh(r);if(n===null)return null;r=n[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(n=!n.disabled)||(e=e.type,n=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!n;break e;default:e=!1}if(e)return null;if(r&&typeof r!="function")throw Error(de(231,t,typeof r));return r}var Zm=!1;if(is)try{var uc={};Object.defineProperty(uc,"passive",{get:function(){Zm=!0}}),window.addEventListener("test",uc,uc),window.removeEventListener("test",uc,uc)}catch{Zm=!1}function DD(e,t,r,n,a,s,i,o,l){var c=Array.prototype.slice.call(arguments,3);try{t.apply(r,c)}catch(f){this.onError(f)}}var Rc=!1,Xd=null,Qd=!1,ev=null,jD={onError:function(e){Rc=!0,Xd=e}};function PD(e,t,r,n,a,s,i,o,l){Rc=!1,Xd=null,DD.apply(jD,arguments)}function FD(e,t,r,n,a,s,i,o,l){if(PD.apply(this,arguments),Rc){if(Rc){var c=Xd;Rc=!1,Xd=null}else throw Error(de(198));Qd||(Qd=!0,ev=c)}}function lo(e){var t=e,r=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(r=t.return),e=t.return;while(e)}return t.tag===3?r:null}function iS(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Yy(e){if(lo(e)!==e)throw Error(de(188))}function RD(e){var t=e.alternate;if(!t){if(t=lo(e),t===null)throw Error(de(188));return t!==e?null:e}for(var r=e,n=t;;){var a=r.return;if(a===null)break;var s=a.alternate;if(s===null){if(n=a.return,n!==null){r=n;continue}break}if(a.child===s.child){for(s=a.child;s;){if(s===r)return Yy(a),e;if(s===n)return Yy(a),t;s=s.sibling}throw Error(de(188))}if(r.return!==n.return)r=a,n=s;else{for(var i=!1,o=a.child;o;){if(o===r){i=!0,r=a,n=s;break}if(o===n){i=!0,n=a,r=s;break}o=o.sibling}if(!i){for(o=s.child;o;){if(o===r){i=!0,r=s,n=a;break}if(o===n){i=!0,n=s,r=a;break}o=o.sibling}if(!i)throw Error(de(189))}}if(r.alternate!==n)throw Error(de(190))}if(r.tag!==3)throw Error(de(188));return r.stateNode.current===r?e:t}function oS(e){return e=RD(e),e!==null?lS(e):null}function lS(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=lS(e);if(t!==null)return t;e=e.sibling}return null}var cS=sn.unstable_scheduleCallback,Gy=sn.unstable_cancelCallback,MD=sn.unstable_shouldYield,ID=sn.unstable_requestPaint,jt=sn.unstable_now,LD=sn.unstable_getCurrentPriorityLevel,Gg=sn.unstable_ImmediatePriority,uS=sn.unstable_UserBlockingPriority,Jd=sn.unstable_NormalPriority,$D=sn.unstable_LowPriority,fS=sn.unstable_IdlePriority,oh=null,ba=null;function BD(e){if(ba&&typeof ba.onCommitFiberRoot=="function")try{ba.onCommitFiberRoot(oh,e,void 0,(e.current.flags&128)===128)}catch{}}var Qn=Math.clz32?Math.clz32:VD,UD=Math.log,WD=Math.LN2;function VD(e){return e>>>=0,e===0?32:31-(UD(e)/WD|0)|0}var Vf=64,Hf=4194304;function Tc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function Zd(e,t){var r=e.pendingLanes;if(r===0)return 0;var n=0,a=e.suspendedLanes,s=e.pingedLanes,i=r&268435455;if(i!==0){var o=i&~a;o!==0?n=Tc(o):(s&=i,s!==0&&(n=Tc(s)))}else i=r&~a,i!==0?n=Tc(i):s!==0&&(n=Tc(s));if(n===0)return 0;if(t!==0&&t!==n&&!(t&a)&&(a=n&-n,s=t&-t,a>=s||a===16&&(s&4194240)!==0))return t;if(n&4&&(n|=r&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=n;0<t;)r=31-Qn(t),a=1<<r,n|=e[r],t&=~a;return n}function HD(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function zD(e,t){for(var r=e.suspendedLanes,n=e.pingedLanes,a=e.expirationTimes,s=e.pendingLanes;0<s;){var i=31-Qn(s),o=1<<i,l=a[i];l===-1?(!(o&r)||o&n)&&(a[i]=HD(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function tv(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function dS(){var e=Vf;return Vf<<=1,!(Vf&4194240)&&(Vf=64),e}function Pp(e){for(var t=[],r=0;31>r;r++)t.push(e);return t}function nf(e,t,r){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Qn(t),e[t]=r}function YD(e,t){var r=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var n=e.eventTimes;for(e=e.expirationTimes;0<r;){var a=31-Qn(r),s=1<<a;t[a]=0,n[a]=-1,e[a]=-1,r&=~s}}function Kg(e,t){var r=e.entangledLanes|=t;for(e=e.entanglements;r;){var n=31-Qn(r),a=1<<n;a&t|e[n]&t&&(e[n]|=t),r&=~a}}var Ze=0;function hS(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var pS,qg,mS,vS,gS,rv=!1,zf=[],Vs=null,Hs=null,zs=null,uu=new Map,fu=new Map,Ds=[],GD="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ky(e,t){switch(e){case"focusin":case"focusout":Vs=null;break;case"dragenter":case"dragleave":Hs=null;break;case"mouseover":case"mouseout":zs=null;break;case"pointerover":case"pointerout":uu.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":fu.delete(t.pointerId)}}function fc(e,t,r,n,a,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:r,eventSystemFlags:n,nativeEvent:s,targetContainers:[a]},t!==null&&(t=sf(t),t!==null&&qg(t)),e):(e.eventSystemFlags|=n,t=e.targetContainers,a!==null&&t.indexOf(a)===-1&&t.push(a),e)}function KD(e,t,r,n,a){switch(t){case"focusin":return Vs=fc(Vs,e,t,r,n,a),!0;case"dragenter":return Hs=fc(Hs,e,t,r,n,a),!0;case"mouseover":return zs=fc(zs,e,t,r,n,a),!0;case"pointerover":var s=a.pointerId;return uu.set(s,fc(uu.get(s)||null,e,t,r,n,a)),!0;case"gotpointercapture":return s=a.pointerId,fu.set(s,fc(fu.get(s)||null,e,t,r,n,a)),!0}return!1}function xS(e){var t=Ni(e.target);if(t!==null){var r=lo(t);if(r!==null){if(t=r.tag,t===13){if(t=iS(r),t!==null){e.blockedOn=t,gS(e.priority,function(){mS(r)});return}}else if(t===3&&r.stateNode.current.memoizedState.isDehydrated){e.blockedOn=r.tag===3?r.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Nd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var r=nv(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(r===null){r=e.nativeEvent;var n=new r.constructor(r.type,r);Qm=n,r.target.dispatchEvent(n),Qm=null}else return t=sf(r),t!==null&&qg(t),e.blockedOn=r,!1;t.shift()}return!0}function qy(e,t,r){Nd(e)&&r.delete(t)}function qD(){rv=!1,Vs!==null&&Nd(Vs)&&(Vs=null),Hs!==null&&Nd(Hs)&&(Hs=null),zs!==null&&Nd(zs)&&(zs=null),uu.forEach(qy),fu.forEach(qy)}function dc(e,t){e.blockedOn===t&&(e.blockedOn=null,rv||(rv=!0,sn.unstable_scheduleCallback(sn.unstable_NormalPriority,qD)))}function du(e){function t(a){return dc(a,e)}if(0<zf.length){dc(zf[0],e);for(var r=1;r<zf.length;r++){var n=zf[r];n.blockedOn===e&&(n.blockedOn=null)}}for(Vs!==null&&dc(Vs,e),Hs!==null&&dc(Hs,e),zs!==null&&dc(zs,e),uu.forEach(t),fu.forEach(t),r=0;r<Ds.length;r++)n=Ds[r],n.blockedOn===e&&(n.blockedOn=null);for(;0<Ds.length&&(r=Ds[0],r.blockedOn===null);)xS(r),r.blockedOn===null&&Ds.shift()}var el=vs.ReactCurrentBatchConfig,e0=!0;function XD(e,t,r,n){var a=Ze,s=el.transition;el.transition=null;try{Ze=1,Xg(e,t,r,n)}finally{Ze=a,el.transition=s}}function QD(e,t,r,n){var a=Ze,s=el.transition;el.transition=null;try{Ze=4,Xg(e,t,r,n)}finally{Ze=a,el.transition=s}}function Xg(e,t,r,n){if(e0){var a=nv(e,t,r,n);if(a===null)Vp(e,t,n,t0,r),Ky(e,n);else if(KD(a,e,t,r,n))n.stopPropagation();else if(Ky(e,n),t&4&&-1<GD.indexOf(e)){for(;a!==null;){var s=sf(a);if(s!==null&&pS(s),s=nv(e,t,r,n),s===null&&Vp(e,t,n,t0,r),s===a)break;a=s}a!==null&&n.stopPropagation()}else Vp(e,t,n,null,r)}}var t0=null;function nv(e,t,r,n){if(t0=null,e=Yg(n),e=Ni(e),e!==null)if(t=lo(e),t===null)e=null;else if(r=t.tag,r===13){if(e=iS(t),e!==null)return e;e=null}else if(r===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return t0=e,null}function yS(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(LD()){case Gg:return 1;case uS:return 4;case Jd:case $D:return 16;case fS:return 536870912;default:return 16}default:return 16}}var Rs=null,Qg=null,Ad=null;function _S(){if(Ad)return Ad;var e,t=Qg,r=t.length,n,a="value"in Rs?Rs.value:Rs.textContent,s=a.length;for(e=0;e<r&&t[e]===a[e];e++);var i=r-e;for(n=1;n<=i&&t[r-n]===a[s-n];n++);return Ad=a.slice(e,1<n?1-n:void 0)}function Od(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function Yf(){return!0}function Xy(){return!1}function un(e){function t(r,n,a,s,i){this._reactName=r,this._targetInst=a,this.type=n,this.nativeEvent=s,this.target=i,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(r=e[o],this[o]=r?r(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?Yf:Xy,this.isPropagationStopped=Xy,this}return Et(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var r=this.nativeEvent;r&&(r.preventDefault?r.preventDefault():typeof r.returnValue!="unknown"&&(r.returnValue=!1),this.isDefaultPrevented=Yf)},stopPropagation:function(){var r=this.nativeEvent;r&&(r.stopPropagation?r.stopPropagation():typeof r.cancelBubble!="unknown"&&(r.cancelBubble=!0),this.isPropagationStopped=Yf)},persist:function(){},isPersistent:Yf}),t}var Dl={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Jg=un(Dl),af=Et({},Dl,{view:0,detail:0}),JD=un(af),Fp,Rp,hc,lh=Et({},af,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Zg,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==hc&&(hc&&e.type==="mousemove"?(Fp=e.screenX-hc.screenX,Rp=e.screenY-hc.screenY):Rp=Fp=0,hc=e),Fp)},movementY:function(e){return"movementY"in e?e.movementY:Rp}}),Qy=un(lh),ZD=Et({},lh,{dataTransfer:0}),ej=un(ZD),tj=Et({},af,{relatedTarget:0}),Mp=un(tj),rj=Et({},Dl,{animationName:0,elapsedTime:0,pseudoElement:0}),nj=un(rj),aj=Et({},Dl,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),sj=un(aj),ij=Et({},Dl,{data:0}),Jy=un(ij),oj={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},lj={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},cj={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function uj(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=cj[e])?!!t[e]:!1}function Zg(){return uj}var fj=Et({},af,{key:function(e){if(e.key){var t=oj[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Od(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?lj[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Zg,charCode:function(e){return e.type==="keypress"?Od(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Od(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),dj=un(fj),hj=Et({},lh,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Zy=un(hj),pj=Et({},af,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Zg}),mj=un(pj),vj=Et({},Dl,{propertyName:0,elapsedTime:0,pseudoElement:0}),gj=un(vj),xj=Et({},lh,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),yj=un(xj),_j=[9,13,27,32],ex=is&&"CompositionEvent"in window,Mc=null;is&&"documentMode"in document&&(Mc=document.documentMode);var wj=is&&"TextEvent"in window&&!Mc,wS=is&&(!ex||Mc&&8<Mc&&11>=Mc),e_=" ",t_=!1;function bS(e,t){switch(e){case"keyup":return _j.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ES(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var Mo=!1;function bj(e,t){switch(e){case"compositionend":return ES(t);case"keypress":return t.which!==32?null:(t_=!0,e_);case"textInput":return e=t.data,e===e_&&t_?null:e;default:return null}}function Ej(e,t){if(Mo)return e==="compositionend"||!ex&&bS(e,t)?(e=_S(),Ad=Qg=Rs=null,Mo=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return wS&&t.locale!=="ko"?null:t.data;default:return null}}var Sj={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function r_(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!Sj[e.type]:t==="textarea"}function SS(e,t,r,n){tS(n),t=r0(t,"onChange"),0<t.length&&(r=new Jg("onChange","change",null,r,n),e.push({event:r,listeners:t}))}var Ic=null,hu=null;function kj(e){RS(e,0)}function ch(e){var t=$o(e);if(KE(t))return e}function Tj(e,t){if(e==="change")return t}var kS=!1;if(is){var Ip;if(is){var Lp="oninput"in document;if(!Lp){var n_=document.createElement("div");n_.setAttribute("oninput","return;"),Lp=typeof n_.oninput=="function"}Ip=Lp}else Ip=!1;kS=Ip&&(!document.documentMode||9<document.documentMode)}function a_(){Ic&&(Ic.detachEvent("onpropertychange",TS),hu=Ic=null)}function TS(e){if(e.propertyName==="value"&&ch(hu)){var t=[];SS(t,hu,e,Yg(e)),sS(kj,t)}}function Cj(e,t,r){e==="focusin"?(a_(),Ic=t,hu=r,Ic.attachEvent("onpropertychange",TS)):e==="focusout"&&a_()}function Nj(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return ch(hu)}function Aj(e,t){if(e==="click")return ch(t)}function Oj(e,t){if(e==="input"||e==="change")return ch(t)}function Dj(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var ra=typeof Object.is=="function"?Object.is:Dj;function pu(e,t){if(ra(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var r=Object.keys(e),n=Object.keys(t);if(r.length!==n.length)return!1;for(n=0;n<r.length;n++){var a=r[n];if(!$m.call(t,a)||!ra(e[a],t[a]))return!1}return!0}function s_(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function i_(e,t){var r=s_(e);e=0;for(var n;r;){if(r.nodeType===3){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=s_(r)}}function CS(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?CS(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function NS(){for(var e=window,t=qd();t instanceof e.HTMLIFrameElement;){try{var r=typeof t.contentWindow.location.href=="string"}catch{r=!1}if(r)e=t.contentWindow;else break;t=qd(e.document)}return t}function tx(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function jj(e){var t=NS(),r=e.focusedElem,n=e.selectionRange;if(t!==r&&r&&r.ownerDocument&&CS(r.ownerDocument.documentElement,r)){if(n!==null&&tx(r)){if(t=n.start,e=n.end,e===void 0&&(e=t),"selectionStart"in r)r.selectionStart=t,r.selectionEnd=Math.min(e,r.value.length);else if(e=(t=r.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var a=r.textContent.length,s=Math.min(n.start,a);n=n.end===void 0?s:Math.min(n.end,a),!e.extend&&s>n&&(a=n,n=s,s=a),a=i_(r,s);var i=i_(r,n);a&&i&&(e.rangeCount!==1||e.anchorNode!==a.node||e.anchorOffset!==a.offset||e.focusNode!==i.node||e.focusOffset!==i.offset)&&(t=t.createRange(),t.setStart(a.node,a.offset),e.removeAllRanges(),s>n?(e.addRange(t),e.extend(i.node,i.offset)):(t.setEnd(i.node,i.offset),e.addRange(t)))}}for(t=[],e=r;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof r.focus=="function"&&r.focus(),r=0;r<t.length;r++)e=t[r],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var Pj=is&&"documentMode"in document&&11>=document.documentMode,Io=null,av=null,Lc=null,sv=!1;function o_(e,t,r){var n=r.window===r?r.document:r.nodeType===9?r:r.ownerDocument;sv||Io==null||Io!==qd(n)||(n=Io,"selectionStart"in n&&tx(n)?n={start:n.selectionStart,end:n.selectionEnd}:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}),Lc&&pu(Lc,n)||(Lc=n,n=r0(av,"onSelect"),0<n.length&&(t=new Jg("onSelect","select",null,t,r),e.push({event:t,listeners:n}),t.target=Io)))}function Gf(e,t){var r={};return r[e.toLowerCase()]=t.toLowerCase(),r["Webkit"+e]="webkit"+t,r["Moz"+e]="moz"+t,r}var Lo={animationend:Gf("Animation","AnimationEnd"),animationiteration:Gf("Animation","AnimationIteration"),animationstart:Gf("Animation","AnimationStart"),transitionend:Gf("Transition","TransitionEnd")},$p={},AS={};is&&(AS=document.createElement("div").style,"AnimationEvent"in window||(delete Lo.animationend.animation,delete Lo.animationiteration.animation,delete Lo.animationstart.animation),"TransitionEvent"in window||delete Lo.transitionend.transition);function uh(e){if($p[e])return $p[e];if(!Lo[e])return e;var t=Lo[e],r;for(r in t)if(t.hasOwnProperty(r)&&r in AS)return $p[e]=t[r];return e}var OS=uh("animationend"),DS=uh("animationiteration"),jS=uh("animationstart"),PS=uh("transitionend"),FS=new Map,l_="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(e,t){FS.set(e,t),oo(t,[e])}for(var Bp=0;Bp<l_.length;Bp++){var Up=l_[Bp],Fj=Up.toLowerCase(),Rj=Up[0].toUpperCase()+Up.slice(1);oi(Fj,"on"+Rj)}oi(OS,"onAnimationEnd");oi(DS,"onAnimationIteration");oi(jS,"onAnimationStart");oi("dblclick","onDoubleClick");oi("focusin","onFocus");oi("focusout","onBlur");oi(PS,"onTransitionEnd");fl("onMouseEnter",["mouseout","mouseover"]);fl("onMouseLeave",["mouseout","mouseover"]);fl("onPointerEnter",["pointerout","pointerover"]);fl("onPointerLeave",["pointerout","pointerover"]);oo("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));oo("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));oo("onBeforeInput",["compositionend","keypress","textInput","paste"]);oo("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));oo("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));oo("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cc="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Mj=new Set("cancel close invalid load scroll toggle".split(" ").concat(Cc));function c_(e,t,r){var n=e.type||"unknown-event";e.currentTarget=r,FD(n,t,void 0,e),e.currentTarget=null}function RS(e,t){t=(t&4)!==0;for(var r=0;r<e.length;r++){var n=e[r],a=n.event;n=n.listeners;e:{var s=void 0;if(t)for(var i=n.length-1;0<=i;i--){var o=n[i],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&a.isPropagationStopped())break e;c_(a,o,c),s=l}else for(i=0;i<n.length;i++){if(o=n[i],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&a.isPropagationStopped())break e;c_(a,o,c),s=l}}}if(Qd)throw e=ev,Qd=!1,ev=null,e}function ot(e,t){var r=t[uv];r===void 0&&(r=t[uv]=new Set);var n=e+"__bubble";r.has(n)||(MS(t,e,2,!1),r.add(n))}function Wp(e,t,r){var n=0;t&&(n|=4),MS(r,e,n,t)}var Kf="_reactListening"+Math.random().toString(36).slice(2);function mu(e){if(!e[Kf]){e[Kf]=!0,VE.forEach(function(r){r!=="selectionchange"&&(Mj.has(r)||Wp(r,!1,e),Wp(r,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[Kf]||(t[Kf]=!0,Wp("selectionchange",!1,t))}}function MS(e,t,r,n){switch(yS(t)){case 1:var a=XD;break;case 4:a=QD;break;default:a=Xg}r=a.bind(null,t,r,e),a=void 0,!Zm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(a=!0),n?a!==void 0?e.addEventListener(t,r,{capture:!0,passive:a}):e.addEventListener(t,r,!0):a!==void 0?e.addEventListener(t,r,{passive:a}):e.addEventListener(t,r,!1)}function Vp(e,t,r,n,a){var s=n;if(!(t&1)&&!(t&2)&&n!==null)e:for(;;){if(n===null)return;var i=n.tag;if(i===3||i===4){var o=n.stateNode.containerInfo;if(o===a||o.nodeType===8&&o.parentNode===a)break;if(i===4)for(i=n.return;i!==null;){var l=i.tag;if((l===3||l===4)&&(l=i.stateNode.containerInfo,l===a||l.nodeType===8&&l.parentNode===a))return;i=i.return}for(;o!==null;){if(i=Ni(o),i===null)return;if(l=i.tag,l===5||l===6){n=s=i;continue e}o=o.parentNode}}n=n.return}sS(function(){var c=s,f=Yg(r),d=[];e:{var h=FS.get(e);if(h!==void 0){var p=Jg,v=e;switch(e){case"keypress":if(Od(r)===0)break e;case"keydown":case"keyup":p=dj;break;case"focusin":v="focus",p=Mp;break;case"focusout":v="blur",p=Mp;break;case"beforeblur":case"afterblur":p=Mp;break;case"click":if(r.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":p=Qy;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":p=ej;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":p=mj;break;case OS:case DS:case jS:p=nj;break;case PS:p=gj;break;case"scroll":p=JD;break;case"wheel":p=yj;break;case"copy":case"cut":case"paste":p=sj;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":p=Zy}var m=(t&4)!==0,_=!m&&e==="scroll",g=m?h!==null?h+"Capture":null:h;m=[];for(var y=c,x;y!==null;){x=y;var w=x.stateNode;if(x.tag===5&&w!==null&&(x=w,g!==null&&(w=cu(y,g),w!=null&&m.push(vu(y,w,x)))),_)break;y=y.return}0<m.length&&(h=new p(h,v,null,r,f),d.push({event:h,listeners:m}))}}if(!(t&7)){e:{if(h=e==="mouseover"||e==="pointerover",p=e==="mouseout"||e==="pointerout",h&&r!==Qm&&(v=r.relatedTarget||r.fromElement)&&(Ni(v)||v[os]))break e;if((p||h)&&(h=f.window===f?f:(h=f.ownerDocument)?h.defaultView||h.parentWindow:window,p?(v=r.relatedTarget||r.toElement,p=c,v=v?Ni(v):null,v!==null&&(_=lo(v),v!==_||v.tag!==5&&v.tag!==6)&&(v=null)):(p=null,v=c),p!==v)){if(m=Qy,w="onMouseLeave",g="onMouseEnter",y="mouse",(e==="pointerout"||e==="pointerover")&&(m=Zy,w="onPointerLeave",g="onPointerEnter",y="pointer"),_=p==null?h:$o(p),x=v==null?h:$o(v),h=new m(w,y+"leave",p,r,f),h.target=_,h.relatedTarget=x,w=null,Ni(f)===c&&(m=new m(g,y+"enter",v,r,f),m.target=x,m.relatedTarget=_,w=m),_=w,p&&v)t:{for(m=p,g=v,y=0,x=m;x;x=Eo(x))y++;for(x=0,w=g;w;w=Eo(w))x++;for(;0<y-x;)m=Eo(m),y--;for(;0<x-y;)g=Eo(g),x--;for(;y--;){if(m===g||g!==null&&m===g.alternate)break t;m=Eo(m),g=Eo(g)}m=null}else m=null;p!==null&&u_(d,h,p,m,!1),v!==null&&_!==null&&u_(d,_,v,m,!0)}}e:{if(h=c?$o(c):window,p=h.nodeName&&h.nodeName.toLowerCase(),p==="select"||p==="input"&&h.type==="file")var E=Tj;else if(r_(h))if(kS)E=Oj;else{E=Nj;var S=Cj}else(p=h.nodeName)&&p.toLowerCase()==="input"&&(h.type==="checkbox"||h.type==="radio")&&(E=Aj);if(E&&(E=E(e,c))){SS(d,E,r,f);break e}S&&S(e,h,c),e==="focusout"&&(S=h._wrapperState)&&S.controlled&&h.type==="number"&&Ym(h,"number",h.value)}switch(S=c?$o(c):window,e){case"focusin":(r_(S)||S.contentEditable==="true")&&(Io=S,av=c,Lc=null);break;case"focusout":Lc=av=Io=null;break;case"mousedown":sv=!0;break;case"contextmenu":case"mouseup":case"dragend":sv=!1,o_(d,r,f);break;case"selectionchange":if(Pj)break;case"keydown":case"keyup":o_(d,r,f)}var b;if(ex)e:{switch(e){case"compositionstart":var j="onCompositionStart";break e;case"compositionend":j="onCompositionEnd";break e;case"compositionupdate":j="onCompositionUpdate";break e}j=void 0}else Mo?bS(e,r)&&(j="onCompositionEnd"):e==="keydown"&&r.keyCode===229&&(j="onCompositionStart");j&&(wS&&r.locale!=="ko"&&(Mo||j!=="onCompositionStart"?j==="onCompositionEnd"&&Mo&&(b=_S()):(Rs=f,Qg="value"in Rs?Rs.value:Rs.textContent,Mo=!0)),S=r0(c,j),0<S.length&&(j=new Jy(j,e,null,r,f),d.push({event:j,listeners:S}),b?j.data=b:(b=ES(r),b!==null&&(j.data=b)))),(b=wj?bj(e,r):Ej(e,r))&&(c=r0(c,"onBeforeInput"),0<c.length&&(f=new Jy("onBeforeInput","beforeinput",null,r,f),d.push({event:f,listeners:c}),f.data=b))}RS(d,t)})}function vu(e,t,r){return{instance:e,listener:t,currentTarget:r}}function r0(e,t){for(var r=t+"Capture",n=[];e!==null;){var a=e,s=a.stateNode;a.tag===5&&s!==null&&(a=s,s=cu(e,r),s!=null&&n.unshift(vu(e,s,a)),s=cu(e,t),s!=null&&n.push(vu(e,s,a))),e=e.return}return n}function Eo(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function u_(e,t,r,n,a){for(var s=t._reactName,i=[];r!==null&&r!==n;){var o=r,l=o.alternate,c=o.stateNode;if(l!==null&&l===n)break;o.tag===5&&c!==null&&(o=c,a?(l=cu(r,s),l!=null&&i.unshift(vu(r,l,o))):a||(l=cu(r,s),l!=null&&i.push(vu(r,l,o)))),r=r.return}i.length!==0&&e.push({event:t,listeners:i})}var Ij=/\r\n?/g,Lj=/\u0000|\uFFFD/g;function f_(e){return(typeof e=="string"?e:""+e).replace(Ij,`
`).replace(Lj,"")}function qf(e,t,r){if(t=f_(t),f_(e)!==t&&r)throw Error(de(425))}function n0(){}var iv=null,ov=null;function lv(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var cv=typeof setTimeout=="function"?setTimeout:void 0,$j=typeof clearTimeout=="function"?clearTimeout:void 0,d_=typeof Promise=="function"?Promise:void 0,Bj=typeof queueMicrotask=="function"?queueMicrotask:typeof d_<"u"?function(e){return d_.resolve(null).then(e).catch(Uj)}:cv;function Uj(e){setTimeout(function(){throw e})}function Hp(e,t){var r=t,n=0;do{var a=r.nextSibling;if(e.removeChild(r),a&&a.nodeType===8)if(r=a.data,r==="/$"){if(n===0){e.removeChild(a),du(t);return}n--}else r!=="$"&&r!=="$?"&&r!=="$!"||n++;r=a}while(r);du(t)}function Ys(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function h_(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="$"||r==="$!"||r==="$?"){if(t===0)return e;t--}else r==="/$"&&t++}e=e.previousSibling}return null}var jl=Math.random().toString(36).slice(2),ga="__reactFiber$"+jl,gu="__reactProps$"+jl,os="__reactContainer$"+jl,uv="__reactEvents$"+jl,Wj="__reactListeners$"+jl,Vj="__reactHandles$"+jl;function Ni(e){var t=e[ga];if(t)return t;for(var r=e.parentNode;r;){if(t=r[os]||r[ga]){if(r=t.alternate,t.child!==null||r!==null&&r.child!==null)for(e=h_(e);e!==null;){if(r=e[ga])return r;e=h_(e)}return t}e=r,r=e.parentNode}return null}function sf(e){return e=e[ga]||e[os],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function $o(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(de(33))}function fh(e){return e[gu]||null}var fv=[],Bo=-1;function li(e){return{current:e}}function ut(e){0>Bo||(e.current=fv[Bo],fv[Bo]=null,Bo--)}function at(e,t){Bo++,fv[Bo]=e.current,e.current=t}var ti={},wr=li(ti),Hr=li(!1),Ui=ti;function dl(e,t){var r=e.type.contextTypes;if(!r)return ti;var n=e.stateNode;if(n&&n.__reactInternalMemoizedUnmaskedChildContext===t)return n.__reactInternalMemoizedMaskedChildContext;var a={},s;for(s in r)a[s]=t[s];return n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=a),a}function zr(e){return e=e.childContextTypes,e!=null}function a0(){ut(Hr),ut(wr)}function p_(e,t,r){if(wr.current!==ti)throw Error(de(168));at(wr,t),at(Hr,r)}function IS(e,t,r){var n=e.stateNode;if(t=t.childContextTypes,typeof n.getChildContext!="function")return r;n=n.getChildContext();for(var a in n)if(!(a in t))throw Error(de(108,CD(e)||"Unknown",a));return Et({},r,n)}function s0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||ti,Ui=wr.current,at(wr,e),at(Hr,Hr.current),!0}function m_(e,t,r){var n=e.stateNode;if(!n)throw Error(de(169));r?(e=IS(e,t,Ui),n.__reactInternalMemoizedMergedChildContext=e,ut(Hr),ut(wr),at(wr,e)):ut(Hr),at(Hr,r)}var za=null,dh=!1,zp=!1;function LS(e){za===null?za=[e]:za.push(e)}function Hj(e){dh=!0,LS(e)}function ci(){if(!zp&&za!==null){zp=!0;var e=0,t=Ze;try{var r=za;for(Ze=1;e<r.length;e++){var n=r[e];do n=n(!0);while(n!==null)}za=null,dh=!1}catch(a){throw za!==null&&(za=za.slice(e+1)),cS(Gg,ci),a}finally{Ze=t,zp=!1}}return null}var Uo=[],Wo=0,i0=null,o0=0,xn=[],yn=0,Wi=null,Ka=1,qa="";function wi(e,t){Uo[Wo++]=o0,Uo[Wo++]=i0,i0=e,o0=t}function $S(e,t,r){xn[yn++]=Ka,xn[yn++]=qa,xn[yn++]=Wi,Wi=e;var n=Ka;e=qa;var a=32-Qn(n)-1;n&=~(1<<a),r+=1;var s=32-Qn(t)+a;if(30<s){var i=a-a%5;s=(n&(1<<i)-1).toString(32),n>>=i,a-=i,Ka=1<<32-Qn(t)+a|r<<a|n,qa=s+e}else Ka=1<<s|r<<a|n,qa=e}function rx(e){e.return!==null&&(wi(e,1),$S(e,1,0))}function nx(e){for(;e===i0;)i0=Uo[--Wo],Uo[Wo]=null,o0=Uo[--Wo],Uo[Wo]=null;for(;e===Wi;)Wi=xn[--yn],xn[yn]=null,qa=xn[--yn],xn[yn]=null,Ka=xn[--yn],xn[yn]=null}var an=null,nn=null,vt=!1,Yn=null;function BS(e,t){var r=Sn(5,null,null,0);r.elementType="DELETED",r.stateNode=t,r.return=e,t=e.deletions,t===null?(e.deletions=[r],e.flags|=16):t.push(r)}function v_(e,t){switch(e.tag){case 5:var r=e.type;return t=t.nodeType!==1||r.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,an=e,nn=Ys(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,an=e,nn=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(r=Wi!==null?{id:Ka,overflow:qa}:null,e.memoizedState={dehydrated:t,treeContext:r,retryLane:1073741824},r=Sn(18,null,null,0),r.stateNode=t,r.return=e,e.child=r,an=e,nn=null,!0):!1;default:return!1}}function dv(e){return(e.mode&1)!==0&&(e.flags&128)===0}function hv(e){if(vt){var t=nn;if(t){var r=t;if(!v_(e,t)){if(dv(e))throw Error(de(418));t=Ys(r.nextSibling);var n=an;t&&v_(e,t)?BS(n,r):(e.flags=e.flags&-4097|2,vt=!1,an=e)}}else{if(dv(e))throw Error(de(418));e.flags=e.flags&-4097|2,vt=!1,an=e}}}function g_(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;an=e}function Xf(e){if(e!==an)return!1;if(!vt)return g_(e),vt=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!lv(e.type,e.memoizedProps)),t&&(t=nn)){if(dv(e))throw US(),Error(de(418));for(;t;)BS(e,t),t=Ys(t.nextSibling)}if(g_(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(de(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var r=e.data;if(r==="/$"){if(t===0){nn=Ys(e.nextSibling);break e}t--}else r!=="$"&&r!=="$!"&&r!=="$?"||t++}e=e.nextSibling}nn=null}}else nn=an?Ys(e.stateNode.nextSibling):null;return!0}function US(){for(var e=nn;e;)e=Ys(e.nextSibling)}function hl(){nn=an=null,vt=!1}function ax(e){Yn===null?Yn=[e]:Yn.push(e)}var zj=vs.ReactCurrentBatchConfig;function pc(e,t,r){if(e=r.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(r._owner){if(r=r._owner,r){if(r.tag!==1)throw Error(de(309));var n=r.stateNode}if(!n)throw Error(de(147,e));var a=n,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(i){var o=a.refs;i===null?delete o[s]:o[s]=i},t._stringRef=s,t)}if(typeof e!="string")throw Error(de(284));if(!r._owner)throw Error(de(290,e))}return e}function Qf(e,t){throw e=Object.prototype.toString.call(t),Error(de(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function x_(e){var t=e._init;return t(e._payload)}function WS(e){function t(g,y){if(e){var x=g.deletions;x===null?(g.deletions=[y],g.flags|=16):x.push(y)}}function r(g,y){if(!e)return null;for(;y!==null;)t(g,y),y=y.sibling;return null}function n(g,y){for(g=new Map;y!==null;)y.key!==null?g.set(y.key,y):g.set(y.index,y),y=y.sibling;return g}function a(g,y){return g=Xs(g,y),g.index=0,g.sibling=null,g}function s(g,y,x){return g.index=x,e?(x=g.alternate,x!==null?(x=x.index,x<y?(g.flags|=2,y):x):(g.flags|=2,y)):(g.flags|=1048576,y)}function i(g){return e&&g.alternate===null&&(g.flags|=2),g}function o(g,y,x,w){return y===null||y.tag!==6?(y=Jp(x,g.mode,w),y.return=g,y):(y=a(y,x),y.return=g,y)}function l(g,y,x,w){var E=x.type;return E===Ro?f(g,y,x.props.children,w,x.key):y!==null&&(y.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ns&&x_(E)===y.type)?(w=a(y,x.props),w.ref=pc(g,y,x),w.return=g,w):(w=Id(x.type,x.key,x.props,null,g.mode,w),w.ref=pc(g,y,x),w.return=g,w)}function c(g,y,x,w){return y===null||y.tag!==4||y.stateNode.containerInfo!==x.containerInfo||y.stateNode.implementation!==x.implementation?(y=Zp(x,g.mode,w),y.return=g,y):(y=a(y,x.children||[]),y.return=g,y)}function f(g,y,x,w,E){return y===null||y.tag!==7?(y=Fi(x,g.mode,w,E),y.return=g,y):(y=a(y,x),y.return=g,y)}function d(g,y,x){if(typeof y=="string"&&y!==""||typeof y=="number")return y=Jp(""+y,g.mode,x),y.return=g,y;if(typeof y=="object"&&y!==null){switch(y.$$typeof){case Bf:return x=Id(y.type,y.key,y.props,null,g.mode,x),x.ref=pc(g,null,y),x.return=g,x;case Fo:return y=Zp(y,g.mode,x),y.return=g,y;case Ns:var w=y._init;return d(g,w(y._payload),x)}if(kc(y)||cc(y))return y=Fi(y,g.mode,x,null),y.return=g,y;Qf(g,y)}return null}function h(g,y,x,w){var E=y!==null?y.key:null;if(typeof x=="string"&&x!==""||typeof x=="number")return E!==null?null:o(g,y,""+x,w);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Bf:return x.key===E?l(g,y,x,w):null;case Fo:return x.key===E?c(g,y,x,w):null;case Ns:return E=x._init,h(g,y,E(x._payload),w)}if(kc(x)||cc(x))return E!==null?null:f(g,y,x,w,null);Qf(g,x)}return null}function p(g,y,x,w,E){if(typeof w=="string"&&w!==""||typeof w=="number")return g=g.get(x)||null,o(y,g,""+w,E);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case Bf:return g=g.get(w.key===null?x:w.key)||null,l(y,g,w,E);case Fo:return g=g.get(w.key===null?x:w.key)||null,c(y,g,w,E);case Ns:var S=w._init;return p(g,y,x,S(w._payload),E)}if(kc(w)||cc(w))return g=g.get(x)||null,f(y,g,w,E,null);Qf(y,w)}return null}function v(g,y,x,w){for(var E=null,S=null,b=y,j=y=0,k=null;b!==null&&j<x.length;j++){b.index>j?(k=b,b=null):k=b.sibling;var C=h(g,b,x[j],w);if(C===null){b===null&&(b=k);break}e&&b&&C.alternate===null&&t(g,b),y=s(C,y,j),S===null?E=C:S.sibling=C,S=C,b=k}if(j===x.length)return r(g,b),vt&&wi(g,j),E;if(b===null){for(;j<x.length;j++)b=d(g,x[j],w),b!==null&&(y=s(b,y,j),S===null?E=b:S.sibling=b,S=b);return vt&&wi(g,j),E}for(b=n(g,b);j<x.length;j++)k=p(b,g,j,x[j],w),k!==null&&(e&&k.alternate!==null&&b.delete(k.key===null?j:k.key),y=s(k,y,j),S===null?E=k:S.sibling=k,S=k);return e&&b.forEach(function(P){return t(g,P)}),vt&&wi(g,j),E}function m(g,y,x,w){var E=cc(x);if(typeof E!="function")throw Error(de(150));if(x=E.call(x),x==null)throw Error(de(151));for(var S=E=null,b=y,j=y=0,k=null,C=x.next();b!==null&&!C.done;j++,C=x.next()){b.index>j?(k=b,b=null):k=b.sibling;var P=h(g,b,C.value,w);if(P===null){b===null&&(b=k);break}e&&b&&P.alternate===null&&t(g,b),y=s(P,y,j),S===null?E=P:S.sibling=P,S=P,b=k}if(C.done)return r(g,b),vt&&wi(g,j),E;if(b===null){for(;!C.done;j++,C=x.next())C=d(g,C.value,w),C!==null&&(y=s(C,y,j),S===null?E=C:S.sibling=C,S=C);return vt&&wi(g,j),E}for(b=n(g,b);!C.done;j++,C=x.next())C=p(b,g,j,C.value,w),C!==null&&(e&&C.alternate!==null&&b.delete(C.key===null?j:C.key),y=s(C,y,j),S===null?E=C:S.sibling=C,S=C);return e&&b.forEach(function(I){return t(g,I)}),vt&&wi(g,j),E}function _(g,y,x,w){if(typeof x=="object"&&x!==null&&x.type===Ro&&x.key===null&&(x=x.props.children),typeof x=="object"&&x!==null){switch(x.$$typeof){case Bf:e:{for(var E=x.key,S=y;S!==null;){if(S.key===E){if(E=x.type,E===Ro){if(S.tag===7){r(g,S.sibling),y=a(S,x.props.children),y.return=g,g=y;break e}}else if(S.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Ns&&x_(E)===S.type){r(g,S.sibling),y=a(S,x.props),y.ref=pc(g,S,x),y.return=g,g=y;break e}r(g,S);break}else t(g,S);S=S.sibling}x.type===Ro?(y=Fi(x.props.children,g.mode,w,x.key),y.return=g,g=y):(w=Id(x.type,x.key,x.props,null,g.mode,w),w.ref=pc(g,y,x),w.return=g,g=w)}return i(g);case Fo:e:{for(S=x.key;y!==null;){if(y.key===S)if(y.tag===4&&y.stateNode.containerInfo===x.containerInfo&&y.stateNode.implementation===x.implementation){r(g,y.sibling),y=a(y,x.children||[]),y.return=g,g=y;break e}else{r(g,y);break}else t(g,y);y=y.sibling}y=Zp(x,g.mode,w),y.return=g,g=y}return i(g);case Ns:return S=x._init,_(g,y,S(x._payload),w)}if(kc(x))return v(g,y,x,w);if(cc(x))return m(g,y,x,w);Qf(g,x)}return typeof x=="string"&&x!==""||typeof x=="number"?(x=""+x,y!==null&&y.tag===6?(r(g,y.sibling),y=a(y,x),y.return=g,g=y):(r(g,y),y=Jp(x,g.mode,w),y.return=g,g=y),i(g)):r(g,y)}return _}var pl=WS(!0),VS=WS(!1),l0=li(null),c0=null,Vo=null,sx=null;function ix(){sx=Vo=c0=null}function ox(e){var t=l0.current;ut(l0),e._currentValue=t}function pv(e,t,r){for(;e!==null;){var n=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,n!==null&&(n.childLanes|=t)):n!==null&&(n.childLanes&t)!==t&&(n.childLanes|=t),e===r)break;e=e.return}}function tl(e,t){c0=e,sx=Vo=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Vr=!0),e.firstContext=null)}function Nn(e){var t=e._currentValue;if(sx!==e)if(e={context:e,memoizedValue:t,next:null},Vo===null){if(c0===null)throw Error(de(308));Vo=e,c0.dependencies={lanes:0,firstContext:e}}else Vo=Vo.next=e;return t}var Ai=null;function lx(e){Ai===null?Ai=[e]:Ai.push(e)}function HS(e,t,r,n){var a=t.interleaved;return a===null?(r.next=r,lx(t)):(r.next=a.next,a.next=r),t.interleaved=r,ls(e,n)}function ls(e,t){e.lanes|=t;var r=e.alternate;for(r!==null&&(r.lanes|=t),r=e,e=e.return;e!==null;)e.childLanes|=t,r=e.alternate,r!==null&&(r.childLanes|=t),r=e,e=e.return;return r.tag===3?r.stateNode:null}var As=!1;function cx(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function zS(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Za(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Gs(e,t,r){var n=e.updateQueue;if(n===null)return null;if(n=n.shared,He&2){var a=n.pending;return a===null?t.next=t:(t.next=a.next,a.next=t),n.pending=t,ls(e,r)}return a=n.interleaved,a===null?(t.next=t,lx(n)):(t.next=a.next,a.next=t),n.interleaved=t,ls(e,r)}function Dd(e,t,r){if(t=t.updateQueue,t!==null&&(t=t.shared,(r&4194240)!==0)){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kg(e,r)}}function y_(e,t){var r=e.updateQueue,n=e.alternate;if(n!==null&&(n=n.updateQueue,r===n)){var a=null,s=null;if(r=r.firstBaseUpdate,r!==null){do{var i={eventTime:r.eventTime,lane:r.lane,tag:r.tag,payload:r.payload,callback:r.callback,next:null};s===null?a=s=i:s=s.next=i,r=r.next}while(r!==null);s===null?a=s=t:s=s.next=t}else a=s=t;r={baseState:n.baseState,firstBaseUpdate:a,lastBaseUpdate:s,shared:n.shared,effects:n.effects},e.updateQueue=r;return}e=r.lastBaseUpdate,e===null?r.firstBaseUpdate=t:e.next=t,r.lastBaseUpdate=t}function u0(e,t,r,n){var a=e.updateQueue;As=!1;var s=a.firstBaseUpdate,i=a.lastBaseUpdate,o=a.shared.pending;if(o!==null){a.shared.pending=null;var l=o,c=l.next;l.next=null,i===null?s=c:i.next=c,i=l;var f=e.alternate;f!==null&&(f=f.updateQueue,o=f.lastBaseUpdate,o!==i&&(o===null?f.firstBaseUpdate=c:o.next=c,f.lastBaseUpdate=l))}if(s!==null){var d=a.baseState;i=0,f=c=l=null,o=s;do{var h=o.lane,p=o.eventTime;if((n&h)===h){f!==null&&(f=f.next={eventTime:p,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,m=o;switch(h=t,p=r,m.tag){case 1:if(v=m.payload,typeof v=="function"){d=v.call(p,d,h);break e}d=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,h=typeof v=="function"?v.call(p,d,h):v,h==null)break e;d=Et({},d,h);break e;case 2:As=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,h=a.effects,h===null?a.effects=[o]:h.push(o))}else p={eventTime:p,lane:h,tag:o.tag,payload:o.payload,callback:o.callback,next:null},f===null?(c=f=p,l=d):f=f.next=p,i|=h;if(o=o.next,o===null){if(o=a.shared.pending,o===null)break;h=o,o=h.next,h.next=null,a.lastBaseUpdate=h,a.shared.pending=null}}while(!0);if(f===null&&(l=d),a.baseState=l,a.firstBaseUpdate=c,a.lastBaseUpdate=f,t=a.shared.interleaved,t!==null){a=t;do i|=a.lane,a=a.next;while(a!==t)}else s===null&&(a.shared.lanes=0);Hi|=i,e.lanes=i,e.memoizedState=d}}function __(e,t,r){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var n=e[t],a=n.callback;if(a!==null){if(n.callback=null,n=r,typeof a!="function")throw Error(de(191,a));a.call(n)}}}var of={},Ea=li(of),xu=li(of),yu=li(of);function Oi(e){if(e===of)throw Error(de(174));return e}function ux(e,t){switch(at(yu,t),at(xu,e),at(Ea,of),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Km(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Km(t,e)}ut(Ea),at(Ea,t)}function ml(){ut(Ea),ut(xu),ut(yu)}function YS(e){Oi(yu.current);var t=Oi(Ea.current),r=Km(t,e.type);t!==r&&(at(xu,e),at(Ea,r))}function fx(e){xu.current===e&&(ut(Ea),ut(xu))}var _t=li(0);function f0(e){for(var t=e;t!==null;){if(t.tag===13){var r=t.memoizedState;if(r!==null&&(r=r.dehydrated,r===null||r.data==="$?"||r.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Yp=[];function dx(){for(var e=0;e<Yp.length;e++)Yp[e]._workInProgressVersionPrimary=null;Yp.length=0}var jd=vs.ReactCurrentDispatcher,Gp=vs.ReactCurrentBatchConfig,Vi=0,bt=null,Wt=null,Jt=null,d0=!1,$c=!1,_u=0,Yj=0;function fr(){throw Error(de(321))}function hx(e,t){if(t===null)return!1;for(var r=0;r<t.length&&r<e.length;r++)if(!ra(e[r],t[r]))return!1;return!0}function px(e,t,r,n,a,s){if(Vi=s,bt=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,jd.current=e===null||e.memoizedState===null?Xj:Qj,e=r(n,a),$c){s=0;do{if($c=!1,_u=0,25<=s)throw Error(de(301));s+=1,Jt=Wt=null,t.updateQueue=null,jd.current=Jj,e=r(n,a)}while($c)}if(jd.current=h0,t=Wt!==null&&Wt.next!==null,Vi=0,Jt=Wt=bt=null,d0=!1,t)throw Error(de(300));return e}function mx(){var e=_u!==0;return _u=0,e}function va(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e,Jt}function An(){if(Wt===null){var e=bt.alternate;e=e!==null?e.memoizedState:null}else e=Wt.next;var t=Jt===null?bt.memoizedState:Jt.next;if(t!==null)Jt=t,Wt=e;else{if(e===null)throw Error(de(310));Wt=e,e={memoizedState:Wt.memoizedState,baseState:Wt.baseState,baseQueue:Wt.baseQueue,queue:Wt.queue,next:null},Jt===null?bt.memoizedState=Jt=e:Jt=Jt.next=e}return Jt}function wu(e,t){return typeof t=="function"?t(e):t}function Kp(e){var t=An(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=Wt,a=n.baseQueue,s=r.pending;if(s!==null){if(a!==null){var i=a.next;a.next=s.next,s.next=i}n.baseQueue=a=s,r.pending=null}if(a!==null){s=a.next,n=n.baseState;var o=i=null,l=null,c=s;do{var f=c.lane;if((Vi&f)===f)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),n=c.hasEagerState?c.eagerState:e(n,c.action);else{var d={lane:f,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=d,i=n):l=l.next=d,bt.lanes|=f,Hi|=f}c=c.next}while(c!==null&&c!==s);l===null?i=n:l.next=o,ra(n,t.memoizedState)||(Vr=!0),t.memoizedState=n,t.baseState=i,t.baseQueue=l,r.lastRenderedState=n}if(e=r.interleaved,e!==null){a=e;do s=a.lane,bt.lanes|=s,Hi|=s,a=a.next;while(a!==e)}else a===null&&(r.lanes=0);return[t.memoizedState,r.dispatch]}function qp(e){var t=An(),r=t.queue;if(r===null)throw Error(de(311));r.lastRenderedReducer=e;var n=r.dispatch,a=r.pending,s=t.memoizedState;if(a!==null){r.pending=null;var i=a=a.next;do s=e(s,i.action),i=i.next;while(i!==a);ra(s,t.memoizedState)||(Vr=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),r.lastRenderedState=s}return[s,n]}function GS(){}function KS(e,t){var r=bt,n=An(),a=t(),s=!ra(n.memoizedState,a);if(s&&(n.memoizedState=a,Vr=!0),n=n.queue,vx(QS.bind(null,r,n,e),[e]),n.getSnapshot!==t||s||Jt!==null&&Jt.memoizedState.tag&1){if(r.flags|=2048,bu(9,XS.bind(null,r,n,a,t),void 0,null),Zt===null)throw Error(de(349));Vi&30||qS(r,t,a)}return a}function qS(e,t,r){e.flags|=16384,e={getSnapshot:t,value:r},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.stores=[e]):(r=t.stores,r===null?t.stores=[e]:r.push(e))}function XS(e,t,r,n){t.value=r,t.getSnapshot=n,JS(t)&&ZS(e)}function QS(e,t,r){return r(function(){JS(t)&&ZS(e)})}function JS(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!ra(e,r)}catch{return!0}}function ZS(e){var t=ls(e,1);t!==null&&Jn(t,e,1,-1)}function w_(e){var t=va();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:wu,lastRenderedState:e},t.queue=e,e=e.dispatch=qj.bind(null,bt,e),[t.memoizedState,e]}function bu(e,t,r,n){return e={tag:e,create:t,destroy:r,deps:n,next:null},t=bt.updateQueue,t===null?(t={lastEffect:null,stores:null},bt.updateQueue=t,t.lastEffect=e.next=e):(r=t.lastEffect,r===null?t.lastEffect=e.next=e:(n=r.next,r.next=e,e.next=n,t.lastEffect=e)),e}function ek(){return An().memoizedState}function Pd(e,t,r,n){var a=va();bt.flags|=e,a.memoizedState=bu(1|t,r,void 0,n===void 0?null:n)}function hh(e,t,r,n){var a=An();n=n===void 0?null:n;var s=void 0;if(Wt!==null){var i=Wt.memoizedState;if(s=i.destroy,n!==null&&hx(n,i.deps)){a.memoizedState=bu(t,r,s,n);return}}bt.flags|=e,a.memoizedState=bu(1|t,r,s,n)}function b_(e,t){return Pd(8390656,8,e,t)}function vx(e,t){return hh(2048,8,e,t)}function tk(e,t){return hh(4,2,e,t)}function rk(e,t){return hh(4,4,e,t)}function nk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function ak(e,t,r){return r=r!=null?r.concat([e]):null,hh(4,4,nk.bind(null,t,e),r)}function gx(){}function sk(e,t){var r=An();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hx(t,n[1])?n[0]:(r.memoizedState=[e,t],e)}function ik(e,t){var r=An();t=t===void 0?null:t;var n=r.memoizedState;return n!==null&&t!==null&&hx(t,n[1])?n[0]:(e=e(),r.memoizedState=[e,t],e)}function ok(e,t,r){return Vi&21?(ra(r,t)||(r=dS(),bt.lanes|=r,Hi|=r,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Vr=!0),e.memoizedState=r)}function Gj(e,t){var r=Ze;Ze=r!==0&&4>r?r:4,e(!0);var n=Gp.transition;Gp.transition={};try{e(!1),t()}finally{Ze=r,Gp.transition=n}}function lk(){return An().memoizedState}function Kj(e,t,r){var n=qs(e);if(r={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null},ck(e))uk(t,r);else if(r=HS(e,t,r,n),r!==null){var a=jr();Jn(r,e,n,a),fk(r,t,n)}}function qj(e,t,r){var n=qs(e),a={lane:n,action:r,hasEagerState:!1,eagerState:null,next:null};if(ck(e))uk(t,a);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var i=t.lastRenderedState,o=s(i,r);if(a.hasEagerState=!0,a.eagerState=o,ra(o,i)){var l=t.interleaved;l===null?(a.next=a,lx(t)):(a.next=l.next,l.next=a),t.interleaved=a;return}}catch{}finally{}r=HS(e,t,a,n),r!==null&&(a=jr(),Jn(r,e,n,a),fk(r,t,n))}}function ck(e){var t=e.alternate;return e===bt||t!==null&&t===bt}function uk(e,t){$c=d0=!0;var r=e.pending;r===null?t.next=t:(t.next=r.next,r.next=t),e.pending=t}function fk(e,t,r){if(r&4194240){var n=t.lanes;n&=e.pendingLanes,r|=n,t.lanes=r,Kg(e,r)}}var h0={readContext:Nn,useCallback:fr,useContext:fr,useEffect:fr,useImperativeHandle:fr,useInsertionEffect:fr,useLayoutEffect:fr,useMemo:fr,useReducer:fr,useRef:fr,useState:fr,useDebugValue:fr,useDeferredValue:fr,useTransition:fr,useMutableSource:fr,useSyncExternalStore:fr,useId:fr,unstable_isNewReconciler:!1},Xj={readContext:Nn,useCallback:function(e,t){return va().memoizedState=[e,t===void 0?null:t],e},useContext:Nn,useEffect:b_,useImperativeHandle:function(e,t,r){return r=r!=null?r.concat([e]):null,Pd(4194308,4,nk.bind(null,t,e),r)},useLayoutEffect:function(e,t){return Pd(4194308,4,e,t)},useInsertionEffect:function(e,t){return Pd(4,2,e,t)},useMemo:function(e,t){var r=va();return t=t===void 0?null:t,e=e(),r.memoizedState=[e,t],e},useReducer:function(e,t,r){var n=va();return t=r!==void 0?r(t):t,n.memoizedState=n.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},n.queue=e,e=e.dispatch=Kj.bind(null,bt,e),[n.memoizedState,e]},useRef:function(e){var t=va();return e={current:e},t.memoizedState=e},useState:w_,useDebugValue:gx,useDeferredValue:function(e){return va().memoizedState=e},useTransition:function(){var e=w_(!1),t=e[0];return e=Gj.bind(null,e[1]),va().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,r){var n=bt,a=va();if(vt){if(r===void 0)throw Error(de(407));r=r()}else{if(r=t(),Zt===null)throw Error(de(349));Vi&30||qS(n,t,r)}a.memoizedState=r;var s={value:r,getSnapshot:t};return a.queue=s,b_(QS.bind(null,n,s,e),[e]),n.flags|=2048,bu(9,XS.bind(null,n,s,r,t),void 0,null),r},useId:function(){var e=va(),t=Zt.identifierPrefix;if(vt){var r=qa,n=Ka;r=(n&~(1<<32-Qn(n)-1)).toString(32)+r,t=":"+t+"R"+r,r=_u++,0<r&&(t+="H"+r.toString(32)),t+=":"}else r=Yj++,t=":"+t+"r"+r.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Qj={readContext:Nn,useCallback:sk,useContext:Nn,useEffect:vx,useImperativeHandle:ak,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:ik,useReducer:Kp,useRef:ek,useState:function(){return Kp(wu)},useDebugValue:gx,useDeferredValue:function(e){var t=An();return ok(t,Wt.memoizedState,e)},useTransition:function(){var e=Kp(wu)[0],t=An().memoizedState;return[e,t]},useMutableSource:GS,useSyncExternalStore:KS,useId:lk,unstable_isNewReconciler:!1},Jj={readContext:Nn,useCallback:sk,useContext:Nn,useEffect:vx,useImperativeHandle:ak,useInsertionEffect:tk,useLayoutEffect:rk,useMemo:ik,useReducer:qp,useRef:ek,useState:function(){return qp(wu)},useDebugValue:gx,useDeferredValue:function(e){var t=An();return Wt===null?t.memoizedState=e:ok(t,Wt.memoizedState,e)},useTransition:function(){var e=qp(wu)[0],t=An().memoizedState;return[e,t]},useMutableSource:GS,useSyncExternalStore:KS,useId:lk,unstable_isNewReconciler:!1};function Vn(e,t){if(e&&e.defaultProps){t=Et({},t),e=e.defaultProps;for(var r in e)t[r]===void 0&&(t[r]=e[r]);return t}return t}function mv(e,t,r,n){t=e.memoizedState,r=r(n,t),r=r==null?t:Et({},t,r),e.memoizedState=r,e.lanes===0&&(e.updateQueue.baseState=r)}var ph={isMounted:function(e){return(e=e._reactInternals)?lo(e)===e:!1},enqueueSetState:function(e,t,r){e=e._reactInternals;var n=jr(),a=qs(e),s=Za(n,a);s.payload=t,r!=null&&(s.callback=r),t=Gs(e,s,a),t!==null&&(Jn(t,e,a,n),Dd(t,e,a))},enqueueReplaceState:function(e,t,r){e=e._reactInternals;var n=jr(),a=qs(e),s=Za(n,a);s.tag=1,s.payload=t,r!=null&&(s.callback=r),t=Gs(e,s,a),t!==null&&(Jn(t,e,a,n),Dd(t,e,a))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var r=jr(),n=qs(e),a=Za(r,n);a.tag=2,t!=null&&(a.callback=t),t=Gs(e,a,n),t!==null&&(Jn(t,e,n,r),Dd(t,e,n))}};function E_(e,t,r,n,a,s,i){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(n,s,i):t.prototype&&t.prototype.isPureReactComponent?!pu(r,n)||!pu(a,s):!0}function dk(e,t,r){var n=!1,a=ti,s=t.contextType;return typeof s=="object"&&s!==null?s=Nn(s):(a=zr(t)?Ui:wr.current,n=t.contextTypes,s=(n=n!=null)?dl(e,a):ti),t=new t(r,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=ph,e.stateNode=t,t._reactInternals=e,n&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=a,e.__reactInternalMemoizedMaskedChildContext=s),t}function S_(e,t,r,n){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(r,n),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(r,n),t.state!==e&&ph.enqueueReplaceState(t,t.state,null)}function vv(e,t,r,n){var a=e.stateNode;a.props=r,a.state=e.memoizedState,a.refs={},cx(e);var s=t.contextType;typeof s=="object"&&s!==null?a.context=Nn(s):(s=zr(t)?Ui:wr.current,a.context=dl(e,s)),a.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(mv(e,t,s,r),a.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof a.getSnapshotBeforeUpdate=="function"||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(t=a.state,typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount(),t!==a.state&&ph.enqueueReplaceState(a,a.state,null),u0(e,r,a,n),a.state=e.memoizedState),typeof a.componentDidMount=="function"&&(e.flags|=4194308)}function vl(e,t){try{var r="",n=t;do r+=TD(n),n=n.return;while(n);var a=r}catch(s){a=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:a,digest:null}}function Xp(e,t,r){return{value:e,source:null,stack:r??null,digest:t??null}}function gv(e,t){try{console.error(t.value)}catch(r){setTimeout(function(){throw r})}}var Zj=typeof WeakMap=="function"?WeakMap:Map;function hk(e,t,r){r=Za(-1,r),r.tag=3,r.payload={element:null};var n=t.value;return r.callback=function(){m0||(m0=!0,Cv=n),gv(e,t)},r}function pk(e,t,r){r=Za(-1,r),r.tag=3;var n=e.type.getDerivedStateFromError;if(typeof n=="function"){var a=t.value;r.payload=function(){return n(a)},r.callback=function(){gv(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(r.callback=function(){gv(e,t),typeof n!="function"&&(Ks===null?Ks=new Set([this]):Ks.add(this));var i=t.stack;this.componentDidCatch(t.value,{componentStack:i!==null?i:""})}),r}function k_(e,t,r){var n=e.pingCache;if(n===null){n=e.pingCache=new Zj;var a=new Set;n.set(t,a)}else a=n.get(t),a===void 0&&(a=new Set,n.set(t,a));a.has(r)||(a.add(r),e=h3.bind(null,e,t,r),t.then(e,e))}function T_(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function C_(e,t,r,n,a){return e.mode&1?(e.flags|=65536,e.lanes=a,e):(e===t?e.flags|=65536:(e.flags|=128,r.flags|=131072,r.flags&=-52805,r.tag===1&&(r.alternate===null?r.tag=17:(t=Za(-1,1),t.tag=2,Gs(r,t,1))),r.lanes|=1),e)}var e3=vs.ReactCurrentOwner,Vr=!1;function Nr(e,t,r,n){t.child=e===null?VS(t,null,r,n):pl(t,e.child,r,n)}function N_(e,t,r,n,a){r=r.render;var s=t.ref;return tl(t,a),n=px(e,t,r,n,s,a),r=mx(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cs(e,t,a)):(vt&&r&&rx(t),t.flags|=1,Nr(e,t,n,a),t.child)}function A_(e,t,r,n,a){if(e===null){var s=r.type;return typeof s=="function"&&!kx(s)&&s.defaultProps===void 0&&r.compare===null&&r.defaultProps===void 0?(t.tag=15,t.type=s,mk(e,t,s,n,a)):(e=Id(r.type,null,n,t,t.mode,a),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&a)){var i=s.memoizedProps;if(r=r.compare,r=r!==null?r:pu,r(i,n)&&e.ref===t.ref)return cs(e,t,a)}return t.flags|=1,e=Xs(s,n),e.ref=t.ref,e.return=t,t.child=e}function mk(e,t,r,n,a){if(e!==null){var s=e.memoizedProps;if(pu(s,n)&&e.ref===t.ref)if(Vr=!1,t.pendingProps=n=s,(e.lanes&a)!==0)e.flags&131072&&(Vr=!0);else return t.lanes=e.lanes,cs(e,t,a)}return xv(e,t,r,n,a)}function vk(e,t,r){var n=t.pendingProps,a=n.children,s=e!==null?e.memoizedState:null;if(n.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},at(zo,Jr),Jr|=r;else{if(!(r&1073741824))return e=s!==null?s.baseLanes|r:r,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,at(zo,Jr),Jr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},n=s!==null?s.baseLanes:r,at(zo,Jr),Jr|=n}else s!==null?(n=s.baseLanes|r,t.memoizedState=null):n=r,at(zo,Jr),Jr|=n;return Nr(e,t,a,r),t.child}function gk(e,t){var r=t.ref;(e===null&&r!==null||e!==null&&e.ref!==r)&&(t.flags|=512,t.flags|=2097152)}function xv(e,t,r,n,a){var s=zr(r)?Ui:wr.current;return s=dl(t,s),tl(t,a),r=px(e,t,r,n,s,a),n=mx(),e!==null&&!Vr?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~a,cs(e,t,a)):(vt&&n&&rx(t),t.flags|=1,Nr(e,t,r,a),t.child)}function O_(e,t,r,n,a){if(zr(r)){var s=!0;s0(t)}else s=!1;if(tl(t,a),t.stateNode===null)Fd(e,t),dk(t,r,n),vv(t,r,n,a),n=!0;else if(e===null){var i=t.stateNode,o=t.memoizedProps;i.props=o;var l=i.context,c=r.contextType;typeof c=="object"&&c!==null?c=Nn(c):(c=zr(r)?Ui:wr.current,c=dl(t,c));var f=r.getDerivedStateFromProps,d=typeof f=="function"||typeof i.getSnapshotBeforeUpdate=="function";d||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==n||l!==c)&&S_(t,i,n,c),As=!1;var h=t.memoizedState;i.state=h,u0(t,n,i,a),l=t.memoizedState,o!==n||h!==l||Hr.current||As?(typeof f=="function"&&(mv(t,r,f,n),l=t.memoizedState),(o=As||E_(t,r,o,n,h,l,c))?(d||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount()),typeof i.componentDidMount=="function"&&(t.flags|=4194308)):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=n,t.memoizedState=l),i.props=n,i.state=l,i.context=c,n=o):(typeof i.componentDidMount=="function"&&(t.flags|=4194308),n=!1)}else{i=t.stateNode,zS(e,t),o=t.memoizedProps,c=t.type===t.elementType?o:Vn(t.type,o),i.props=c,d=t.pendingProps,h=i.context,l=r.contextType,typeof l=="object"&&l!==null?l=Nn(l):(l=zr(r)?Ui:wr.current,l=dl(t,l));var p=r.getDerivedStateFromProps;(f=typeof p=="function"||typeof i.getSnapshotBeforeUpdate=="function")||typeof i.UNSAFE_componentWillReceiveProps!="function"&&typeof i.componentWillReceiveProps!="function"||(o!==d||h!==l)&&S_(t,i,n,l),As=!1,h=t.memoizedState,i.state=h,u0(t,n,i,a);var v=t.memoizedState;o!==d||h!==v||Hr.current||As?(typeof p=="function"&&(mv(t,r,p,n),v=t.memoizedState),(c=As||E_(t,r,c,n,h,v,l)||!1)?(f||typeof i.UNSAFE_componentWillUpdate!="function"&&typeof i.componentWillUpdate!="function"||(typeof i.componentWillUpdate=="function"&&i.componentWillUpdate(n,v,l),typeof i.UNSAFE_componentWillUpdate=="function"&&i.UNSAFE_componentWillUpdate(n,v,l)),typeof i.componentDidUpdate=="function"&&(t.flags|=4),typeof i.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),t.memoizedProps=n,t.memoizedState=v),i.props=n,i.state=v,i.context=l,n=c):(typeof i.componentDidUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=4),typeof i.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&h===e.memoizedState||(t.flags|=1024),n=!1)}return yv(e,t,r,n,s,a)}function yv(e,t,r,n,a,s){gk(e,t);var i=(t.flags&128)!==0;if(!n&&!i)return a&&m_(t,r,!1),cs(e,t,s);n=t.stateNode,e3.current=t;var o=i&&typeof r.getDerivedStateFromError!="function"?null:n.render();return t.flags|=1,e!==null&&i?(t.child=pl(t,e.child,null,s),t.child=pl(t,null,o,s)):Nr(e,t,o,s),t.memoizedState=n.state,a&&m_(t,r,!0),t.child}function xk(e){var t=e.stateNode;t.pendingContext?p_(e,t.pendingContext,t.pendingContext!==t.context):t.context&&p_(e,t.context,!1),ux(e,t.containerInfo)}function D_(e,t,r,n,a){return hl(),ax(a),t.flags|=256,Nr(e,t,r,n),t.child}var _v={dehydrated:null,treeContext:null,retryLane:0};function wv(e){return{baseLanes:e,cachePool:null,transitions:null}}function yk(e,t,r){var n=t.pendingProps,a=_t.current,s=!1,i=(t.flags&128)!==0,o;if((o=i)||(o=e!==null&&e.memoizedState===null?!1:(a&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(a|=1),at(_t,a&1),e===null)return hv(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(i=n.children,e=n.fallback,s?(n=t.mode,s=t.child,i={mode:"hidden",children:i},!(n&1)&&s!==null?(s.childLanes=0,s.pendingProps=i):s=gh(i,n,0,null),e=Fi(e,n,r,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=wv(r),t.memoizedState=_v,e):xx(t,i));if(a=e.memoizedState,a!==null&&(o=a.dehydrated,o!==null))return t3(e,t,i,n,o,a,r);if(s){s=n.fallback,i=t.mode,a=e.child,o=a.sibling;var l={mode:"hidden",children:n.children};return!(i&1)&&t.child!==a?(n=t.child,n.childLanes=0,n.pendingProps=l,t.deletions=null):(n=Xs(a,l),n.subtreeFlags=a.subtreeFlags&14680064),o!==null?s=Xs(o,s):(s=Fi(s,i,r,null),s.flags|=2),s.return=t,n.return=t,n.sibling=s,t.child=n,n=s,s=t.child,i=e.child.memoizedState,i=i===null?wv(r):{baseLanes:i.baseLanes|r,cachePool:null,transitions:i.transitions},s.memoizedState=i,s.childLanes=e.childLanes&~r,t.memoizedState=_v,n}return s=e.child,e=s.sibling,n=Xs(s,{mode:"visible",children:n.children}),!(t.mode&1)&&(n.lanes=r),n.return=t,n.sibling=null,e!==null&&(r=t.deletions,r===null?(t.deletions=[e],t.flags|=16):r.push(e)),t.child=n,t.memoizedState=null,n}function xx(e,t){return t=gh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Jf(e,t,r,n){return n!==null&&ax(n),pl(t,e.child,null,r),e=xx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function t3(e,t,r,n,a,s,i){if(r)return t.flags&256?(t.flags&=-257,n=Xp(Error(de(422))),Jf(e,t,i,n)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=n.fallback,a=t.mode,n=gh({mode:"visible",children:n.children},a,0,null),s=Fi(s,a,i,null),s.flags|=2,n.return=t,s.return=t,n.sibling=s,t.child=n,t.mode&1&&pl(t,e.child,null,i),t.child.memoizedState=wv(i),t.memoizedState=_v,s);if(!(t.mode&1))return Jf(e,t,i,null);if(a.data==="$!"){if(n=a.nextSibling&&a.nextSibling.dataset,n)var o=n.dgst;return n=o,s=Error(de(419)),n=Xp(s,n,void 0),Jf(e,t,i,n)}if(o=(i&e.childLanes)!==0,Vr||o){if(n=Zt,n!==null){switch(i&-i){case 4:a=2;break;case 16:a=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:a=32;break;case 536870912:a=268435456;break;default:a=0}a=a&(n.suspendedLanes|i)?0:a,a!==0&&a!==s.retryLane&&(s.retryLane=a,ls(e,a),Jn(n,e,a,-1))}return Sx(),n=Xp(Error(de(421))),Jf(e,t,i,n)}return a.data==="$?"?(t.flags|=128,t.child=e.child,t=p3.bind(null,e),a._reactRetry=t,null):(e=s.treeContext,nn=Ys(a.nextSibling),an=t,vt=!0,Yn=null,e!==null&&(xn[yn++]=Ka,xn[yn++]=qa,xn[yn++]=Wi,Ka=e.id,qa=e.overflow,Wi=t),t=xx(t,n.children),t.flags|=4096,t)}function j_(e,t,r){e.lanes|=t;var n=e.alternate;n!==null&&(n.lanes|=t),pv(e.return,t,r)}function Qp(e,t,r,n,a){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:n,tail:r,tailMode:a}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=n,s.tail=r,s.tailMode=a)}function _k(e,t,r){var n=t.pendingProps,a=n.revealOrder,s=n.tail;if(Nr(e,t,n.children,r),n=_t.current,n&2)n=n&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&j_(e,r,t);else if(e.tag===19)j_(e,r,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}n&=1}if(at(_t,n),!(t.mode&1))t.memoizedState=null;else switch(a){case"forwards":for(r=t.child,a=null;r!==null;)e=r.alternate,e!==null&&f0(e)===null&&(a=r),r=r.sibling;r=a,r===null?(a=t.child,t.child=null):(a=r.sibling,r.sibling=null),Qp(t,!1,a,r,s);break;case"backwards":for(r=null,a=t.child,t.child=null;a!==null;){if(e=a.alternate,e!==null&&f0(e)===null){t.child=a;break}e=a.sibling,a.sibling=r,r=a,a=e}Qp(t,!0,r,null,s);break;case"together":Qp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Fd(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function cs(e,t,r){if(e!==null&&(t.dependencies=e.dependencies),Hi|=t.lanes,!(r&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(de(153));if(t.child!==null){for(e=t.child,r=Xs(e,e.pendingProps),t.child=r,r.return=t;e.sibling!==null;)e=e.sibling,r=r.sibling=Xs(e,e.pendingProps),r.return=t;r.sibling=null}return t.child}function r3(e,t,r){switch(t.tag){case 3:xk(t),hl();break;case 5:YS(t);break;case 1:zr(t.type)&&s0(t);break;case 4:ux(t,t.stateNode.containerInfo);break;case 10:var n=t.type._context,a=t.memoizedProps.value;at(l0,n._currentValue),n._currentValue=a;break;case 13:if(n=t.memoizedState,n!==null)return n.dehydrated!==null?(at(_t,_t.current&1),t.flags|=128,null):r&t.child.childLanes?yk(e,t,r):(at(_t,_t.current&1),e=cs(e,t,r),e!==null?e.sibling:null);at(_t,_t.current&1);break;case 19:if(n=(r&t.childLanes)!==0,e.flags&128){if(n)return _k(e,t,r);t.flags|=128}if(a=t.memoizedState,a!==null&&(a.rendering=null,a.tail=null,a.lastEffect=null),at(_t,_t.current),n)break;return null;case 22:case 23:return t.lanes=0,vk(e,t,r)}return cs(e,t,r)}var wk,bv,bk,Ek;wk=function(e,t){for(var r=t.child;r!==null;){if(r.tag===5||r.tag===6)e.appendChild(r.stateNode);else if(r.tag!==4&&r.child!==null){r.child.return=r,r=r.child;continue}if(r===t)break;for(;r.sibling===null;){if(r.return===null||r.return===t)return;r=r.return}r.sibling.return=r.return,r=r.sibling}};bv=function(){};bk=function(e,t,r,n){var a=e.memoizedProps;if(a!==n){e=t.stateNode,Oi(Ea.current);var s=null;switch(r){case"input":a=Hm(e,a),n=Hm(e,n),s=[];break;case"select":a=Et({},a,{value:void 0}),n=Et({},n,{value:void 0}),s=[];break;case"textarea":a=Gm(e,a),n=Gm(e,n),s=[];break;default:typeof a.onClick!="function"&&typeof n.onClick=="function"&&(e.onclick=n0)}qm(r,n);var i;r=null;for(c in a)if(!n.hasOwnProperty(c)&&a.hasOwnProperty(c)&&a[c]!=null)if(c==="style"){var o=a[c];for(i in o)o.hasOwnProperty(i)&&(r||(r={}),r[i]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ou.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in n){var l=n[c];if(o=a!=null?a[c]:void 0,n.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(i in o)!o.hasOwnProperty(i)||l&&l.hasOwnProperty(i)||(r||(r={}),r[i]="");for(i in l)l.hasOwnProperty(i)&&o[i]!==l[i]&&(r||(r={}),r[i]=l[i])}else r||(s||(s=[]),s.push(c,r)),r=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ou.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&ot("scroll",e),s||o===l||(s=[])):(s=s||[]).push(c,l))}r&&(s=s||[]).push("style",r);var c=s;(t.updateQueue=c)&&(t.flags|=4)}};Ek=function(e,t,r,n){r!==n&&(t.flags|=4)};function mc(e,t){if(!vt)switch(e.tailMode){case"hidden":t=e.tail;for(var r=null;t!==null;)t.alternate!==null&&(r=t),t=t.sibling;r===null?e.tail=null:r.sibling=null;break;case"collapsed":r=e.tail;for(var n=null;r!==null;)r.alternate!==null&&(n=r),r=r.sibling;n===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:n.sibling=null}}function dr(e){var t=e.alternate!==null&&e.alternate.child===e.child,r=0,n=0;if(t)for(var a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags&14680064,n|=a.flags&14680064,a.return=e,a=a.sibling;else for(a=e.child;a!==null;)r|=a.lanes|a.childLanes,n|=a.subtreeFlags,n|=a.flags,a.return=e,a=a.sibling;return e.subtreeFlags|=n,e.childLanes=r,t}function n3(e,t,r){var n=t.pendingProps;switch(nx(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return dr(t),null;case 1:return zr(t.type)&&a0(),dr(t),null;case 3:return n=t.stateNode,ml(),ut(Hr),ut(wr),dx(),n.pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),(e===null||e.child===null)&&(Xf(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,Yn!==null&&(Ov(Yn),Yn=null))),bv(e,t),dr(t),null;case 5:fx(t);var a=Oi(yu.current);if(r=t.type,e!==null&&t.stateNode!=null)bk(e,t,r,n,a),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!n){if(t.stateNode===null)throw Error(de(166));return dr(t),null}if(e=Oi(Ea.current),Xf(t)){n=t.stateNode,r=t.type;var s=t.memoizedProps;switch(n[ga]=t,n[gu]=s,e=(t.mode&1)!==0,r){case"dialog":ot("cancel",n),ot("close",n);break;case"iframe":case"object":case"embed":ot("load",n);break;case"video":case"audio":for(a=0;a<Cc.length;a++)ot(Cc[a],n);break;case"source":ot("error",n);break;case"img":case"image":case"link":ot("error",n),ot("load",n);break;case"details":ot("toggle",n);break;case"input":Uy(n,s),ot("invalid",n);break;case"select":n._wrapperState={wasMultiple:!!s.multiple},ot("invalid",n);break;case"textarea":Vy(n,s),ot("invalid",n)}qm(r,s),a=null;for(var i in s)if(s.hasOwnProperty(i)){var o=s[i];i==="children"?typeof o=="string"?n.textContent!==o&&(s.suppressHydrationWarning!==!0&&qf(n.textContent,o,e),a=["children",o]):typeof o=="number"&&n.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&qf(n.textContent,o,e),a=["children",""+o]):ou.hasOwnProperty(i)&&o!=null&&i==="onScroll"&&ot("scroll",n)}switch(r){case"input":Uf(n),Wy(n,s,!0);break;case"textarea":Uf(n),Hy(n);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(n.onclick=n0)}n=a,t.updateQueue=n,n!==null&&(t.flags|=4)}else{i=a.nodeType===9?a:a.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=QE(r)),e==="http://www.w3.org/1999/xhtml"?r==="script"?(e=i.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof n.is=="string"?e=i.createElement(r,{is:n.is}):(e=i.createElement(r),r==="select"&&(i=e,n.multiple?i.multiple=!0:n.size&&(i.size=n.size))):e=i.createElementNS(e,r),e[ga]=t,e[gu]=n,wk(e,t,!1,!1),t.stateNode=e;e:{switch(i=Xm(r,n),r){case"dialog":ot("cancel",e),ot("close",e),a=n;break;case"iframe":case"object":case"embed":ot("load",e),a=n;break;case"video":case"audio":for(a=0;a<Cc.length;a++)ot(Cc[a],e);a=n;break;case"source":ot("error",e),a=n;break;case"img":case"image":case"link":ot("error",e),ot("load",e),a=n;break;case"details":ot("toggle",e),a=n;break;case"input":Uy(e,n),a=Hm(e,n),ot("invalid",e);break;case"option":a=n;break;case"select":e._wrapperState={wasMultiple:!!n.multiple},a=Et({},n,{value:void 0}),ot("invalid",e);break;case"textarea":Vy(e,n),a=Gm(e,n),ot("invalid",e);break;default:a=n}qm(r,a),o=a;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?eS(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&JE(e,l)):s==="children"?typeof l=="string"?(r!=="textarea"||l!=="")&&lu(e,l):typeof l=="number"&&lu(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ou.hasOwnProperty(s)?l!=null&&s==="onScroll"&&ot("scroll",e):l!=null&&Wg(e,s,l,i))}switch(r){case"input":Uf(e),Wy(e,n,!1);break;case"textarea":Uf(e),Hy(e);break;case"option":n.value!=null&&e.setAttribute("value",""+ei(n.value));break;case"select":e.multiple=!!n.multiple,s=n.value,s!=null?Qo(e,!!n.multiple,s,!1):n.defaultValue!=null&&Qo(e,!!n.multiple,n.defaultValue,!0);break;default:typeof a.onClick=="function"&&(e.onclick=n0)}switch(r){case"button":case"input":case"select":case"textarea":n=!!n.autoFocus;break e;case"img":n=!0;break e;default:n=!1}}n&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return dr(t),null;case 6:if(e&&t.stateNode!=null)Ek(e,t,e.memoizedProps,n);else{if(typeof n!="string"&&t.stateNode===null)throw Error(de(166));if(r=Oi(yu.current),Oi(Ea.current),Xf(t)){if(n=t.stateNode,r=t.memoizedProps,n[ga]=t,(s=n.nodeValue!==r)&&(e=an,e!==null))switch(e.tag){case 3:qf(n.nodeValue,r,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&qf(n.nodeValue,r,(e.mode&1)!==0)}s&&(t.flags|=4)}else n=(r.nodeType===9?r:r.ownerDocument).createTextNode(n),n[ga]=t,t.stateNode=n}return dr(t),null;case 13:if(ut(_t),n=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(vt&&nn!==null&&t.mode&1&&!(t.flags&128))US(),hl(),t.flags|=98560,s=!1;else if(s=Xf(t),n!==null&&n.dehydrated!==null){if(e===null){if(!s)throw Error(de(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(de(317));s[ga]=t}else hl(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;dr(t),s=!1}else Yn!==null&&(Ov(Yn),Yn=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=r,t):(n=n!==null,n!==(e!==null&&e.memoizedState!==null)&&n&&(t.child.flags|=8192,t.mode&1&&(e===null||_t.current&1?Vt===0&&(Vt=3):Sx())),t.updateQueue!==null&&(t.flags|=4),dr(t),null);case 4:return ml(),bv(e,t),e===null&&mu(t.stateNode.containerInfo),dr(t),null;case 10:return ox(t.type._context),dr(t),null;case 17:return zr(t.type)&&a0(),dr(t),null;case 19:if(ut(_t),s=t.memoizedState,s===null)return dr(t),null;if(n=(t.flags&128)!==0,i=s.rendering,i===null)if(n)mc(s,!1);else{if(Vt!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(i=f0(e),i!==null){for(t.flags|=128,mc(s,!1),n=i.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),t.subtreeFlags=0,n=r,r=t.child;r!==null;)s=r,e=n,s.flags&=14680066,i=s.alternate,i===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=i.childLanes,s.lanes=i.lanes,s.child=i.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=i.memoizedProps,s.memoizedState=i.memoizedState,s.updateQueue=i.updateQueue,s.type=i.type,e=i.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),r=r.sibling;return at(_t,_t.current&1|2),t.child}e=e.sibling}s.tail!==null&&jt()>gl&&(t.flags|=128,n=!0,mc(s,!1),t.lanes=4194304)}else{if(!n)if(e=f0(i),e!==null){if(t.flags|=128,n=!0,r=e.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),mc(s,!0),s.tail===null&&s.tailMode==="hidden"&&!i.alternate&&!vt)return dr(t),null}else 2*jt()-s.renderingStartTime>gl&&r!==1073741824&&(t.flags|=128,n=!0,mc(s,!1),t.lanes=4194304);s.isBackwards?(i.sibling=t.child,t.child=i):(r=s.last,r!==null?r.sibling=i:t.child=i,s.last=i)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=jt(),t.sibling=null,r=_t.current,at(_t,n?r&1|2:r&1),t):(dr(t),null);case 22:case 23:return Ex(),n=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==n&&(t.flags|=8192),n&&t.mode&1?Jr&1073741824&&(dr(t),t.subtreeFlags&6&&(t.flags|=8192)):dr(t),null;case 24:return null;case 25:return null}throw Error(de(156,t.tag))}function a3(e,t){switch(nx(t),t.tag){case 1:return zr(t.type)&&a0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return ml(),ut(Hr),ut(wr),dx(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return fx(t),null;case 13:if(ut(_t),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(de(340));hl()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return ut(_t),null;case 4:return ml(),null;case 10:return ox(t.type._context),null;case 22:case 23:return Ex(),null;case 24:return null;default:return null}}var Zf=!1,vr=!1,s3=typeof WeakSet=="function"?WeakSet:Set,Ee=null;function Ho(e,t){var r=e.ref;if(r!==null)if(typeof r=="function")try{r(null)}catch(n){St(e,t,n)}else r.current=null}function Ev(e,t,r){try{r()}catch(n){St(e,t,n)}}var P_=!1;function i3(e,t){if(iv=e0,e=NS(),tx(e)){if("selectionStart"in e)var r={start:e.selectionStart,end:e.selectionEnd};else e:{r=(r=e.ownerDocument)&&r.defaultView||window;var n=r.getSelection&&r.getSelection();if(n&&n.rangeCount!==0){r=n.anchorNode;var a=n.anchorOffset,s=n.focusNode;n=n.focusOffset;try{r.nodeType,s.nodeType}catch{r=null;break e}var i=0,o=-1,l=-1,c=0,f=0,d=e,h=null;t:for(;;){for(var p;d!==r||a!==0&&d.nodeType!==3||(o=i+a),d!==s||n!==0&&d.nodeType!==3||(l=i+n),d.nodeType===3&&(i+=d.nodeValue.length),(p=d.firstChild)!==null;)h=d,d=p;for(;;){if(d===e)break t;if(h===r&&++c===a&&(o=i),h===s&&++f===n&&(l=i),(p=d.nextSibling)!==null)break;d=h,h=d.parentNode}d=p}r=o===-1||l===-1?null:{start:o,end:l}}else r=null}r=r||{start:0,end:0}}else r=null;for(ov={focusedElem:e,selectionRange:r},e0=!1,Ee=t;Ee!==null;)if(t=Ee,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,Ee=e;else for(;Ee!==null;){t=Ee;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,_=v.memoizedState,g=t.stateNode,y=g.getSnapshotBeforeUpdate(t.elementType===t.type?m:Vn(t.type,m),_);g.__reactInternalSnapshotBeforeUpdate=y}break;case 3:var x=t.stateNode.containerInfo;x.nodeType===1?x.textContent="":x.nodeType===9&&x.documentElement&&x.removeChild(x.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(de(163))}}catch(w){St(t,t.return,w)}if(e=t.sibling,e!==null){e.return=t.return,Ee=e;break}Ee=t.return}return v=P_,P_=!1,v}function Bc(e,t,r){var n=t.updateQueue;if(n=n!==null?n.lastEffect:null,n!==null){var a=n=n.next;do{if((a.tag&e)===e){var s=a.destroy;a.destroy=void 0,s!==void 0&&Ev(t,r,s)}a=a.next}while(a!==n)}}function mh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var r=t=t.next;do{if((r.tag&e)===e){var n=r.create;r.destroy=n()}r=r.next}while(r!==t)}}function Sv(e){var t=e.ref;if(t!==null){var r=e.stateNode;switch(e.tag){case 5:e=r;break;default:e=r}typeof t=="function"?t(e):t.current=e}}function Sk(e){var t=e.alternate;t!==null&&(e.alternate=null,Sk(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ga],delete t[gu],delete t[uv],delete t[Wj],delete t[Vj])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function kk(e){return e.tag===5||e.tag===3||e.tag===4}function F_(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||kk(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function kv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.nodeType===8?r.parentNode.insertBefore(e,t):r.insertBefore(e,t):(r.nodeType===8?(t=r.parentNode,t.insertBefore(e,r)):(t=r,t.appendChild(e)),r=r._reactRootContainer,r!=null||t.onclick!==null||(t.onclick=n0));else if(n!==4&&(e=e.child,e!==null))for(kv(e,t,r),e=e.sibling;e!==null;)kv(e,t,r),e=e.sibling}function Tv(e,t,r){var n=e.tag;if(n===5||n===6)e=e.stateNode,t?r.insertBefore(e,t):r.appendChild(e);else if(n!==4&&(e=e.child,e!==null))for(Tv(e,t,r),e=e.sibling;e!==null;)Tv(e,t,r),e=e.sibling}var rr=null,Hn=!1;function Es(e,t,r){for(r=r.child;r!==null;)Tk(e,t,r),r=r.sibling}function Tk(e,t,r){if(ba&&typeof ba.onCommitFiberUnmount=="function")try{ba.onCommitFiberUnmount(oh,r)}catch{}switch(r.tag){case 5:vr||Ho(r,t);case 6:var n=rr,a=Hn;rr=null,Es(e,t,r),rr=n,Hn=a,rr!==null&&(Hn?(e=rr,r=r.stateNode,e.nodeType===8?e.parentNode.removeChild(r):e.removeChild(r)):rr.removeChild(r.stateNode));break;case 18:rr!==null&&(Hn?(e=rr,r=r.stateNode,e.nodeType===8?Hp(e.parentNode,r):e.nodeType===1&&Hp(e,r),du(e)):Hp(rr,r.stateNode));break;case 4:n=rr,a=Hn,rr=r.stateNode.containerInfo,Hn=!0,Es(e,t,r),rr=n,Hn=a;break;case 0:case 11:case 14:case 15:if(!vr&&(n=r.updateQueue,n!==null&&(n=n.lastEffect,n!==null))){a=n=n.next;do{var s=a,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&Ev(r,t,i),a=a.next}while(a!==n)}Es(e,t,r);break;case 1:if(!vr&&(Ho(r,t),n=r.stateNode,typeof n.componentWillUnmount=="function"))try{n.props=r.memoizedProps,n.state=r.memoizedState,n.componentWillUnmount()}catch(o){St(r,t,o)}Es(e,t,r);break;case 21:Es(e,t,r);break;case 22:r.mode&1?(vr=(n=vr)||r.memoizedState!==null,Es(e,t,r),vr=n):Es(e,t,r);break;default:Es(e,t,r)}}function R_(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var r=e.stateNode;r===null&&(r=e.stateNode=new s3),t.forEach(function(n){var a=m3.bind(null,e,n);r.has(n)||(r.add(n),n.then(a,a))})}}function Bn(e,t){var r=t.deletions;if(r!==null)for(var n=0;n<r.length;n++){var a=r[n];try{var s=e,i=t,o=i;e:for(;o!==null;){switch(o.tag){case 5:rr=o.stateNode,Hn=!1;break e;case 3:rr=o.stateNode.containerInfo,Hn=!0;break e;case 4:rr=o.stateNode.containerInfo,Hn=!0;break e}o=o.return}if(rr===null)throw Error(de(160));Tk(s,i,a),rr=null,Hn=!1;var l=a.alternate;l!==null&&(l.return=null),a.return=null}catch(c){St(a,t,c)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)Ck(t,e),t=t.sibling}function Ck(e,t){var r=e.alternate,n=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Bn(t,e),da(e),n&4){try{Bc(3,e,e.return),mh(3,e)}catch(m){St(e,e.return,m)}try{Bc(5,e,e.return)}catch(m){St(e,e.return,m)}}break;case 1:Bn(t,e),da(e),n&512&&r!==null&&Ho(r,r.return);break;case 5:if(Bn(t,e),da(e),n&512&&r!==null&&Ho(r,r.return),e.flags&32){var a=e.stateNode;try{lu(a,"")}catch(m){St(e,e.return,m)}}if(n&4&&(a=e.stateNode,a!=null)){var s=e.memoizedProps,i=r!==null?r.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&qE(a,s),Xm(o,i);var c=Xm(o,s);for(i=0;i<l.length;i+=2){var f=l[i],d=l[i+1];f==="style"?eS(a,d):f==="dangerouslySetInnerHTML"?JE(a,d):f==="children"?lu(a,d):Wg(a,f,d,c)}switch(o){case"input":zm(a,s);break;case"textarea":XE(a,s);break;case"select":var h=a._wrapperState.wasMultiple;a._wrapperState.wasMultiple=!!s.multiple;var p=s.value;p!=null?Qo(a,!!s.multiple,p,!1):h!==!!s.multiple&&(s.defaultValue!=null?Qo(a,!!s.multiple,s.defaultValue,!0):Qo(a,!!s.multiple,s.multiple?[]:"",!1))}a[gu]=s}catch(m){St(e,e.return,m)}}break;case 6:if(Bn(t,e),da(e),n&4){if(e.stateNode===null)throw Error(de(162));a=e.stateNode,s=e.memoizedProps;try{a.nodeValue=s}catch(m){St(e,e.return,m)}}break;case 3:if(Bn(t,e),da(e),n&4&&r!==null&&r.memoizedState.isDehydrated)try{du(t.containerInfo)}catch(m){St(e,e.return,m)}break;case 4:Bn(t,e),da(e);break;case 13:Bn(t,e),da(e),a=e.child,a.flags&8192&&(s=a.memoizedState!==null,a.stateNode.isHidden=s,!s||a.alternate!==null&&a.alternate.memoizedState!==null||(wx=jt())),n&4&&R_(e);break;case 22:if(f=r!==null&&r.memoizedState!==null,e.mode&1?(vr=(c=vr)||f,Bn(t,e),vr=c):Bn(t,e),da(e),n&8192){if(c=e.memoizedState!==null,(e.stateNode.isHidden=c)&&!f&&e.mode&1)for(Ee=e,f=e.child;f!==null;){for(d=Ee=f;Ee!==null;){switch(h=Ee,p=h.child,h.tag){case 0:case 11:case 14:case 15:Bc(4,h,h.return);break;case 1:Ho(h,h.return);var v=h.stateNode;if(typeof v.componentWillUnmount=="function"){n=h,r=h.return;try{t=n,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(m){St(n,r,m)}}break;case 5:Ho(h,h.return);break;case 22:if(h.memoizedState!==null){I_(d);continue}}p!==null?(p.return=h,Ee=p):I_(d)}f=f.sibling}e:for(f=null,d=e;;){if(d.tag===5){if(f===null){f=d;try{a=d.stateNode,c?(s=a.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=d.stateNode,l=d.memoizedProps.style,i=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ZE("display",i))}catch(m){St(e,e.return,m)}}}else if(d.tag===6){if(f===null)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(m){St(e,e.return,m)}}else if((d.tag!==22&&d.tag!==23||d.memoizedState===null||d===e)&&d.child!==null){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;d.sibling===null;){if(d.return===null||d.return===e)break e;f===d&&(f=null),d=d.return}f===d&&(f=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:Bn(t,e),da(e),n&4&&R_(e);break;case 21:break;default:Bn(t,e),da(e)}}function da(e){var t=e.flags;if(t&2){try{e:{for(var r=e.return;r!==null;){if(kk(r)){var n=r;break e}r=r.return}throw Error(de(160))}switch(n.tag){case 5:var a=n.stateNode;n.flags&32&&(lu(a,""),n.flags&=-33);var s=F_(e);Tv(e,s,a);break;case 3:case 4:var i=n.stateNode.containerInfo,o=F_(e);kv(e,o,i);break;default:throw Error(de(161))}}catch(l){St(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function o3(e,t,r){Ee=e,Nk(e)}function Nk(e,t,r){for(var n=(e.mode&1)!==0;Ee!==null;){var a=Ee,s=a.child;if(a.tag===22&&n){var i=a.memoizedState!==null||Zf;if(!i){var o=a.alternate,l=o!==null&&o.memoizedState!==null||vr;o=Zf;var c=vr;if(Zf=i,(vr=l)&&!c)for(Ee=a;Ee!==null;)i=Ee,l=i.child,i.tag===22&&i.memoizedState!==null?L_(a):l!==null?(l.return=i,Ee=l):L_(a);for(;s!==null;)Ee=s,Nk(s),s=s.sibling;Ee=a,Zf=o,vr=c}M_(e)}else a.subtreeFlags&8772&&s!==null?(s.return=a,Ee=s):M_(e)}}function M_(e){for(;Ee!==null;){var t=Ee;if(t.flags&8772){var r=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:vr||mh(5,t);break;case 1:var n=t.stateNode;if(t.flags&4&&!vr)if(r===null)n.componentDidMount();else{var a=t.elementType===t.type?r.memoizedProps:Vn(t.type,r.memoizedProps);n.componentDidUpdate(a,r.memoizedState,n.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&__(t,s,n);break;case 3:var i=t.updateQueue;if(i!==null){if(r=null,t.child!==null)switch(t.child.tag){case 5:r=t.child.stateNode;break;case 1:r=t.child.stateNode}__(t,i,r)}break;case 5:var o=t.stateNode;if(r===null&&t.flags&4){r=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&r.focus();break;case"img":l.src&&(r.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var c=t.alternate;if(c!==null){var f=c.memoizedState;if(f!==null){var d=f.dehydrated;d!==null&&du(d)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(de(163))}vr||t.flags&512&&Sv(t)}catch(h){St(t,t.return,h)}}if(t===e){Ee=null;break}if(r=t.sibling,r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function I_(e){for(;Ee!==null;){var t=Ee;if(t===e){Ee=null;break}var r=t.sibling;if(r!==null){r.return=t.return,Ee=r;break}Ee=t.return}}function L_(e){for(;Ee!==null;){var t=Ee;try{switch(t.tag){case 0:case 11:case 15:var r=t.return;try{mh(4,t)}catch(l){St(t,r,l)}break;case 1:var n=t.stateNode;if(typeof n.componentDidMount=="function"){var a=t.return;try{n.componentDidMount()}catch(l){St(t,a,l)}}var s=t.return;try{Sv(t)}catch(l){St(t,s,l)}break;case 5:var i=t.return;try{Sv(t)}catch(l){St(t,i,l)}}}catch(l){St(t,t.return,l)}if(t===e){Ee=null;break}var o=t.sibling;if(o!==null){o.return=t.return,Ee=o;break}Ee=t.return}}var l3=Math.ceil,p0=vs.ReactCurrentDispatcher,yx=vs.ReactCurrentOwner,Cn=vs.ReactCurrentBatchConfig,He=0,Zt=null,Lt=null,sr=0,Jr=0,zo=li(0),Vt=0,Eu=null,Hi=0,vh=0,_x=0,Uc=null,Ur=null,wx=0,gl=1/0,Ua=null,m0=!1,Cv=null,Ks=null,ed=!1,Ms=null,v0=0,Wc=0,Nv=null,Rd=-1,Md=0;function jr(){return He&6?jt():Rd!==-1?Rd:Rd=jt()}function qs(e){return e.mode&1?He&2&&sr!==0?sr&-sr:zj.transition!==null?(Md===0&&(Md=dS()),Md):(e=Ze,e!==0||(e=window.event,e=e===void 0?16:yS(e.type)),e):1}function Jn(e,t,r,n){if(50<Wc)throw Wc=0,Nv=null,Error(de(185));nf(e,r,n),(!(He&2)||e!==Zt)&&(e===Zt&&(!(He&2)&&(vh|=r),Vt===4&&js(e,sr)),Yr(e,n),r===1&&He===0&&!(t.mode&1)&&(gl=jt()+500,dh&&ci()))}function Yr(e,t){var r=e.callbackNode;zD(e,t);var n=Zd(e,e===Zt?sr:0);if(n===0)r!==null&&Gy(r),e.callbackNode=null,e.callbackPriority=0;else if(t=n&-n,e.callbackPriority!==t){if(r!=null&&Gy(r),t===1)e.tag===0?Hj($_.bind(null,e)):LS($_.bind(null,e)),Bj(function(){!(He&6)&&ci()}),r=null;else{switch(hS(n)){case 1:r=Gg;break;case 4:r=uS;break;case 16:r=Jd;break;case 536870912:r=fS;break;default:r=Jd}r=Mk(r,Ak.bind(null,e))}e.callbackPriority=t,e.callbackNode=r}}function Ak(e,t){if(Rd=-1,Md=0,He&6)throw Error(de(327));var r=e.callbackNode;if(rl()&&e.callbackNode!==r)return null;var n=Zd(e,e===Zt?sr:0);if(n===0)return null;if(n&30||n&e.expiredLanes||t)t=g0(e,n);else{t=n;var a=He;He|=2;var s=Dk();(Zt!==e||sr!==t)&&(Ua=null,gl=jt()+500,Pi(e,t));do try{f3();break}catch(o){Ok(e,o)}while(!0);ix(),p0.current=s,He=a,Lt!==null?t=0:(Zt=null,sr=0,t=Vt)}if(t!==0){if(t===2&&(a=tv(e),a!==0&&(n=a,t=Av(e,a))),t===1)throw r=Eu,Pi(e,0),js(e,n),Yr(e,jt()),r;if(t===6)js(e,n);else{if(a=e.current.alternate,!(n&30)&&!c3(a)&&(t=g0(e,n),t===2&&(s=tv(e),s!==0&&(n=s,t=Av(e,s))),t===1))throw r=Eu,Pi(e,0),js(e,n),Yr(e,jt()),r;switch(e.finishedWork=a,e.finishedLanes=n,t){case 0:case 1:throw Error(de(345));case 2:bi(e,Ur,Ua);break;case 3:if(js(e,n),(n&130023424)===n&&(t=wx+500-jt(),10<t)){if(Zd(e,0)!==0)break;if(a=e.suspendedLanes,(a&n)!==n){jr(),e.pingedLanes|=e.suspendedLanes&a;break}e.timeoutHandle=cv(bi.bind(null,e,Ur,Ua),t);break}bi(e,Ur,Ua);break;case 4:if(js(e,n),(n&4194240)===n)break;for(t=e.eventTimes,a=-1;0<n;){var i=31-Qn(n);s=1<<i,i=t[i],i>a&&(a=i),n&=~s}if(n=a,n=jt()-n,n=(120>n?120:480>n?480:1080>n?1080:1920>n?1920:3e3>n?3e3:4320>n?4320:1960*l3(n/1960))-n,10<n){e.timeoutHandle=cv(bi.bind(null,e,Ur,Ua),n);break}bi(e,Ur,Ua);break;case 5:bi(e,Ur,Ua);break;default:throw Error(de(329))}}}return Yr(e,jt()),e.callbackNode===r?Ak.bind(null,e):null}function Av(e,t){var r=Uc;return e.current.memoizedState.isDehydrated&&(Pi(e,t).flags|=256),e=g0(e,t),e!==2&&(t=Ur,Ur=r,t!==null&&Ov(t)),e}function Ov(e){Ur===null?Ur=e:Ur.push.apply(Ur,e)}function c3(e){for(var t=e;;){if(t.flags&16384){var r=t.updateQueue;if(r!==null&&(r=r.stores,r!==null))for(var n=0;n<r.length;n++){var a=r[n],s=a.getSnapshot;a=a.value;try{if(!ra(s(),a))return!1}catch{return!1}}}if(r=t.child,t.subtreeFlags&16384&&r!==null)r.return=t,t=r;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function js(e,t){for(t&=~_x,t&=~vh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var r=31-Qn(t),n=1<<r;e[r]=-1,t&=~n}}function $_(e){if(He&6)throw Error(de(327));rl();var t=Zd(e,0);if(!(t&1))return Yr(e,jt()),null;var r=g0(e,t);if(e.tag!==0&&r===2){var n=tv(e);n!==0&&(t=n,r=Av(e,n))}if(r===1)throw r=Eu,Pi(e,0),js(e,t),Yr(e,jt()),r;if(r===6)throw Error(de(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,bi(e,Ur,Ua),Yr(e,jt()),null}function bx(e,t){var r=He;He|=1;try{return e(t)}finally{He=r,He===0&&(gl=jt()+500,dh&&ci())}}function zi(e){Ms!==null&&Ms.tag===0&&!(He&6)&&rl();var t=He;He|=1;var r=Cn.transition,n=Ze;try{if(Cn.transition=null,Ze=1,e)return e()}finally{Ze=n,Cn.transition=r,He=t,!(He&6)&&ci()}}function Ex(){Jr=zo.current,ut(zo)}function Pi(e,t){e.finishedWork=null,e.finishedLanes=0;var r=e.timeoutHandle;if(r!==-1&&(e.timeoutHandle=-1,$j(r)),Lt!==null)for(r=Lt.return;r!==null;){var n=r;switch(nx(n),n.tag){case 1:n=n.type.childContextTypes,n!=null&&a0();break;case 3:ml(),ut(Hr),ut(wr),dx();break;case 5:fx(n);break;case 4:ml();break;case 13:ut(_t);break;case 19:ut(_t);break;case 10:ox(n.type._context);break;case 22:case 23:Ex()}r=r.return}if(Zt=e,Lt=e=Xs(e.current,null),sr=Jr=t,Vt=0,Eu=null,_x=vh=Hi=0,Ur=Uc=null,Ai!==null){for(t=0;t<Ai.length;t++)if(r=Ai[t],n=r.interleaved,n!==null){r.interleaved=null;var a=n.next,s=r.pending;if(s!==null){var i=s.next;s.next=a,n.next=i}r.pending=n}Ai=null}return e}function Ok(e,t){do{var r=Lt;try{if(ix(),jd.current=h0,d0){for(var n=bt.memoizedState;n!==null;){var a=n.queue;a!==null&&(a.pending=null),n=n.next}d0=!1}if(Vi=0,Jt=Wt=bt=null,$c=!1,_u=0,yx.current=null,r===null||r.return===null){Vt=1,Eu=t,Lt=null;break}e:{var s=e,i=r.return,o=r,l=t;if(t=sr,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,f=o,d=f.tag;if(!(f.mode&1)&&(d===0||d===11||d===15)){var h=f.alternate;h?(f.updateQueue=h.updateQueue,f.memoizedState=h.memoizedState,f.lanes=h.lanes):(f.updateQueue=null,f.memoizedState=null)}var p=T_(i);if(p!==null){p.flags&=-257,C_(p,i,o,s,t),p.mode&1&&k_(s,c,t),t=p,l=c;var v=t.updateQueue;if(v===null){var m=new Set;m.add(l),t.updateQueue=m}else v.add(l);break e}else{if(!(t&1)){k_(s,c,t),Sx();break e}l=Error(de(426))}}else if(vt&&o.mode&1){var _=T_(i);if(_!==null){!(_.flags&65536)&&(_.flags|=256),C_(_,i,o,s,t),ax(vl(l,o));break e}}s=l=vl(l,o),Vt!==4&&(Vt=2),Uc===null?Uc=[s]:Uc.push(s),s=i;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var g=hk(s,l,t);y_(s,g);break e;case 1:o=l;var y=s.type,x=s.stateNode;if(!(s.flags&128)&&(typeof y.getDerivedStateFromError=="function"||x!==null&&typeof x.componentDidCatch=="function"&&(Ks===null||!Ks.has(x)))){s.flags|=65536,t&=-t,s.lanes|=t;var w=pk(s,o,t);y_(s,w);break e}}s=s.return}while(s!==null)}Pk(r)}catch(E){t=E,Lt===r&&r!==null&&(Lt=r=r.return);continue}break}while(!0)}function Dk(){var e=p0.current;return p0.current=h0,e===null?h0:e}function Sx(){(Vt===0||Vt===3||Vt===2)&&(Vt=4),Zt===null||!(Hi&268435455)&&!(vh&268435455)||js(Zt,sr)}function g0(e,t){var r=He;He|=2;var n=Dk();(Zt!==e||sr!==t)&&(Ua=null,Pi(e,t));do try{u3();break}catch(a){Ok(e,a)}while(!0);if(ix(),He=r,p0.current=n,Lt!==null)throw Error(de(261));return Zt=null,sr=0,Vt}function u3(){for(;Lt!==null;)jk(Lt)}function f3(){for(;Lt!==null&&!MD();)jk(Lt)}function jk(e){var t=Rk(e.alternate,e,Jr);e.memoizedProps=e.pendingProps,t===null?Pk(e):Lt=t,yx.current=null}function Pk(e){var t=e;do{var r=t.alternate;if(e=t.return,t.flags&32768){if(r=a3(r,t),r!==null){r.flags&=32767,Lt=r;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{Vt=6,Lt=null;return}}else if(r=n3(r,t,Jr),r!==null){Lt=r;return}if(t=t.sibling,t!==null){Lt=t;return}Lt=t=e}while(t!==null);Vt===0&&(Vt=5)}function bi(e,t,r){var n=Ze,a=Cn.transition;try{Cn.transition=null,Ze=1,d3(e,t,r,n)}finally{Cn.transition=a,Ze=n}return null}function d3(e,t,r,n){do rl();while(Ms!==null);if(He&6)throw Error(de(327));r=e.finishedWork;var a=e.finishedLanes;if(r===null)return null;if(e.finishedWork=null,e.finishedLanes=0,r===e.current)throw Error(de(177));e.callbackNode=null,e.callbackPriority=0;var s=r.lanes|r.childLanes;if(YD(e,s),e===Zt&&(Lt=Zt=null,sr=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ed||(ed=!0,Mk(Jd,function(){return rl(),null})),s=(r.flags&15990)!==0,r.subtreeFlags&15990||s){s=Cn.transition,Cn.transition=null;var i=Ze;Ze=1;var o=He;He|=4,yx.current=null,i3(e,r),Ck(r,e),jj(ov),e0=!!iv,ov=iv=null,e.current=r,o3(r),ID(),He=o,Ze=i,Cn.transition=s}else e.current=r;if(ed&&(ed=!1,Ms=e,v0=a),s=e.pendingLanes,s===0&&(Ks=null),BD(r.stateNode),Yr(e,jt()),t!==null)for(n=e.onRecoverableError,r=0;r<t.length;r++)a=t[r],n(a.value,{componentStack:a.stack,digest:a.digest});if(m0)throw m0=!1,e=Cv,Cv=null,e;return v0&1&&e.tag!==0&&rl(),s=e.pendingLanes,s&1?e===Nv?Wc++:(Wc=0,Nv=e):Wc=0,ci(),null}function rl(){if(Ms!==null){var e=hS(v0),t=Cn.transition,r=Ze;try{if(Cn.transition=null,Ze=16>e?16:e,Ms===null)var n=!1;else{if(e=Ms,Ms=null,v0=0,He&6)throw Error(de(331));var a=He;for(He|=4,Ee=e.current;Ee!==null;){var s=Ee,i=s.child;if(Ee.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(Ee=c;Ee!==null;){var f=Ee;switch(f.tag){case 0:case 11:case 15:Bc(8,f,s)}var d=f.child;if(d!==null)d.return=f,Ee=d;else for(;Ee!==null;){f=Ee;var h=f.sibling,p=f.return;if(Sk(f),f===c){Ee=null;break}if(h!==null){h.return=p,Ee=h;break}Ee=p}}}var v=s.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var _=m.sibling;m.sibling=null,m=_}while(m!==null)}}Ee=s}}if(s.subtreeFlags&2064&&i!==null)i.return=s,Ee=i;else e:for(;Ee!==null;){if(s=Ee,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Bc(9,s,s.return)}var g=s.sibling;if(g!==null){g.return=s.return,Ee=g;break e}Ee=s.return}}var y=e.current;for(Ee=y;Ee!==null;){i=Ee;var x=i.child;if(i.subtreeFlags&2064&&x!==null)x.return=i,Ee=x;else e:for(i=y;Ee!==null;){if(o=Ee,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:mh(9,o)}}catch(E){St(o,o.return,E)}if(o===i){Ee=null;break e}var w=o.sibling;if(w!==null){w.return=o.return,Ee=w;break e}Ee=o.return}}if(He=a,ci(),ba&&typeof ba.onPostCommitFiberRoot=="function")try{ba.onPostCommitFiberRoot(oh,e)}catch{}n=!0}return n}finally{Ze=r,Cn.transition=t}}return!1}function B_(e,t,r){t=vl(r,t),t=hk(e,t,1),e=Gs(e,t,1),t=jr(),e!==null&&(nf(e,1,t),Yr(e,t))}function St(e,t,r){if(e.tag===3)B_(e,e,r);else for(;t!==null;){if(t.tag===3){B_(t,e,r);break}else if(t.tag===1){var n=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof n.componentDidCatch=="function"&&(Ks===null||!Ks.has(n))){e=vl(r,e),e=pk(t,e,1),t=Gs(t,e,1),e=jr(),t!==null&&(nf(t,1,e),Yr(t,e));break}}t=t.return}}function h3(e,t,r){var n=e.pingCache;n!==null&&n.delete(t),t=jr(),e.pingedLanes|=e.suspendedLanes&r,Zt===e&&(sr&r)===r&&(Vt===4||Vt===3&&(sr&130023424)===sr&&500>jt()-wx?Pi(e,0):_x|=r),Yr(e,t)}function Fk(e,t){t===0&&(e.mode&1?(t=Hf,Hf<<=1,!(Hf&130023424)&&(Hf=4194304)):t=1);var r=jr();e=ls(e,t),e!==null&&(nf(e,t,r),Yr(e,r))}function p3(e){var t=e.memoizedState,r=0;t!==null&&(r=t.retryLane),Fk(e,r)}function m3(e,t){var r=0;switch(e.tag){case 13:var n=e.stateNode,a=e.memoizedState;a!==null&&(r=a.retryLane);break;case 19:n=e.stateNode;break;default:throw Error(de(314))}n!==null&&n.delete(t),Fk(e,r)}var Rk;Rk=function(e,t,r){if(e!==null)if(e.memoizedProps!==t.pendingProps||Hr.current)Vr=!0;else{if(!(e.lanes&r)&&!(t.flags&128))return Vr=!1,r3(e,t,r);Vr=!!(e.flags&131072)}else Vr=!1,vt&&t.flags&1048576&&$S(t,o0,t.index);switch(t.lanes=0,t.tag){case 2:var n=t.type;Fd(e,t),e=t.pendingProps;var a=dl(t,wr.current);tl(t,r),a=px(null,t,n,e,a,r);var s=mx();return t.flags|=1,typeof a=="object"&&a!==null&&typeof a.render=="function"&&a.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,zr(n)?(s=!0,s0(t)):s=!1,t.memoizedState=a.state!==null&&a.state!==void 0?a.state:null,cx(t),a.updater=ph,t.stateNode=a,a._reactInternals=t,vv(t,n,e,r),t=yv(null,t,n,!0,s,r)):(t.tag=0,vt&&s&&rx(t),Nr(null,t,a,r),t=t.child),t;case 16:n=t.elementType;e:{switch(Fd(e,t),e=t.pendingProps,a=n._init,n=a(n._payload),t.type=n,a=t.tag=g3(n),e=Vn(n,e),a){case 0:t=xv(null,t,n,e,r);break e;case 1:t=O_(null,t,n,e,r);break e;case 11:t=N_(null,t,n,e,r);break e;case 14:t=A_(null,t,n,Vn(n.type,e),r);break e}throw Error(de(306,n,""))}return t;case 0:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),xv(e,t,n,a,r);case 1:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),O_(e,t,n,a,r);case 3:e:{if(xk(t),e===null)throw Error(de(387));n=t.pendingProps,s=t.memoizedState,a=s.element,zS(e,t),u0(t,n,null,r);var i=t.memoizedState;if(n=i.element,s.isDehydrated)if(s={element:n,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){a=vl(Error(de(423)),t),t=D_(e,t,n,r,a);break e}else if(n!==a){a=vl(Error(de(424)),t),t=D_(e,t,n,r,a);break e}else for(nn=Ys(t.stateNode.containerInfo.firstChild),an=t,vt=!0,Yn=null,r=VS(t,null,n,r),t.child=r;r;)r.flags=r.flags&-3|4096,r=r.sibling;else{if(hl(),n===a){t=cs(e,t,r);break e}Nr(e,t,n,r)}t=t.child}return t;case 5:return YS(t),e===null&&hv(t),n=t.type,a=t.pendingProps,s=e!==null?e.memoizedProps:null,i=a.children,lv(n,a)?i=null:s!==null&&lv(n,s)&&(t.flags|=32),gk(e,t),Nr(e,t,i,r),t.child;case 6:return e===null&&hv(t),null;case 13:return yk(e,t,r);case 4:return ux(t,t.stateNode.containerInfo),n=t.pendingProps,e===null?t.child=pl(t,null,n,r):Nr(e,t,n,r),t.child;case 11:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),N_(e,t,n,a,r);case 7:return Nr(e,t,t.pendingProps,r),t.child;case 8:return Nr(e,t,t.pendingProps.children,r),t.child;case 12:return Nr(e,t,t.pendingProps.children,r),t.child;case 10:e:{if(n=t.type._context,a=t.pendingProps,s=t.memoizedProps,i=a.value,at(l0,n._currentValue),n._currentValue=i,s!==null)if(ra(s.value,i)){if(s.children===a.children&&!Hr.current){t=cs(e,t,r);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){i=s.child;for(var l=o.firstContext;l!==null;){if(l.context===n){if(s.tag===1){l=Za(-1,r&-r),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var f=c.pending;f===null?l.next=l:(l.next=f.next,f.next=l),c.pending=l}}s.lanes|=r,l=s.alternate,l!==null&&(l.lanes|=r),pv(s.return,r,t),o.lanes|=r;break}l=l.next}}else if(s.tag===10)i=s.type===t.type?null:s.child;else if(s.tag===18){if(i=s.return,i===null)throw Error(de(341));i.lanes|=r,o=i.alternate,o!==null&&(o.lanes|=r),pv(i,r,t),i=s.sibling}else i=s.child;if(i!==null)i.return=s;else for(i=s;i!==null;){if(i===t){i=null;break}if(s=i.sibling,s!==null){s.return=i.return,i=s;break}i=i.return}s=i}Nr(e,t,a.children,r),t=t.child}return t;case 9:return a=t.type,n=t.pendingProps.children,tl(t,r),a=Nn(a),n=n(a),t.flags|=1,Nr(e,t,n,r),t.child;case 14:return n=t.type,a=Vn(n,t.pendingProps),a=Vn(n.type,a),A_(e,t,n,a,r);case 15:return mk(e,t,t.type,t.pendingProps,r);case 17:return n=t.type,a=t.pendingProps,a=t.elementType===n?a:Vn(n,a),Fd(e,t),t.tag=1,zr(n)?(e=!0,s0(t)):e=!1,tl(t,r),dk(t,n,a),vv(t,n,a,r),yv(null,t,n,!0,e,r);case 19:return _k(e,t,r);case 22:return vk(e,t,r)}throw Error(de(156,t.tag))};function Mk(e,t){return cS(e,t)}function v3(e,t,r,n){this.tag=e,this.key=r,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=n,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sn(e,t,r,n){return new v3(e,t,r,n)}function kx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function g3(e){if(typeof e=="function")return kx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hg)return 11;if(e===zg)return 14}return 2}function Xs(e,t){var r=e.alternate;return r===null?(r=Sn(e.tag,t,e.key,e.mode),r.elementType=e.elementType,r.type=e.type,r.stateNode=e.stateNode,r.alternate=e,e.alternate=r):(r.pendingProps=t,r.type=e.type,r.flags=0,r.subtreeFlags=0,r.deletions=null),r.flags=e.flags&14680064,r.childLanes=e.childLanes,r.lanes=e.lanes,r.child=e.child,r.memoizedProps=e.memoizedProps,r.memoizedState=e.memoizedState,r.updateQueue=e.updateQueue,t=e.dependencies,r.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},r.sibling=e.sibling,r.index=e.index,r.ref=e.ref,r}function Id(e,t,r,n,a,s){var i=2;if(n=e,typeof e=="function")kx(e)&&(i=1);else if(typeof e=="string")i=5;else e:switch(e){case Ro:return Fi(r.children,a,s,t);case Vg:i=8,a|=8;break;case Bm:return e=Sn(12,r,t,a|2),e.elementType=Bm,e.lanes=s,e;case Um:return e=Sn(13,r,t,a),e.elementType=Um,e.lanes=s,e;case Wm:return e=Sn(19,r,t,a),e.elementType=Wm,e.lanes=s,e;case YE:return gh(r,a,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case HE:i=10;break e;case zE:i=9;break e;case Hg:i=11;break e;case zg:i=14;break e;case Ns:i=16,n=null;break e}throw Error(de(130,e==null?e:typeof e,""))}return t=Sn(i,r,t,a),t.elementType=e,t.type=n,t.lanes=s,t}function Fi(e,t,r,n){return e=Sn(7,e,n,t),e.lanes=r,e}function gh(e,t,r,n){return e=Sn(22,e,n,t),e.elementType=YE,e.lanes=r,e.stateNode={isHidden:!1},e}function Jp(e,t,r){return e=Sn(6,e,null,t),e.lanes=r,e}function Zp(e,t,r){return t=Sn(4,e.children!==null?e.children:[],e.key,t),t.lanes=r,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function x3(e,t,r,n,a){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Pp(0),this.expirationTimes=Pp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Pp(0),this.identifierPrefix=n,this.onRecoverableError=a,this.mutableSourceEagerHydrationData=null}function Tx(e,t,r,n,a,s,i,o,l){return e=new x3(e,t,r,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=Sn(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:n,isDehydrated:r,cache:null,transitions:null,pendingSuspenseBoundaries:null},cx(s),e}function y3(e,t,r){var n=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Fo,key:n==null?null:""+n,children:e,containerInfo:t,implementation:r}}function Ik(e){if(!e)return ti;e=e._reactInternals;e:{if(lo(e)!==e||e.tag!==1)throw Error(de(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(zr(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(de(171))}if(e.tag===1){var r=e.type;if(zr(r))return IS(e,r,t)}return t}function Lk(e,t,r,n,a,s,i,o,l){return e=Tx(r,n,!0,e,a,s,i,o,l),e.context=Ik(null),r=e.current,n=jr(),a=qs(r),s=Za(n,a),s.callback=t??null,Gs(r,s,a),e.current.lanes=a,nf(e,a,n),Yr(e,n),e}function xh(e,t,r,n){var a=t.current,s=jr(),i=qs(a);return r=Ik(r),t.context===null?t.context=r:t.pendingContext=r,t=Za(s,i),t.payload={element:e},n=n===void 0?null:n,n!==null&&(t.callback=n),e=Gs(a,t,i),e!==null&&(Jn(e,a,i,s),Dd(e,a,i)),i}function x0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function U_(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var r=e.retryLane;e.retryLane=r!==0&&r<t?r:t}}function Cx(e,t){U_(e,t),(e=e.alternate)&&U_(e,t)}function _3(){return null}var $k=typeof reportError=="function"?reportError:function(e){console.error(e)};function Nx(e){this._internalRoot=e}yh.prototype.render=Nx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(de(409));xh(e,t,null,null)};yh.prototype.unmount=Nx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;zi(function(){xh(null,e,null,null)}),t[os]=null}};function yh(e){this._internalRoot=e}yh.prototype.unstable_scheduleHydration=function(e){if(e){var t=vS();e={blockedOn:null,target:e,priority:t};for(var r=0;r<Ds.length&&t!==0&&t<Ds[r].priority;r++);Ds.splice(r,0,e),r===0&&xS(e)}};function Ax(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function _h(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function W_(){}function w3(e,t,r,n,a){if(a){if(typeof n=="function"){var s=n;n=function(){var c=x0(i);s.call(c)}}var i=Lk(t,n,e,0,null,!1,!1,"",W_);return e._reactRootContainer=i,e[os]=i.current,mu(e.nodeType===8?e.parentNode:e),zi(),i}for(;a=e.lastChild;)e.removeChild(a);if(typeof n=="function"){var o=n;n=function(){var c=x0(l);o.call(c)}}var l=Tx(e,0,!1,null,null,!1,!1,"",W_);return e._reactRootContainer=l,e[os]=l.current,mu(e.nodeType===8?e.parentNode:e),zi(function(){xh(t,l,r,n)}),l}function wh(e,t,r,n,a){var s=r._reactRootContainer;if(s){var i=s;if(typeof a=="function"){var o=a;a=function(){var l=x0(i);o.call(l)}}xh(t,i,e,a)}else i=w3(r,t,e,a,n);return x0(i)}pS=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var r=Tc(t.pendingLanes);r!==0&&(Kg(t,r|1),Yr(t,jt()),!(He&6)&&(gl=jt()+500,ci()))}break;case 13:zi(function(){var n=ls(e,1);if(n!==null){var a=jr();Jn(n,e,1,a)}}),Cx(e,1)}};qg=function(e){if(e.tag===13){var t=ls(e,134217728);if(t!==null){var r=jr();Jn(t,e,134217728,r)}Cx(e,134217728)}};mS=function(e){if(e.tag===13){var t=qs(e),r=ls(e,t);if(r!==null){var n=jr();Jn(r,e,t,n)}Cx(e,t)}};vS=function(){return Ze};gS=function(e,t){var r=Ze;try{return Ze=e,t()}finally{Ze=r}};Jm=function(e,t,r){switch(t){case"input":if(zm(e,r),t=r.name,r.type==="radio"&&t!=null){for(r=e;r.parentNode;)r=r.parentNode;for(r=r.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<r.length;t++){var n=r[t];if(n!==e&&n.form===e.form){var a=fh(n);if(!a)throw Error(de(90));KE(n),zm(n,a)}}}break;case"textarea":XE(e,r);break;case"select":t=r.value,t!=null&&Qo(e,!!r.multiple,t,!1)}};nS=bx;aS=zi;var b3={usingClientEntryPoint:!1,Events:[sf,$o,fh,tS,rS,bx]},vc={findFiberByHostInstance:Ni,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},E3={bundleType:vc.bundleType,version:vc.version,rendererPackageName:vc.rendererPackageName,rendererConfig:vc.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=oS(e),e===null?null:e.stateNode},findFiberByHostInstance:vc.findFiberByHostInstance||_3,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var td=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!td.isDisabled&&td.supportsFiber)try{oh=td.inject(E3),ba=td}catch{}}cn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=b3;cn.createPortal=function(e,t){var r=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Ax(t))throw Error(de(200));return y3(e,t,null,r)};cn.createRoot=function(e,t){if(!Ax(e))throw Error(de(299));var r=!1,n="",a=$k;return t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(n=t.identifierPrefix),t.onRecoverableError!==void 0&&(a=t.onRecoverableError)),t=Tx(e,1,!1,null,null,r,!1,n,a),e[os]=t.current,mu(e.nodeType===8?e.parentNode:e),new Nx(t)};cn.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(de(188)):(e=Object.keys(e).join(","),Error(de(268,e)));return e=oS(t),e=e===null?null:e.stateNode,e};cn.flushSync=function(e){return zi(e)};cn.hydrate=function(e,t,r){if(!_h(t))throw Error(de(200));return wh(null,e,t,!0,r)};cn.hydrateRoot=function(e,t,r){if(!Ax(e))throw Error(de(405));var n=r!=null&&r.hydratedSources||null,a=!1,s="",i=$k;if(r!=null&&(r.unstable_strictMode===!0&&(a=!0),r.identifierPrefix!==void 0&&(s=r.identifierPrefix),r.onRecoverableError!==void 0&&(i=r.onRecoverableError)),t=Lk(t,null,e,1,r??null,a,!1,s,i),e[os]=t.current,mu(e),n)for(e=0;e<n.length;e++)r=n[e],a=r._getVersion,a=a(r._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[r,a]:t.mutableSourceEagerHydrationData.push(r,a);return new yh(t)};cn.render=function(e,t,r){if(!_h(t))throw Error(de(200));return wh(null,e,t,!1,r)};cn.unmountComponentAtNode=function(e){if(!_h(e))throw Error(de(40));return e._reactRootContainer?(zi(function(){wh(null,null,e,!1,function(){e._reactRootContainer=null,e[os]=null})}),!0):!1};cn.unstable_batchedUpdates=bx;cn.unstable_renderSubtreeIntoContainer=function(e,t,r,n){if(!_h(r))throw Error(de(200));if(e==null||e._reactInternals===void 0)throw Error(de(38));return wh(e,t,r,!1,n)};cn.version="18.3.1-next-f1338f8080-20240426";function Bk(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(Bk)}catch(e){console.error(e)}}Bk(),BE.exports=cn;var Ox=BE.exports;const Uk=Er(Ox);var Wk,V_=Ox;Wk=V_.createRoot,V_.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Su(){return Su=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Su.apply(this,arguments)}var Is;(function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"})(Is||(Is={}));const H_="popstate";function S3(e){e===void 0&&(e={});function t(n,a){let{pathname:s,search:i,hash:o}=n.location;return Dv("",{pathname:s,search:i,hash:o},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function r(n,a){return typeof a=="string"?a:y0(a)}return T3(t,r,null,e)}function Ft(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Vk(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function k3(){return Math.random().toString(36).substr(2,8)}function z_(e,t){return{usr:e.state,key:e.key,idx:t}}function Dv(e,t,r,n){return r===void 0&&(r=null),Su({pathname:typeof e=="string"?e:e.pathname,search:"",hash:""},typeof t=="string"?Pl(t):t,{state:r,key:t&&t.key||n||k3()})}function y0(e){let{pathname:t="/",search:r="",hash:n=""}=e;return r&&r!=="?"&&(t+=r.charAt(0)==="?"?r:"?"+r),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function Pl(e){let t={};if(e){let r=e.indexOf("#");r>=0&&(t.hash=e.substr(r),e=e.substr(0,r));let n=e.indexOf("?");n>=0&&(t.search=e.substr(n),e=e.substr(0,n)),e&&(t.pathname=e)}return t}function T3(e,t,r,n){n===void 0&&(n={});let{window:a=document.defaultView,v5Compat:s=!1}=n,i=a.history,o=Is.Pop,l=null,c=f();c==null&&(c=0,i.replaceState(Su({},i.state,{idx:c}),""));function f(){return(i.state||{idx:null}).idx}function d(){o=Is.Pop;let _=f(),g=_==null?null:_-c;c=_,l&&l({action:o,location:m.location,delta:g})}function h(_,g){o=Is.Push;let y=Dv(m.location,_,g);c=f()+1;let x=z_(y,c),w=m.createHref(y);try{i.pushState(x,"",w)}catch(E){if(E instanceof DOMException&&E.name==="DataCloneError")throw E;a.location.assign(w)}s&&l&&l({action:o,location:m.location,delta:1})}function p(_,g){o=Is.Replace;let y=Dv(m.location,_,g);c=f();let x=z_(y,c),w=m.createHref(y);i.replaceState(x,"",w),s&&l&&l({action:o,location:m.location,delta:0})}function v(_){let g=a.location.origin!=="null"?a.location.origin:a.location.href,y=typeof _=="string"?_:y0(_);return y=y.replace(/ $/,"%20"),Ft(g,"No window.location.(origin|href) available to create URL for href: "+y),new URL(y,g)}let m={get action(){return o},get location(){return e(a,i)},listen(_){if(l)throw new Error("A history only accepts one active listener");return a.addEventListener(H_,d),l=_,()=>{a.removeEventListener(H_,d),l=null}},createHref(_){return t(a,_)},createURL:v,encodeLocation(_){let g=v(_);return{pathname:g.pathname,search:g.search,hash:g.hash}},push:h,replace:p,go(_){return i.go(_)}};return m}var Y_;(function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"})(Y_||(Y_={}));function C3(e,t,r){return r===void 0&&(r="/"),N3(e,t,r)}function N3(e,t,r,n){let a=typeof t=="string"?Pl(t):t,s=Dx(a.pathname||"/",r);if(s==null)return null;let i=Hk(e);A3(i);let o=null;for(let l=0;o==null&&l<i.length;++l){let c=U3(s);o=L3(i[l],c)}return o}function Hk(e,t,r,n){t===void 0&&(t=[]),r===void 0&&(r=[]),n===void 0&&(n="");let a=(s,i,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:i,route:s};l.relativePath.startsWith("/")&&(Ft(l.relativePath.startsWith(n),'Absolute route path "'+l.relativePath+'" nested under path '+('"'+n+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),l.relativePath=l.relativePath.slice(n.length));let c=Qs([n,l.relativePath]),f=r.concat(l);s.children&&s.children.length>0&&(Ft(s.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+c+'".')),Hk(s.children,t,f,c)),!(s.path==null&&!s.index)&&t.push({path:c,score:M3(c,s.index),routesMeta:f})};return e.forEach((s,i)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))a(s,i);else for(let l of zk(s.path))a(s,i,l)}),t}function zk(e){let t=e.split("/");if(t.length===0)return[];let[r,...n]=t,a=r.endsWith("?"),s=r.replace(/\?$/,"");if(n.length===0)return a?[s,""]:[s];let i=zk(n.join("/")),o=[];return o.push(...i.map(l=>l===""?s:[s,l].join("/"))),a&&o.push(...i),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function A3(e){e.sort((t,r)=>t.score!==r.score?r.score-t.score:I3(t.routesMeta.map(n=>n.childrenIndex),r.routesMeta.map(n=>n.childrenIndex)))}const O3=/^:[\w-]+$/,D3=3,j3=2,P3=1,F3=10,R3=-2,G_=e=>e==="*";function M3(e,t){let r=e.split("/"),n=r.length;return r.some(G_)&&(n+=R3),t&&(n+=j3),r.filter(a=>!G_(a)).reduce((a,s)=>a+(O3.test(s)?D3:s===""?P3:F3),n)}function I3(e,t){return e.length===t.length&&e.slice(0,-1).every((n,a)=>n===t[a])?e[e.length-1]-t[t.length-1]:0}function L3(e,t,r){let{routesMeta:n}=e,a={},s="/",i=[];for(let o=0;o<n.length;++o){let l=n[o],c=o===n.length-1,f=s==="/"?t:t.slice(s.length)||"/",d=$3({path:l.relativePath,caseSensitive:l.caseSensitive,end:c},f),h=l.route;if(!d)return null;Object.assign(a,d.params),i.push({params:a,pathname:Qs([s,d.pathname]),pathnameBase:z3(Qs([s,d.pathnameBase])),route:h}),d.pathnameBase!=="/"&&(s=Qs([s,d.pathnameBase]))}return i}function $3(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[r,n]=B3(e.path,e.caseSensitive,e.end),a=t.match(r);if(!a)return null;let s=a[0],i=s.replace(/(.)\/+$/,"$1"),o=a.slice(1);return{params:n.reduce((c,f,d)=>{let{paramName:h,isOptional:p}=f;if(h==="*"){let m=o[d]||"";i=s.slice(0,s.length-m.length).replace(/(.)\/+$/,"$1")}const v=o[d];return p&&!v?c[h]=void 0:c[h]=(v||"").replace(/%2F/g,"/"),c},{}),pathname:s,pathnameBase:i,pattern:e}}function B3(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!0),Vk(e==="*"||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were '+('"'+e.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+e.replace(/\*$/,"/*")+'".'));let n=[],a="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(i,o,l)=>(n.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(n.push({paramName:"*"}),a+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?a+="\\/*$":e!==""&&e!=="/"&&(a+="(?:(?=\\/|$))"),[new RegExp(a,t?void 0:"i"),n]}function U3(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Vk(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+t+").")),e}}function Dx(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let r=t.endsWith("/")?t.length-1:t.length,n=e.charAt(r);return n&&n!=="/"?null:e.slice(r)||"/"}function W3(e,t){t===void 0&&(t="/");let{pathname:r,search:n="",hash:a=""}=typeof e=="string"?Pl(e):e;return{pathname:r?r.startsWith("/")?r:V3(r,t):t,search:Y3(n),hash:G3(a)}}function V3(e,t){let r=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(a=>{a===".."?r.length>1&&r.pop():a!=="."&&r.push(a)}),r.length>1?r.join("/"):"/"}function em(e,t,r,n){return"Cannot include a '"+e+"' character in a manually specified "+("`to."+t+"` field ["+JSON.stringify(n)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function H3(e){return e.filter((t,r)=>r===0||t.route.path&&t.route.path.length>0)}function jx(e,t){let r=H3(e);return t?r.map((n,a)=>a===r.length-1?n.pathname:n.pathnameBase):r.map(n=>n.pathnameBase)}function Px(e,t,r,n){n===void 0&&(n=!1);let a;typeof e=="string"?a=Pl(e):(a=Su({},e),Ft(!a.pathname||!a.pathname.includes("?"),em("?","pathname","search",a)),Ft(!a.pathname||!a.pathname.includes("#"),em("#","pathname","hash",a)),Ft(!a.search||!a.search.includes("#"),em("#","search","hash",a)));let s=e===""||a.pathname==="",i=s?"/":a.pathname,o;if(i==null)o=r;else{let d=t.length-1;if(!n&&i.startsWith("..")){let h=i.split("/");for(;h[0]==="..";)h.shift(),d-=1;a.pathname=h.join("/")}o=d>=0?t[d]:"/"}let l=W3(a,o),c=i&&i!=="/"&&i.endsWith("/"),f=(s||i===".")&&r.endsWith("/");return!l.pathname.endsWith("/")&&(c||f)&&(l.pathname+="/"),l}const Qs=e=>e.join("/").replace(/\/\/+/g,"/"),z3=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Y3=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,G3=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e;function K3(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}const Yk=["post","put","patch","delete"];new Set(Yk);const q3=["get",...Yk];new Set(q3);/**
 * React Router v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function ku(){return ku=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ku.apply(this,arguments)}const Fx=O.createContext(null),X3=O.createContext(null),ui=O.createContext(null),bh=O.createContext(null),ja=O.createContext({outlet:null,matches:[],isDataRoute:!1}),Gk=O.createContext(null);function Q3(e,t){let{relative:r}=t===void 0?{}:t;Fl()||Ft(!1);let{basename:n,navigator:a}=O.useContext(ui),{hash:s,pathname:i,search:o}=qk(e,{relative:r}),l=i;return n!=="/"&&(l=i==="/"?n:Qs([n,i])),a.createHref({pathname:l,search:o,hash:s})}function Fl(){return O.useContext(bh)!=null}function Rl(){return Fl()||Ft(!1),O.useContext(bh).location}function Kk(e){O.useContext(ui).static||O.useLayoutEffect(e)}function Pn(){let{isDataRoute:e}=O.useContext(ja);return e?dP():J3()}function J3(){Fl()||Ft(!1);let e=O.useContext(Fx),{basename:t,future:r,navigator:n}=O.useContext(ui),{matches:a}=O.useContext(ja),{pathname:s}=Rl(),i=JSON.stringify(jx(a,r.v7_relativeSplatPath)),o=O.useRef(!1);return Kk(()=>{o.current=!0}),O.useCallback(function(c,f){if(f===void 0&&(f={}),!o.current)return;if(typeof c=="number"){n.go(c);return}let d=Px(c,JSON.parse(i),s,f.relative==="path");e==null&&t!=="/"&&(d.pathname=d.pathname==="/"?t:Qs([t,d.pathname])),(f.replace?n.replace:n.push)(d,f.state,f)},[t,n,i,s,e])}const Z3=O.createContext(null);function eP(e){let t=O.useContext(ja).outlet;return t&&O.createElement(Z3.Provider,{value:e},t)}function Ml(){let{matches:e}=O.useContext(ja),t=e[e.length-1];return t?t.params:{}}function qk(e,t){let{relative:r}=t===void 0?{}:t,{future:n}=O.useContext(ui),{matches:a}=O.useContext(ja),{pathname:s}=Rl(),i=JSON.stringify(jx(a,n.v7_relativeSplatPath));return O.useMemo(()=>Px(e,JSON.parse(i),s,r==="path"),[e,i,s,r])}function tP(e,t){return rP(e,t)}function rP(e,t,r,n){Fl()||Ft(!1);let{navigator:a,static:s}=O.useContext(ui),{matches:i}=O.useContext(ja),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let f=Rl(),d;if(t){var h;let g=typeof t=="string"?Pl(t):t;c==="/"||(h=g.pathname)!=null&&h.startsWith(c)||Ft(!1),d=g}else d=f;let p=d.pathname||"/",v=p;if(c!=="/"){let g=c.replace(/^\//,"").split("/");v="/"+p.replace(/^\//,"").split("/").slice(g.length).join("/")}let m=C3(e,{pathname:v}),_=oP(m&&m.map(g=>Object.assign({},g,{params:Object.assign({},l,g.params),pathname:Qs([c,a.encodeLocation?a.encodeLocation(g.pathname).pathname:g.pathname]),pathnameBase:g.pathnameBase==="/"?c:Qs([c,a.encodeLocation?a.encodeLocation(g.pathnameBase).pathname:g.pathnameBase])})),i,r,n);return t&&_?O.createElement(bh.Provider,{value:{location:ku({pathname:"/",search:"",hash:"",state:null,key:"default"},d),navigationType:Is.Pop}},_):_}function nP(){let e=fP(),t=K3(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),r=e instanceof Error?e.stack:null,a={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return O.createElement(O.Fragment,null,O.createElement("h2",null,"Unexpected Application Error!"),O.createElement("h3",{style:{fontStyle:"italic"}},t),r?O.createElement("pre",{style:a},r):null,null)}const aP=O.createElement(nP,null);class sP extends O.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,r){return r.location!==t.location||r.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:r.error,location:r.location,revalidation:t.revalidation||r.revalidation}}componentDidCatch(t,r){console.error("React Router caught the following error during render",t,r)}render(){return this.state.error!==void 0?O.createElement(ja.Provider,{value:this.props.routeContext},O.createElement(Gk.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function iP(e){let{routeContext:t,match:r,children:n}=e,a=O.useContext(Fx);return a&&a.static&&a.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(a.staticContext._deepestRenderedBoundaryId=r.route.id),O.createElement(ja.Provider,{value:t},n)}function oP(e,t,r,n){var a;if(t===void 0&&(t=[]),r===void 0&&(r=null),n===void 0&&(n=null),e==null){var s;if(!r)return null;if(r.errors)e=r.matches;else if((s=n)!=null&&s.v7_partialHydration&&t.length===0&&!r.initialized&&r.matches.length>0)e=r.matches;else return null}let i=e,o=(a=r)==null?void 0:a.errors;if(o!=null){let f=i.findIndex(d=>d.route.id&&(o==null?void 0:o[d.route.id])!==void 0);f>=0||Ft(!1),i=i.slice(0,Math.min(i.length,f+1))}let l=!1,c=-1;if(r&&n&&n.v7_partialHydration)for(let f=0;f<i.length;f++){let d=i[f];if((d.route.HydrateFallback||d.route.hydrateFallbackElement)&&(c=f),d.route.id){let{loaderData:h,errors:p}=r,v=d.route.loader&&h[d.route.id]===void 0&&(!p||p[d.route.id]===void 0);if(d.route.lazy||v){l=!0,c>=0?i=i.slice(0,c+1):i=[i[0]];break}}}return i.reduceRight((f,d,h)=>{let p,v=!1,m=null,_=null;r&&(p=o&&d.route.id?o[d.route.id]:void 0,m=d.route.errorElement||aP,l&&(c<0&&h===0?(hP("route-fallback"),v=!0,_=null):c===h&&(v=!0,_=d.route.hydrateFallbackElement||null)));let g=t.concat(i.slice(0,h+1)),y=()=>{let x;return p?x=m:v?x=_:d.route.Component?x=O.createElement(d.route.Component,null):d.route.element?x=d.route.element:x=f,O.createElement(iP,{match:d,routeContext:{outlet:f,matches:g,isDataRoute:r!=null},children:x})};return r&&(d.route.ErrorBoundary||d.route.errorElement||h===0)?O.createElement(sP,{location:r.location,revalidation:r.revalidation,component:m,error:p,children:y(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):y()},null)}var Xk=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(Xk||{}),Qk=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(Qk||{});function lP(e){let t=O.useContext(Fx);return t||Ft(!1),t}function cP(e){let t=O.useContext(X3);return t||Ft(!1),t}function uP(e){let t=O.useContext(ja);return t||Ft(!1),t}function Jk(e){let t=uP(),r=t.matches[t.matches.length-1];return r.route.id||Ft(!1),r.route.id}function fP(){var e;let t=O.useContext(Gk),r=cP(),n=Jk();return t!==void 0?t:(e=r.errors)==null?void 0:e[n]}function dP(){let{router:e}=lP(Xk.UseNavigateStable),t=Jk(Qk.UseNavigateStable),r=O.useRef(!1);return Kk(()=>{r.current=!0}),O.useCallback(function(a,s){s===void 0&&(s={}),r.current&&(typeof a=="number"?e.navigate(a):e.navigate(a,ku({fromRouteId:t},s)))},[e,t])}const K_={};function hP(e,t,r){K_[e]||(K_[e]=!0)}function pP(e,t){e==null||e.v7_startTransition,e==null||e.v7_relativeSplatPath}function _0(e){let{to:t,replace:r,state:n,relative:a}=e;Fl()||Ft(!1);let{future:s,static:i}=O.useContext(ui),{matches:o}=O.useContext(ja),{pathname:l}=Rl(),c=Pn(),f=Px(t,jx(o,s.v7_relativeSplatPath),l,a==="path"),d=JSON.stringify(f);return O.useEffect(()=>c(JSON.parse(d),{replace:r,state:n,relative:a}),[c,d,a,r,n]),null}function mP(e){return eP(e.context)}function ht(e){Ft(!1)}function vP(e){let{basename:t="/",children:r=null,location:n,navigationType:a=Is.Pop,navigator:s,static:i=!1,future:o}=e;Fl()&&Ft(!1);let l=t.replace(/^\/*/,"/"),c=O.useMemo(()=>({basename:l,navigator:s,static:i,future:ku({v7_relativeSplatPath:!1},o)}),[l,o,s,i]);typeof n=="string"&&(n=Pl(n));let{pathname:f="/",search:d="",hash:h="",state:p=null,key:v="default"}=n,m=O.useMemo(()=>{let _=Dx(f,l);return _==null?null:{location:{pathname:_,search:d,hash:h,state:p,key:v},navigationType:a}},[l,f,d,h,p,v,a]);return m==null?null:O.createElement(ui.Provider,{value:c},O.createElement(bh.Provider,{children:r,value:m}))}function gP(e){let{children:t,location:r}=e;return tP(jv(t),r)}new Promise(()=>{});function jv(e,t){t===void 0&&(t=[]);let r=[];return O.Children.forEach(e,(n,a)=>{if(!O.isValidElement(n))return;let s=[...t,a];if(n.type===O.Fragment){r.push.apply(r,jv(n.props.children,s));return}n.type!==ht&&Ft(!1),!n.props.index||!n.props.children||Ft(!1);let i={id:n.props.id||s.join("-"),caseSensitive:n.props.caseSensitive,element:n.props.element,Component:n.props.Component,index:n.props.index,path:n.props.path,loader:n.props.loader,action:n.props.action,errorElement:n.props.errorElement,ErrorBoundary:n.props.ErrorBoundary,hasErrorBoundary:n.props.ErrorBoundary!=null||n.props.errorElement!=null,shouldRevalidate:n.props.shouldRevalidate,handle:n.props.handle,lazy:n.props.lazy};n.props.children&&(i.children=jv(n.props.children,s)),r.push(i)}),r}/**
 * React Router DOM v6.30.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Pv(){return Pv=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},Pv.apply(this,arguments)}function xP(e,t){if(e==null)return{};var r={},n=Object.keys(e),a,s;for(s=0;s<n.length;s++)a=n[s],!(t.indexOf(a)>=0)&&(r[a]=e[a]);return r}function yP(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function _P(e,t){return e.button===0&&(!t||t==="_self")&&!yP(e)}const wP=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],bP="6";try{window.__reactRouterVersion=bP}catch{}const EP="startTransition",q_=hD[EP];function SP(e){let{basename:t,children:r,future:n,window:a}=e,s=O.useRef();s.current==null&&(s.current=S3({window:a,v5Compat:!0}));let i=s.current,[o,l]=O.useState({action:i.action,location:i.location}),{v7_startTransition:c}=n||{},f=O.useCallback(d=>{c&&q_?q_(()=>l(d)):l(d)},[l,c]);return O.useLayoutEffect(()=>i.listen(f),[i,f]),O.useEffect(()=>pP(n),[n]),O.createElement(vP,{basename:t,children:r,location:o.location,navigationType:o.action,navigator:i,future:n})}const kP=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",TP=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Xr=O.forwardRef(function(t,r){let{onClick:n,relative:a,reloadDocument:s,replace:i,state:o,target:l,to:c,preventScrollReset:f,viewTransition:d}=t,h=xP(t,wP),{basename:p}=O.useContext(ui),v,m=!1;if(typeof c=="string"&&TP.test(c)&&(v=c,kP))try{let x=new URL(window.location.href),w=c.startsWith("//")?new URL(x.protocol+c):new URL(c),E=Dx(w.pathname,p);w.origin===x.origin&&E!=null?c=E+w.search+w.hash:m=!0}catch{}let _=Q3(c,{relative:a}),g=CP(c,{replace:i,state:o,target:l,preventScrollReset:f,relative:a,viewTransition:d});function y(x){n&&n(x),x.defaultPrevented||g(x)}return O.createElement("a",Pv({},h,{href:v||_,onClick:m||s?n:y,ref:r,target:l}))});var X_;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(X_||(X_={}));var Q_;(function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"})(Q_||(Q_={}));function CP(e,t){let{target:r,replace:n,state:a,preventScrollReset:s,relative:i,viewTransition:o}=t===void 0?{}:t,l=Pn(),c=Rl(),f=qk(e,{relative:i});return O.useCallback(d=>{if(_P(d,r)){d.preventDefault();let h=n!==void 0?n:y0(c)===y0(f);l(e,{replace:h,state:a,preventScrollReset:s,relative:i,viewTransition:o})}},[c,l,f,n,a,r,e,s,i,o])}const NP={},J_=e=>{let t;const r=new Set,n=(f,d)=>{const h=typeof f=="function"?f(t):f;if(!Object.is(h,t)){const p=t;t=d??(typeof h!="object"||h===null)?h:Object.assign({},t,h),r.forEach(v=>v(t,p))}},a=()=>t,l={setState:n,getState:a,getInitialState:()=>c,subscribe:f=>(r.add(f),()=>r.delete(f)),destroy:()=>{(NP?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),r.clear()}},c=t=e(n,a,l);return l},AP=e=>e?J_(e):J_;var Zk={exports:{}},eT={},tT={exports:{}},rT={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xl=O;function OP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var DP=typeof Object.is=="function"?Object.is:OP,jP=xl.useState,PP=xl.useEffect,FP=xl.useLayoutEffect,RP=xl.useDebugValue;function MP(e,t){var r=t(),n=jP({inst:{value:r,getSnapshot:t}}),a=n[0].inst,s=n[1];return FP(function(){a.value=r,a.getSnapshot=t,tm(a)&&s({inst:a})},[e,r,t]),PP(function(){return tm(a)&&s({inst:a}),e(function(){tm(a)&&s({inst:a})})},[e]),RP(r),r}function tm(e){var t=e.getSnapshot;e=e.value;try{var r=t();return!DP(e,r)}catch{return!0}}function IP(e,t){return t()}var LP=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?IP:MP;rT.useSyncExternalStore=xl.useSyncExternalStore!==void 0?xl.useSyncExternalStore:LP;tT.exports=rT;var nT=tT.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Eh=O,$P=nT;function BP(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var UP=typeof Object.is=="function"?Object.is:BP,WP=$P.useSyncExternalStore,VP=Eh.useRef,HP=Eh.useEffect,zP=Eh.useMemo,YP=Eh.useDebugValue;eT.useSyncExternalStoreWithSelector=function(e,t,r,n,a){var s=VP(null);if(s.current===null){var i={hasValue:!1,value:null};s.current=i}else i=s.current;s=zP(function(){function l(p){if(!c){if(c=!0,f=p,p=n(p),a!==void 0&&i.hasValue){var v=i.value;if(a(v,p))return d=v}return d=p}if(v=d,UP(f,p))return v;var m=n(p);return a!==void 0&&a(v,m)?(f=p,v):(f=p,d=m)}var c=!1,f,d,h=r===void 0?null:r;return[function(){return l(t())},h===null?void 0:function(){return l(h())}]},[t,r,n,a]);var o=WP(e,s[0],s[1]);return HP(function(){i.hasValue=!0,i.value=o},[o]),YP(o),o};Zk.exports=eT;var GP=Zk.exports;const KP=Er(GP),aT={},{useDebugValue:qP}=Z,{useSyncExternalStoreWithSelector:XP}=KP;let Z_=!1;const QP=e=>e;function JP(e,t=QP,r){(aT?"production":void 0)!=="production"&&r&&!Z_&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),Z_=!0);const n=XP(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,r);return qP(n),n}const ew=e=>{(aT?"production":void 0)!=="production"&&typeof e!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const t=typeof e=="function"?AP(e):e,r=(n,a)=>JP(t,n,a);return Object.assign(r,t),r},ZP=e=>e?ew(e):ew,eF="modulepreload",tF=function(e){return"/"+e},tw={},yl=function(t,r,n){let a=Promise.resolve();if(r&&r.length>0){document.getElementsByTagName("link");const i=document.querySelector("meta[property=csp-nonce]"),o=(i==null?void 0:i.nonce)||(i==null?void 0:i.getAttribute("nonce"));a=Promise.allSettled(r.map(l=>{if(l=tF(l),l in tw)return;tw[l]=!0;const c=l.endsWith(".css"),f=c?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${f}`))return;const d=document.createElement("link");if(d.rel=c?"stylesheet":eF,c||(d.as="script"),d.crossOrigin="",d.href=l,o&&d.setAttribute("nonce",o),document.head.appendChild(d),c)return new Promise((h,p)=>{d.addEventListener("load",h),d.addEventListener("error",()=>p(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(i){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=i,window.dispatchEvent(o),!o.defaultPrevented)throw i}return a.then(i=>{for(const o of i||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})},rF=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>yl(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)};class Rx extends Error{constructor(t,r="FunctionsError",n){super(t),this.name=r,this.context=n}}class nF extends Rx{constructor(t){super("Failed to send a request to the Edge Function","FunctionsFetchError",t)}}class aF extends Rx{constructor(t){super("Relay Error invoking the Edge Function","FunctionsRelayError",t)}}class sF extends Rx{constructor(t){super("Edge Function returned a non-2xx status code","FunctionsHttpError",t)}}var Fv;(function(e){e.Any="any",e.ApNortheast1="ap-northeast-1",e.ApNortheast2="ap-northeast-2",e.ApSouth1="ap-south-1",e.ApSoutheast1="ap-southeast-1",e.ApSoutheast2="ap-southeast-2",e.CaCentral1="ca-central-1",e.EuCentral1="eu-central-1",e.EuWest1="eu-west-1",e.EuWest2="eu-west-2",e.EuWest3="eu-west-3",e.SaEast1="sa-east-1",e.UsEast1="us-east-1",e.UsWest1="us-west-1",e.UsWest2="us-west-2"})(Fv||(Fv={}));var iF=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class oF{constructor(t,{headers:r={},customFetch:n,region:a=Fv.Any}={}){this.url=t,this.headers=r,this.region=a,this.fetch=rF(n)}setAuth(t){this.headers.Authorization=`Bearer ${t}`}invoke(t,r={}){var n;return iF(this,void 0,void 0,function*(){try{const{headers:a,method:s,body:i}=r;let o={},{region:l}=r;l||(l=this.region),l&&l!=="any"&&(o["x-region"]=l);let c;i&&(a&&!Object.prototype.hasOwnProperty.call(a,"Content-Type")||!a)&&(typeof Blob<"u"&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",c=i):typeof i=="string"?(o["Content-Type"]="text/plain",c=i):typeof FormData<"u"&&i instanceof FormData?c=i:(o["Content-Type"]="application/json",c=JSON.stringify(i)));const f=yield this.fetch(`${this.url}/${t}`,{method:s||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),a),body:c}).catch(v=>{throw new nF(v)}),d=f.headers.get("x-relay-error");if(d&&d==="true")throw new aF(f);if(!f.ok)throw new sF(f);let h=((n=f.headers.get("Content-Type"))!==null&&n!==void 0?n:"text/plain").split(";")[0].trim(),p;return h==="application/json"?p=yield f.json():h==="application/octet-stream"?p=yield f.blob():h==="text/event-stream"?p=f:h==="multipart/form-data"?p=yield f.formData():p=yield f.text(),{data:p,error:null}}catch(a){return{data:null,error:a}}})}}var Wr={},Mx={},Sh={},lf={},kh={},Th={},lF=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},_l=lF();const cF=_l.fetch,sT=_l.fetch.bind(_l),iT=_l.Headers,uF=_l.Request,fF=_l.Response,Il=Object.freeze(Object.defineProperty({__proto__:null,Headers:iT,Request:uF,Response:fF,default:sT,fetch:cF},Symbol.toStringTag,{value:"Module"})),dF=QO(Il);var Ch={};Object.defineProperty(Ch,"__esModule",{value:!0});let hF=class extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}};Ch.default=hF;var oT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Th,"__esModule",{value:!0});const pF=oT(dF),mF=oT(Ch);let vF=class{constructor(t){this.shouldThrowOnError=!1,this.method=t.method,this.url=t.url,this.headers=t.headers,this.schema=t.schema,this.body=t.body,this.shouldThrowOnError=t.shouldThrowOnError,this.signal=t.signal,this.isMaybeSingle=t.isMaybeSingle,t.fetch?this.fetch=t.fetch:typeof fetch>"u"?this.fetch=pF.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(t,r){return this.headers=Object.assign({},this.headers),this.headers[t]=r,this}then(t,r){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const n=this.fetch;let a=n(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async s=>{var i,o,l;let c=null,f=null,d=null,h=s.status,p=s.statusText;if(s.ok){if(this.method!=="HEAD"){const g=await s.text();g===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?f=g:f=JSON.parse(g))}const m=(i=this.headers.Prefer)===null||i===void 0?void 0:i.match(/count=(exact|planned|estimated)/),_=(o=s.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");m&&_&&_.length>1&&(d=parseInt(_[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(f)&&(f.length>1?(c={code:"PGRST116",details:`Results contain ${f.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},f=null,d=null,h=406,p="Not Acceptable"):f.length===1?f=f[0]:f=null)}else{const m=await s.text();try{c=JSON.parse(m),Array.isArray(c)&&s.status===404&&(f=[],c=null,h=200,p="OK")}catch{s.status===404&&m===""?(h=204,p="No Content"):c={message:m}}if(c&&this.isMaybeSingle&&(!((l=c==null?void 0:c.details)===null||l===void 0)&&l.includes("0 rows"))&&(c=null,h=200,p="OK"),c&&this.shouldThrowOnError)throw new mF.default(c)}return{error:c,data:f,count:d,status:h,statusText:p}});return this.shouldThrowOnError||(a=a.catch(s=>{var i,o,l;return{error:{message:`${(i=s==null?void 0:s.name)!==null&&i!==void 0?i:"FetchError"}: ${s==null?void 0:s.message}`,details:`${(o=s==null?void 0:s.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(l=s==null?void 0:s.code)!==null&&l!==void 0?l:""}`},data:null,count:null,status:0,statusText:""}})),a.then(t,r)}returns(){return this}overrideTypes(){return this}};Th.default=vF;var gF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(kh,"__esModule",{value:!0});const xF=gF(Th);let yF=class extends xF.default{select(t){let r=!1;const n=(t??"*").split("").map(a=>/\s/.test(a)&&!r?"":(a==='"'&&(r=!r),a)).join("");return this.url.searchParams.set("select",n),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(t,{ascending:r=!0,nullsFirst:n,foreignTable:a,referencedTable:s=a}={}){const i=s?`${s}.order`:"order",o=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${o?`${o},`:""}${t}.${r?"asc":"desc"}${n===void 0?"":n?".nullsfirst":".nullslast"}`),this}limit(t,{foreignTable:r,referencedTable:n=r}={}){const a=typeof n>"u"?"limit":`${n}.limit`;return this.url.searchParams.set(a,`${t}`),this}range(t,r,{foreignTable:n,referencedTable:a=n}={}){const s=typeof a>"u"?"offset":`${a}.offset`,i=typeof a>"u"?"limit":`${a}.limit`;return this.url.searchParams.set(s,`${t}`),this.url.searchParams.set(i,`${r-t+1}`),this}abortSignal(t){return this.signal=t,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:t=!1,verbose:r=!1,settings:n=!1,buffers:a=!1,wal:s=!1,format:i="text"}={}){var o;const l=[t?"analyze":null,r?"verbose":null,n?"settings":null,a?"buffers":null,s?"wal":null].filter(Boolean).join("|"),c=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${c}"; options=${l};`,i==="json"?this:this}rollback(){var t;return((t=this.headers.Prefer)!==null&&t!==void 0?t:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};kh.default=yF;var _F=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(lf,"__esModule",{value:!0});const wF=_F(kh);let bF=class extends wF.default{eq(t,r){return this.url.searchParams.append(t,`eq.${r}`),this}neq(t,r){return this.url.searchParams.append(t,`neq.${r}`),this}gt(t,r){return this.url.searchParams.append(t,`gt.${r}`),this}gte(t,r){return this.url.searchParams.append(t,`gte.${r}`),this}lt(t,r){return this.url.searchParams.append(t,`lt.${r}`),this}lte(t,r){return this.url.searchParams.append(t,`lte.${r}`),this}like(t,r){return this.url.searchParams.append(t,`like.${r}`),this}likeAllOf(t,r){return this.url.searchParams.append(t,`like(all).{${r.join(",")}}`),this}likeAnyOf(t,r){return this.url.searchParams.append(t,`like(any).{${r.join(",")}}`),this}ilike(t,r){return this.url.searchParams.append(t,`ilike.${r}`),this}ilikeAllOf(t,r){return this.url.searchParams.append(t,`ilike(all).{${r.join(",")}}`),this}ilikeAnyOf(t,r){return this.url.searchParams.append(t,`ilike(any).{${r.join(",")}}`),this}is(t,r){return this.url.searchParams.append(t,`is.${r}`),this}in(t,r){const n=Array.from(new Set(r)).map(a=>typeof a=="string"&&new RegExp("[,()]").test(a)?`"${a}"`:`${a}`).join(",");return this.url.searchParams.append(t,`in.(${n})`),this}contains(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cs.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cs.{${r.join(",")}}`):this.url.searchParams.append(t,`cs.${JSON.stringify(r)}`),this}containedBy(t,r){return typeof r=="string"?this.url.searchParams.append(t,`cd.${r}`):Array.isArray(r)?this.url.searchParams.append(t,`cd.{${r.join(",")}}`):this.url.searchParams.append(t,`cd.${JSON.stringify(r)}`),this}rangeGt(t,r){return this.url.searchParams.append(t,`sr.${r}`),this}rangeGte(t,r){return this.url.searchParams.append(t,`nxl.${r}`),this}rangeLt(t,r){return this.url.searchParams.append(t,`sl.${r}`),this}rangeLte(t,r){return this.url.searchParams.append(t,`nxr.${r}`),this}rangeAdjacent(t,r){return this.url.searchParams.append(t,`adj.${r}`),this}overlaps(t,r){return typeof r=="string"?this.url.searchParams.append(t,`ov.${r}`):this.url.searchParams.append(t,`ov.{${r.join(",")}}`),this}textSearch(t,r,{config:n,type:a}={}){let s="";a==="plain"?s="pl":a==="phrase"?s="ph":a==="websearch"&&(s="w");const i=n===void 0?"":`(${n})`;return this.url.searchParams.append(t,`${s}fts${i}.${r}`),this}match(t){return Object.entries(t).forEach(([r,n])=>{this.url.searchParams.append(r,`eq.${n}`)}),this}not(t,r,n){return this.url.searchParams.append(t,`not.${r}.${n}`),this}or(t,{foreignTable:r,referencedTable:n=r}={}){const a=n?`${n}.or`:"or";return this.url.searchParams.append(a,`(${t})`),this}filter(t,r,n){return this.url.searchParams.append(t,`${r}.${n}`),this}};lf.default=bF;var EF=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Sh,"__esModule",{value:!0});const gc=EF(lf);let SF=class{constructor(t,{headers:r={},schema:n,fetch:a}){this.url=t,this.headers=r,this.schema=n,this.fetch=a}select(t,{head:r=!1,count:n}={}){const a=r?"HEAD":"GET";let s=!1;const i=(t??"*").split("").map(o=>/\s/.test(o)&&!s?"":(o==='"'&&(s=!s),o)).join("");return this.url.searchParams.set("select",i),n&&(this.headers.Prefer=`count=${n}`),new gc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(t,{count:r,defaultToNull:n=!0}={}){const a="POST",s=[];if(this.headers.Prefer&&s.push(this.headers.Prefer),r&&s.push(`count=${r}`),n||s.push("missing=default"),this.headers.Prefer=s.join(","),Array.isArray(t)){const i=t.reduce((o,l)=>o.concat(Object.keys(l)),[]);if(i.length>0){const o=[...new Set(i)].map(l=>`"${l}"`);this.url.searchParams.set("columns",o.join(","))}}return new gc.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}upsert(t,{onConflict:r,ignoreDuplicates:n=!1,count:a,defaultToNull:s=!0}={}){const i="POST",o=[`resolution=${n?"ignore":"merge"}-duplicates`];if(r!==void 0&&this.url.searchParams.set("on_conflict",r),this.headers.Prefer&&o.push(this.headers.Prefer),a&&o.push(`count=${a}`),s||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(t)){const l=t.reduce((c,f)=>c.concat(Object.keys(f)),[]);if(l.length>0){const c=[...new Set(l)].map(f=>`"${f}"`);this.url.searchParams.set("columns",c.join(","))}}return new gc.default({method:i,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}update(t,{count:r}={}){const n="PATCH",a=[];return this.headers.Prefer&&a.push(this.headers.Prefer),r&&a.push(`count=${r}`),this.headers.Prefer=a.join(","),new gc.default({method:n,url:this.url,headers:this.headers,schema:this.schema,body:t,fetch:this.fetch,allowEmpty:!1})}delete({count:t}={}){const r="DELETE",n=[];return t&&n.push(`count=${t}`),this.headers.Prefer&&n.unshift(this.headers.Prefer),this.headers.Prefer=n.join(","),new gc.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Sh.default=SF;var Nh={},Ah={};Object.defineProperty(Ah,"__esModule",{value:!0});Ah.version=void 0;Ah.version="0.0.0-automated";Object.defineProperty(Nh,"__esModule",{value:!0});Nh.DEFAULT_HEADERS=void 0;const kF=Ah;Nh.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${kF.version}`};var lT=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Mx,"__esModule",{value:!0});const TF=lT(Sh),CF=lT(lf),NF=Nh;let AF=class cT{constructor(t,{headers:r={},schema:n,fetch:a}={}){this.url=t,this.headers=Object.assign(Object.assign({},NF.DEFAULT_HEADERS),r),this.schemaName=n,this.fetch=a}from(t){const r=new URL(`${this.url}/${t}`);return new TF.default(r,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new cT(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(t,r={},{head:n=!1,get:a=!1,count:s}={}){let i;const o=new URL(`${this.url}/rpc/${t}`);let l;n||a?(i=n?"HEAD":"GET",Object.entries(r).filter(([f,d])=>d!==void 0).map(([f,d])=>[f,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([f,d])=>{o.searchParams.append(f,d)})):(i="POST",l=r);const c=Object.assign({},this.headers);return s&&(c.Prefer=`count=${s}`),new CF.default({method:i,url:o,headers:c,schema:this.schemaName,body:l,fetch:this.fetch,allowEmpty:!1})}};Mx.default=AF;var Ll=wt&&wt.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Wr,"__esModule",{value:!0});Wr.PostgrestError=Wr.PostgrestBuilder=Wr.PostgrestTransformBuilder=Wr.PostgrestFilterBuilder=Wr.PostgrestQueryBuilder=Wr.PostgrestClient=void 0;const uT=Ll(Mx);Wr.PostgrestClient=uT.default;const fT=Ll(Sh);Wr.PostgrestQueryBuilder=fT.default;const dT=Ll(lf);Wr.PostgrestFilterBuilder=dT.default;const hT=Ll(kh);Wr.PostgrestTransformBuilder=hT.default;const pT=Ll(Th);Wr.PostgrestBuilder=pT.default;const mT=Ll(Ch);Wr.PostgrestError=mT.default;var OF=Wr.default={PostgrestClient:uT.default,PostgrestQueryBuilder:fT.default,PostgrestFilterBuilder:dT.default,PostgrestTransformBuilder:hT.default,PostgrestBuilder:pT.default,PostgrestError:mT.default};const{PostgrestClient:DF,PostgrestQueryBuilder:Fde,PostgrestFilterBuilder:Rde,PostgrestTransformBuilder:Mde,PostgrestBuilder:Ide,PostgrestError:Lde}=OF,jF="2.11.2",PF={"X-Client-Info":`realtime-js/${jF}`},FF="1.0.0",vT=1e4,RF=1e3;var nl;(function(e){e[e.connecting=0]="connecting",e[e.open=1]="open",e[e.closing=2]="closing",e[e.closed=3]="closed"})(nl||(nl={}));var Qr;(function(e){e.closed="closed",e.errored="errored",e.joined="joined",e.joining="joining",e.leaving="leaving"})(Qr||(Qr={}));var zn;(function(e){e.close="phx_close",e.error="phx_error",e.join="phx_join",e.reply="phx_reply",e.leave="phx_leave",e.access_token="access_token"})(zn||(zn={}));var Rv;(function(e){e.websocket="websocket"})(Rv||(Rv={}));var ki;(function(e){e.Connecting="connecting",e.Open="open",e.Closing="closing",e.Closed="closed"})(ki||(ki={}));class MF{constructor(){this.HEADER_LENGTH=1}decode(t,r){return t.constructor===ArrayBuffer?r(this._binaryDecode(t)):r(typeof t=="string"?JSON.parse(t):{})}_binaryDecode(t){const r=new DataView(t),n=new TextDecoder;return this._decodeBroadcast(t,r,n)}_decodeBroadcast(t,r,n){const a=r.getUint8(1),s=r.getUint8(2);let i=this.HEADER_LENGTH+2;const o=n.decode(t.slice(i,i+a));i=i+a;const l=n.decode(t.slice(i,i+s));i=i+s;const c=JSON.parse(n.decode(t.slice(i,t.byteLength)));return{ref:null,topic:o,event:l,payload:c}}}class gT{constructor(t,r){this.callback=t,this.timerCalc=r,this.timer=void 0,this.tries=0,this.callback=t,this.timerCalc=r}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var rt;(function(e){e.abstime="abstime",e.bool="bool",e.date="date",e.daterange="daterange",e.float4="float4",e.float8="float8",e.int2="int2",e.int4="int4",e.int4range="int4range",e.int8="int8",e.int8range="int8range",e.json="json",e.jsonb="jsonb",e.money="money",e.numeric="numeric",e.oid="oid",e.reltime="reltime",e.text="text",e.time="time",e.timestamp="timestamp",e.timestamptz="timestamptz",e.timetz="timetz",e.tsrange="tsrange",e.tstzrange="tstzrange"})(rt||(rt={}));const rw=(e,t,r={})=>{var n;const a=(n=r.skipTypes)!==null&&n!==void 0?n:[];return Object.keys(t).reduce((s,i)=>(s[i]=IF(i,e,t,a),s),{})},IF=(e,t,r,n)=>{const a=t.find(o=>o.name===e),s=a==null?void 0:a.type,i=r[e];return s&&!n.includes(s)?xT(s,i):Mv(i)},xT=(e,t)=>{if(e.charAt(0)==="_"){const r=e.slice(1,e.length);return UF(t,r)}switch(e){case rt.bool:return LF(t);case rt.float4:case rt.float8:case rt.int2:case rt.int4:case rt.int8:case rt.numeric:case rt.oid:return $F(t);case rt.json:case rt.jsonb:return BF(t);case rt.timestamp:return WF(t);case rt.abstime:case rt.date:case rt.daterange:case rt.int4range:case rt.int8range:case rt.money:case rt.reltime:case rt.text:case rt.time:case rt.timestamptz:case rt.timetz:case rt.tsrange:case rt.tstzrange:return Mv(t);default:return Mv(t)}},Mv=e=>e,LF=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},$F=e=>{if(typeof e=="string"){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},BF=e=>{if(typeof e=="string")try{return JSON.parse(e)}catch(t){return console.log(`JSON parse error: ${t}`),e}return e},UF=(e,t)=>{if(typeof e!="string")return e;const r=e.length-1,n=e[r];if(e[0]==="{"&&n==="}"){let s;const i=e.slice(1,r);try{s=JSON.parse("["+i+"]")}catch{s=i?i.split(","):[]}return s.map(o=>xT(t,o))}return e},WF=e=>typeof e=="string"?e.replace(" ","T"):e,yT=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class rm{constructor(t,r,n={},a=vT){this.channel=t,this.event=r,this.payload=n,this.timeout=a,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(t){this.timeout=t,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(t){this.payload=Object.assign(Object.assign({},this.payload),t)}receive(t,r){var n;return this._hasReceived(t)&&r((n=this.receivedResp)===null||n===void 0?void 0:n.response),this.recHooks.push({status:t,callback:r}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const t=r=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=r,this._matchReceive(r)};this.channel._on(this.refEvent,{},t),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(t,r){this.refEvent&&this.channel._trigger(this.refEvent,{status:t,response:r})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:t,response:r}){this.recHooks.filter(n=>n.status===t).forEach(n=>n.callback(r))}_hasReceived(t){return this.receivedResp&&this.receivedResp.status===t}}var nw;(function(e){e.SYNC="sync",e.JOIN="join",e.LEAVE="leave"})(nw||(nw={}));class Vc{constructor(t,r){this.channel=t,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const n=(r==null?void 0:r.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(n.state,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Vc.syncState(this.state,a,s,i),this.pendingDiffs.forEach(l=>{this.state=Vc.syncDiff(this.state,l,s,i)}),this.pendingDiffs=[],o()}),this.channel._on(n.diff,{},a=>{const{onJoin:s,onLeave:i,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(a):(this.state=Vc.syncDiff(this.state,a,s,i),o())}),this.onJoin((a,s,i)=>{this.channel._trigger("presence",{event:"join",key:a,currentPresences:s,newPresences:i})}),this.onLeave((a,s,i)=>{this.channel._trigger("presence",{event:"leave",key:a,currentPresences:s,leftPresences:i})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(t,r,n,a){const s=this.cloneDeep(t),i=this.transformState(r),o={},l={};return this.map(s,(c,f)=>{i[c]||(l[c]=f)}),this.map(i,(c,f)=>{const d=s[c];if(d){const h=f.map(_=>_.presence_ref),p=d.map(_=>_.presence_ref),v=f.filter(_=>p.indexOf(_.presence_ref)<0),m=d.filter(_=>h.indexOf(_.presence_ref)<0);v.length>0&&(o[c]=v),m.length>0&&(l[c]=m)}else o[c]=f}),this.syncDiff(s,{joins:o,leaves:l},n,a)}static syncDiff(t,r,n,a){const{joins:s,leaves:i}={joins:this.transformState(r.joins),leaves:this.transformState(r.leaves)};return n||(n=()=>{}),a||(a=()=>{}),this.map(s,(o,l)=>{var c;const f=(c=t[o])!==null&&c!==void 0?c:[];if(t[o]=this.cloneDeep(l),f.length>0){const d=t[o].map(p=>p.presence_ref),h=f.filter(p=>d.indexOf(p.presence_ref)<0);t[o].unshift(...h)}n(o,f,l)}),this.map(i,(o,l)=>{let c=t[o];if(!c)return;const f=l.map(d=>d.presence_ref);c=c.filter(d=>f.indexOf(d.presence_ref)<0),t[o]=c,a(o,c,l),c.length===0&&delete t[o]}),t}static map(t,r){return Object.getOwnPropertyNames(t).map(n=>r(n,t[n]))}static transformState(t){return t=this.cloneDeep(t),Object.getOwnPropertyNames(t).reduce((r,n)=>{const a=t[n];return"metas"in a?r[n]=a.metas.map(s=>(s.presence_ref=s.phx_ref,delete s.phx_ref,delete s.phx_ref_prev,s)):r[n]=a,r},{})}static cloneDeep(t){return JSON.parse(JSON.stringify(t))}onJoin(t){this.caller.onJoin=t}onLeave(t){this.caller.onLeave=t}onSync(t){this.caller.onSync=t}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var aw;(function(e){e.ALL="*",e.INSERT="INSERT",e.UPDATE="UPDATE",e.DELETE="DELETE"})(aw||(aw={}));var sw;(function(e){e.BROADCAST="broadcast",e.PRESENCE="presence",e.POSTGRES_CHANGES="postgres_changes",e.SYSTEM="system"})(sw||(sw={}));var Wa;(function(e){e.SUBSCRIBED="SUBSCRIBED",e.TIMED_OUT="TIMED_OUT",e.CLOSED="CLOSED",e.CHANNEL_ERROR="CHANNEL_ERROR"})(Wa||(Wa={}));class Ix{constructor(t,r={config:{}},n){this.topic=t,this.params=r,this.socket=n,this.bindings={},this.state=Qr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=t.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},r.config),this.timeout=this.socket.timeout,this.joinPush=new rm(this,zn.join,this.params,this.timeout),this.rejoinTimer=new gT(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Qr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(a=>a.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Qr.closed,this.socket._remove(this)}),this._onError(a=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,a),this.state=Qr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Qr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zn.reply,{},(a,s)=>{this._trigger(this._replyEventName(s),a)}),this.presence=new Vc(this),this.broadcastEndpointURL=yT(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(t,r=this.timeout){var n,a;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:s,presence:i,private:o}}=this.params;this._onError(f=>t==null?void 0:t(Wa.CHANNEL_ERROR,f)),this._onClose(()=>t==null?void 0:t(Wa.CLOSED));const l={},c={broadcast:s,presence:i,postgres_changes:(a=(n=this.bindings.postgres_changes)===null||n===void 0?void 0:n.map(f=>f.filter))!==null&&a!==void 0?a:[],private:o};this.socket.accessTokenValue&&(l.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:c},l)),this.joinedOnce=!0,this._rejoin(r),this.joinPush.receive("ok",async({postgres_changes:f})=>{var d;if(this.socket.setAuth(),f===void 0){t==null||t(Wa.SUBSCRIBED);return}else{const h=this.bindings.postgres_changes,p=(d=h==null?void 0:h.length)!==null&&d!==void 0?d:0,v=[];for(let m=0;m<p;m++){const _=h[m],{filter:{event:g,schema:y,table:x,filter:w}}=_,E=f&&f[m];if(E&&E.event===g&&E.schema===y&&E.table===x&&E.filter===w)v.push(Object.assign(Object.assign({},_),{id:E.id}));else{this.unsubscribe(),t==null||t(Wa.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=v,t&&t(Wa.SUBSCRIBED);return}}).receive("error",f=>{t==null||t(Wa.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(f).join(", ")||"error")))}).receive("timeout",()=>{t==null||t(Wa.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(t,r={}){return await this.send({type:"presence",event:"track",payload:t},r.timeout||this.timeout)}async untrack(t={}){return await this.send({type:"presence",event:"untrack"},t)}on(t,r,n){return this._on(t,r,n)}async send(t,r={}){var n,a;if(!this._canPush()&&t.type==="broadcast"){const{event:s,payload:i}=t,l={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:s,payload:i,private:this.private}]})};try{const c=await this._fetchWithTimeout(this.broadcastEndpointURL,l,(n=r.timeout)!==null&&n!==void 0?n:this.timeout);return await((a=c.body)===null||a===void 0?void 0:a.cancel()),c.ok?"ok":"error"}catch(c){return c.name==="AbortError"?"timed out":"error"}}else return new Promise(s=>{var i,o,l;const c=this._push(t.type,t,r.timeout||this.timeout);t.type==="broadcast"&&!(!((l=(o=(i=this.params)===null||i===void 0?void 0:i.config)===null||o===void 0?void 0:o.broadcast)===null||l===void 0)&&l.ack)&&s("ok"),c.receive("ok",()=>s("ok")),c.receive("error",()=>s("error")),c.receive("timeout",()=>s("timed out"))})}updateJoinPayload(t){this.joinPush.updatePayload(t)}unsubscribe(t=this.timeout){this.state=Qr.leaving;const r=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(n=>{const a=new rm(this,zn.leave,{},t);a.receive("ok",()=>{r(),n("ok")}).receive("timeout",()=>{r(),n("timed out")}).receive("error",()=>{n("error")}),a.send(),this._canPush()||a.trigger("ok",{})})}async _fetchWithTimeout(t,r,n){const a=new AbortController,s=setTimeout(()=>a.abort(),n),i=await this.socket.fetch(t,Object.assign(Object.assign({},r),{signal:a.signal}));return clearTimeout(s),i}_push(t,r,n=this.timeout){if(!this.joinedOnce)throw`tried to push '${t}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let a=new rm(this,t,r,n);return this._canPush()?a.send():(a.startTimeout(),this.pushBuffer.push(a)),a}_onMessage(t,r,n){return r}_isMember(t){return this.topic===t}_joinRef(){return this.joinPush.ref}_trigger(t,r,n){var a,s;const i=t.toLocaleLowerCase(),{close:o,error:l,leave:c,join:f}=zn;if(n&&[o,l,c,f].indexOf(i)>=0&&n!==this._joinRef())return;let h=this._onMessage(i,r,n);if(r&&!h)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?(a=this.bindings.postgres_changes)===null||a===void 0||a.filter(p=>{var v,m,_;return((v=p.filter)===null||v===void 0?void 0:v.event)==="*"||((_=(m=p.filter)===null||m===void 0?void 0:m.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===i}).map(p=>p.callback(h,n)):(s=this.bindings[i])===null||s===void 0||s.filter(p=>{var v,m,_,g,y,x;if(["broadcast","presence","postgres_changes"].includes(i))if("id"in p){const w=p.id,E=(v=p.filter)===null||v===void 0?void 0:v.event;return w&&((m=r.ids)===null||m===void 0?void 0:m.includes(w))&&(E==="*"||(E==null?void 0:E.toLocaleLowerCase())===((_=r.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const w=(y=(g=p==null?void 0:p.filter)===null||g===void 0?void 0:g.event)===null||y===void 0?void 0:y.toLocaleLowerCase();return w==="*"||w===((x=r==null?void 0:r.event)===null||x===void 0?void 0:x.toLocaleLowerCase())}else return p.type.toLocaleLowerCase()===i}).map(p=>{if(typeof h=="object"&&"ids"in h){const v=h.data,{schema:m,table:_,commit_timestamp:g,type:y,errors:x}=v;h=Object.assign(Object.assign({},{schema:m,table:_,commit_timestamp:g,eventType:y,new:{},old:{},errors:x}),this._getPayloadRecords(v))}p.callback(h,n)})}_isClosed(){return this.state===Qr.closed}_isJoined(){return this.state===Qr.joined}_isJoining(){return this.state===Qr.joining}_isLeaving(){return this.state===Qr.leaving}_replyEventName(t){return`chan_reply_${t}`}_on(t,r,n){const a=t.toLocaleLowerCase(),s={type:a,filter:r,callback:n};return this.bindings[a]?this.bindings[a].push(s):this.bindings[a]=[s],this}_off(t,r){const n=t.toLocaleLowerCase();return this.bindings[n]=this.bindings[n].filter(a=>{var s;return!(((s=a.type)===null||s===void 0?void 0:s.toLocaleLowerCase())===n&&Ix.isEqual(a.filter,r))}),this}static isEqual(t,r){if(Object.keys(t).length!==Object.keys(r).length)return!1;for(const n in t)if(t[n]!==r[n])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(t){this._on(zn.close,{},t)}_onError(t){this._on(zn.error,{},r=>t(r))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(t=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Qr.joining,this.joinPush.resend(t))}_getPayloadRecords(t){const r={new:{},old:{}};return(t.type==="INSERT"||t.type==="UPDATE")&&(r.new=rw(t.columns,t.record)),(t.type==="UPDATE"||t.type==="DELETE")&&(r.old=rw(t.columns,t.old_record)),r}}const VF=()=>{},HF=typeof WebSocket<"u",zF=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class YF{constructor(t,r){var n;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=PF,this.params={},this.timeout=vT,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=VF,this.conn=null,this.sendBuffer=[],this.serializer=new MF,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=s=>{let i;return s?i=s:typeof fetch>"u"?i=(...o)=>yl(async()=>{const{default:l}=await Promise.resolve().then(()=>Il);return{default:l}},void 0).then(({default:l})=>l(...o)):i=fetch,(...o)=>i(...o)},this.endPoint=`${t}/${Rv.websocket}`,this.httpEndpoint=yT(t),r!=null&&r.transport?this.transport=r.transport:this.transport=null,r!=null&&r.params&&(this.params=r.params),r!=null&&r.headers&&(this.headers=Object.assign(Object.assign({},this.headers),r.headers)),r!=null&&r.timeout&&(this.timeout=r.timeout),r!=null&&r.logger&&(this.logger=r.logger),r!=null&&r.heartbeatIntervalMs&&(this.heartbeatIntervalMs=r.heartbeatIntervalMs);const a=(n=r==null?void 0:r.params)===null||n===void 0?void 0:n.apikey;if(a&&(this.accessTokenValue=a,this.apiKey=a),this.reconnectAfterMs=r!=null&&r.reconnectAfterMs?r.reconnectAfterMs:s=>[1e3,2e3,5e3,1e4][s-1]||1e4,this.encode=r!=null&&r.encode?r.encode:(s,i)=>i(JSON.stringify(s)),this.decode=r!=null&&r.decode?r.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new gT(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(r==null?void 0:r.fetch),r!=null&&r.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(r==null?void 0:r.worker)||!1,this.workerUrl=r==null?void 0:r.workerUrl}this.accessToken=(r==null?void 0:r.accessToken)||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(HF){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new GF(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),yl(async()=>{const{default:t}=await import("./browser-DSQcilec.js").then(r=>r.b);return{default:t}},[]).then(({default:t})=>{this.conn=new t(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:FF}))}disconnect(t,r){this.conn&&(this.conn.onclose=function(){},t?this.conn.close(t,r??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(t){const r=await t.unsubscribe();return this.channels.length===0&&this.disconnect(),r}async removeAllChannels(){const t=await Promise.all(this.channels.map(r=>r.unsubscribe()));return this.disconnect(),t}log(t,r,n){this.logger(t,r,n)}connectionState(){switch(this.conn&&this.conn.readyState){case nl.connecting:return ki.Connecting;case nl.open:return ki.Open;case nl.closing:return ki.Closing;default:return ki.Closed}}isConnected(){return this.connectionState()===ki.Open}channel(t,r={config:{}}){const n=new Ix(`realtime:${t}`,r,this);return this.channels.push(n),n}push(t){const{topic:r,event:n,payload:a,ref:s}=t,i=()=>{this.encode(t,o=>{var l;(l=this.conn)===null||l===void 0||l.send(o)})};this.log("push",`${r} ${n} (${s})`,a),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(t=null){let r=t||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(r){let n=null;try{n=JSON.parse(atob(r.split(".")[1]))}catch{}if(n&&n.exp&&!(Math.floor(Date.now()/1e3)-n.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${n.exp}`);this.accessTokenValue=r,this.channels.forEach(a=>{r&&a.updateJoinPayload({access_token:r}),a.joinedOnce&&a._isJoined()&&a._push(zn.access_token,{access_token:r})})}}async sendHeartbeat(){var t;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(t=this.conn)===null||t===void 0||t.close(RF,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(t=>t()),this.sendBuffer=[])}_makeRef(){let t=this.ref+1;return t===this.ref?this.ref=0:this.ref=t,this.ref.toString()}_leaveOpenTopic(t){let r=this.channels.find(n=>n.topic===t&&(n._isJoined()||n._isJoining()));r&&(this.log("transport",`leaving duplicate topic "${t}"`),r.unsubscribe())}_remove(t){this.channels=this.channels.filter(r=>r._joinRef()!==t._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=t=>this._onConnError(t),this.conn.onmessage=t=>this._onConnMessage(t),this.conn.onclose=t=>this._onConnClose(t))}_onConnMessage(t){this.decode(t.data,r=>{let{topic:n,event:a,payload:s,ref:i}=r;i&&i===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${s.status||""} ${n} ${a} ${i&&"("+i+")"||""}`,s),this.channels.filter(o=>o._isMember(n)).forEach(o=>o._trigger(a,s,i)),this.stateChangeCallbacks.message.forEach(o=>o(r))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const t=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(t),this.workerRef.onerror=r=>{this.log("worker","worker error",r.message),this.workerRef.terminate()},this.workerRef.onmessage=r=>{r.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(t=>t())}_onConnClose(t){this.log("transport","close",t),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(r=>r(t))}_onConnError(t){this.log("transport",t.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(r=>r(t))}_triggerChanError(){this.channels.forEach(t=>t._trigger(zn.error))}_appendParams(t,r){if(Object.keys(r).length===0)return t;const n=t.match(/\?/)?"&":"?",a=new URLSearchParams(r);return`${t}${n}${a}`}_workerObjectUrl(t){let r;if(t)r=t;else{const n=new Blob([zF],{type:"application/javascript"});r=URL.createObjectURL(n)}return r}}class GF{constructor(t,r,n){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=nl.connecting,this.send=()=>{},this.url=null,this.url=t,this.close=n.close}}class Lx extends Error{constructor(t){super(t),this.__isStorageError=!0,this.name="StorageError"}}function Xt(e){return typeof e=="object"&&e!==null&&"__isStorageError"in e}class KF extends Lx{constructor(t,r){super(t),this.name="StorageApiError",this.status=r}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Iv extends Lx{constructor(t,r){super(t),this.name="StorageUnknownError",this.originalError=r}}var qF=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const _T=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>yl(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},XF=()=>qF(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield yl(()=>Promise.resolve().then(()=>Il),void 0)).Response:Response}),Lv=e=>{if(Array.isArray(e))return e.map(r=>Lv(r));if(typeof e=="function"||e!==Object(e))return e;const t={};return Object.entries(e).forEach(([r,n])=>{const a=r.replace(/([-_][a-z])/gi,s=>s.toUpperCase().replace(/[-_]/g,""));t[a]=Lv(n)}),t};var co=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const nm=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),QF=(e,t,r)=>co(void 0,void 0,void 0,function*(){const n=yield XF();e instanceof n&&!(r!=null&&r.noResolveJson)?e.json().then(a=>{t(new KF(nm(a),e.status||500))}).catch(a=>{t(new Iv(nm(a),a))}):t(new Iv(nm(e),e))}),JF=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json"},t==null?void 0:t.headers),n&&(a.body=JSON.stringify(n)),Object.assign(Object.assign({},a),r))};function cf(e,t,r,n,a,s){return co(this,void 0,void 0,function*(){return new Promise((i,o)=>{e(r,JF(t,n,a,s)).then(l=>{if(!l.ok)throw l;return n!=null&&n.noResolveJson?l:l.json()}).then(l=>i(l)).catch(l=>QF(l,o,n))})})}function w0(e,t,r,n){return co(this,void 0,void 0,function*(){return cf(e,"GET",t,r,n)})}function Os(e,t,r,n,a){return co(this,void 0,void 0,function*(){return cf(e,"POST",t,n,a,r)})}function ZF(e,t,r,n,a){return co(this,void 0,void 0,function*(){return cf(e,"PUT",t,n,a,r)})}function eR(e,t,r,n){return co(this,void 0,void 0,function*(){return cf(e,"HEAD",t,Object.assign(Object.assign({},r),{noResolveJson:!0}),n)})}function wT(e,t,r,n,a){return co(this,void 0,void 0,function*(){return cf(e,"DELETE",t,n,a,r)})}var Lr=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const tR={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},iw={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class rR{constructor(t,r={},n,a){this.url=t,this.headers=r,this.bucketId=n,this.fetch=_T(a)}uploadOrUpdate(t,r,n,a){return Lr(this,void 0,void 0,function*(){try{let s;const i=Object.assign(Object.assign({},iw),a);let o=Object.assign(Object.assign({},this.headers),t==="POST"&&{"x-upsert":String(i.upsert)});const l=i.metadata;typeof Blob<"u"&&n instanceof Blob?(s=new FormData,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l)),s.append("",n)):typeof FormData<"u"&&n instanceof FormData?(s=n,s.append("cacheControl",i.cacheControl),l&&s.append("metadata",this.encodeMetadata(l))):(s=n,o["cache-control"]=`max-age=${i.cacheControl}`,o["content-type"]=i.contentType,l&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(l)))),a!=null&&a.headers&&(o=Object.assign(Object.assign({},o),a.headers));const c=this._removeEmptyFolders(r),f=this._getFinalPath(c),d=yield this.fetch(`${this.url}/object/${f}`,Object.assign({method:t,body:s,headers:o},i!=null&&i.duplex?{duplex:i.duplex}:{})),h=yield d.json();return d.ok?{data:{path:c,id:h.Id,fullPath:h.Key},error:null}:{data:null,error:h}}catch(s){if(Xt(s))return{data:null,error:s};throw s}})}upload(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",t,r,n)})}uploadToSignedUrl(t,r,n,a){return Lr(this,void 0,void 0,function*(){const s=this._removeEmptyFolders(t),i=this._getFinalPath(s),o=new URL(this.url+`/object/upload/sign/${i}`);o.searchParams.set("token",r);try{let l;const c=Object.assign({upsert:iw.upsert},a),f=Object.assign(Object.assign({},this.headers),{"x-upsert":String(c.upsert)});typeof Blob<"u"&&n instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),l.append("",n)):typeof FormData<"u"&&n instanceof FormData?(l=n,l.append("cacheControl",c.cacheControl)):(l=n,f["cache-control"]=`max-age=${c.cacheControl}`,f["content-type"]=c.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:l,headers:f}),h=yield d.json();return d.ok?{data:{path:s,fullPath:h.Key},error:null}:{data:null,error:h}}catch(l){if(Xt(l))return{data:null,error:l};throw l}})}createSignedUploadUrl(t,r){return Lr(this,void 0,void 0,function*(){try{let n=this._getFinalPath(t);const a=Object.assign({},this.headers);r!=null&&r.upsert&&(a["x-upsert"]="true");const s=yield Os(this.fetch,`${this.url}/object/upload/sign/${n}`,{},{headers:a}),i=new URL(this.url+s.url),o=i.searchParams.get("token");if(!o)throw new Lx("No token returned by API");return{data:{signedUrl:i.toString(),path:t,token:o},error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}})}update(t,r,n){return Lr(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",t,r,n)})}move(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers}),error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}})}copy(t,r,n){return Lr(this,void 0,void 0,function*(){try{return{data:{path:(yield Os(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:t,destinationKey:r,destinationBucket:n==null?void 0:n.destinationBucket},{headers:this.headers})).Key},error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}})}createSignedUrl(t,r,n){return Lr(this,void 0,void 0,function*(){try{let a=this._getFinalPath(t),s=yield Os(this.fetch,`${this.url}/object/sign/${a}`,Object.assign({expiresIn:r},n!=null&&n.transform?{transform:n.transform}:{}),{headers:this.headers});const i=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return s={signedUrl:encodeURI(`${this.url}${s.signedURL}${i}`)},{data:s,error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}})}createSignedUrls(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=yield Os(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:r,paths:t},{headers:this.headers}),s=n!=null&&n.download?`&download=${n.download===!0?"":n.download}`:"";return{data:a.map(i=>Object.assign(Object.assign({},i),{signedUrl:i.signedURL?encodeURI(`${this.url}${i.signedURL}${s}`):null})),error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}})}download(t,r){return Lr(this,void 0,void 0,function*(){const a=typeof(r==null?void 0:r.transform)<"u"?"render/image/authenticated":"object",s=this.transformOptsToQueryString((r==null?void 0:r.transform)||{}),i=s?`?${s}`:"";try{const o=this._getFinalPath(t);return{data:yield(yield w0(this.fetch,`${this.url}/${a}/${o}${i}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(Xt(o))return{data:null,error:o};throw o}})}info(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{const n=yield w0(this.fetch,`${this.url}/object/info/${r}`,{headers:this.headers});return{data:Lv(n),error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}})}exists(t){return Lr(this,void 0,void 0,function*(){const r=this._getFinalPath(t);try{return yield eR(this.fetch,`${this.url}/object/${r}`,{headers:this.headers}),{data:!0,error:null}}catch(n){if(Xt(n)&&n instanceof Iv){const a=n.originalError;if([400,404].includes(a==null?void 0:a.status))return{data:!1,error:n}}throw n}})}getPublicUrl(t,r){const n=this._getFinalPath(t),a=[],s=r!=null&&r.download?`download=${r.download===!0?"":r.download}`:"";s!==""&&a.push(s);const o=typeof(r==null?void 0:r.transform)<"u"?"render/image":"object",l=this.transformOptsToQueryString((r==null?void 0:r.transform)||{});l!==""&&a.push(l);let c=a.join("&");return c!==""&&(c=`?${c}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${n}${c}`)}}}remove(t){return Lr(this,void 0,void 0,function*(){try{return{data:yield wT(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:t},{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}list(t,r,n){return Lr(this,void 0,void 0,function*(){try{const a=Object.assign(Object.assign(Object.assign({},tR),r),{prefix:t||""});return{data:yield Os(this.fetch,`${this.url}/object/list/${this.bucketId}`,a,{headers:this.headers},n),error:null}}catch(a){if(Xt(a))return{data:null,error:a};throw a}})}encodeMetadata(t){return JSON.stringify(t)}toBase64(t){return typeof Buffer<"u"?Buffer.from(t).toString("base64"):btoa(t)}_getFinalPath(t){return`${this.bucketId}/${t}`}_removeEmptyFolders(t){return t.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(t){const r=[];return t.width&&r.push(`width=${t.width}`),t.height&&r.push(`height=${t.height}`),t.resize&&r.push(`resize=${t.resize}`),t.format&&r.push(`format=${t.format}`),t.quality&&r.push(`quality=${t.quality}`),r.join("&")}}const nR="2.7.1",aR={"X-Client-Info":`storage-js/${nR}`};var So=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class sR{constructor(t,r={},n){this.url=t,this.headers=Object.assign(Object.assign({},aR),r),this.fetch=_T(n)}listBuckets(){return So(this,void 0,void 0,function*(){try{return{data:yield w0(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(t){if(Xt(t))return{data:null,error:t};throw t}})}getBucket(t){return So(this,void 0,void 0,function*(){try{return{data:yield w0(this.fetch,`${this.url}/bucket/${t}`,{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}createBucket(t,r={public:!1}){return So(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}})}updateBucket(t,r){return So(this,void 0,void 0,function*(){try{return{data:yield ZF(this.fetch,`${this.url}/bucket/${t}`,{id:t,name:t,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(n){if(Xt(n))return{data:null,error:n};throw n}})}emptyBucket(t){return So(this,void 0,void 0,function*(){try{return{data:yield Os(this.fetch,`${this.url}/bucket/${t}/empty`,{},{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}deleteBucket(t){return So(this,void 0,void 0,function*(){try{return{data:yield wT(this.fetch,`${this.url}/bucket/${t}`,{},{headers:this.headers}),error:null}}catch(r){if(Xt(r))return{data:null,error:r};throw r}})}}class iR extends sR{constructor(t,r={},n){super(t,r,n)}from(t){return new rR(this.url,this.headers,t,this.fetch)}}const oR="2.49.4";let Nc="";typeof Deno<"u"?Nc="deno":typeof document<"u"?Nc="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Nc="react-native":Nc="node";const lR={"X-Client-Info":`supabase-js-${Nc}/${oR}`},cR={headers:lR},uR={schema:"public"},fR={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dR={};var hR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};const pR=e=>{let t;return e?t=e:typeof fetch>"u"?t=sT:t=fetch,(...r)=>t(...r)},mR=()=>typeof Headers>"u"?iT:Headers,vR=(e,t,r)=>{const n=pR(r),a=mR();return(s,i)=>hR(void 0,void 0,void 0,function*(){var o;const l=(o=yield t())!==null&&o!==void 0?o:e;let c=new a(i==null?void 0:i.headers);return c.has("apikey")||c.set("apikey",e),c.has("Authorization")||c.set("Authorization",`Bearer ${l}`),n(s,Object.assign(Object.assign({},i),{headers:c}))})};var gR=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};function xR(e){return e.replace(/\/$/,"")}function yR(e,t){const{db:r,auth:n,realtime:a,global:s}=e,{db:i,auth:o,realtime:l,global:c}=t,f={db:Object.assign(Object.assign({},i),r),auth:Object.assign(Object.assign({},o),n),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),s),accessToken:()=>gR(this,void 0,void 0,function*(){return""})};return e.accessToken?f.accessToken=e.accessToken:delete f.accessToken,f}const bT="2.69.1",Oo=30*1e3,$v=3,am=$v*Oo,_R="http://localhost:9999",wR="supabase.auth.token",bR={"X-Client-Info":`gotrue-js/${bT}`},Bv="X-Supabase-Api-Version",ET={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},ER=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,SR=6e5;class $x extends Error{constructor(t,r,n){super(t),this.__isAuthError=!0,this.name="AuthError",this.status=r,this.code=n}}function Pe(e){return typeof e=="object"&&e!==null&&"__isAuthError"in e}class kR extends $x{constructor(t,r,n){super(t,r,n),this.name="AuthApiError",this.status=r,this.code=n}}function TR(e){return Pe(e)&&e.name==="AuthApiError"}class ST extends $x{constructor(t,r){super(t),this.name="AuthUnknownError",this.originalError=r}}class fi extends $x{constructor(t,r,n,a){super(t,n,a),this.name=r,this.status=n}}class Ts extends fi{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function CR(e){return Pe(e)&&e.name==="AuthSessionMissingError"}class sm extends fi{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rd extends fi{constructor(t){super(t,"AuthInvalidCredentialsError",400,void 0)}}class nd extends fi{constructor(t,r=null){super(t,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function NR(e){return Pe(e)&&e.name==="AuthImplicitGrantRedirectError"}class ow extends fi{constructor(t,r=null){super(t,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=r}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Uv extends fi{constructor(t,r){super(t,"AuthRetryableFetchError",r,void 0)}}function im(e){return Pe(e)&&e.name==="AuthRetryableFetchError"}class lw extends fi{constructor(t,r,n){super(t,"AuthWeakPasswordError",r,"weak_password"),this.reasons=n}}class Hc extends fi{constructor(t){super(t,"AuthInvalidJwtError",400,"invalid_jwt")}}const cw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),uw=` 	
\r=`.split(""),AR=(()=>{const e=new Array(128);for(let t=0;t<e.length;t+=1)e[t]=-1;for(let t=0;t<uw.length;t+=1)e[uw[t].charCodeAt(0)]=-2;for(let t=0;t<cw.length;t+=1)e[cw[t].charCodeAt(0)]=t;return e})();function kT(e,t,r){const n=AR[e];if(n>-1)for(t.queue=t.queue<<6|n,t.queuedBits+=6;t.queuedBits>=8;)r(t.queue>>t.queuedBits-8&255),t.queuedBits-=8;else{if(n===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(e)}"`)}}function fw(e){const t=[],r=i=>{t.push(String.fromCodePoint(i))},n={utf8seq:0,codepoint:0},a={queue:0,queuedBits:0},s=i=>{jR(i,n,r)};for(let i=0;i<e.length;i+=1)kT(e.charCodeAt(i),a,s);return t.join("")}function OR(e,t){if(e<=127){t(e);return}else if(e<=2047){t(192|e>>6),t(128|e&63);return}else if(e<=65535){t(224|e>>12),t(128|e>>6&63),t(128|e&63);return}else if(e<=1114111){t(240|e>>18),t(128|e>>12&63),t(128|e>>6&63),t(128|e&63);return}throw new Error(`Unrecognized Unicode codepoint: ${e.toString(16)}`)}function DR(e,t){for(let r=0;r<e.length;r+=1){let n=e.charCodeAt(r);if(n>55295&&n<=56319){const a=(n-55296)*1024&65535;n=(e.charCodeAt(r+1)-56320&65535|a)+65536,r+=1}OR(n,t)}}function jR(e,t,r){if(t.utf8seq===0){if(e<=127){r(e);return}for(let n=1;n<6;n+=1)if(!(e>>7-n&1)){t.utf8seq=n;break}if(t.utf8seq===2)t.codepoint=e&31;else if(t.utf8seq===3)t.codepoint=e&15;else if(t.utf8seq===4)t.codepoint=e&7;else throw new Error("Invalid UTF-8 sequence");t.utf8seq-=1}else if(t.utf8seq>0){if(e<=127)throw new Error("Invalid UTF-8 sequence");t.codepoint=t.codepoint<<6|e&63,t.utf8seq-=1,t.utf8seq===0&&r(t.codepoint)}}function PR(e){const t=[],r={queue:0,queuedBits:0},n=a=>{t.push(a)};for(let a=0;a<e.length;a+=1)kT(e.charCodeAt(a),r,n);return new Uint8Array(t)}function FR(e){const t=[];return DR(e,r=>t.push(r)),new Uint8Array(t)}function RR(e){return Math.round(Date.now()/1e3)+e}function MR(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){const t=Math.random()*16|0;return(e=="x"?t:t&3|8).toString(16)})}const pa=()=>typeof window<"u"&&typeof document<"u",yi={tested:!1,writable:!1},zc=()=>{if(!pa())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(yi.tested)return yi.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),yi.tested=!0,yi.writable=!0}catch{yi.tested=!0,yi.writable=!1}return yi.writable};function IR(e){const t={},r=new URL(e);if(r.hash&&r.hash[0]==="#")try{new URLSearchParams(r.hash.substring(1)).forEach((a,s)=>{t[s]=a})}catch{}return r.searchParams.forEach((n,a)=>{t[a]=n}),t}const TT=e=>{let t;return e?t=e:typeof fetch>"u"?t=(...r)=>yl(async()=>{const{default:n}=await Promise.resolve().then(()=>Il);return{default:n}},void 0).then(({default:n})=>n(...r)):t=fetch,(...r)=>t(...r)},LR=e=>typeof e=="object"&&e!==null&&"status"in e&&"ok"in e&&"json"in e&&typeof e.json=="function",CT=async(e,t,r)=>{await e.setItem(t,JSON.stringify(r))},ad=async(e,t)=>{const r=await e.getItem(t);if(!r)return null;try{return JSON.parse(r)}catch{return r}},sd=async(e,t)=>{await e.removeItem(t)};class Oh{constructor(){this.promise=new Oh.promiseConstructor((t,r)=>{this.resolve=t,this.reject=r})}}Oh.promiseConstructor=Promise;function om(e){const t=e.split(".");if(t.length!==3)throw new Hc("Invalid JWT structure");for(let n=0;n<t.length;n++)if(!ER.test(t[n]))throw new Hc("JWT not in base64url format");return{header:JSON.parse(fw(t[0])),payload:JSON.parse(fw(t[1])),signature:PR(t[2]),raw:{header:t[0],payload:t[1]}}}async function $R(e){return await new Promise(t=>{setTimeout(()=>t(null),e)})}function BR(e,t){return new Promise((n,a)=>{(async()=>{for(let s=0;s<1/0;s++)try{const i=await e(s);if(!t(s,null,i)){n(i);return}}catch(i){if(!t(s,i)){a(i);return}}})()})}function UR(e){return("0"+e.toString(16)).substr(-2)}function WR(){const t=new Uint32Array(56);if(typeof crypto>"u"){const r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",n=r.length;let a="";for(let s=0;s<56;s++)a+=r.charAt(Math.floor(Math.random()*n));return a}return crypto.getRandomValues(t),Array.from(t,UR).join("")}async function VR(e){const r=new TextEncoder().encode(e),n=await crypto.subtle.digest("SHA-256",r),a=new Uint8Array(n);return Array.from(a).map(s=>String.fromCharCode(s)).join("")}async function HR(e){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),e;const r=await VR(e);return btoa(r).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ko(e,t,r=!1){const n=WR();let a=n;r&&(a+="/PASSWORD_RECOVERY"),await CT(e,`${t}-code-verifier`,a);const s=await HR(n);return[s,n===s?"plain":"s256"]}const zR=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function YR(e){const t=e.headers.get(Bv);if(!t||!t.match(zR))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch{return null}}function GR(e){if(!e)throw new Error("Missing exp claim");const t=Math.floor(Date.now()/1e3);if(e<=t)throw new Error("JWT has expired")}function KR(e){switch(e){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}var qR=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};const Ei=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),XR=[502,503,504];async function dw(e){var t;if(!LR(e))throw new Uv(Ei(e),0);if(XR.includes(e.status))throw new Uv(Ei(e),e.status);let r;try{r=await e.json()}catch(s){throw new ST(Ei(s),s)}let n;const a=YR(e);if(a&&a.getTime()>=ET["2024-01-01"].timestamp&&typeof r=="object"&&r&&typeof r.code=="string"?n=r.code:typeof r=="object"&&r&&typeof r.error_code=="string"&&(n=r.error_code),n){if(n==="weak_password")throw new lw(Ei(r),e.status,((t=r.weak_password)===null||t===void 0?void 0:t.reasons)||[]);if(n==="session_not_found")throw new Ts}else if(typeof r=="object"&&r&&typeof r.weak_password=="object"&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce((s,i)=>s&&typeof i=="string",!0))throw new lw(Ei(r),e.status,r.weak_password.reasons);throw new kR(Ei(r),e.status||500,n)}const QR=(e,t,r,n)=>{const a={method:e,headers:(t==null?void 0:t.headers)||{}};return e==="GET"?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},t==null?void 0:t.headers),a.body=JSON.stringify(n),Object.assign(Object.assign({},a),r))};async function Ie(e,t,r,n){var a;const s=Object.assign({},n==null?void 0:n.headers);s[Bv]||(s[Bv]=ET["2024-01-01"].name),n!=null&&n.jwt&&(s.Authorization=`Bearer ${n.jwt}`);const i=(a=n==null?void 0:n.query)!==null&&a!==void 0?a:{};n!=null&&n.redirectTo&&(i.redirect_to=n.redirectTo);const o=Object.keys(i).length?"?"+new URLSearchParams(i).toString():"",l=await JR(e,t,r+o,{headers:s,noResolveJson:n==null?void 0:n.noResolveJson},{},n==null?void 0:n.body);return n!=null&&n.xform?n==null?void 0:n.xform(l):{data:Object.assign({},l),error:null}}async function JR(e,t,r,n,a,s){const i=QR(t,n,a,s);let o;try{o=await e(r,Object.assign({},i))}catch(l){throw console.error(l),new Uv(Ei(l),0)}if(o.ok||await dw(o),n!=null&&n.noResolveJson)return o;try{return await o.json()}catch(l){await dw(l)}}function Cs(e){var t;let r=null;r6(e)&&(r=Object.assign({},e),e.expires_at||(r.expires_at=RR(e.expires_in)));const n=(t=e.user)!==null&&t!==void 0?t:e;return{data:{session:r,user:n},error:null}}function hw(e){const t=Cs(e);return!t.error&&e.weak_password&&typeof e.weak_password=="object"&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&typeof e.weak_password.message=="string"&&e.weak_password.reasons.reduce((r,n)=>r&&typeof n=="string",!0)&&(t.data.weak_password=e.weak_password),t}function Ps(e){var t;return{data:{user:(t=e.user)!==null&&t!==void 0?t:e},error:null}}function ZR(e){return{data:e,error:null}}function e6(e){const{action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s}=e,i=qR(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:t,email_otp:r,hashed_token:n,redirect_to:a,verification_type:s},l=Object.assign({},i);return{data:{properties:o,user:l},error:null}}function t6(e){return e}function r6(e){return e.access_token&&e.refresh_token&&e.expires_in}var n6=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]]);return r};class a6{constructor({url:t="",headers:r={},fetch:n}){this.url=t,this.headers=r,this.fetch=TT(n),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(t,r="global"){try{return await Ie(this.fetch,"POST",`${this.url}/logout?scope=${r}`,{headers:this.headers,jwt:t,noResolveJson:!0}),{data:null,error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}async inviteUserByEmail(t,r={}){try{return await Ie(this.fetch,"POST",`${this.url}/invite`,{body:{email:t,data:r.data},headers:this.headers,redirectTo:r.redirectTo,xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async generateLink(t){try{const{options:r}=t,n=n6(t,["options"]),a=Object.assign(Object.assign({},n),r);return"newEmail"in n&&(a.new_email=n==null?void 0:n.newEmail,delete a.newEmail),await Ie(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:a,headers:this.headers,xform:e6,redirectTo:r==null?void 0:r.redirectTo})}catch(r){if(Pe(r))return{data:{properties:null,user:null},error:r};throw r}}async createUser(t){try{return await Ie(this.fetch,"POST",`${this.url}/admin/users`,{body:t,headers:this.headers,xform:Ps})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async listUsers(t){var r,n,a,s,i,o,l;try{const c={nextPage:null,lastPage:0,total:0},f=await Ie(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(n=(r=t==null?void 0:t.page)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:"",per_page:(s=(a=t==null?void 0:t.perPage)===null||a===void 0?void 0:a.toString())!==null&&s!==void 0?s:""},xform:t6});if(f.error)throw f.error;const d=await f.json(),h=(i=f.headers.get("x-total-count"))!==null&&i!==void 0?i:0,p=(l=(o=f.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&l!==void 0?l:[];return p.length>0&&(p.forEach(v=>{const m=parseInt(v.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(v.split(";")[1].split("=")[1]);c[`${_}Page`]=m}),c.total=parseInt(h)),{data:Object.assign(Object.assign({},d),c),error:null}}catch(c){if(Pe(c))return{data:{users:[]},error:c};throw c}}async getUserById(t){try{return await Ie(this.fetch,"GET",`${this.url}/admin/users/${t}`,{headers:this.headers,xform:Ps})}catch(r){if(Pe(r))return{data:{user:null},error:r};throw r}}async updateUserById(t,r){try{return await Ie(this.fetch,"PUT",`${this.url}/admin/users/${t}`,{body:r,headers:this.headers,xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async deleteUser(t,r=!1){try{return await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t}`,{headers:this.headers,body:{should_soft_delete:r},xform:Ps})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async _listFactors(t){try{const{data:r,error:n}=await Ie(this.fetch,"GET",`${this.url}/admin/users/${t.userId}/factors`,{headers:this.headers,xform:a=>({data:{factors:a},error:null})});return{data:r,error:n}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _deleteFactor(t){try{return{data:await Ie(this.fetch,"DELETE",`${this.url}/admin/users/${t.userId}/factors/${t.id}`,{headers:this.headers}),error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}}const s6={getItem:e=>zc()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{zc()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{zc()&&globalThis.localStorage.removeItem(e)}};function pw(e={}){return{getItem:t=>e[t]||null,setItem:(t,r)=>{e[t]=r},removeItem:t=>{delete e[t]}}}function i6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const To={debug:!!(globalThis&&zc()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class NT extends Error{constructor(t){super(t),this.isAcquireTimeout=!0}}class o6 extends NT{}async function l6(e,t,r){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",e,t);const n=new globalThis.AbortController;return t>0&&setTimeout(()=>{n.abort(),To.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",e)},t),await Promise.resolve().then(()=>globalThis.navigator.locks.request(e,t===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:n.signal},async a=>{if(a){To.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",e,a.name);try{return await r()}finally{To.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",e,a.name)}}else{if(t===0)throw To.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",e),new o6(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(To.debug)try{const s=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(s,null,"  "))}catch(s){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",s)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await r()}}))}i6();const c6={url:_R,storageKey:wR,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:bR,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function mw(e,t,r){return await r()}class Tu{constructor(t){var r,n;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Tu.nextInstanceID,Tu.nextInstanceID+=1,this.instanceID>0&&pa()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const a=Object.assign(Object.assign({},c6),t);if(this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.persistSession=a.persistSession,this.storageKey=a.storageKey,this.autoRefreshToken=a.autoRefreshToken,this.admin=new a6({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=TT(a.fetch),this.lock=a.lock||mw,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,a.lock?this.lock=a.lock:pa()&&(!((r=globalThis==null?void 0:globalThis.navigator)===null||r===void 0)&&r.locks)?this.lock=l6:this.lock=mw,this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?a.storage?this.storage=a.storage:zc()?this.storage=s6:(this.memoryStorage={},this.storage=pw(this.memoryStorage)):(this.memoryStorage={},this.storage=pw(this.memoryStorage)),pa()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(s){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",s)}(n=this.broadcastChannel)===null||n===void 0||n.addEventListener("message",async s=>{this._debug("received broadcast notification from other tab or client",s),await this._notifyAllSubscribers(s.data.event,s.data.session,!1)})}this.initialize()}_debug(...t){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${bT}) ${new Date().toISOString()}`,...t),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var t;try{const r=IR(window.location.href);let n="none";if(this._isImplicitGrantCallback(r)?n="implicit":await this._isPKCECallback(r)&&(n="pkce"),pa()&&this.detectSessionInUrl&&n!=="none"){const{data:a,error:s}=await this._getSessionFromURL(r,n);if(s){if(this._debug("#_initialize()","error detecting session from URL",s),NR(s)){const l=(t=s.details)===null||t===void 0?void 0:t.code;if(l==="identity_already_exists"||l==="identity_not_found"||l==="single_identity_not_deletable")return{error:s}}return await this._removeSession(),{error:s}}const{session:i,redirectType:o}=a;return this._debug("#_initialize()","detected session in URL",i,"redirect type",o),await this._saveSession(i),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(r){return Pe(r)?{error:r}:{error:new ST("Unexpected error during initialization",r)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(t){var r,n,a;try{const s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(n=(r=t==null?void 0:t.options)===null||r===void 0?void 0:r.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:(a=t==null?void 0:t.options)===null||a===void 0?void 0:a.captchaToken}},xform:Cs}),{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signUp(t){var r,n,a;try{let s;if("email"in t){const{email:f,password:d,options:h}=t;let p=null,v=null;this.flowType==="pkce"&&([p,v]=await ko(this.storage,this.storageKey)),s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:h==null?void 0:h.emailRedirectTo,body:{email:f,password:d,data:(r=h==null?void 0:h.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:p,code_challenge_method:v},xform:Cs})}else if("phone"in t){const{phone:f,password:d,options:h}=t;s=await Ie(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:f,password:d,data:(n=h==null?void 0:h.data)!==null&&n!==void 0?n:{},channel:(a=h==null?void 0:h.channel)!==null&&a!==void 0?a:"sms",gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken}},xform:Cs})}else throw new rd("You must provide either an email or phone number and a password");const{data:i,error:o}=s;if(o||!i)return{data:{user:null,session:null},error:o};const l=i.session,c=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(s){if(Pe(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithPassword(t){try{let r;if("email"in t){const{email:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:hw})}else if("phone"in t){const{phone:s,password:i,options:o}=t;r=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:i,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:hw})}else throw new rd("You must provide either an email or phone number and a password");const{data:n,error:a}=r;return a?{data:{user:null,session:null},error:a}:!n||!n.session||!n.user?{data:{user:null,session:null},error:new sm}:(n.session&&(await this._saveSession(n.session),await this._notifyAllSubscribers("SIGNED_IN",n.session)),{data:Object.assign({user:n.user,session:n.session},n.weak_password?{weakPassword:n.weak_password}:null),error:a})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOAuth(t){var r,n,a,s;return await this._handleProviderSignIn(t.provider,{redirectTo:(r=t.options)===null||r===void 0?void 0:r.redirectTo,scopes:(n=t.options)===null||n===void 0?void 0:n.scopes,queryParams:(a=t.options)===null||a===void 0?void 0:a.queryParams,skipBrowserRedirect:(s=t.options)===null||s===void 0?void 0:s.skipBrowserRedirect})}async exchangeCodeForSession(t){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(t))}async _exchangeCodeForSession(t){const r=await ad(this.storage,`${this.storageKey}-code-verifier`),[n,a]=(r??"").split("/");try{const{data:s,error:i}=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:t,code_verifier:n},xform:Cs});if(await sd(this.storage,`${this.storageKey}-code-verifier`),i)throw i;return!s||!s.session||!s.user?{data:{user:null,session:null,redirectType:null},error:new sm}:(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign(Object.assign({},s),{redirectType:a??null}),error:i})}catch(s){if(Pe(s))return{data:{user:null,session:null,redirectType:null},error:s};throw s}}async signInWithIdToken(t){try{const{options:r,provider:n,token:a,access_token:s,nonce:i}=t,o=await Ie(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:n,id_token:a,access_token:s,nonce:i,gotrue_meta_security:{captcha_token:r==null?void 0:r.captchaToken}},xform:Cs}),{data:l,error:c}=o;return c?{data:{user:null,session:null},error:c}:!l||!l.session||!l.user?{data:{user:null,session:null},error:new sm}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:l,error:c})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithOtp(t){var r,n,a,s,i;try{if("email"in t){const{email:o,options:l}=t;let c=null,f=null;this.flowType==="pkce"&&([c,f]=await ko(this.storage,this.storageKey));const{error:d}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(r=l==null?void 0:l.data)!==null&&r!==void 0?r:{},create_user:(n=l==null?void 0:l.shouldCreateUser)!==null&&n!==void 0?n:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},code_challenge:c,code_challenge_method:f},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in t){const{phone:o,options:l}=t,{data:c,error:f}=await Ie(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(a=l==null?void 0:l.data)!==null&&a!==void 0?a:{},create_user:(s=l==null?void 0:l.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken},channel:(i=l==null?void 0:l.channel)!==null&&i!==void 0?i:"sms"}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:f}}throw new rd("You must provide either an email or phone number.")}catch(o){if(Pe(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(t){var r,n;try{let a,s;"options"in t&&(a=(r=t.options)===null||r===void 0?void 0:r.redirectTo,s=(n=t.options)===null||n===void 0?void 0:n.captchaToken);const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},t),{gotrue_meta_security:{captcha_token:s}}),redirectTo:a,xform:Cs});if(o)throw o;if(!i)throw new Error("An error occurred on token verification.");const l=i.session,c=i.user;return l!=null&&l.access_token&&(await this._saveSession(l),await this._notifyAllSubscribers(t.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",l)),{data:{user:c,session:l},error:null}}catch(a){if(Pe(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithSSO(t){var r,n,a;try{let s=null,i=null;return this.flowType==="pkce"&&([s,i]=await ko(this.storage,this.storageKey)),await Ie(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in t?{provider_id:t.providerId}:null),"domain"in t?{domain:t.domain}:null),{redirect_to:(n=(r=t.options)===null||r===void 0?void 0:r.redirectTo)!==null&&n!==void 0?n:void 0}),!((a=t==null?void 0:t.options)===null||a===void 0)&&a.captchaToken?{gotrue_meta_security:{captcha_token:t.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:s,code_challenge_method:i}),headers:this.headers,xform:ZR})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async t=>{const{data:{session:r},error:n}=t;if(n)throw n;if(!r)throw new Ts;const{error:a}=await Ie(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:r.access_token});return{data:{user:null,session:null},error:a}})}catch(t){if(Pe(t))return{data:{user:null,session:null},error:t};throw t}}async resend(t){try{const r=`${this.url}/resend`;if("email"in t){const{email:n,type:a,options:s}=t,{error:i}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{email:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}},redirectTo:s==null?void 0:s.emailRedirectTo});return{data:{user:null,session:null},error:i}}else if("phone"in t){const{phone:n,type:a,options:s}=t,{data:i,error:o}=await Ie(this.fetch,"POST",r,{headers:this.headers,body:{phone:n,type:a,gotrue_meta_security:{captcha_token:s==null?void 0:s.captchaToken}}});return{data:{user:null,session:null,messageId:i==null?void 0:i.message_id},error:o}}throw new rd("You must provide either an email or phone number and a type")}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async r=>r))}async _acquireLock(t,r){this._debug("#_acquireLock","begin",t);try{if(this.lockAcquired){const n=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),a=(async()=>(await n,await r()))();return this.pendingInLock.push((async()=>{try{await a}catch{}})()),a}return await this.lock(`lock:${this.storageKey}`,t,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const n=r();for(this.pendingInLock.push((async()=>{try{await n}catch{}})()),await n;this.pendingInLock.length;){const a=[...this.pendingInLock];await Promise.all(a),this.pendingInLock.splice(0,a.length)}return await n}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(t){this._debug("#_useSession","begin");try{const r=await this.__loadSession();return await t(r)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let t=null;const r=await ad(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",r),r!==null&&(this._isValidSession(r)?t=r:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!t)return{data:{session:null},error:null};const n=t.expires_at?t.expires_at*1e3-Date.now()<am:!1;if(this._debug("#__loadSession()",`session has${n?"":" not"} expired`,"expires_at",t.expires_at),!n){if(this.storage.isServer){let i=this.suppressGetSessionWarning;t=new Proxy(t,{get:(l,c,f)=>(!i&&c==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),i=!0,this.suppressGetSessionWarning=!0),Reflect.get(l,c,f))})}return{data:{session:t},error:null}}const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{session:null},error:s}:{data:{session:a},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(t){return t?await this._getUser(t):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(t){try{return t?await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:t,xform:Ps}):await this._useSession(async r=>{var n,a,s;const{data:i,error:o}=r;if(o)throw o;return!(!((n=i.session)===null||n===void 0)&&n.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ts}:await Ie(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(s=(a=i.session)===null||a===void 0?void 0:a.access_token)!==null&&s!==void 0?s:void 0,xform:Ps})})}catch(r){if(Pe(r))return CR(r)&&(await this._removeSession(),await sd(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:r};throw r}}async updateUser(t,r={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(t,r))}async _updateUser(t,r={}){try{return await this._useSession(async n=>{const{data:a,error:s}=n;if(s)throw s;if(!a.session)throw new Ts;const i=a.session;let o=null,l=null;this.flowType==="pkce"&&t.email!=null&&([o,l]=await ko(this.storage,this.storageKey));const{data:c,error:f}=await Ie(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:r==null?void 0:r.emailRedirectTo,body:Object.assign(Object.assign({},t),{code_challenge:o,code_challenge_method:l}),jwt:i.access_token,xform:Ps});if(f)throw f;return i.user=c.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}})}catch(n){if(Pe(n))return{data:{user:null},error:n};throw n}}async setSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(t))}async _setSession(t){try{if(!t.access_token||!t.refresh_token)throw new Ts;const r=Date.now()/1e3;let n=r,a=!0,s=null;const{payload:i}=om(t.access_token);if(i.exp&&(n=i.exp,a=n<=r),a){const{session:o,error:l}=await this._callRefreshToken(t.refresh_token);if(l)return{data:{user:null,session:null},error:l};if(!o)return{data:{user:null,session:null},error:null};s=o}else{const{data:o,error:l}=await this._getUser(t.access_token);if(l)throw l;s={access_token:t.access_token,refresh_token:t.refresh_token,user:o.user,token_type:"bearer",expires_in:n-r,expires_at:n},await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)}return{data:{user:s.user,session:s},error:null}}catch(r){if(Pe(r))return{data:{session:null,user:null},error:r};throw r}}async refreshSession(t){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(t))}async _refreshSession(t){try{return await this._useSession(async r=>{var n;if(!t){const{data:i,error:o}=r;if(o)throw o;t=(n=i.session)!==null&&n!==void 0?n:void 0}if(!(t!=null&&t.refresh_token))throw new Ts;const{session:a,error:s}=await this._callRefreshToken(t.refresh_token);return s?{data:{user:null,session:null},error:s}:a?{data:{user:a.user,session:a},error:null}:{data:{user:null,session:null},error:null}})}catch(r){if(Pe(r))return{data:{user:null,session:null},error:r};throw r}}async _getSessionFromURL(t,r){try{if(!pa())throw new nd("No browser detected.");if(t.error||t.error_description||t.error_code)throw new nd(t.error_description||"Error in URL with unspecified error_description",{error:t.error||"unspecified_error",code:t.error_code||"unspecified_code"});switch(r){case"implicit":if(this.flowType==="pkce")throw new ow("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new nd("Not a valid implicit grant flow url.");break;default:}if(r==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!t.code)throw new ow("No code detected.");const{data:y,error:x}=await this._exchangeCodeForSession(t.code);if(x)throw x;const w=new URL(window.location.href);return w.searchParams.delete("code"),window.history.replaceState(window.history.state,"",w.toString()),{data:{session:y.session,redirectType:null},error:null}}const{provider_token:n,provider_refresh_token:a,access_token:s,refresh_token:i,expires_in:o,expires_at:l,token_type:c}=t;if(!s||!o||!i||!c)throw new nd("No session defined in URL");const f=Math.round(Date.now()/1e3),d=parseInt(o);let h=f+d;l&&(h=parseInt(l));const p=h-f;p*1e3<=Oo&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${p}s, should have been closer to ${d}s`);const v=h-d;f-v>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",v,h,f):f-v<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",v,h,f);const{data:m,error:_}=await this._getUser(s);if(_)throw _;const g={provider_token:n,provider_refresh_token:a,access_token:s,expires_in:d,expires_at:h,refresh_token:i,token_type:c,user:m.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:g,redirectType:t.type},error:null}}catch(n){if(Pe(n))return{data:{session:null,redirectType:null},error:n};throw n}}_isImplicitGrantCallback(t){return!!(t.access_token||t.error_description)}async _isPKCECallback(t){const r=await ad(this.storage,`${this.storageKey}-code-verifier`);return!!(t.code&&r)}async signOut(t={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(t))}async _signOut({scope:t}={scope:"global"}){return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{error:s};const i=(n=a.session)===null||n===void 0?void 0:n.access_token;if(i){const{error:o}=await this.admin.signOut(i,t);if(o&&!(TR(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return t!=="others"&&(await this._removeSession(),await sd(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(t){const r=MR(),n={id:r,callback:t,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",r),this.stateChangeEmitters.delete(r)}};return this._debug("#onAuthStateChange()","registered callback with id",r),this.stateChangeEmitters.set(r,n),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(r)})))(),{data:{subscription:n}}}async _emitInitialSession(t){return await this._useSession(async r=>{var n,a;try{const{data:{session:s},error:i}=r;if(i)throw i;await((n=this.stateChangeEmitters.get(t))===null||n===void 0?void 0:n.callback("INITIAL_SESSION",s)),this._debug("INITIAL_SESSION","callback id",t,"session",s)}catch(s){await((a=this.stateChangeEmitters.get(t))===null||a===void 0?void 0:a.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",t,"error",s),console.error(s)}})}async resetPasswordForEmail(t,r={}){let n=null,a=null;this.flowType==="pkce"&&([n,a]=await ko(this.storage,this.storageKey,!0));try{return await Ie(this.fetch,"POST",`${this.url}/recover`,{body:{email:t,code_challenge:n,code_challenge_method:a,gotrue_meta_security:{captcha_token:r.captchaToken}},headers:this.headers,redirectTo:r.redirectTo})}catch(s){if(Pe(s))return{data:null,error:s};throw s}}async getUserIdentities(){var t;try{const{data:r,error:n}=await this.getUser();if(n)throw n;return{data:{identities:(t=r.user.identities)!==null&&t!==void 0?t:[]},error:null}}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async linkIdentity(t){var r;try{const{data:n,error:a}=await this._useSession(async s=>{var i,o,l,c,f;const{data:d,error:h}=s;if(h)throw h;const p=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,t.provider,{redirectTo:(i=t.options)===null||i===void 0?void 0:i.redirectTo,scopes:(o=t.options)===null||o===void 0?void 0:o.scopes,queryParams:(l=t.options)===null||l===void 0?void 0:l.queryParams,skipBrowserRedirect:!0});return await Ie(this.fetch,"GET",p,{headers:this.headers,jwt:(f=(c=d.session)===null||c===void 0?void 0:c.access_token)!==null&&f!==void 0?f:void 0})});if(a)throw a;return pa()&&!(!((r=t.options)===null||r===void 0)&&r.skipBrowserRedirect)&&window.location.assign(n==null?void 0:n.url),{data:{provider:t.provider,url:n==null?void 0:n.url},error:null}}catch(n){if(Pe(n))return{data:{provider:t.provider,url:null},error:n};throw n}}async unlinkIdentity(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)throw i;return await Ie(this.fetch,"DELETE",`${this.url}/user/identities/${t.identity_id}`,{headers:this.headers,jwt:(a=(n=s.session)===null||n===void 0?void 0:n.access_token)!==null&&a!==void 0?a:void 0})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _refreshAccessToken(t){const r=`#_refreshAccessToken(${t.substring(0,5)}...)`;this._debug(r,"begin");try{const n=Date.now();return await BR(async a=>(a>0&&await $R(200*Math.pow(2,a-1)),this._debug(r,"refreshing attempt",a),await Ie(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:t},headers:this.headers,xform:Cs})),(a,s)=>{const i=200*Math.pow(2,a);return s&&im(s)&&Date.now()+i-n<Oo})}catch(n){if(this._debug(r,"error",n),Pe(n))return{data:{session:null,user:null},error:n};throw n}finally{this._debug(r,"end")}}_isValidSession(t){return typeof t=="object"&&t!==null&&"access_token"in t&&"refresh_token"in t&&"expires_at"in t}async _handleProviderSignIn(t,r){const n=await this._getUrlForProvider(`${this.url}/authorize`,t,{redirectTo:r.redirectTo,scopes:r.scopes,queryParams:r.queryParams});return this._debug("#_handleProviderSignIn()","provider",t,"options",r,"url",n),pa()&&!r.skipBrowserRedirect&&window.location.assign(n),{data:{provider:t,url:n},error:null}}async _recoverAndRefresh(){var t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const n=await ad(this.storage,this.storageKey);if(this._debug(r,"session from storage",n),!this._isValidSession(n)){this._debug(r,"session is not valid"),n!==null&&await this._removeSession();return}const a=((t=n.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<am;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${am}s`),a){if(this.autoRefreshToken&&n.refresh_token){const{error:s}=await this._callRefreshToken(n.refresh_token);s&&(console.error(s),im(s)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",s),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",n)}catch(n){this._debug(r,"error",n),console.error(n);return}finally{this._debug(r,"end")}}async _callRefreshToken(t){var r,n;if(!t)throw new Ts;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const a=`#_callRefreshToken(${t.substring(0,5)}...)`;this._debug(a,"begin");try{this.refreshingDeferred=new Oh;const{data:s,error:i}=await this._refreshAccessToken(t);if(i)throw i;if(!s.session)throw new Ts;await this._saveSession(s.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",s.session);const o={session:s.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(s){if(this._debug(a,"error",s),Pe(s)){const i={session:null,error:s};return im(s)||await this._removeSession(),(r=this.refreshingDeferred)===null||r===void 0||r.resolve(i),i}throw(n=this.refreshingDeferred)===null||n===void 0||n.reject(s),s}finally{this.refreshingDeferred=null,this._debug(a,"end")}}async _notifyAllSubscribers(t,r,n=!0){const a=`#_notifyAllSubscribers(${t})`;this._debug(a,"begin",r,`broadcast = ${n}`);try{this.broadcastChannel&&n&&this.broadcastChannel.postMessage({event:t,session:r});const s=[],i=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(t,r)}catch(l){s.push(l)}});if(await Promise.all(i),s.length>0){for(let o=0;o<s.length;o+=1)console.error(s[o]);throw s[0]}}finally{this._debug(a,"end")}}async _saveSession(t){this._debug("#_saveSession()",t),this.suppressGetSessionWarning=!0,await CT(this.storage,this.storageKey,t)}async _removeSession(){this._debug("#_removeSession()"),await sd(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const t=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{t&&pa()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",t)}catch(r){console.error("removing visibilitychange callback failed",r)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const t=setInterval(()=>this._autoRefreshTokenTick(),Oo);this.autoRefreshTicker=t,t&&typeof t=="object"&&typeof t.unref=="function"?t.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(t),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const t=this.autoRefreshTicker;this.autoRefreshTicker=null,t&&clearInterval(t)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const t=Date.now();try{return await this._useSession(async r=>{const{data:{session:n}}=r;if(!n||!n.refresh_token||!n.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const a=Math.floor((n.expires_at*1e3-t)/Oo);this._debug("#_autoRefreshTokenTick()",`access token expires in ${a} ticks, a tick lasts ${Oo}ms, refresh threshold is ${$v} ticks`),a<=$v&&await this._callRefreshToken(n.refresh_token)})}catch(r){console.error("Auto refresh tick failed with error. This is likely a transient error.",r)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(t){if(t.isAcquireTimeout||t instanceof NT)this._debug("auto refresh token tick lock not available");else throw t}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!pa()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(t){console.error("_handleVisibilityChange",t)}}async _onVisibilityChanged(t){const r=`#_onVisibilityChanged(${t})`;this._debug(r,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),t||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(r,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(t,r,n){const a=[`provider=${encodeURIComponent(r)}`];if(n!=null&&n.redirectTo&&a.push(`redirect_to=${encodeURIComponent(n.redirectTo)}`),n!=null&&n.scopes&&a.push(`scopes=${encodeURIComponent(n.scopes)}`),this.flowType==="pkce"){const[s,i]=await ko(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(s)}`,code_challenge_method:`${encodeURIComponent(i)}`});a.push(o.toString())}if(n!=null&&n.queryParams){const s=new URLSearchParams(n.queryParams);a.push(s.toString())}return n!=null&&n.skipBrowserRedirect&&a.push(`skip_http_redirect=${n.skipBrowserRedirect}`),`${t}?${a.join("&")}`}async _unenroll(t){try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"DELETE",`${this.url}/factors/${t.factorId}`,{headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _enroll(t){try{return await this._useSession(async r=>{var n,a;const{data:s,error:i}=r;if(i)return{data:null,error:i};const o=Object.assign({friendly_name:t.friendlyName,factor_type:t.factorType},t.factorType==="phone"?{phone:t.phone}:{issuer:t.issuer}),{data:l,error:c}=await Ie(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(n=s==null?void 0:s.session)===null||n===void 0?void 0:n.access_token});return c?{data:null,error:c}:(t.factorType==="totp"&&(!((a=l==null?void 0:l.totp)===null||a===void 0)&&a.qr_code)&&(l.totp.qr_code=`data:image/svg+xml;utf-8,${l.totp.qr_code}`),{data:l,error:null})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}}async _verify(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;if(s)return{data:null,error:s};const{data:i,error:o}=await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/verify`,{body:{code:t.code,challenge_id:t.challengeId},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:o})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challenge(t){return this._acquireLock(-1,async()=>{try{return await this._useSession(async r=>{var n;const{data:a,error:s}=r;return s?{data:null,error:s}:await Ie(this.fetch,"POST",`${this.url}/factors/${t.factorId}/challenge`,{body:{channel:t.channel},headers:this.headers,jwt:(n=a==null?void 0:a.session)===null||n===void 0?void 0:n.access_token})})}catch(r){if(Pe(r))return{data:null,error:r};throw r}})}async _challengeAndVerify(t){const{data:r,error:n}=await this._challenge({factorId:t.factorId});return n?{data:null,error:n}:await this._verify({factorId:t.factorId,challengeId:r.id,code:t.code})}async _listFactors(){const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const n=(t==null?void 0:t.factors)||[],a=n.filter(i=>i.factor_type==="totp"&&i.status==="verified"),s=n.filter(i=>i.factor_type==="phone"&&i.status==="verified");return{data:{all:n,totp:a,phone:s},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async t=>{var r,n;const{data:{session:a},error:s}=t;if(s)return{data:null,error:s};if(!a)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=om(a.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((n=(r=a.user.factors)===null||r===void 0?void 0:r.filter(d=>d.status==="verified"))!==null&&n!==void 0?n:[]).length>0&&(l="aal2");const f=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:f},error:null}}))}async fetchJwk(t,r={keys:[]}){let n=r.keys.find(i=>i.kid===t);if(n||(n=this.jwks.keys.find(i=>i.kid===t),n&&this.jwks_cached_at+SR>Date.now()))return n;const{data:a,error:s}=await Ie(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(s)throw s;if(!a.keys||a.keys.length===0)throw new Hc("JWKS is empty");if(this.jwks=a,this.jwks_cached_at=Date.now(),n=a.keys.find(i=>i.kid===t),!n)throw new Hc("No matching signing key found in JWKS");return n}async getClaims(t,r={keys:[]}){try{let n=t;if(!n){const{data:p,error:v}=await this.getSession();if(v||!p.session)return{data:null,error:v};n=p.session.access_token}const{header:a,payload:s,signature:i,raw:{header:o,payload:l}}=om(n);if(GR(s.exp),!a.kid||a.alg==="HS256"||!("crypto"in globalThis&&"subtle"in globalThis.crypto)){const{error:p}=await this.getUser(n);if(p)throw p;return{data:{claims:s,header:a,signature:i},error:null}}const c=KR(a.alg),f=await this.fetchJwk(a.kid,r),d=await crypto.subtle.importKey("jwk",f,c,!0,["verify"]);if(!await crypto.subtle.verify(c,d,i,FR(`${o}.${l}`)))throw new Hc("Invalid JWT signature");return{data:{claims:s,header:a,signature:i},error:null}}catch(n){if(Pe(n))return{data:null,error:n};throw n}}}Tu.nextInstanceID=0;const u6=Tu;class f6 extends u6{constructor(t){super(t)}}var d6=function(e,t,r,n){function a(s){return s instanceof r?s:new r(function(i){i(s)})}return new(r||(r=Promise))(function(s,i){function o(f){try{c(n.next(f))}catch(d){i(d)}}function l(f){try{c(n.throw(f))}catch(d){i(d)}}function c(f){f.done?s(f.value):a(f.value).then(o,l)}c((n=n.apply(e,t||[])).next())})};class h6{constructor(t,r,n){var a,s,i;if(this.supabaseUrl=t,this.supabaseKey=r,!t)throw new Error("supabaseUrl is required.");if(!r)throw new Error("supabaseKey is required.");const o=xR(t);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const l=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,c={db:uR,realtime:dR,auth:Object.assign(Object.assign({},fR),{storageKey:l}),global:cR},f=yR(n??{},c);this.storageKey=(a=f.auth.storageKey)!==null&&a!==void 0?a:"",this.headers=(s=f.global.headers)!==null&&s!==void 0?s:{},f.accessToken?(this.accessToken=f.accessToken,this.auth=new Proxy({},{get:(d,h)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(h)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((i=f.auth)!==null&&i!==void 0?i:{},this.headers,f.global.fetch),this.fetch=vR(r,this._getAccessToken.bind(this),f.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},f.realtime)),this.rest=new DF(`${o}/rest/v1`,{headers:this.headers,schema:f.db.schema,fetch:this.fetch}),f.accessToken||this._listenForAuthEvents()}get functions(){return new oF(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new iR(this.storageUrl,this.headers,this.fetch)}from(t){return this.rest.from(t)}schema(t){return this.rest.schema(t)}rpc(t,r={},n={}){return this.rest.rpc(t,r,n)}channel(t,r={config:{}}){return this.realtime.channel(t,r)}getChannels(){return this.realtime.getChannels()}removeChannel(t){return this.realtime.removeChannel(t)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var t,r;return d6(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:n}=yield this.auth.getSession();return(r=(t=n.session)===null||t===void 0?void 0:t.access_token)!==null&&r!==void 0?r:null})}_initSupabaseAuthClient({autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,storageKey:s,flowType:i,lock:o,debug:l},c,f){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new f6({url:this.authUrl,headers:Object.assign(Object.assign({},d),c),storageKey:s,autoRefreshToken:t,persistSession:r,detectSessionInUrl:n,storage:a,flowType:i,lock:o,debug:l,fetch:f,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(t){return new YF(this.realtimeUrl,Object.assign(Object.assign({},t),{params:Object.assign({apikey:this.supabaseKey},t==null?void 0:t.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((r,n)=>{this._handleTokenChanged(r,"CLIENT",n==null?void 0:n.access_token)})}_handleTokenChanged(t,r,n){(t==="TOKEN_REFRESHED"||t==="SIGNED_IN")&&this.changedAccessToken!==n?this.changedAccessToken=n:t==="SIGNED_OUT"&&(this.realtime.setAuth(),r=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const p6=(e,t,r)=>new h6(e,t,r),m6="https://wgewrecaqwhpynuktuxp.supabase.co",v6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndnZXdyZWNhcXdocHludWt0dXhwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Mzg2MTI2NzMsImV4cCI6MjA1NDE4ODY3M30.xsi-rH3yossZT99w9JcLVE_FUpMs7lN6jKQUOadIV-Y",ie=p6(m6,v6),Qe=ZP(e=>({user:null,role:null,setUser:t=>e({user:t}),setRole:t=>e({role:t}),logout:async()=>{await ie.auth.signOut(),e({user:null,role:null})}}));/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var g6={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),Je=(e,t)=>{const r=O.forwardRef(({color:n="currentColor",size:a=24,strokeWidth:s=2,absoluteStrokeWidth:i,className:o="",children:l,...c},f)=>O.createElement("svg",{ref:f,...g6,width:a,height:a,stroke:n,strokeWidth:i?Number(s)*24/Number(a):s,className:["lucide",`lucide-${x6(e)}`,o].join(" "),...c},[...t.map(([d,h])=>O.createElement(d,h)),...Array.isArray(l)?l:[l]]));return r.displayName=`${e}`,r};/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=Je("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wv=Je("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _6=Je("Book",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H20v20H6.5a2.5 2.5 0 0 1 0-5H20",key:"t4utmx"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yc=Je("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vw=Je("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=Je("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gw=Je("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xw=Je("Clipboard",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yw=Je("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _w=Je("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const al=Je("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AT=Je("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=Je("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b6=Je("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b0=Je("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $l=Je("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E0=Je("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OT=Je("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ww=Je("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bw=Je("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uf=Je("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const us=Je("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const na=Je("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DT=Je("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const id=Je("Table2",[["path",{d:"M9 3H5a2 2 0 0 0-2 2v4m6-6h10a2 2 0 0 1 2 2v4M9 3v18m0 0h10a2 2 0 0 0 2-2V9M9 21H5a2 2 0 0 1-2-2V9m0 0h18",key:"gugj83"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const E6=Je("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bx=Je("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vv=Je("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yi=Je("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bl=Je("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function S6(){const[e,t]=O.useState(""),[r,n]=O.useState(""),[a,s]=O.useState(!1),[i,o]=O.useState(""),l=Pn(),{setUser:c,setRole:f}=Qe(),[d,h]=O.useState(!1);O.useEffect(()=>{(async()=>{const{data:{session:m}}=await ie.auth.getSession();if(m){const{data:_,error:g}=await ie.from("employees").select("*").eq("id",m.user.id).single();g||(c(m.user),f(_.role),l("/dashboard"))}else t(""),n("")})()},[l,c,f]);async function p(v){v.preventDefault(),s(!0),o("");try{const{data:m,error:_}=await ie.auth.signInWithPassword({email:e,password:r});if(_)throw _;const{data:g,error:y}=await ie.from("employees").select("*").eq("id",m.user.id).single();if(y)throw y;c(m.user),f(g.role),l("/dashboard")}catch(m){o(m.message)}finally{s(!1)}}return u.jsx("div",{className:"min-h-screen bg-gray-100 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-md w-full max-w-md",children:[u.jsx("div",{className:"flex justify-center mb-6",children:u.jsx(Yc,{className:"w-12 h-12 text-blue-600"})}),u.jsx("h1",{className:"text-2xl font-bold text-center text-gray-800 mb-8",children:"Login"}),i&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:i}),u.jsxs("form",{onSubmit:p,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:e,onChange:v=>t(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsxs("div",{className:"relative",children:[u.jsx("input",{type:d?"text":"password",value:r,onChange:v=>n(v.target.value),className:"w-full p-2 border rounded focus:ring-2 focus:ring-blue-500 focus:border-blue-500",required:!0}),u.jsx("button",{type:"button",className:"absolute right-2 top-1/2 transform -translate-y-1/2 text-gray-500 hover:text-gray-700 focus:outline-none",onClick:()=>h(!d),children:d?"Hide":"Show"})]})]}),u.jsx("button",{type:"submit",disabled:a,className:"w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700 disabled:opacity-50",children:a?"Logging in...":"Login"})]})]})})}function fs(e){"@babel/helpers - typeof";return fs=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fs(e)}function k6(e,t){if(fs(e)!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(fs(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function jT(e){var t=k6(e,"string");return fs(t)=="symbol"?t:t+""}function Ti(e,t,r){return(t=jT(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function Ew(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),r.push.apply(r,n)}return r}function tt(e){for(var t=1;t<arguments.length;t++){var r=arguments[t]!=null?arguments[t]:{};t%2?Ew(Object(r),!0).forEach(function(n){Ti(e,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Ew(Object(r)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))})}return e}function jh(e,t){if(e==null)return{};var r={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(t.indexOf(n)!==-1)continue;r[n]=e[n]}return r}function Aa(e,t){if(e==null)return{};var r,n,a=jh(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)r=s[n],t.indexOf(r)===-1&&{}.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}function Gt(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function Sw(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,jT(n.key),n)}}function Kt(e,t,r){return t&&Sw(e.prototype,t),r&&Sw(e,r),Object.defineProperty(e,"prototype",{writable:!1}),e}function S0(e){return S0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},S0(e)}function PT(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(PT=function(){return!!e})()}function T6(e){if(e===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C6(e,t){if(t&&(fs(t)=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return T6(e)}function Sr(e,t,r){return t=S0(t),C6(e,PT()?Reflect.construct(t,r||[],S0(e).constructor):t.apply(e,r))}function k0(e,t){return k0=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},k0(e,t)}function kr(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&k0(e,t)}function FT(e){if(Array.isArray(e))return e}function N6(e,t){var r=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r!=null){var n,a,s,i,o=[],l=!0,c=!1;try{if(s=(r=r.call(e)).next,t===0){if(Object(r)!==r)return;l=!1}else for(;!(l=(n=s.call(r)).done)&&(o.push(n.value),o.length!==t);l=!0);}catch(f){c=!0,a=f}finally{try{if(!l&&r.return!=null&&(i=r.return(),Object(i)!==i))return}finally{if(c)throw a}}return o}}function Hv(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function Ux(e,t){if(e){if(typeof e=="string")return Hv(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Hv(e,t):void 0}}function RT(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function wn(e,t){return FT(e)||N6(e,t)||Ux(e,t)||RT()}function MT(e){var t,r,n="";if(typeof e=="string"||typeof e=="number")n+=e;else if(typeof e=="object")if(Array.isArray(e))for(t=0;t<e.length;t++)e[t]&&(r=MT(e[t]))&&(n&&(n+=" "),n+=r);else for(t in e)e[t]&&(n&&(n+=" "),n+=t);return n}function Ct(){for(var e,t,r=0,n="";r<arguments.length;)(e=arguments[r++])&&(t=MT(e))&&(n&&(n+=" "),n+=t);return n}function kt(){return kt=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},kt.apply(null,arguments)}var A6=function(e,t,r,n,a,s,i,o){if(!e){var l;if(t===void 0)l=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var c=[r,n,a,s,i,o],f=0;l=new Error(t.replace(/%s/g,function(){return c[f++]})),l.name="Invariant Violation"}throw l.framesToPop=1,l}},O6=A6;const Cu=Er(O6);var D6=function(){};function j6(e,t){var r={};return Object.keys(e).forEach(function(n){r[Ld(n)]=D6}),r}function kw(e,t){return e[t]!==void 0}function Ld(e){return"default"+e.charAt(0).toUpperCase()+e.substr(1)}function P6(e){return!!e&&(typeof e!="function"||e.prototype&&e.prototype.isReactComponent)}function F6(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,k0(e,t)}function IT(){var e=this.constructor.getDerivedStateFromProps(this.props,this.state);e!=null&&this.setState(e)}function LT(e){function t(r){var n=this.constructor.getDerivedStateFromProps(e,r);return n??null}this.setState(t.bind(this))}function $T(e,t){try{var r=this.props,n=this.state;this.props=e,this.state=t,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(r,n)}finally{this.props=r,this.state=n}}IT.__suppressDeprecationWarning=!0;LT.__suppressDeprecationWarning=!0;$T.__suppressDeprecationWarning=!0;function R6(e){var t=e.prototype;if(!t||!t.isReactComponent)throw new Error("Can only polyfill class components");if(typeof e.getDerivedStateFromProps!="function"&&typeof t.getSnapshotBeforeUpdate!="function")return e;var r=null,n=null,a=null;if(typeof t.componentWillMount=="function"?r="componentWillMount":typeof t.UNSAFE_componentWillMount=="function"&&(r="UNSAFE_componentWillMount"),typeof t.componentWillReceiveProps=="function"?n="componentWillReceiveProps":typeof t.UNSAFE_componentWillReceiveProps=="function"&&(n="UNSAFE_componentWillReceiveProps"),typeof t.componentWillUpdate=="function"?a="componentWillUpdate":typeof t.UNSAFE_componentWillUpdate=="function"&&(a="UNSAFE_componentWillUpdate"),r!==null||n!==null||a!==null){var s=e.displayName||e.name,i=typeof e.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+i+" but also contains the following legacy lifecycles:"+(r!==null?`
  `+r:"")+(n!==null?`
  `+n:"")+(a!==null?`
  `+a:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof e.getDerivedStateFromProps=="function"&&(t.componentWillMount=IT,t.componentWillReceiveProps=LT),typeof t.getSnapshotBeforeUpdate=="function"){if(typeof t.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");t.componentWillUpdate=$T;var o=t.componentDidUpdate;t.componentDidUpdate=function(c,f,d){var h=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:d;o.call(this,c,f,h)}}return e}var M6="/Users/jquense/src/uncontrollable/src/uncontrollable.js";function BT(e,t,r){r===void 0&&(r=[]);var n=e.displayName||e.name||"Component",a=P6(e),s=Object.keys(t),i=s.map(Ld);a||!r.length||Cu(!1);var o=function(c){F6(f,c);function f(){for(var h,p=arguments.length,v=new Array(p),m=0;m<p;m++)v[m]=arguments[m];h=c.call.apply(c,[this].concat(v))||this,h.handlers=Object.create(null),s.forEach(function(g){var y=t[g],x=function(E){if(h.props[y]){var S;h._notifying=!0;for(var b=arguments.length,j=new Array(b>1?b-1:0),k=1;k<b;k++)j[k-1]=arguments[k];(S=h.props)[y].apply(S,[E].concat(j)),h._notifying=!1}h.unmounted||h.setState(function(C){var P,I=C.values;return{values:kt(Object.create(null),I,(P={},P[g]=E,P))}})};h.handlers[y]=x}),r.length&&(h.attachRef=function(g){h.inner=g});var _=Object.create(null);return s.forEach(function(g){_[g]=h.props[Ld(g)]}),h.state={values:_,prevProps:{}},h}var d=f.prototype;return d.shouldComponentUpdate=function(){return!this._notifying},f.getDerivedStateFromProps=function(p,v){var m=v.values,_=v.prevProps,g={values:kt(Object.create(null),m),prevProps:{}};return s.forEach(function(y){g.prevProps[y]=p[y],!kw(p,y)&&kw(_,y)&&(g.values[y]=p[Ld(y)])}),g},d.componentWillUnmount=function(){this.unmounted=!0},d.render=function(){var p=this,v=this.props,m=v.innerRef,_=jh(v,["innerRef"]);i.forEach(function(y){delete _[y]});var g={};return s.forEach(function(y){var x=p.props[y];g[y]=x!==void 0?x:p.state.values[y]}),Z.createElement(e,kt({},_,g,this.handlers,{ref:m||this.attachRef}))},f}(Z.Component);R6(o),o.displayName="Uncontrolled("+n+")",o.propTypes=kt({innerRef:function(){}},j6(t)),r.forEach(function(c){o.prototype[c]=function(){var d;return(d=this.inner)[c].apply(d,arguments)}});var l=o;return Z.forwardRef&&(l=Z.forwardRef(function(c,f){return Z.createElement(o,kt({},c,{innerRef:f,__source:{fileName:M6,lineNumber:128},__self:this}))}),l.propTypes=o.propTypes),l.ControlledComponent=e,l.deferControlTo=function(c,f,d){return f===void 0&&(f={}),BT(c,kt({},t,f),d)},l}var UT={exports:{}},I6="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",L6=I6,$6=L6;function WT(){}function VT(){}VT.resetWarningCache=WT;var B6=function(){function e(n,a,s,i,o,l){if(l!==$6){var c=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw c.name="Invariant Violation",c}}e.isRequired=e;function t(){return e}var r={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:VT,resetWarningCache:WT};return r.PropTypes=r,r};UT.exports=B6();var U6=UT.exports;const ue=Er(U6);var T0="milliseconds",Nu="seconds",Au="minutes",Ou="hours",Gi="day",wl="week",Du="month",Ki="year",qi="decade",Xi="century",HT={milliseconds:1,seconds:1e3,minutes:60*1e3,hours:60*60*1e3,day:24*60*60*1e3,week:7*24*60*60*1e3},W6={month:1,year:12,decade:10*12,century:100*12};function V6(e){return[31,H6(e),31,30,31,30,31,31,30,31,30,31]}function H6(e){return e%4===0&&e%100!==0||e%400===0?29:28}function aa(e,t,r){switch(e=new Date(e),r){case T0:case Nu:case Au:case Ou:case Gi:case wl:return z6(e,t*HT[r]);case Du:case Ki:case qi:case Xi:return Y6(e,t*W6[r])}throw new TypeError('Invalid units: "'+r+'"')}function z6(e,t){var r=new Date(+e+t);return G6(e,r)}function Y6(e,t){var r=e.getFullYear(),n=e.getMonth(),a=e.getDate(),s=r*12+n+t,i=Math.trunc(s/12),o=s%12,l=Math.min(a,V6(i)[o]),c=new Date(e);return c.setFullYear(i),c.setDate(1),c.setMonth(o),c.setDate(l),c}function G6(e,t){var r=e.getTimezoneOffset(),n=t.getTimezoneOffset(),a=n-r;return new Date(+t+a*HT.minutes)}function ju(e,t,r){return aa(e,-t,r)}function cr(e,t,r){switch(e=new Date(e),t){case Xi:case qi:case Ki:e=N0(e,0);case Du:e=qT(e,1);case wl:case Gi:e=Ru(e,0);case Ou:e=bl(e,0);case Au:e=Fu(e,0);case Nu:e=Pu(e,0)}return t===qi&&(e=ju(e,Qi(e)%10,"year")),t===Xi&&(e=ju(e,Qi(e)%100,"year")),t===wl&&(e=XT(e,0,r)),e}function C0(e,t,r){switch(e=new Date(e),e=cr(e,t,r),t){case Xi:case qi:case Ki:case Du:case wl:e=aa(e,1,t),e=ju(e,1,Gi),e.setHours(23,59,59,999);break;case Gi:e.setHours(23,59,59,999);break;case Ou:case Au:case Nu:e=aa(e,1,t),e=ju(e,1,T0)}return e}var ff=Wl(function(e,t){return e===t}),Wx=Wl(function(e,t){return e!==t}),Ph=Wl(function(e,t){return e>t}),df=Wl(function(e,t){return e>=t}),Vx=Wl(function(e,t){return e<t}),Ul=Wl(function(e,t){return e<=t});function zT(){return new Date(Math.min.apply(Math,arguments))}function YT(){return new Date(Math.max.apply(Math,arguments))}function GT(e,t,r,n){return n=n||"day",(!t||df(e,t,n))&&(!r||Ul(e,r,n))}var Pu=di("Milliseconds"),Fu=di("Seconds"),bl=di("Minutes"),Ru=di("Hours"),KT=di("Day"),qT=di("Date"),N0=di("Month"),Qi=di("FullYear");function K6(e,t){return t===void 0?Qi(cr(e,qi)):aa(e,t+10,Ki)}function q6(e,t){return t===void 0?Qi(cr(e,Xi)):aa(e,t+100,Ki)}function XT(e,t,r){var n=(KT(e)+7-(r||0))%7;return t===void 0?n:aa(e,t-n,Gi)}function X6(e,t,r,n){var a,s,i;switch(r){case T0:case Nu:case Au:case Ou:case Gi:case wl:a=t.getTime()-e.getTime();break;case Du:case Ki:case qi:case Xi:a=(Qi(t)-Qi(e))*12+N0(t)-N0(e);break;default:throw new TypeError('Invalid units: "'+r+'"')}switch(r){case T0:s=1;break;case Nu:s=1e3;break;case Au:s=1e3*60;break;case Ou:s=1e3*60*60;break;case Gi:s=1e3*60*60*24;break;case wl:s=1e3*60*60*24*7;break;case Du:s=1;break;case Ki:s=12;break;case qi:s=120;break;case Xi:s=1200;break;default:throw new TypeError('Invalid units: "'+r+'"')}return i=a/s,n?i:Math.round(i)}function di(e){var t=function(r){switch(r){case"Milliseconds":return 36e5;case"Seconds":return 3600;case"Minutes":return 60;case"Hours":return 1;default:return null}}(e);return function(r,n){if(n===void 0)return r["get"+e]();var a=new Date(r);return a["set"+e](n),t&&a["get"+e]()!=n&&(e==="Hours"||n>=t&&a.getHours()-r.getHours()<Math.floor(n/t))&&a["set"+e](n+t),a}}function Wl(e){return function(t,r,n){return e(+cr(t,n),+cr(r,n))}}const Tw=Object.freeze(Object.defineProperty({__proto__:null,add:aa,century:q6,date:qT,day:KT,decade:K6,diff:X6,endOf:C0,eq:ff,gt:Ph,gte:df,hours:Ru,inRange:GT,lt:Vx,lte:Ul,max:YT,milliseconds:Pu,min:zT,minutes:bl,month:N0,neq:Wx,seconds:Fu,startOf:cr,subtract:ju,weekday:XT,year:Qi},Symbol.toStringTag,{value:"Module"}));function Q6(e){if(Array.isArray(e))return Hv(e)}function QT(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function J6(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $d(e){return Q6(e)||QT(e)||Ux(e)||J6()}function Z6(e,t,r){var n=-1,a=e.length;t<0&&(t=-t>a?0:a+t),r=r>a?a:r,r<0&&(r+=a),a=t>r?0:r-t>>>0,t>>>=0;for(var s=Array(a);++n<a;)s[n]=e[n+t];return s}var JT=Z6;function eM(e,t){return e===t||e!==e&&t!==t}var hf=eM,tM=typeof wt=="object"&&wt&&wt.Object===Object&&wt,ZT=tM,rM=ZT,nM=typeof self=="object"&&self&&self.Object===Object&&self,aM=rM||nM||Function("return this")(),Pa=aM,sM=Pa,iM=sM.Symbol,Vl=iM,Cw=Vl,eC=Object.prototype,oM=eC.hasOwnProperty,lM=eC.toString,xc=Cw?Cw.toStringTag:void 0;function cM(e){var t=oM.call(e,xc),r=e[xc];try{e[xc]=void 0;var n=!0}catch{}var a=lM.call(e);return n&&(t?e[xc]=r:delete e[xc]),a}var uM=cM,fM=Object.prototype,dM=fM.toString;function hM(e){return dM.call(e)}var pM=hM,Nw=Vl,mM=uM,vM=pM,gM="[object Null]",xM="[object Undefined]",Aw=Nw?Nw.toStringTag:void 0;function yM(e){return e==null?e===void 0?xM:gM:Aw&&Aw in Object(e)?mM(e):vM(e)}var Hl=yM;function _M(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var gs=_M,wM=Hl,bM=gs,EM="[object AsyncFunction]",SM="[object Function]",kM="[object GeneratorFunction]",TM="[object Proxy]";function CM(e){if(!bM(e))return!1;var t=wM(e);return t==SM||t==kM||t==EM||t==TM}var Hx=CM,NM=9007199254740991;function AM(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=NM}var zx=AM,OM=Hx,DM=zx;function jM(e){return e!=null&&DM(e.length)&&!OM(e)}var pf=jM,PM=9007199254740991,FM=/^(?:0|[1-9]\d*)$/;function RM(e,t){var r=typeof e;return t=t??PM,!!t&&(r=="number"||r!="symbol"&&FM.test(e))&&e>-1&&e%1==0&&e<t}var Yx=RM,MM=hf,IM=pf,LM=Yx,$M=gs;function BM(e,t,r){if(!$M(r))return!1;var n=typeof t;return(n=="number"?IM(r)&&LM(t,r.length):n=="string"&&t in r)?MM(r[t],e):!1}var Fh=BM,UM=/\s/;function WM(e){for(var t=e.length;t--&&UM.test(e.charAt(t)););return t}var VM=WM,HM=VM,zM=/^\s+/;function YM(e){return e&&e.slice(0,HM(e)+1).replace(zM,"")}var GM=YM;function KM(e){return e!=null&&typeof e=="object"}var hi=KM,qM=Hl,XM=hi,QM="[object Symbol]";function JM(e){return typeof e=="symbol"||XM(e)&&qM(e)==QM}var mf=JM,ZM=GM,Ow=gs,e8=mf,Dw=NaN,t8=/^[-+]0x[0-9a-f]+$/i,r8=/^0b[01]+$/i,n8=/^0o[0-7]+$/i,a8=parseInt;function s8(e){if(typeof e=="number")return e;if(e8(e))return Dw;if(Ow(e)){var t=typeof e.valueOf=="function"?e.valueOf():e;e=Ow(t)?t+"":t}if(typeof e!="string")return e===0?e:+e;e=ZM(e);var r=r8.test(e);return r||n8.test(e)?a8(e.slice(2),r?2:8):t8.test(e)?Dw:+e}var i8=s8,o8=i8,l8=1/0,c8=17976931348623157e292;function u8(e){if(!e)return e===0?e:0;if(e=o8(e),e===l8||e===-1/0){var t=e<0?-1:1;return t*c8}return e===e?e:0}var tC=u8,f8=tC;function d8(e){var t=f8(e),r=t%1;return t===t?r?t-r:t:0}var rC=d8,h8=JT,p8=Fh,m8=rC,v8=Math.ceil,g8=Math.max;function x8(e,t,r){(r?p8(e,t,r):t===void 0)?t=1:t=g8(m8(t),0);var n=e==null?0:e.length;if(!n||t<1)return[];for(var a=0,s=0,i=Array(v8(n/t));a<n;)i[s++]=h8(e,a,a+=t);return i}var y8=x8;const _8=Er(y8);function vf(e){return e&&e.ownerDocument||document}function w8(e){var t=vf(e);return t&&t.defaultView||window}function b8(e,t){return w8(e).getComputedStyle(e,t)}var E8=/([A-Z])/g;function S8(e){return e.replace(E8,"-$1").toLowerCase()}var k8=/^ms-/;function od(e){return S8(e).replace(k8,"-ms-")}var T8=/^((translate|rotate|scale)(X|Y|Z|3d)?|matrix(3d)?|perspective|skew(X|Y)?)$/i;function C8(e){return!!(e&&T8.test(e))}function Do(e,t){var r="",n="";if(typeof t=="string")return e.style.getPropertyValue(od(t))||b8(e).getPropertyValue(od(t));Object.keys(t).forEach(function(a){var s=t[a];!s&&s!==0?e.style.removeProperty(od(a)):C8(a)?n+=a+"("+s+") ":r+=od(a)+": "+s+";"}),n&&(r+="transform: "+n+";"),e.style.cssText+=";"+r}function Mu(e,t){if(e.contains)return e.contains(t);if(e.compareDocumentPosition)return e===t||!!(e.compareDocumentPosition(t)&16)}function N8(e){return"nodeType"in e&&e.nodeType===document.DOCUMENT_NODE}function Gx(e){return"window"in e&&e.window===e?e:N8(e)&&e.defaultView||!1}function nC(e){var t=e==="pageXOffset"?"scrollLeft":"scrollTop";function r(n,a){var s=Gx(n);if(a===void 0)return s?s[e]:n[t];s?s.scrollTo(s[e],a):n[t]=a}return r}const aC=nC("pageXOffset"),sC=nC("pageYOffset");function Ri(e){var t=vf(e),r={top:0,left:0,height:0,width:0},n=t&&t.documentElement;return!n||!Mu(n,e)||(e.getBoundingClientRect!==void 0&&(r=e.getBoundingClientRect()),r={top:r.top+sC(n)-(n.clientTop||0),left:r.left+aC(n)-(n.clientLeft||0),width:r.width,height:r.height}),r}var A8=function(t){return!!t&&"offsetParent"in t};function O8(e){for(var t=vf(e),r=e&&e.offsetParent;A8(r)&&r.nodeName!=="HTML"&&Do(r,"position")==="static";)r=r.offsetParent;return r||t.documentElement}var D8=function(t){return t.nodeName&&t.nodeName.toLowerCase()};function iC(e,t){var r={top:0,left:0},n;if(Do(e,"position")==="fixed")n=e.getBoundingClientRect();else{var a=t||O8(e);n=Ri(e),D8(a)!=="html"&&(r=Ri(a));var s=String(Do(a,"borderTopWidth")||0);r.top+=parseInt(s,10)-sC(a)||0;var i=String(Do(a,"borderLeftWidth")||0);r.left+=parseInt(i,10)-aC(a)||0}var o=String(Do(e,"marginTop")||0),l=String(Do(e,"marginLeft")||0);return kt({},n,{top:n.top-r.top-(parseInt(o,10)||0),left:n.left-r.left-(parseInt(l,10)||0)})}const Kx=!!(typeof window<"u"&&window.document&&window.document.createElement);var jw=new Date().getTime();function j8(e){var t=new Date().getTime(),r=Math.max(0,16-(t-jw)),n=setTimeout(e,r);return jw=t,n}var P8=["","webkit","moz","o","ms"],zv="clearTimeout",Yv=j8,Pw=function(t,r){return t+(t?r[0].toUpperCase()+r.substr(1):r)+"AnimationFrame"};Kx&&P8.some(function(e){var t=Pw(e,"request");return t in window&&(zv=Pw(e,"cancel"),Yv=function(n){return window[t](n)}),!!Yv});var Fw=function(t){typeof window[zv]=="function"&&window[zv](t)},oC=Yv,lm;function F8(e,t){if(!lm){var r=document.body,n=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector;lm=function(s,i){return n.call(s,i)}}return lm(e,t)}var R8=Function.prototype.bind.call(Function.prototype.call,[].slice);function M8(e,t){return R8(e.querySelectorAll(t))}var Gv=!1,Kv=!1;try{var cm={get passive(){return Gv=!0},get once(){return Kv=Gv=!0}};Kx&&(window.addEventListener("test",cm,cm),window.removeEventListener("test",cm,!0))}catch{}function I8(e,t,r,n){if(n&&typeof n!="boolean"&&!Kv){var a=n.once,s=n.capture,i=r;!Kv&&a&&(i=r.__once||function o(l){this.removeEventListener(t,o,s),r.call(this,l)},r.__once=i),e.addEventListener(t,i,Gv?n:s)}e.addEventListener(t,r,n)}function L8(e){const t=O.useRef(e);return O.useEffect(()=>{t.current=e},[e]),t}function Rw(e){const t=L8(e);return O.useCallback(function(...r){return t.current&&t.current(...r)},[t])}function Mw(){return O.useState(null)}function $8(){const e=O.useRef(!0),t=O.useRef(()=>e.current);return O.useEffect(()=>(e.current=!0,()=>{e.current=!1}),[]),t.current}function B8(e){const t=$8();return[e[0],O.useCallback(r=>{if(t())return e[1](r)},[t,e[1]])]}var Gr="top",On="bottom",Dn="right",Kr="left",qx="auto",gf=[Gr,On,Dn,Kr],El="start",Iu="end",U8="clippingParents",lC="viewport",yc="popper",W8="reference",Iw=gf.reduce(function(e,t){return e.concat([t+"-"+El,t+"-"+Iu])},[]),Xx=[].concat(gf,[qx]).reduce(function(e,t){return e.concat([t,t+"-"+El,t+"-"+Iu])},[]),V8="beforeRead",H8="read",z8="afterRead",Y8="beforeMain",G8="main",K8="afterMain",q8="beforeWrite",X8="write",Q8="afterWrite",J8=[V8,H8,z8,Y8,G8,K8,q8,X8,Q8];function Sa(e){return e.split("-")[0]}function on(e){if(e==null)return window;if(e.toString()!=="[object Window]"){var t=e.ownerDocument;return t&&t.defaultView||window}return e}function Ji(e){var t=on(e).Element;return e instanceof t||e instanceof Element}function ka(e){var t=on(e).HTMLElement;return e instanceof t||e instanceof HTMLElement}function Qx(e){if(typeof ShadowRoot>"u")return!1;var t=on(e).ShadowRoot;return e instanceof t||e instanceof ShadowRoot}var Mi=Math.max,A0=Math.min,Sl=Math.round;function qv(){var e=navigator.userAgentData;return e!=null&&e.brands&&Array.isArray(e.brands)?e.brands.map(function(t){return t.brand+"/"+t.version}).join(" "):navigator.userAgent}function cC(){return!/^((?!chrome|android).)*safari/i.test(qv())}function kl(e,t,r){t===void 0&&(t=!1),r===void 0&&(r=!1);var n=e.getBoundingClientRect(),a=1,s=1;t&&ka(e)&&(a=e.offsetWidth>0&&Sl(n.width)/e.offsetWidth||1,s=e.offsetHeight>0&&Sl(n.height)/e.offsetHeight||1);var i=Ji(e)?on(e):window,o=i.visualViewport,l=!cC()&&r,c=(n.left+(l&&o?o.offsetLeft:0))/a,f=(n.top+(l&&o?o.offsetTop:0))/s,d=n.width/a,h=n.height/s;return{width:d,height:h,top:f,right:c+d,bottom:f+h,left:c,x:c,y:f}}function Jx(e){var t=kl(e),r=e.offsetWidth,n=e.offsetHeight;return Math.abs(t.width-r)<=1&&(r=t.width),Math.abs(t.height-n)<=1&&(n=t.height),{x:e.offsetLeft,y:e.offsetTop,width:r,height:n}}function uC(e,t){var r=t.getRootNode&&t.getRootNode();if(e.contains(t))return!0;if(r&&Qx(r)){var n=t;do{if(n&&e.isSameNode(n))return!0;n=n.parentNode||n.host}while(n)}return!1}function ri(e){return e?(e.nodeName||"").toLowerCase():null}function ds(e){return on(e).getComputedStyle(e)}function Z8(e){return["table","td","th"].indexOf(ri(e))>=0}function pi(e){return((Ji(e)?e.ownerDocument:e.document)||window.document).documentElement}function Rh(e){return ri(e)==="html"?e:e.assignedSlot||e.parentNode||(Qx(e)?e.host:null)||pi(e)}function Lw(e){return!ka(e)||ds(e).position==="fixed"?null:e.offsetParent}function eI(e){var t=/firefox/i.test(qv()),r=/Trident/i.test(qv());if(r&&ka(e)){var n=ds(e);if(n.position==="fixed")return null}var a=Rh(e);for(Qx(a)&&(a=a.host);ka(a)&&["html","body"].indexOf(ri(a))<0;){var s=ds(a);if(s.transform!=="none"||s.perspective!=="none"||s.contain==="paint"||["transform","perspective"].indexOf(s.willChange)!==-1||t&&s.willChange==="filter"||t&&s.filter&&s.filter!=="none")return a;a=a.parentNode}return null}function xf(e){for(var t=on(e),r=Lw(e);r&&Z8(r)&&ds(r).position==="static";)r=Lw(r);return r&&(ri(r)==="html"||ri(r)==="body"&&ds(r).position==="static")?t:r||eI(e)||t}function Zx(e){return["top","bottom"].indexOf(e)>=0?"x":"y"}function Gc(e,t,r){return Mi(e,A0(t,r))}function tI(e,t,r){var n=Gc(e,t,r);return n>r?r:n}function fC(){return{top:0,right:0,bottom:0,left:0}}function dC(e){return Object.assign({},fC(),e)}function hC(e,t){return t.reduce(function(r,n){return r[n]=e,r},{})}var rI=function(t,r){return t=typeof t=="function"?t(Object.assign({},r.rects,{placement:r.placement})):t,dC(typeof t!="number"?t:hC(t,gf))};function nI(e){var t,r=e.state,n=e.name,a=e.options,s=r.elements.arrow,i=r.modifiersData.popperOffsets,o=Sa(r.placement),l=Zx(o),c=[Kr,Dn].indexOf(o)>=0,f=c?"height":"width";if(!(!s||!i)){var d=rI(a.padding,r),h=Jx(s),p=l==="y"?Gr:Kr,v=l==="y"?On:Dn,m=r.rects.reference[f]+r.rects.reference[l]-i[l]-r.rects.popper[f],_=i[l]-r.rects.reference[l],g=xf(s),y=g?l==="y"?g.clientHeight||0:g.clientWidth||0:0,x=m/2-_/2,w=d[p],E=y-h[f]-d[v],S=y/2-h[f]/2+x,b=Gc(w,S,E),j=l;r.modifiersData[n]=(t={},t[j]=b,t.centerOffset=b-S,t)}}function aI(e){var t=e.state,r=e.options,n=r.element,a=n===void 0?"[data-popper-arrow]":n;a!=null&&(typeof a=="string"&&(a=t.elements.popper.querySelector(a),!a)||uC(t.elements.popper,a)&&(t.elements.arrow=a))}const sI={name:"arrow",enabled:!0,phase:"main",fn:nI,effect:aI,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Tl(e){return e.split("-")[1]}var iI={top:"auto",right:"auto",bottom:"auto",left:"auto"};function oI(e,t){var r=e.x,n=e.y,a=t.devicePixelRatio||1;return{x:Sl(r*a)/a||0,y:Sl(n*a)/a||0}}function $w(e){var t,r=e.popper,n=e.popperRect,a=e.placement,s=e.variation,i=e.offsets,o=e.position,l=e.gpuAcceleration,c=e.adaptive,f=e.roundOffsets,d=e.isFixed,h=i.x,p=h===void 0?0:h,v=i.y,m=v===void 0?0:v,_=typeof f=="function"?f({x:p,y:m}):{x:p,y:m};p=_.x,m=_.y;var g=i.hasOwnProperty("x"),y=i.hasOwnProperty("y"),x=Kr,w=Gr,E=window;if(c){var S=xf(r),b="clientHeight",j="clientWidth";if(S===on(r)&&(S=pi(r),ds(S).position!=="static"&&o==="absolute"&&(b="scrollHeight",j="scrollWidth")),S=S,a===Gr||(a===Kr||a===Dn)&&s===Iu){w=On;var k=d&&S===E&&E.visualViewport?E.visualViewport.height:S[b];m-=k-n.height,m*=l?1:-1}if(a===Kr||(a===Gr||a===On)&&s===Iu){x=Dn;var C=d&&S===E&&E.visualViewport?E.visualViewport.width:S[j];p-=C-n.width,p*=l?1:-1}}var P=Object.assign({position:o},c&&iI),I=f===!0?oI({x:p,y:m},on(r)):{x:p,y:m};if(p=I.x,m=I.y,l){var D;return Object.assign({},P,(D={},D[w]=y?"0":"",D[x]=g?"0":"",D.transform=(E.devicePixelRatio||1)<=1?"translate("+p+"px, "+m+"px)":"translate3d("+p+"px, "+m+"px, 0)",D))}return Object.assign({},P,(t={},t[w]=y?m+"px":"",t[x]=g?p+"px":"",t.transform="",t))}function lI(e){var t=e.state,r=e.options,n=r.gpuAcceleration,a=n===void 0?!0:n,s=r.adaptive,i=s===void 0?!0:s,o=r.roundOffsets,l=o===void 0?!0:o,c={placement:Sa(t.placement),variation:Tl(t.placement),popper:t.elements.popper,popperRect:t.rects.popper,gpuAcceleration:a,isFixed:t.options.strategy==="fixed"};t.modifiersData.popperOffsets!=null&&(t.styles.popper=Object.assign({},t.styles.popper,$w(Object.assign({},c,{offsets:t.modifiersData.popperOffsets,position:t.options.strategy,adaptive:i,roundOffsets:l})))),t.modifiersData.arrow!=null&&(t.styles.arrow=Object.assign({},t.styles.arrow,$w(Object.assign({},c,{offsets:t.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:l})))),t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-placement":t.placement})}const cI={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:lI,data:{}};var ld={passive:!0};function uI(e){var t=e.state,r=e.instance,n=e.options,a=n.scroll,s=a===void 0?!0:a,i=n.resize,o=i===void 0?!0:i,l=on(t.elements.popper),c=[].concat(t.scrollParents.reference,t.scrollParents.popper);return s&&c.forEach(function(f){f.addEventListener("scroll",r.update,ld)}),o&&l.addEventListener("resize",r.update,ld),function(){s&&c.forEach(function(f){f.removeEventListener("scroll",r.update,ld)}),o&&l.removeEventListener("resize",r.update,ld)}}const fI={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:uI,data:{}};var dI={left:"right",right:"left",bottom:"top",top:"bottom"};function Bd(e){return e.replace(/left|right|bottom|top/g,function(t){return dI[t]})}var hI={start:"end",end:"start"};function Bw(e){return e.replace(/start|end/g,function(t){return hI[t]})}function e1(e){var t=on(e),r=t.pageXOffset,n=t.pageYOffset;return{scrollLeft:r,scrollTop:n}}function t1(e){return kl(pi(e)).left+e1(e).scrollLeft}function pI(e,t){var r=on(e),n=pi(e),a=r.visualViewport,s=n.clientWidth,i=n.clientHeight,o=0,l=0;if(a){s=a.width,i=a.height;var c=cC();(c||!c&&t==="fixed")&&(o=a.offsetLeft,l=a.offsetTop)}return{width:s,height:i,x:o+t1(e),y:l}}function mI(e){var t,r=pi(e),n=e1(e),a=(t=e.ownerDocument)==null?void 0:t.body,s=Mi(r.scrollWidth,r.clientWidth,a?a.scrollWidth:0,a?a.clientWidth:0),i=Mi(r.scrollHeight,r.clientHeight,a?a.scrollHeight:0,a?a.clientHeight:0),o=-n.scrollLeft+t1(e),l=-n.scrollTop;return ds(a||r).direction==="rtl"&&(o+=Mi(r.clientWidth,a?a.clientWidth:0)-s),{width:s,height:i,x:o,y:l}}function r1(e){var t=ds(e),r=t.overflow,n=t.overflowX,a=t.overflowY;return/auto|scroll|overlay|hidden/.test(r+a+n)}function pC(e){return["html","body","#document"].indexOf(ri(e))>=0?e.ownerDocument.body:ka(e)&&r1(e)?e:pC(Rh(e))}function Kc(e,t){var r;t===void 0&&(t=[]);var n=pC(e),a=n===((r=e.ownerDocument)==null?void 0:r.body),s=on(n),i=a?[s].concat(s.visualViewport||[],r1(n)?n:[]):n,o=t.concat(i);return a?o:o.concat(Kc(Rh(i)))}function Xv(e){return Object.assign({},e,{left:e.x,top:e.y,right:e.x+e.width,bottom:e.y+e.height})}function vI(e,t){var r=kl(e,!1,t==="fixed");return r.top=r.top+e.clientTop,r.left=r.left+e.clientLeft,r.bottom=r.top+e.clientHeight,r.right=r.left+e.clientWidth,r.width=e.clientWidth,r.height=e.clientHeight,r.x=r.left,r.y=r.top,r}function Uw(e,t,r){return t===lC?Xv(pI(e,r)):Ji(t)?vI(t,r):Xv(mI(pi(e)))}function gI(e){var t=Kc(Rh(e)),r=["absolute","fixed"].indexOf(ds(e).position)>=0,n=r&&ka(e)?xf(e):e;return Ji(n)?t.filter(function(a){return Ji(a)&&uC(a,n)&&ri(a)!=="body"}):[]}function xI(e,t,r,n){var a=t==="clippingParents"?gI(e):[].concat(t),s=[].concat(a,[r]),i=s[0],o=s.reduce(function(l,c){var f=Uw(e,c,n);return l.top=Mi(f.top,l.top),l.right=A0(f.right,l.right),l.bottom=A0(f.bottom,l.bottom),l.left=Mi(f.left,l.left),l},Uw(e,i,n));return o.width=o.right-o.left,o.height=o.bottom-o.top,o.x=o.left,o.y=o.top,o}function mC(e){var t=e.reference,r=e.element,n=e.placement,a=n?Sa(n):null,s=n?Tl(n):null,i=t.x+t.width/2-r.width/2,o=t.y+t.height/2-r.height/2,l;switch(a){case Gr:l={x:i,y:t.y-r.height};break;case On:l={x:i,y:t.y+t.height};break;case Dn:l={x:t.x+t.width,y:o};break;case Kr:l={x:t.x-r.width,y:o};break;default:l={x:t.x,y:t.y}}var c=a?Zx(a):null;if(c!=null){var f=c==="y"?"height":"width";switch(s){case El:l[c]=l[c]-(t[f]/2-r[f]/2);break;case Iu:l[c]=l[c]+(t[f]/2-r[f]/2);break}}return l}function Lu(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=n===void 0?e.placement:n,s=r.strategy,i=s===void 0?e.strategy:s,o=r.boundary,l=o===void 0?U8:o,c=r.rootBoundary,f=c===void 0?lC:c,d=r.elementContext,h=d===void 0?yc:d,p=r.altBoundary,v=p===void 0?!1:p,m=r.padding,_=m===void 0?0:m,g=dC(typeof _!="number"?_:hC(_,gf)),y=h===yc?W8:yc,x=e.rects.popper,w=e.elements[v?y:h],E=xI(Ji(w)?w:w.contextElement||pi(e.elements.popper),l,f,i),S=kl(e.elements.reference),b=mC({reference:S,element:x,placement:a}),j=Xv(Object.assign({},x,b)),k=h===yc?j:S,C={top:E.top-k.top+g.top,bottom:k.bottom-E.bottom+g.bottom,left:E.left-k.left+g.left,right:k.right-E.right+g.right},P=e.modifiersData.offset;if(h===yc&&P){var I=P[a];Object.keys(C).forEach(function(D){var K=[Dn,On].indexOf(D)>=0?1:-1,Q=[Gr,On].indexOf(D)>=0?"y":"x";C[D]+=I[Q]*K})}return C}function yI(e,t){t===void 0&&(t={});var r=t,n=r.placement,a=r.boundary,s=r.rootBoundary,i=r.padding,o=r.flipVariations,l=r.allowedAutoPlacements,c=l===void 0?Xx:l,f=Tl(n),d=f?o?Iw:Iw.filter(function(v){return Tl(v)===f}):gf,h=d.filter(function(v){return c.indexOf(v)>=0});h.length===0&&(h=d);var p=h.reduce(function(v,m){return v[m]=Lu(e,{placement:m,boundary:a,rootBoundary:s,padding:i})[Sa(m)],v},{});return Object.keys(p).sort(function(v,m){return p[v]-p[m]})}function _I(e){if(Sa(e)===qx)return[];var t=Bd(e);return[Bw(e),t,Bw(t)]}function wI(e){var t=e.state,r=e.options,n=e.name;if(!t.modifiersData[n]._skip){for(var a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!0:i,l=r.fallbackPlacements,c=r.padding,f=r.boundary,d=r.rootBoundary,h=r.altBoundary,p=r.flipVariations,v=p===void 0?!0:p,m=r.allowedAutoPlacements,_=t.options.placement,g=Sa(_),y=g===_,x=l||(y||!v?[Bd(_)]:_I(_)),w=[_].concat(x).reduce(function(T,R){return T.concat(Sa(R)===qx?yI(t,{placement:R,boundary:f,rootBoundary:d,padding:c,flipVariations:v,allowedAutoPlacements:m}):R)},[]),E=t.rects.reference,S=t.rects.popper,b=new Map,j=!0,k=w[0],C=0;C<w.length;C++){var P=w[C],I=Sa(P),D=Tl(P)===El,K=[Gr,On].indexOf(I)>=0,Q=K?"width":"height",z=Lu(t,{placement:P,boundary:f,rootBoundary:d,altBoundary:h,padding:c}),q=K?D?Dn:Kr:D?On:Gr;E[Q]>S[Q]&&(q=Bd(q));var ee=Bd(q),H=[];if(s&&H.push(z[I]<=0),o&&H.push(z[q]<=0,z[ee]<=0),H.every(function(T){return T})){k=P,j=!1;break}b.set(P,H)}if(j)for(var ce=v?3:1,J=function(R){var G=w.find(function(X){var Y=b.get(X);if(Y)return Y.slice(0,R).every(function(ae){return ae})});if(G)return k=G,"break"},N=ce;N>0;N--){var F=J(N);if(F==="break")break}t.placement!==k&&(t.modifiersData[n]._skip=!0,t.placement=k,t.reset=!0)}}const bI={name:"flip",enabled:!0,phase:"main",fn:wI,requiresIfExists:["offset"],data:{_skip:!1}};function Ww(e,t,r){return r===void 0&&(r={x:0,y:0}),{top:e.top-t.height-r.y,right:e.right-t.width+r.x,bottom:e.bottom-t.height+r.y,left:e.left-t.width-r.x}}function Vw(e){return[Gr,Dn,On,Kr].some(function(t){return e[t]>=0})}function EI(e){var t=e.state,r=e.name,n=t.rects.reference,a=t.rects.popper,s=t.modifiersData.preventOverflow,i=Lu(t,{elementContext:"reference"}),o=Lu(t,{altBoundary:!0}),l=Ww(i,n),c=Ww(o,a,s),f=Vw(l),d=Vw(c);t.modifiersData[r]={referenceClippingOffsets:l,popperEscapeOffsets:c,isReferenceHidden:f,hasPopperEscaped:d},t.attributes.popper=Object.assign({},t.attributes.popper,{"data-popper-reference-hidden":f,"data-popper-escaped":d})}const SI={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:EI};function kI(e,t,r){var n=Sa(e),a=[Kr,Gr].indexOf(n)>=0?-1:1,s=typeof r=="function"?r(Object.assign({},t,{placement:e})):r,i=s[0],o=s[1];return i=i||0,o=(o||0)*a,[Kr,Dn].indexOf(n)>=0?{x:o,y:i}:{x:i,y:o}}function TI(e){var t=e.state,r=e.options,n=e.name,a=r.offset,s=a===void 0?[0,0]:a,i=Xx.reduce(function(f,d){return f[d]=kI(d,t.rects,s),f},{}),o=i[t.placement],l=o.x,c=o.y;t.modifiersData.popperOffsets!=null&&(t.modifiersData.popperOffsets.x+=l,t.modifiersData.popperOffsets.y+=c),t.modifiersData[n]=i}const CI={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:TI};function NI(e){var t=e.state,r=e.name;t.modifiersData[r]=mC({reference:t.rects.reference,element:t.rects.popper,placement:t.placement})}const AI={name:"popperOffsets",enabled:!0,phase:"read",fn:NI,data:{}};function OI(e){return e==="x"?"y":"x"}function DI(e){var t=e.state,r=e.options,n=e.name,a=r.mainAxis,s=a===void 0?!0:a,i=r.altAxis,o=i===void 0?!1:i,l=r.boundary,c=r.rootBoundary,f=r.altBoundary,d=r.padding,h=r.tether,p=h===void 0?!0:h,v=r.tetherOffset,m=v===void 0?0:v,_=Lu(t,{boundary:l,rootBoundary:c,padding:d,altBoundary:f}),g=Sa(t.placement),y=Tl(t.placement),x=!y,w=Zx(g),E=OI(w),S=t.modifiersData.popperOffsets,b=t.rects.reference,j=t.rects.popper,k=typeof m=="function"?m(Object.assign({},t.rects,{placement:t.placement})):m,C=typeof k=="number"?{mainAxis:k,altAxis:k}:Object.assign({mainAxis:0,altAxis:0},k),P=t.modifiersData.offset?t.modifiersData.offset[t.placement]:null,I={x:0,y:0};if(S){if(s){var D,K=w==="y"?Gr:Kr,Q=w==="y"?On:Dn,z=w==="y"?"height":"width",q=S[w],ee=q+_[K],H=q-_[Q],ce=p?-j[z]/2:0,J=y===El?b[z]:j[z],N=y===El?-j[z]:-b[z],F=t.elements.arrow,T=p&&F?Jx(F):{width:0,height:0},R=t.modifiersData["arrow#persistent"]?t.modifiersData["arrow#persistent"].padding:fC(),G=R[K],X=R[Q],Y=Gc(0,b[z],T[z]),ae=x?b[z]/2-ce-Y-G-C.mainAxis:J-Y-G-C.mainAxis,oe=x?-b[z]/2+ce+Y+X+C.mainAxis:N+Y+X+C.mainAxis,ve=t.elements.arrow&&xf(t.elements.arrow),B=ve?w==="y"?ve.clientTop||0:ve.clientLeft||0:0,Te=(D=P==null?void 0:P[w])!=null?D:0,ke=q+ae-Te-B,$e=q+oe-Te,Ne=Gc(p?A0(ee,ke):ee,q,p?Mi(H,$e):H);S[w]=Ne,I[w]=Ne-q}if(o){var me,Xe=w==="x"?Gr:Kr,$t=w==="x"?On:Dn,gt=S[E],Ir=E==="y"?"height":"width",ws=gt+_[Xe],Ln=gt-_[$t],tr=[Gr,Kr].indexOf(g)!==-1,hn=(me=P==null?void 0:P[E])!=null?me:0,$n=tr?ws:gt-b[Ir]-j[Ir]-hn+C.altAxis,bs=tr?gt+b[Ir]+j[Ir]-hn-C.altAxis:Ln,qt=p&&tr?tI($n,gt,bs):Gc(p?$n:ws,gt,p?bs:Ln);S[E]=qt,I[E]=qt-gt}t.modifiersData[n]=I}}const jI={name:"preventOverflow",enabled:!0,phase:"main",fn:DI,requiresIfExists:["offset"]};function PI(e){return{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}function FI(e){return e===on(e)||!ka(e)?e1(e):PI(e)}function RI(e){var t=e.getBoundingClientRect(),r=Sl(t.width)/e.offsetWidth||1,n=Sl(t.height)/e.offsetHeight||1;return r!==1||n!==1}function MI(e,t,r){r===void 0&&(r=!1);var n=ka(t),a=ka(t)&&RI(t),s=pi(t),i=kl(e,a,r),o={scrollLeft:0,scrollTop:0},l={x:0,y:0};return(n||!n&&!r)&&((ri(t)!=="body"||r1(s))&&(o=FI(t)),ka(t)?(l=kl(t,!0),l.x+=t.clientLeft,l.y+=t.clientTop):s&&(l.x=t1(s))),{x:i.left+o.scrollLeft-l.x,y:i.top+o.scrollTop-l.y,width:i.width,height:i.height}}function II(e){var t=new Map,r=new Set,n=[];e.forEach(function(s){t.set(s.name,s)});function a(s){r.add(s.name);var i=[].concat(s.requires||[],s.requiresIfExists||[]);i.forEach(function(o){if(!r.has(o)){var l=t.get(o);l&&a(l)}}),n.push(s)}return e.forEach(function(s){r.has(s.name)||a(s)}),n}function LI(e){var t=II(e);return J8.reduce(function(r,n){return r.concat(t.filter(function(a){return a.phase===n}))},[])}function $I(e){var t;return function(){return t||(t=new Promise(function(r){Promise.resolve().then(function(){t=void 0,r(e())})})),t}}function BI(e){var t=e.reduce(function(r,n){var a=r[n.name];return r[n.name]=a?Object.assign({},a,n,{options:Object.assign({},a.options,n.options),data:Object.assign({},a.data,n.data)}):n,r},{});return Object.keys(t).map(function(r){return t[r]})}var Hw={placement:"bottom",modifiers:[],strategy:"absolute"};function zw(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return!t.some(function(n){return!(n&&typeof n.getBoundingClientRect=="function")})}function UI(e){e===void 0&&(e={});var t=e,r=t.defaultModifiers,n=r===void 0?[]:r,a=t.defaultOptions,s=a===void 0?Hw:a;return function(o,l,c){c===void 0&&(c=s);var f={placement:"bottom",orderedModifiers:[],options:Object.assign({},Hw,s),modifiersData:{},elements:{reference:o,popper:l},attributes:{},styles:{}},d=[],h=!1,p={state:f,setOptions:function(g){var y=typeof g=="function"?g(f.options):g;m(),f.options=Object.assign({},s,f.options,y),f.scrollParents={reference:Ji(o)?Kc(o):o.contextElement?Kc(o.contextElement):[],popper:Kc(l)};var x=LI(BI([].concat(n,f.options.modifiers)));return f.orderedModifiers=x.filter(function(w){return w.enabled}),v(),p.update()},forceUpdate:function(){if(!h){var g=f.elements,y=g.reference,x=g.popper;if(zw(y,x)){f.rects={reference:MI(y,xf(x),f.options.strategy==="fixed"),popper:Jx(x)},f.reset=!1,f.placement=f.options.placement,f.orderedModifiers.forEach(function(C){return f.modifiersData[C.name]=Object.assign({},C.data)});for(var w=0;w<f.orderedModifiers.length;w++){if(f.reset===!0){f.reset=!1,w=-1;continue}var E=f.orderedModifiers[w],S=E.fn,b=E.options,j=b===void 0?{}:b,k=E.name;typeof S=="function"&&(f=S({state:f,options:j,name:k,instance:p})||f)}}}},update:$I(function(){return new Promise(function(_){p.forceUpdate(),_(f)})}),destroy:function(){m(),h=!0}};if(!zw(o,l))return p;p.setOptions(c).then(function(_){!h&&c.onFirstUpdate&&c.onFirstUpdate(_)});function v(){f.orderedModifiers.forEach(function(_){var g=_.name,y=_.options,x=y===void 0?{}:y,w=_.effect;if(typeof w=="function"){var E=w({state:f,name:g,instance:p,options:x}),S=function(){};d.push(E||S)}})}function m(){d.forEach(function(_){return _()}),d=[]}return p}}var WI=UI({defaultModifiers:[SI,AI,cI,fI,CI,bI,jI,sI]}),Yw=function(t){return{position:t,top:"0",left:"0",opacity:"0",pointerEvents:"none"}},VI={name:"applyStyles",enabled:!1},HI={name:"ariaDescribedBy",enabled:!0,phase:"afterWrite",effect:function(t){var r=t.state;return function(){var n=r.elements,a=n.reference,s=n.popper;if("removeAttribute"in a){var i=(a.getAttribute("aria-describedby")||"").split(",").filter(function(o){return o.trim()!==s.id});i.length?a.setAttribute("aria-describedby",i.join(",")):a.removeAttribute("aria-describedby")}}},fn:function(t){var r,n=t.state,a=n.elements,s=a.popper,i=a.reference,o=(r=s.getAttribute("role"))==null?void 0:r.toLowerCase();if(s.id&&o==="tooltip"&&"setAttribute"in i){var l=i.getAttribute("aria-describedby");if(l&&l.split(",").indexOf(s.id)!==-1)return;i.setAttribute("aria-describedby",l?l+","+s.id:s.id)}}},zI=[];function YI(e,t,r){var n=r===void 0?{}:r,a=n.enabled,s=a===void 0?!0:a,i=n.placement,o=i===void 0?"bottom":i,l=n.strategy,c=l===void 0?"absolute":l,f=n.modifiers,d=f===void 0?zI:f,h=jh(n,["enabled","placement","strategy","modifiers"]),p=O.useRef(),v=O.useCallback(function(){var w;(w=p.current)==null||w.update()},[]),m=O.useCallback(function(){var w;(w=p.current)==null||w.forceUpdate()},[]),_=B8(O.useState({placement:o,update:v,forceUpdate:m,attributes:{},styles:{popper:Yw(c),arrow:{}}})),g=_[0],y=_[1],x=O.useMemo(function(){return{name:"updateStateModifier",enabled:!0,phase:"write",requires:["computeStyles"],fn:function(E){var S=E.state,b={},j={};Object.keys(S.elements).forEach(function(k){b[k]=S.styles[k],j[k]=S.attributes[k]}),y({state:S,styles:b,attributes:j,update:v,forceUpdate:m,placement:S.placement})}}},[v,m,y]);return O.useEffect(function(){!p.current||!s||p.current.setOptions({placement:o,strategy:c,modifiers:[].concat(d,[x,VI])})},[c,o,x,s]),O.useEffect(function(){if(!(!s||e==null||t==null))return p.current=WI(e,t,kt({},h,{placement:o,strategy:c,modifiers:[].concat(d,[HI,x])})),function(){p.current!=null&&(p.current.destroy(),p.current=void 0,y(function(w){return kt({},w,{attributes:{},styles:{popper:Yw(c)}})}))}},[s,e,t]),g}function GI(e,t,r,n){var a=n&&typeof n!="boolean"?n.capture:n;e.removeEventListener(t,r,a),r.__once&&e.removeEventListener(t,r.__once,a)}function Ac(e,t,r,n){return I8(e,t,r,n),function(){GI(e,t,r,n)}}var KI=function(){},qI=KI;const XI=Er(qI);function QI(e){return e&&"setState"in e?Uk.findDOMNode(e):e??null}const JI=function(e){return vf(QI(e))};var ZI=27,Gw=function(){};function eL(e){return e.button===0}function tL(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}var Kw=function(t){return t&&("current"in t?t.current:t)};function rL(e,t,r){var n=r===void 0?{}:r,a=n.disabled,s=n.clickTrigger,i=s===void 0?"click":s,o=O.useRef(!1),l=t||Gw,c=O.useCallback(function(h){var p,v=Kw(e);XI(!!v,"RootClose captured a close event but does not have a ref to compare it to. useRootClose(), should be passed a ref that resolves to a DOM node"),o.current=!v||tL(h)||!eL(h)||!!Mu(v,(p=h.composedPath==null?void 0:h.composedPath()[0])!=null?p:h.target)},[e]),f=Rw(function(h){o.current||l(h)}),d=Rw(function(h){h.keyCode===ZI&&l(h)});O.useEffect(function(){if(!(a||e==null)){var h=window.event,p=JI(Kw(e)),v=Ac(p,i,c,!0),m=Ac(p,i,function(y){if(y===h){h=void 0;return}f(y)}),_=Ac(p,"keyup",function(y){if(y===h){h=void 0;return}d(y)}),g=[];return"ontouchstart"in p.documentElement&&(g=[].slice.call(p.body.children).map(function(y){return Ac(y,"mousemove",Gw)})),function(){v(),m(),_(),g.forEach(function(y){return y()})}}},[e,a,i,c,f,d])}function nL(e){var t={};return Array.isArray(e)?(e==null||e.forEach(function(r){t[r.name]=r}),t):e||t}function aL(e){return e===void 0&&(e={}),Array.isArray(e)?e:Object.keys(e).map(function(t){return e[t].name=t,e[t]})}function sL(e){var t,r,n,a,s=e.enabled,i=e.enableEvents,o=e.placement,l=e.flip,c=e.offset,f=e.fixed,d=e.containerPadding,h=e.arrowElement,p=e.popperConfig,v=p===void 0?{}:p,m=nL(v.modifiers);return kt({},v,{placement:o,enabled:s,strategy:f?"fixed":v.strategy,modifiers:aL(kt({},m,{eventListeners:{enabled:i},preventOverflow:kt({},m.preventOverflow,{options:d?kt({padding:d},(t=m.preventOverflow)==null?void 0:t.options):(r=m.preventOverflow)==null?void 0:r.options}),offset:{options:kt({offset:c},(n=m.offset)==null?void 0:n.options)},arrow:kt({},m.arrow,{enabled:!!h,options:kt({},(a=m.arrow)==null?void 0:a.options,{element:h})}),flip:kt({enabled:!!l},m.flip)}))})}function iL(e,t){return e.classList?e.classList.contains(t):(" "+(e.className.baseVal||e.className)+" ").indexOf(" "+t+" ")!==-1}function oL(e,t){e.classList?e.classList.add(t):iL(e,t)||(typeof e.className=="string"?e.className=e.className+" "+t:e.setAttribute("class",(e.className&&e.className.baseVal||"")+" "+t))}function qw(e,t){return e.replace(new RegExp("(^|\\s)"+t+"(?:\\s|$)","g"),"$1").replace(/\s+/g," ").replace(/^\s*|\s*$/g,"")}function lL(e,t){e.classList?e.classList.remove(t):typeof e.className=="string"?e.className=qw(e.className,t):e.setAttribute("class",qw(e.className&&e.className.baseVal||"",t))}var cd;function n1(e){if((!cd&&cd!==0||e)&&Kx){var t=document.createElement("div");t.style.position="absolute",t.style.top="-9999px",t.style.width="50px",t.style.height="50px",t.style.overflow="scroll",document.body.appendChild(t),cd=t.offsetWidth-t.clientWidth,document.body.removeChild(t)}return cd}var um=function(t){var r;return typeof document>"u"?null:t==null?vf().body:(typeof t=="function"&&(t=t()),t&&"current"in t&&(t=t.current),(r=t)!=null&&r.nodeType&&t||null)};function Xw(e,t){var r=O.useState(function(){return um(e)}),n=r[0],a=r[1];if(!n){var s=um(e);s&&a(s)}return O.useEffect(function(){},[t,n]),O.useEffect(function(){var i=um(e);i!==n&&a(i)},[e,n]),n}const Qw=e=>!e||typeof e=="function"?e:t=>{e.current=t};function cL(e,t){const r=Qw(e),n=Qw(t);return a=>{r&&r(a),n&&n(a)}}function uL(e,t){return O.useMemo(()=>cL(e,t),[e,t])}var a1=Z.forwardRef(function(e,t){var r=e.flip,n=e.offset,a=e.placement,s=e.containerPadding,i=s===void 0?5:s,o=e.popperConfig,l=o===void 0?{}:o,c=e.transition,f=Mw(),d=f[0],h=f[1],p=Mw(),v=p[0],m=p[1],_=uL(h,t),g=Xw(e.container),y=Xw(e.target),x=O.useState(!e.show),w=x[0],E=x[1],S=YI(y,d,sL({placement:a,enableEvents:!!e.show,containerPadding:i||5,flip:r,offset:n,arrowElement:v,popperConfig:l})),b=S.styles,j=S.attributes,k=jh(S,["styles","attributes"]);e.show?w&&E(!1):!e.transition&&!w&&E(!0);var C=function(){E(!0),e.onExited&&e.onExited.apply(e,arguments)},P=e.show||c&&!w;if(rL(d,e.onHide,{disabled:!e.rootClose||e.rootCloseDisabled,clickTrigger:e.rootCloseEvent}),!P)return null;var I=e.children(kt({},k,{show:!!e.show,props:kt({},j.popper,{style:b.popper,ref:_}),arrowProps:kt({},j.arrow,{style:b.arrow,ref:m})}));if(c){var D=e.onExit,K=e.onExiting,Q=e.onEnter,z=e.onEntering,q=e.onEntered;I=Z.createElement(c,{in:e.show,appear:!0,onExit:D,onExiting:K,onExited:C,onEnter:Q,onEntering:z,onEntered:q},I)}return g?Uk.createPortal(I,g):null});a1.displayName="Overlay";a1.propTypes={show:ue.bool,placement:ue.oneOf(Xx),target:ue.any,container:ue.any,flip:ue.bool,children:ue.func.isRequired,containerPadding:ue.number,popperConfig:ue.object,rootClose:ue.bool,rootCloseEvent:ue.oneOf(["click","mousedown"]),rootCloseDisabled:ue.bool,onHide:function(t){for(var r=arguments.length,n=new Array(r>1?r-1:0),a=1;a<r;a++)n[a-1]=arguments[a];if(t.rootClose){var s;return(s=ue.func).isRequired.apply(s,[t].concat(n))}return ue.func.apply(ue,[t].concat(n))},transition:ue.elementType,onEnter:ue.func,onEntering:ue.func,onEntered:ue.func,onExit:ue.func,onExiting:ue.func,onExited:ue.func};function fL(){this.__data__=[],this.size=0}var dL=fL,hL=hf;function pL(e,t){for(var r=e.length;r--;)if(hL(e[r][0],t))return r;return-1}var Mh=pL,mL=Mh,vL=Array.prototype,gL=vL.splice;function xL(e){var t=this.__data__,r=mL(t,e);if(r<0)return!1;var n=t.length-1;return r==n?t.pop():gL.call(t,r,1),--this.size,!0}var yL=xL,_L=Mh;function wL(e){var t=this.__data__,r=_L(t,e);return r<0?void 0:t[r][1]}var bL=wL,EL=Mh;function SL(e){return EL(this.__data__,e)>-1}var kL=SL,TL=Mh;function CL(e,t){var r=this.__data__,n=TL(r,e);return n<0?(++this.size,r.push([e,t])):r[n][1]=t,this}var NL=CL,AL=dL,OL=yL,DL=bL,jL=kL,PL=NL;function zl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}zl.prototype.clear=AL;zl.prototype.delete=OL;zl.prototype.get=DL;zl.prototype.has=jL;zl.prototype.set=PL;var Ih=zl,FL=Ih;function RL(){this.__data__=new FL,this.size=0}var ML=RL;function IL(e){var t=this.__data__,r=t.delete(e);return this.size=t.size,r}var LL=IL;function $L(e){return this.__data__.get(e)}var BL=$L;function UL(e){return this.__data__.has(e)}var WL=UL,VL=Pa,HL=VL["__core-js_shared__"],zL=HL,fm=zL,Jw=function(){var e=/[^.]+$/.exec(fm&&fm.keys&&fm.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function YL(e){return!!Jw&&Jw in e}var GL=YL,KL=Function.prototype,qL=KL.toString;function XL(e){if(e!=null){try{return qL.call(e)}catch{}try{return e+""}catch{}}return""}var vC=XL,QL=Hx,JL=GL,ZL=gs,e5=vC,t5=/[\\^$.*+?()[\]{}|]/g,r5=/^\[object .+?Constructor\]$/,n5=Function.prototype,a5=Object.prototype,s5=n5.toString,i5=a5.hasOwnProperty,o5=RegExp("^"+s5.call(i5).replace(t5,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function l5(e){if(!ZL(e)||JL(e))return!1;var t=QL(e)?o5:r5;return t.test(e5(e))}var c5=l5;function u5(e,t){return e==null?void 0:e[t]}var f5=u5,d5=c5,h5=f5;function p5(e,t){var r=h5(e,t);return d5(r)?r:void 0}var uo=p5,m5=uo,v5=Pa,g5=m5(v5,"Map"),s1=g5,x5=uo,y5=x5(Object,"create"),Lh=y5,Zw=Lh;function _5(){this.__data__=Zw?Zw(null):{},this.size=0}var w5=_5;function b5(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var E5=b5,S5=Lh,k5="__lodash_hash_undefined__",T5=Object.prototype,C5=T5.hasOwnProperty;function N5(e){var t=this.__data__;if(S5){var r=t[e];return r===k5?void 0:r}return C5.call(t,e)?t[e]:void 0}var A5=N5,O5=Lh,D5=Object.prototype,j5=D5.hasOwnProperty;function P5(e){var t=this.__data__;return O5?t[e]!==void 0:j5.call(t,e)}var F5=P5,R5=Lh,M5="__lodash_hash_undefined__";function I5(e,t){var r=this.__data__;return this.size+=this.has(e)?0:1,r[e]=R5&&t===void 0?M5:t,this}var L5=I5,$5=w5,B5=E5,U5=A5,W5=F5,V5=L5;function Yl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Yl.prototype.clear=$5;Yl.prototype.delete=B5;Yl.prototype.get=U5;Yl.prototype.has=W5;Yl.prototype.set=V5;var H5=Yl,e2=H5,z5=Ih,Y5=s1;function G5(){this.size=0,this.__data__={hash:new e2,map:new(Y5||z5),string:new e2}}var K5=G5;function q5(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}var X5=q5,Q5=X5;function J5(e,t){var r=e.__data__;return Q5(t)?r[typeof t=="string"?"string":"hash"]:r.map}var $h=J5,Z5=$h;function e$(e){var t=Z5(this,e).delete(e);return this.size-=t?1:0,t}var t$=e$,r$=$h;function n$(e){return r$(this,e).get(e)}var a$=n$,s$=$h;function i$(e){return s$(this,e).has(e)}var o$=i$,l$=$h;function c$(e,t){var r=l$(this,e),n=r.size;return r.set(e,t),this.size+=r.size==n?0:1,this}var u$=c$,f$=K5,d$=t$,h$=a$,p$=o$,m$=u$;function Gl(e){var t=-1,r=e==null?0:e.length;for(this.clear();++t<r;){var n=e[t];this.set(n[0],n[1])}}Gl.prototype.clear=f$;Gl.prototype.delete=d$;Gl.prototype.get=h$;Gl.prototype.has=p$;Gl.prototype.set=m$;var i1=Gl,v$=Ih,g$=s1,x$=i1,y$=200;function _$(e,t){var r=this.__data__;if(r instanceof v$){var n=r.__data__;if(!g$||n.length<y$-1)return n.push([e,t]),this.size=++r.size,this;r=this.__data__=new x$(n)}return r.set(e,t),this.size=r.size,this}var w$=_$,b$=Ih,E$=ML,S$=LL,k$=BL,T$=WL,C$=w$;function Kl(e){var t=this.__data__=new b$(e);this.size=t.size}Kl.prototype.clear=E$;Kl.prototype.delete=S$;Kl.prototype.get=k$;Kl.prototype.has=T$;Kl.prototype.set=C$;var o1=Kl,N$="__lodash_hash_undefined__";function A$(e){return this.__data__.set(e,N$),this}var O$=A$;function D$(e){return this.__data__.has(e)}var j$=D$,P$=i1,F$=O$,R$=j$;function O0(e){var t=-1,r=e==null?0:e.length;for(this.__data__=new P$;++t<r;)this.add(e[t])}O0.prototype.add=O0.prototype.push=F$;O0.prototype.has=R$;var M$=O0;function I$(e,t){for(var r=-1,n=e==null?0:e.length;++r<n;)if(t(e[r],r,e))return!0;return!1}var L$=I$;function $$(e,t){return e.has(t)}var B$=$$,U$=M$,W$=L$,V$=B$,H$=1,z$=2;function Y$(e,t,r,n,a,s){var i=r&H$,o=e.length,l=t.length;if(o!=l&&!(i&&l>o))return!1;var c=s.get(e),f=s.get(t);if(c&&f)return c==t&&f==e;var d=-1,h=!0,p=r&z$?new U$:void 0;for(s.set(e,t),s.set(t,e);++d<o;){var v=e[d],m=t[d];if(n)var _=i?n(m,v,d,t,e,s):n(v,m,d,e,t,s);if(_!==void 0){if(_)continue;h=!1;break}if(p){if(!W$(t,function(g,y){if(!V$(p,y)&&(v===g||a(v,g,r,n,s)))return p.push(y)})){h=!1;break}}else if(!(v===m||a(v,m,r,n,s))){h=!1;break}}return s.delete(e),s.delete(t),h}var gC=Y$,G$=Pa,K$=G$.Uint8Array,xC=K$;function q$(e){var t=-1,r=Array(e.size);return e.forEach(function(n,a){r[++t]=[a,n]}),r}var X$=q$;function Q$(e){var t=-1,r=Array(e.size);return e.forEach(function(n){r[++t]=n}),r}var J$=Q$,t2=Vl,r2=xC,Z$=hf,e7=gC,t7=X$,r7=J$,n7=1,a7=2,s7="[object Boolean]",i7="[object Date]",o7="[object Error]",l7="[object Map]",c7="[object Number]",u7="[object RegExp]",f7="[object Set]",d7="[object String]",h7="[object Symbol]",p7="[object ArrayBuffer]",m7="[object DataView]",n2=t2?t2.prototype:void 0,dm=n2?n2.valueOf:void 0;function v7(e,t,r,n,a,s,i){switch(r){case m7:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case p7:return!(e.byteLength!=t.byteLength||!s(new r2(e),new r2(t)));case s7:case i7:case c7:return Z$(+e,+t);case o7:return e.name==t.name&&e.message==t.message;case u7:case d7:return e==t+"";case l7:var o=t7;case f7:var l=n&n7;if(o||(o=r7),e.size!=t.size&&!l)return!1;var c=i.get(e);if(c)return c==t;n|=a7,i.set(e,t);var f=e7(o(e),o(t),n,a,s,i);return i.delete(e),f;case h7:if(dm)return dm.call(e)==dm.call(t)}return!1}var g7=v7;function x7(e,t){for(var r=-1,n=t.length,a=e.length;++r<n;)e[a+r]=t[r];return e}var l1=x7,y7=Array.isArray,Fn=y7,_7=l1,w7=Fn;function b7(e,t,r){var n=t(e);return w7(e)?n:_7(n,r(e))}var yC=b7;function E7(e,t){for(var r=-1,n=e==null?0:e.length,a=0,s=[];++r<n;){var i=e[r];t(i,r,e)&&(s[a++]=i)}return s}var S7=E7;function k7(){return[]}var _C=k7,T7=S7,C7=_C,N7=Object.prototype,A7=N7.propertyIsEnumerable,a2=Object.getOwnPropertySymbols,O7=a2?function(e){return e==null?[]:(e=Object(e),T7(a2(e),function(t){return A7.call(e,t)}))}:C7,c1=O7;function D7(e,t){for(var r=-1,n=Array(e);++r<e;)n[r]=t(r);return n}var j7=D7,P7=Hl,F7=hi,R7="[object Arguments]";function M7(e){return F7(e)&&P7(e)==R7}var I7=M7,s2=I7,L7=hi,wC=Object.prototype,$7=wC.hasOwnProperty,B7=wC.propertyIsEnumerable,U7=s2(function(){return arguments}())?s2:function(e){return L7(e)&&$7.call(e,"callee")&&!B7.call(e,"callee")},u1=U7,D0={exports:{}};function W7(){return!1}var V7=W7;D0.exports;(function(e,t){var r=Pa,n=V7,a=t&&!t.nodeType&&t,s=a&&!0&&e&&!e.nodeType&&e,i=s&&s.exports===a,o=i?r.Buffer:void 0,l=o?o.isBuffer:void 0,c=l||n;e.exports=c})(D0,D0.exports);var Bh=D0.exports,H7=Hl,z7=zx,Y7=hi,G7="[object Arguments]",K7="[object Array]",q7="[object Boolean]",X7="[object Date]",Q7="[object Error]",J7="[object Function]",Z7="[object Map]",eB="[object Number]",tB="[object Object]",rB="[object RegExp]",nB="[object Set]",aB="[object String]",sB="[object WeakMap]",iB="[object ArrayBuffer]",oB="[object DataView]",lB="[object Float32Array]",cB="[object Float64Array]",uB="[object Int8Array]",fB="[object Int16Array]",dB="[object Int32Array]",hB="[object Uint8Array]",pB="[object Uint8ClampedArray]",mB="[object Uint16Array]",vB="[object Uint32Array]",lt={};lt[lB]=lt[cB]=lt[uB]=lt[fB]=lt[dB]=lt[hB]=lt[pB]=lt[mB]=lt[vB]=!0;lt[G7]=lt[K7]=lt[iB]=lt[q7]=lt[oB]=lt[X7]=lt[Q7]=lt[J7]=lt[Z7]=lt[eB]=lt[tB]=lt[rB]=lt[nB]=lt[aB]=lt[sB]=!1;function gB(e){return Y7(e)&&z7(e.length)&&!!lt[H7(e)]}var xB=gB;function yB(e){return function(t){return e(t)}}var Uh=yB,j0={exports:{}};j0.exports;(function(e,t){var r=ZT,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s&&r.process,o=function(){try{var l=a&&a.require&&a.require("util").types;return l||i&&i.binding&&i.binding("util")}catch{}}();e.exports=o})(j0,j0.exports);var f1=j0.exports,_B=xB,wB=Uh,i2=f1,o2=i2&&i2.isTypedArray,bB=o2?wB(o2):_B,d1=bB,EB=j7,SB=u1,kB=Fn,TB=Bh,CB=Yx,NB=d1,AB=Object.prototype,OB=AB.hasOwnProperty;function DB(e,t){var r=kB(e),n=!r&&SB(e),a=!r&&!n&&TB(e),s=!r&&!n&&!a&&NB(e),i=r||n||a||s,o=i?EB(e.length,String):[],l=o.length;for(var c in e)(t||OB.call(e,c))&&!(i&&(c=="length"||a&&(c=="offset"||c=="parent")||s&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||CB(c,l)))&&o.push(c);return o}var bC=DB,jB=Object.prototype;function PB(e){var t=e&&e.constructor,r=typeof t=="function"&&t.prototype||jB;return e===r}var h1=PB;function FB(e,t){return function(r){return e(t(r))}}var EC=FB,RB=EC,MB=RB(Object.keys,Object),IB=MB,LB=h1,$B=IB,BB=Object.prototype,UB=BB.hasOwnProperty;function WB(e){if(!LB(e))return $B(e);var t=[];for(var r in Object(e))UB.call(e,r)&&r!="constructor"&&t.push(r);return t}var VB=WB,HB=bC,zB=VB,YB=pf;function GB(e){return YB(e)?HB(e):zB(e)}var yf=GB,KB=yC,qB=c1,XB=yf;function QB(e){return KB(e,XB,qB)}var SC=QB,l2=SC,JB=1,ZB=Object.prototype,eU=ZB.hasOwnProperty;function tU(e,t,r,n,a,s){var i=r&JB,o=l2(e),l=o.length,c=l2(t),f=c.length;if(l!=f&&!i)return!1;for(var d=l;d--;){var h=o[d];if(!(i?h in t:eU.call(t,h)))return!1}var p=s.get(e),v=s.get(t);if(p&&v)return p==t&&v==e;var m=!0;s.set(e,t),s.set(t,e);for(var _=i;++d<l;){h=o[d];var g=e[h],y=t[h];if(n)var x=i?n(y,g,h,t,e,s):n(g,y,h,e,t,s);if(!(x===void 0?g===y||a(g,y,r,n,s):x)){m=!1;break}_||(_=h=="constructor")}if(m&&!_){var w=e.constructor,E=t.constructor;w!=E&&"constructor"in e&&"constructor"in t&&!(typeof w=="function"&&w instanceof w&&typeof E=="function"&&E instanceof E)&&(m=!1)}return s.delete(e),s.delete(t),m}var rU=tU,nU=uo,aU=Pa,sU=nU(aU,"DataView"),iU=sU,oU=uo,lU=Pa,cU=oU(lU,"Promise"),uU=cU,fU=uo,dU=Pa,hU=fU(dU,"Set"),pU=hU,mU=uo,vU=Pa,gU=mU(vU,"WeakMap"),xU=gU,Qv=iU,Jv=s1,Zv=uU,eg=pU,tg=xU,kC=Hl,ql=vC,c2="[object Map]",yU="[object Object]",u2="[object Promise]",f2="[object Set]",d2="[object WeakMap]",h2="[object DataView]",_U=ql(Qv),wU=ql(Jv),bU=ql(Zv),EU=ql(eg),SU=ql(tg),Si=kC;(Qv&&Si(new Qv(new ArrayBuffer(1)))!=h2||Jv&&Si(new Jv)!=c2||Zv&&Si(Zv.resolve())!=u2||eg&&Si(new eg)!=f2||tg&&Si(new tg)!=d2)&&(Si=function(e){var t=kC(e),r=t==yU?e.constructor:void 0,n=r?ql(r):"";if(n)switch(n){case _U:return h2;case wU:return c2;case bU:return u2;case EU:return f2;case SU:return d2}return t});var Wh=Si,hm=o1,kU=gC,TU=g7,CU=rU,p2=Wh,m2=Fn,v2=Bh,NU=d1,AU=1,g2="[object Arguments]",x2="[object Array]",ud="[object Object]",OU=Object.prototype,y2=OU.hasOwnProperty;function DU(e,t,r,n,a,s){var i=m2(e),o=m2(t),l=i?x2:p2(e),c=o?x2:p2(t);l=l==g2?ud:l,c=c==g2?ud:c;var f=l==ud,d=c==ud,h=l==c;if(h&&v2(e)){if(!v2(t))return!1;i=!0,f=!1}if(h&&!f)return s||(s=new hm),i||NU(e)?kU(e,t,r,n,a,s):TU(e,t,l,r,n,a,s);if(!(r&AU)){var p=f&&y2.call(e,"__wrapped__"),v=d&&y2.call(t,"__wrapped__");if(p||v){var m=p?e.value():e,_=v?t.value():t;return s||(s=new hm),a(m,_,r,n,s)}}return h?(s||(s=new hm),CU(e,t,r,n,a,s)):!1}var jU=DU,PU=jU,_2=hi;function TC(e,t,r,n,a){return e===t?!0:e==null||t==null||!_2(e)&&!_2(t)?e!==e&&t!==t:PU(e,t,r,n,TC,a)}var p1=TC,FU=p1;function RU(e,t){return FU(e,t)}var MU=RU;const IU=Er(MU);function pm(e,t){var r=Gx(e);return r?r.innerHeight:Ri(e).height}function CC(e,t,r){e.closest&&!r&&e.closest(t);var n=e;do{if(F8(n,t))return n;n=n.parentElement}while(n&&n!==r&&n.nodeType===document.ELEMENT_NODE);return null}function LU(e,t,r,n){for(var a=e.length,s=r+(n?1:-1);n?s--:++s<a;)if(t(e[s],s,e))return s;return-1}var $U=LU,BU=o1,UU=p1,WU=1,VU=2;function HU(e,t,r,n){var a=r.length,s=a,i=!n;if(e==null)return!s;for(e=Object(e);a--;){var o=r[a];if(i&&o[2]?o[1]!==e[o[0]]:!(o[0]in e))return!1}for(;++a<s;){o=r[a];var l=o[0],c=e[l],f=o[1];if(i&&o[2]){if(c===void 0&&!(l in e))return!1}else{var d=new BU;if(n)var h=n(c,f,l,e,t,d);if(!(h===void 0?UU(f,c,WU|VU,n,d):h))return!1}}return!0}var zU=HU,YU=gs;function GU(e){return e===e&&!YU(e)}var NC=GU,KU=NC,qU=yf;function XU(e){for(var t=qU(e),r=t.length;r--;){var n=t[r],a=e[n];t[r]=[n,a,KU(a)]}return t}var QU=XU;function JU(e,t){return function(r){return r==null?!1:r[e]===t&&(t!==void 0||e in Object(r))}}var AC=JU,ZU=zU,e9=QU,t9=AC;function r9(e){var t=e9(e);return t.length==1&&t[0][2]?t9(t[0][0],t[0][1]):function(r){return r===e||ZU(r,e,t)}}var n9=r9,a9=Fn,s9=mf,i9=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,o9=/^\w*$/;function l9(e,t){if(a9(e))return!1;var r=typeof e;return r=="number"||r=="symbol"||r=="boolean"||e==null||s9(e)?!0:o9.test(e)||!i9.test(e)||t!=null&&e in Object(t)}var m1=l9,OC=i1,c9="Expected a function";function v1(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(c9);var r=function(){var n=arguments,a=t?t.apply(this,n):n[0],s=r.cache;if(s.has(a))return s.get(a);var i=e.apply(this,n);return r.cache=s.set(a,i)||s,i};return r.cache=new(v1.Cache||OC),r}v1.Cache=OC;var u9=v1,f9=u9,d9=500;function h9(e){var t=f9(e,function(n){return r.size===d9&&r.clear(),n}),r=t.cache;return t}var p9=h9,m9=p9,v9=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,g9=/\\(\\)?/g,x9=m9(function(e){var t=[];return e.charCodeAt(0)===46&&t.push(""),e.replace(v9,function(r,n,a,s){t.push(a?s.replace(g9,"$1"):n||r)}),t}),y9=x9;function _9(e,t){for(var r=-1,n=e==null?0:e.length,a=Array(n);++r<n;)a[r]=t(e[r],r,e);return a}var g1=_9,w2=Vl,w9=g1,b9=Fn,E9=mf,b2=w2?w2.prototype:void 0,E2=b2?b2.toString:void 0;function DC(e){if(typeof e=="string")return e;if(b9(e))return w9(e,DC)+"";if(E9(e))return E2?E2.call(e):"";var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var S9=DC,k9=S9;function T9(e){return e==null?"":k9(e)}var C9=T9,N9=Fn,A9=m1,O9=y9,D9=C9;function j9(e,t){return N9(e)?e:A9(e,t)?[e]:O9(D9(e))}var Vh=j9,P9=mf;function F9(e){if(typeof e=="string"||P9(e))return e;var t=e+"";return t=="0"&&1/e==-1/0?"-0":t}var _f=F9,R9=Vh,M9=_f;function I9(e,t){t=R9(t,e);for(var r=0,n=t.length;e!=null&&r<n;)e=e[M9(t[r++])];return r&&r==n?e:void 0}var Hh=I9,L9=Hh;function $9(e,t,r){var n=e==null?void 0:L9(e,t);return n===void 0?r:n}var B9=$9;function U9(e,t){return e!=null&&t in Object(e)}var W9=U9,V9=Vh,H9=u1,z9=Fn,Y9=Yx,G9=zx,K9=_f;function q9(e,t,r){t=V9(t,e);for(var n=-1,a=t.length,s=!1;++n<a;){var i=K9(t[n]);if(!(s=e!=null&&r(e,i)))break;e=e[i]}return s||++n!=a?s:(a=e==null?0:e.length,!!a&&G9(a)&&Y9(i,a)&&(z9(e)||H9(e)))}var X9=q9,Q9=W9,J9=X9;function Z9(e,t){return e!=null&&J9(e,t,Q9)}var eW=Z9,tW=p1,rW=B9,nW=eW,aW=m1,sW=NC,iW=AC,oW=_f,lW=1,cW=2;function uW(e,t){return aW(e)&&sW(t)?iW(oW(e),t):function(r){var n=rW(r,e);return n===void 0&&n===t?nW(r,e):tW(t,n,lW|cW)}}var fW=uW;function dW(e){return e}var zh=dW;function hW(e){return function(t){return t==null?void 0:t[e]}}var pW=hW,mW=Hh;function vW(e){return function(t){return mW(t,e)}}var gW=vW,xW=pW,yW=gW,_W=m1,wW=_f;function bW(e){return _W(e)?xW(wW(e)):yW(e)}var EW=bW,SW=n9,kW=fW,TW=zh,CW=Fn,NW=EW;function AW(e){return typeof e=="function"?e:e==null?TW:typeof e=="object"?CW(e)?kW(e[0],e[1]):SW(e):NW(e)}var Yh=AW,OW=$U,DW=Yh,jW=rC,PW=Math.max;function FW(e,t,r){var n=e==null?0:e.length;if(!n)return-1;var a=r==null?0:jW(r);return a<0&&(a=PW(n+a,0)),OW(e,DW(t),a)}var RW=FW;const MW=Er(RW);var IW=Math.ceil,LW=Math.max;function $W(e,t,r,n){for(var a=-1,s=LW(IW((t-e)/(r||1)),0),i=Array(s);s--;)i[n?s:++a]=e,e+=r;return i}var BW=$W,UW=BW,WW=Fh,mm=tC;function VW(e){return function(t,r,n){return n&&typeof n!="number"&&WW(t,r,n)&&(r=n=void 0),t=mm(t),r===void 0?(r=t,t=0):r=mm(r),n=n===void 0?t<r?1:-1:mm(n),UW(t,r,n,e)}}var HW=VW,zW=HW,YW=zW(),GW=YW;const KW=Er(GW);var S2=Number.isNaN||function(t){return typeof t=="number"&&t!==t};function qW(e,t){return!!(e===t||S2(e)&&S2(t))}function XW(e,t){if(e.length!==t.length)return!1;for(var r=0;r<e.length;r++)if(!qW(e[r],t[r]))return!1;return!0}function jC(e,t){t===void 0&&(t=XW);var r=null;function n(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];if(r&&r.lastThis===this&&t(a,r.lastArgs))return r.lastResult;var i=e.apply(this,a);return r={lastResult:i,lastArgs:a,lastThis:this},i}return n.clear=function(){r=null},n}function rg(e,t){var r=Gx(e);return r?r.innerWidth:Ri(e).width}var k2=Vl,QW=u1,JW=Fn,T2=k2?k2.isConcatSpreadable:void 0;function ZW(e){return JW(e)||QW(e)||!!(T2&&e&&e[T2])}var eV=ZW,tV=l1,rV=eV;function PC(e,t,r,n,a){var s=-1,i=e.length;for(r||(r=rV),a||(a=[]);++s<i;){var o=e[s];t>0&&r(o)?t>1?PC(o,t-1,r,n,a):tV(a,o):n||(a[a.length]=o)}return a}var FC=PC;function nV(e){return function(t,r,n){for(var a=-1,s=Object(t),i=n(t),o=i.length;o--;){var l=i[e?o:++a];if(r(s[l],l,s)===!1)break}return t}}var aV=nV,sV=aV,iV=sV(),oV=iV,lV=oV,cV=yf;function uV(e,t){return e&&lV(e,t,cV)}var x1=uV,fV=pf;function dV(e,t){return function(r,n){if(r==null)return r;if(!fV(r))return e(r,n);for(var a=r.length,s=t?a:-1,i=Object(r);(t?s--:++s<a)&&n(i[s],s,i)!==!1;);return r}}var hV=dV,pV=x1,mV=hV,vV=mV(pV),gV=vV,xV=gV,yV=pf;function _V(e,t){var r=-1,n=yV(e)?Array(e.length):[];return xV(e,function(a,s,i){n[++r]=t(a,s,i)}),n}var wV=_V;function bV(e,t){var r=e.length;for(e.sort(t);r--;)e[r]=e[r].value;return e}var EV=bV,C2=mf;function SV(e,t){if(e!==t){var r=e!==void 0,n=e===null,a=e===e,s=C2(e),i=t!==void 0,o=t===null,l=t===t,c=C2(t);if(!o&&!c&&!s&&e>t||s&&i&&l&&!o&&!c||n&&i&&l||!r&&l||!a)return 1;if(!n&&!s&&!c&&e<t||c&&r&&a&&!n&&!s||o&&r&&a||!i&&a||!l)return-1}return 0}var kV=SV,TV=kV;function CV(e,t,r){for(var n=-1,a=e.criteria,s=t.criteria,i=a.length,o=r.length;++n<i;){var l=TV(a[n],s[n]);if(l){if(n>=o)return l;var c=r[n];return l*(c=="desc"?-1:1)}}return e.index-t.index}var NV=CV,vm=g1,AV=Hh,OV=Yh,DV=wV,jV=EV,PV=Uh,FV=NV,RV=zh,MV=Fn;function IV(e,t,r){t.length?t=vm(t,function(s){return MV(s)?function(i){return AV(i,s.length===1?s[0]:s)}:s}):t=[RV];var n=-1;t=vm(t,PV(OV));var a=DV(e,function(s,i,o){var l=vm(t,function(c){return c(s)});return{criteria:l,index:++n,value:s}});return jV(a,function(s,i){return FV(s,i,r)})}var LV=IV;function $V(e,t,r){switch(r.length){case 0:return e.call(t);case 1:return e.call(t,r[0]);case 2:return e.call(t,r[0],r[1]);case 3:return e.call(t,r[0],r[1],r[2])}return e.apply(t,r)}var BV=$V,UV=BV,N2=Math.max;function WV(e,t,r){return t=N2(t===void 0?e.length-1:t,0),function(){for(var n=arguments,a=-1,s=N2(n.length-t,0),i=Array(s);++a<s;)i[a]=n[t+a];a=-1;for(var o=Array(t+1);++a<t;)o[a]=n[a];return o[t]=r(i),UV(e,this,o)}}var RC=WV;function VV(e){return function(){return e}}var HV=VV,zV=uo,YV=function(){try{var e=zV(Object,"defineProperty");return e({},"",{}),e}catch{}}(),MC=YV,GV=HV,A2=MC,KV=zh,qV=A2?function(e,t){return A2(e,"toString",{configurable:!0,enumerable:!1,value:GV(t),writable:!0})}:KV,XV=qV,QV=800,JV=16,ZV=Date.now;function eH(e){var t=0,r=0;return function(){var n=ZV(),a=JV-(n-r);if(r=n,a>0){if(++t>=QV)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var tH=eH,rH=XV,nH=tH,aH=nH(rH),IC=aH,sH=zh,iH=RC,oH=IC;function lH(e,t){return oH(iH(e,t,sH),e+"")}var LC=lH,cH=FC,uH=LV,fH=LC,O2=Fh,dH=fH(function(e,t){if(e==null)return[];var r=t.length;return r>1&&O2(e,t[0],t[1])?t=[]:r>2&&O2(t[0],t[1],t[2])&&(t=[t[0]]),uH(e,cH(t,1),[])}),hH=dH;const pH=Er(hH);function $C(e){return FT(e)||QT(e)||Ux(e)||RT()}function mH(e){var t=[];if(e!=null)for(var r in Object(e))t.push(r);return t}var vH=mH,gH=gs,xH=h1,yH=vH,_H=Object.prototype,wH=_H.hasOwnProperty;function bH(e){if(!gH(e))return yH(e);var t=xH(e),r=[];for(var n in e)n=="constructor"&&(t||!wH.call(e,n))||r.push(n);return r}var EH=bH,SH=bC,kH=EH,TH=pf;function CH(e){return TH(e)?SH(e,!0):kH(e)}var Gh=CH,NH=LC,AH=hf,OH=Fh,DH=Gh,BC=Object.prototype,jH=BC.hasOwnProperty,PH=NH(function(e,t){e=Object(e);var r=-1,n=t.length,a=n>2?t[2]:void 0;for(a&&OH(t[0],t[1],a)&&(n=1);++r<n;)for(var s=t[r],i=DH(s),o=-1,l=i.length;++o<l;){var c=i[o],f=e[c];(f===void 0||AH(f,BC[c])&&!jH.call(e,c))&&(e[c]=s[c])}return e}),FH=PH;const RH=Er(FH);var D2=MC;function MH(e,t,r){t=="__proto__"&&D2?D2(e,t,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[t]=r}var y1=MH,IH=y1,LH=x1,$H=Yh;function BH(e,t){var r={};return t=$H(t),LH(e,function(n,a,s){IH(r,a,t(n,a,s))}),r}var UH=BH;const WH=Er(UH);function VH(e,t){for(var r=-1,n=e==null?0:e.length;++r<n&&t(e[r],r,e)!==!1;);return e}var UC=VH,HH=y1,zH=hf,YH=Object.prototype,GH=YH.hasOwnProperty;function KH(e,t,r){var n=e[t];(!(GH.call(e,t)&&zH(n,r))||r===void 0&&!(t in e))&&HH(e,t,r)}var WC=KH,qH=WC,XH=y1;function QH(e,t,r,n){var a=!r;r||(r={});for(var s=-1,i=t.length;++s<i;){var o=t[s],l=n?n(r[o],e[o],o,r,e):void 0;l===void 0&&(l=e[o]),a?XH(r,o,l):qH(r,o,l)}return r}var wf=QH,JH=wf,ZH=yf;function ez(e,t){return e&&JH(t,ZH(t),e)}var tz=ez,rz=wf,nz=Gh;function az(e,t){return e&&rz(t,nz(t),e)}var sz=az,P0={exports:{}};P0.exports;(function(e,t){var r=Pa,n=t&&!t.nodeType&&t,a=n&&!0&&e&&!e.nodeType&&e,s=a&&a.exports===n,i=s?r.Buffer:void 0,o=i?i.allocUnsafe:void 0;function l(c,f){if(f)return c.slice();var d=c.length,h=o?o(d):new c.constructor(d);return c.copy(h),h}e.exports=l})(P0,P0.exports);var iz=P0.exports;function oz(e,t){var r=-1,n=e.length;for(t||(t=Array(n));++r<n;)t[r]=e[r];return t}var lz=oz,cz=wf,uz=c1;function fz(e,t){return cz(e,uz(e),t)}var dz=fz,hz=EC,pz=hz(Object.getPrototypeOf,Object),Kh=pz,mz=l1,vz=Kh,gz=c1,xz=_C,yz=Object.getOwnPropertySymbols,_z=yz?function(e){for(var t=[];e;)mz(t,gz(e)),e=vz(e);return t}:xz,VC=_z,wz=wf,bz=VC;function Ez(e,t){return wz(e,bz(e),t)}var Sz=Ez,kz=yC,Tz=VC,Cz=Gh;function Nz(e){return kz(e,Cz,Tz)}var HC=Nz,Az=Object.prototype,Oz=Az.hasOwnProperty;function Dz(e){var t=e.length,r=new e.constructor(t);return t&&typeof e[0]=="string"&&Oz.call(e,"index")&&(r.index=e.index,r.input=e.input),r}var jz=Dz,j2=xC;function Pz(e){var t=new e.constructor(e.byteLength);return new j2(t).set(new j2(e)),t}var _1=Pz,Fz=_1;function Rz(e,t){var r=t?Fz(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.byteLength)}var Mz=Rz,Iz=/\w*$/;function Lz(e){var t=new e.constructor(e.source,Iz.exec(e));return t.lastIndex=e.lastIndex,t}var $z=Lz,P2=Vl,F2=P2?P2.prototype:void 0,R2=F2?F2.valueOf:void 0;function Bz(e){return R2?Object(R2.call(e)):{}}var Uz=Bz,Wz=_1;function Vz(e,t){var r=t?Wz(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}var Hz=Vz,zz=_1,Yz=Mz,Gz=$z,Kz=Uz,qz=Hz,Xz="[object Boolean]",Qz="[object Date]",Jz="[object Map]",Zz="[object Number]",eY="[object RegExp]",tY="[object Set]",rY="[object String]",nY="[object Symbol]",aY="[object ArrayBuffer]",sY="[object DataView]",iY="[object Float32Array]",oY="[object Float64Array]",lY="[object Int8Array]",cY="[object Int16Array]",uY="[object Int32Array]",fY="[object Uint8Array]",dY="[object Uint8ClampedArray]",hY="[object Uint16Array]",pY="[object Uint32Array]";function mY(e,t,r){var n=e.constructor;switch(t){case aY:return zz(e);case Xz:case Qz:return new n(+e);case sY:return Yz(e,r);case iY:case oY:case lY:case cY:case uY:case fY:case dY:case hY:case pY:return qz(e,r);case Jz:return new n;case Zz:case rY:return new n(e);case eY:return Gz(e);case tY:return new n;case nY:return Kz(e)}}var vY=mY,gY=gs,M2=Object.create,xY=function(){function e(){}return function(t){if(!gY(t))return{};if(M2)return M2(t);e.prototype=t;var r=new e;return e.prototype=void 0,r}}(),zC=xY,yY=zC,_Y=Kh,wY=h1;function bY(e){return typeof e.constructor=="function"&&!wY(e)?yY(_Y(e)):{}}var EY=bY,SY=Wh,kY=hi,TY="[object Map]";function CY(e){return kY(e)&&SY(e)==TY}var NY=CY,AY=NY,OY=Uh,I2=f1,L2=I2&&I2.isMap,DY=L2?OY(L2):AY,jY=DY,PY=Wh,FY=hi,RY="[object Set]";function MY(e){return FY(e)&&PY(e)==RY}var IY=MY,LY=IY,$Y=Uh,$2=f1,B2=$2&&$2.isSet,BY=B2?$Y(B2):LY,UY=BY,WY=o1,VY=UC,HY=WC,zY=tz,YY=sz,GY=iz,KY=lz,qY=dz,XY=Sz,QY=SC,JY=HC,ZY=Wh,eG=jz,tG=vY,rG=EY,nG=Fn,aG=Bh,sG=jY,iG=gs,oG=UY,lG=yf,cG=Gh,uG=1,fG=2,dG=4,YC="[object Arguments]",hG="[object Array]",pG="[object Boolean]",mG="[object Date]",vG="[object Error]",GC="[object Function]",gG="[object GeneratorFunction]",xG="[object Map]",yG="[object Number]",KC="[object Object]",_G="[object RegExp]",wG="[object Set]",bG="[object String]",EG="[object Symbol]",SG="[object WeakMap]",kG="[object ArrayBuffer]",TG="[object DataView]",CG="[object Float32Array]",NG="[object Float64Array]",AG="[object Int8Array]",OG="[object Int16Array]",DG="[object Int32Array]",jG="[object Uint8Array]",PG="[object Uint8ClampedArray]",FG="[object Uint16Array]",RG="[object Uint32Array]",nt={};nt[YC]=nt[hG]=nt[kG]=nt[TG]=nt[pG]=nt[mG]=nt[CG]=nt[NG]=nt[AG]=nt[OG]=nt[DG]=nt[xG]=nt[yG]=nt[KC]=nt[_G]=nt[wG]=nt[bG]=nt[EG]=nt[jG]=nt[PG]=nt[FG]=nt[RG]=!0;nt[vG]=nt[GC]=nt[SG]=!1;function Ud(e,t,r,n,a,s){var i,o=t&uG,l=t&fG,c=t&dG;if(r&&(i=a?r(e,n,a,s):r(e)),i!==void 0)return i;if(!iG(e))return e;var f=nG(e);if(f){if(i=eG(e),!o)return KY(e,i)}else{var d=ZY(e),h=d==GC||d==gG;if(aG(e))return GY(e,o);if(d==KC||d==YC||h&&!a){if(i=l||h?{}:rG(e),!o)return l?XY(e,YY(i,e)):qY(e,zY(i,e))}else{if(!nt[d])return a?e:{};i=tG(e,d,o)}}s||(s=new WY);var p=s.get(e);if(p)return p;s.set(e,i),oG(e)?e.forEach(function(_){i.add(Ud(_,t,r,_,e,s))}):sG(e)&&e.forEach(function(_,g){i.set(g,Ud(_,t,r,g,e,s))});var v=c?l?JY:QY:l?cG:lG,m=f?void 0:v(e);return VY(m||e,function(_,g){m&&(g=_,_=e[g]),HY(i,g,Ud(_,t,r,g,e,s))}),i}var MG=Ud;function IG(e){var t=e==null?0:e.length;return t?e[t-1]:void 0}var LG=IG,$G=Hh,BG=JT;function UG(e,t){return t.length<2?e:$G(e,BG(t,0,-1))}var WG=UG,VG=Vh,HG=LG,zG=WG,YG=_f;function GG(e,t){return t=VG(t,e),e=zG(e,t),e==null||delete e[YG(HG(t))]}var KG=GG,qG=Hl,XG=Kh,QG=hi,JG="[object Object]",ZG=Function.prototype,eK=Object.prototype,qC=ZG.toString,tK=eK.hasOwnProperty,rK=qC.call(Object);function nK(e){if(!QG(e)||qG(e)!=JG)return!1;var t=XG(e);if(t===null)return!0;var r=tK.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r instanceof r&&qC.call(r)==rK}var aK=nK,sK=aK;function iK(e){return sK(e)?void 0:e}var oK=iK,lK=FC;function cK(e){var t=e==null?0:e.length;return t?lK(e,1):[]}var uK=cK,fK=uK,dK=RC,hK=IC;function pK(e){return hK(dK(e,void 0,fK),e+"")}var mK=pK,vK=g1,gK=MG,xK=KG,yK=Vh,_K=wf,wK=oK,bK=mK,EK=HC,SK=1,kK=2,TK=4,CK=bK(function(e,t){var r={};if(e==null)return r;var n=!1;t=vK(t,function(s){return s=yK(s,e),n||(n=s.length>1),s}),_K(e,EK(e),r),n&&(r=gK(r,SK|kK|TK,wK));for(var a=t.length;a--;)xK(r,t[a]);return r}),NK=CK;const AK=Er(NK);var OK=UC,DK=zC,jK=x1,PK=Yh,FK=Kh,RK=Fn,MK=Bh,IK=Hx,LK=gs,$K=d1;function BK(e,t,r){var n=RK(e),a=n||MK(e)||$K(e);if(t=PK(t),r==null){var s=e&&e.constructor;a?r=n?new s:[]:LK(e)?r=IK(s)?DK(FK(e)):{}:r={}}return(a?OK:jK)(e,function(i,o,l){return t(r,i,o,l)}),r}var UK=BK;const WK=Er(UK);var VK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){n.prototype.isBetween=function(s,i,o,l){var c=a(s),f=a(i),d=(l=l||"()")[0]==="(",h=l[1]===")";return(d?this.isAfter(c,o):!this.isBefore(c,o))&&(h?this.isBefore(f,o):!this.isAfter(f,o))||(d?this.isBefore(c,o):!this.isAfter(c,o))&&(h?this.isAfter(f,o):!this.isBefore(f,o))}}})})(VK);var HK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrAfter=function(a,s){return this.isSame(a,s)||this.isAfter(a,s)}}})})(HK);var zK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n){n.prototype.isSameOrBefore=function(a,s){return this.isSame(a,s)||this.isBefore(a,s)}}})})(zK);var YK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=n.prototype,i=function(d){return d&&(d.indexOf?d:d.s)},o=function(d,h,p,v,m){var _=d.name?d:d.$locale(),g=i(_[h]),y=i(_[p]),x=g||y.map(function(E){return E.slice(0,v)});if(!m)return x;var w=_.weekStart;return x.map(function(E,S){return x[(S+(w||0))%7]})},l=function(){return a.Ls[a.locale()]},c=function(d,h){return d.formats[h]||function(p){return p.replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(v,m,_){return m||_.slice(1)})}(d.formats[h.toUpperCase()])},f=function(){var d=this;return{months:function(h){return h?h.format("MMMM"):o(d,"months")},monthsShort:function(h){return h?h.format("MMM"):o(d,"monthsShort","months",3)},firstDayOfWeek:function(){return d.$locale().weekStart||0},weekdays:function(h){return h?h.format("dddd"):o(d,"weekdays")},weekdaysMin:function(h){return h?h.format("dd"):o(d,"weekdaysMin","weekdays",2)},weekdaysShort:function(h){return h?h.format("ddd"):o(d,"weekdaysShort","weekdays",3)},longDateFormat:function(h){return c(d.$locale(),h)},meridiem:this.$locale().meridiem,ordinal:this.$locale().ordinal}};s.localeData=function(){return f.bind(this)()},a.localeData=function(){var d=l();return{firstDayOfWeek:function(){return d.weekStart||0},weekdays:function(){return a.weekdays()},weekdaysShort:function(){return a.weekdaysShort()},weekdaysMin:function(){return a.weekdaysMin()},months:function(){return a.months()},monthsShort:function(){return a.monthsShort()},longDateFormat:function(h){return c(d,h)},meridiem:d.meridiem,ordinal:d.ordinal}},a.months=function(){return o(l(),"months")},a.monthsShort=function(){return o(l(),"monthsShort","months",3)},a.weekdays=function(d){return o(l(),"weekdays",null,null,d)},a.weekdaysShort=function(d){return o(l(),"weekdaysShort","weekdays",3,d)},a.weekdaysMin=function(d){return o(l(),"weekdaysMin","weekdays",2,d)}}})})(YK);var GK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};return function(n,a,s){var i=a.prototype,o=i.format;s.en.formats=r,i.format=function(l){l===void 0&&(l="YYYY-MM-DDTHH:mm:ssZ");var c=this.$locale().formats,f=function(d,h){return d.replace(/(\[[^\]]+])|(LTS?|l{1,4}|L{1,4})/g,function(p,v,m){var _=m&&m.toUpperCase();return v||h[m]||r[m]||h[_].replace(/(\[[^\]]+])|(MMMM|MM|DD|dddd)/g,function(g,y,x){return y||x.slice(1)})})}(l,c===void 0?{}:c);return o.call(this,f)}}})})(GK);var KK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){return function(r,n,a){var s=function(i,o){if(!o||!o.length||o.length===1&&!o[0]||o.length===1&&Array.isArray(o[0])&&!o[0].length)return null;var l;o.length===1&&o[0].length>0&&(o=o[0]),l=(o=o.filter(function(f){return f}))[0];for(var c=1;c<o.length;c+=1)o[c].isValid()&&!o[c][i](l)||(l=o[c]);return l};a.max=function(){var i=[].slice.call(arguments,0);return s("isAfter",i)},a.min=function(){var i=[].slice.call(arguments,0);return s("isBefore",i)}}})})(KK);var qK={exports:{}};(function(e,t){(function(r,n){e.exports=n()})(wt,function(){var r="minute",n=/[+-]\d\d(?::?\d\d)?/g,a=/([+-]|\d\d)/g;return function(s,i,o){var l=i.prototype;o.utc=function(m){var _={date:m,utc:!0,args:arguments};return new i(_)},l.utc=function(m){var _=o(this.toDate(),{locale:this.$L,utc:!0});return m?_.add(this.utcOffset(),r):_},l.local=function(){return o(this.toDate(),{locale:this.$L,utc:!1})};var c=l.parse;l.parse=function(m){m.utc&&(this.$u=!0),this.$utils().u(m.$offset)||(this.$offset=m.$offset),c.call(this,m)};var f=l.init;l.init=function(){if(this.$u){var m=this.$d;this.$y=m.getUTCFullYear(),this.$M=m.getUTCMonth(),this.$D=m.getUTCDate(),this.$W=m.getUTCDay(),this.$H=m.getUTCHours(),this.$m=m.getUTCMinutes(),this.$s=m.getUTCSeconds(),this.$ms=m.getUTCMilliseconds()}else f.call(this)};var d=l.utcOffset;l.utcOffset=function(m,_){var g=this.$utils().u;if(g(m))return this.$u?0:g(this.$offset)?d.call(this):this.$offset;if(typeof m=="string"&&(m=function(E){E===void 0&&(E="");var S=E.match(n);if(!S)return null;var b=(""+S[0]).match(a)||["-",0,0],j=b[0],k=60*+b[1]+ +b[2];return k===0?0:j==="+"?k:-k}(m),m===null))return this;var y=Math.abs(m)<=16?60*m:m,x=this;if(_)return x.$offset=y,x.$u=m===0,x;if(m!==0){var w=this.$u?this.toDate().getTimezoneOffset():-1*this.utcOffset();(x=this.local().add(y+w,r)).$offset=y,x.$x.$localOffset=w}else x=this.utc();return x};var h=l.format;l.format=function(m){var _=m||(this.$u?"YYYY-MM-DDTHH:mm:ss[Z]":"");return h.call(this,_)},l.valueOf=function(){var m=this.$utils().u(this.$offset)?0:this.$offset+(this.$x.$localOffset||this.$d.getTimezoneOffset());return this.$d.valueOf()-6e4*m},l.isUTC=function(){return!!this.$u},l.toISOString=function(){return this.toDate().toISOString()},l.toString=function(){return this.toDate().toUTCString()};var p=l.toDate;l.toDate=function(m){return m==="s"&&this.$offset?o(this.format("YYYY-MM-DD HH:mm:ss:SSS")).toDate():p.call(this)};var v=l.diff;l.diff=function(m,_,g){if(m&&this.$u===m.$u)return v.call(this,m,_,g);var y=this.local(),x=o(m).local();return v.call(y,x,_,g)}}})})(qK);function Va(e){return e.children}var qr={PREVIOUS:"PREV",NEXT:"NEXT",TODAY:"TODAY",DATE:"DATE"},Pt={MONTH:"month",WEEK:"week",WORK_WEEK:"work_week",DAY:"day",AGENDA:"agenda"},U2=Object.keys(Pt).map(function(e){return Pt[e]});ue.oneOfType([ue.string,ue.func]);ue.any;ue.func;ue.oneOfType([ue.arrayOf(ue.oneOf(U2)),ue.objectOf(function(e,t){var r=U2.indexOf(t)!==-1&&typeof e[t]=="boolean";if(r)return null;for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];return ue.elementType.apply(ue,[e,t].concat(a))})]);ue.oneOfType([ue.oneOf(["overlap","no-overlap"]),ue.func]);var W2={seconds:1e3,minutes:1e3*60,hours:1e3*60*60,day:1e3*60*60*24};function XC(e,t){var r=cr(e,"month");return cr(r,"week",t.startOfWeek())}function QC(e,t){var r=C0(e,"month");return C0(r,"week",t.startOfWeek())}function XK(e,t){for(var r=XC(e,t),n=QC(e,t),a=[];Ul(r,n,"day");)a.push(r),r=aa(r,1,"day");return a}function QK(e,t){var r=cr(e,t);return ff(r,e)?r:aa(r,1,t)}function JK(e,t){for(var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",n=e,a=[];Ul(n,t,r);)a.push(n),n=aa(n,1,r);return a}function ZK(e,t){return t==null&&e==null?null:(t==null&&(t=new Date),e==null&&(e=new Date),e=cr(e,"day"),e=Ru(e,Ru(t)),e=bl(e,bl(t)),e=Fu(e,Fu(t)),Pu(e,Pu(t)))}function V2(e){return Ru(e)===0&&bl(e)===0&&Fu(e)===0&&Pu(e)===0}function eq(e,t,r,n){return r==="day"&&(r="date"),Math.abs(Tw[r](e,void 0,n)-Tw[r](t,void 0,n))}function w1(e,t,r){return!r||r==="milliseconds"?Math.abs(+e-+t):Math.round(Math.abs(+cr(e,r)/W2[r]-+cr(t,r)/W2[r]))}var tq=ue.oneOfType([ue.string,ue.func]);function rq(e,t,r,n,a){var s=typeof n=="function"?n(r,a,e):t.call(e,r,n,a);return Cu(s==null||typeof s=="string","`localizer format(..)` must return a string, null, or undefined"),s}function nq(e,t,r){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),0,t+r,0,0)}function b1(e,t){return e.getTimezoneOffset()-t.getTimezoneOffset()}function aq(e,t){return w1(e,t,"minutes")+b1(e,t)}function sq(e){var t=cr(e,"day");return w1(t,e,"minutes")+b1(t,e)}function iq(e,t){return Vx(e,t,"day")}function oq(e,t,r){var n=ff(e,t,"minutes");return n?df(t,r,"minutes"):Ph(t,r,"minutes")}function ng(e,t){return eq(e,t,"day")}function lq(e){var t=e.evtA,r=t.start,n=t.end,a=t.allDay,s=e.evtB,i=s.start,o=s.end,l=s.allDay,c=+cr(r,"day")-+cr(i,"day"),f=ng(r,n),d=ng(i,o);return c||d-f||!!l-!!a||+r-+i||+n-+o}function cq(e){var t=e.event,r=t.start,n=t.end,a=e.range,s=a.start,i=a.end,o=cr(r,"day"),l=Ul(o,i,"day"),c=Wx(o,n,"minutes"),f=c?Ph(n,s,"minutes"):df(n,s,"minutes");return l&&f}function uq(e,t){return ff(e,t,"day")}function fq(e,t){return V2(e)&&V2(t)}var dq=Kt(function e(t){var r=this;Gt(this,e),Cu(typeof t.format=="function","date localizer `format(..)` must be a function"),Cu(typeof t.firstOfWeek=="function","date localizer `firstOfWeek(..)` must be a function"),this.propType=t.propType||tq,this.formats=t.formats,this.format=function(){for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return rq.apply(void 0,[r,t.format].concat(a))},this.startOfWeek=t.firstOfWeek,this.merge=t.merge||ZK,this.inRange=t.inRange||GT,this.lt=t.lt||Vx,this.lte=t.lte||Ul,this.gt=t.gt||Ph,this.gte=t.gte||df,this.eq=t.eq||ff,this.neq=t.neq||Wx,this.startOf=t.startOf||cr,this.endOf=t.endOf||C0,this.add=t.add||aa,this.range=t.range||JK,this.diff=t.diff||w1,this.ceil=t.ceil||QK,this.min=t.min||zT,this.max=t.max||YT,this.minutes=t.minutes||bl,this.daySpan=t.daySpan||ng,this.firstVisibleDay=t.firstVisibleDay||XC,this.lastVisibleDay=t.lastVisibleDay||QC,this.visibleDays=t.visibleDays||XK,this.getSlotDate=t.getSlotDate||nq,this.getTimezoneOffset=t.getTimezoneOffset||function(n){return n.getTimezoneOffset()},this.getDstOffset=t.getDstOffset||b1,this.getTotalMin=t.getTotalMin||aq,this.getMinutesFromMidnight=t.getMinutesFromMidnight||sq,this.continuesPrior=t.continuesPrior||iq,this.continuesAfter=t.continuesAfter||oq,this.sortEvents=t.sortEvents||lq,this.inEventRange=t.inEventRange||cq,this.isSameDate=t.isSameDate||uq,this.startAndEndAreDateOnly=t.startAndEndAreDateOnly||fq,this.segmentOffset=t.browserTZOffset?t.browserTZOffset():0});function hq(e,t,r,n){var a=tt(tt({},e.formats),r);return tt(tt({},e),{},{messages:n,startOfWeek:function(){return e.startOfWeek(t)},format:function(i,o){return e.format(i,a[o]||o,t)}})}var pq=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.navigate=function(i){r.props.onNavigate(i)},r.view=function(i){r.props.onView(i)},r}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.localizer.messages,s=n.label;return Z.createElement("div",{className:"rbc-toolbar"},Z.createElement("span",{className:"rbc-btn-group"},Z.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.TODAY)},a.today),Z.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.PREVIOUS)},a.previous),Z.createElement("button",{type:"button",onClick:this.navigate.bind(null,qr.NEXT)},a.next)),Z.createElement("span",{className:"rbc-toolbar-label"},s),Z.createElement("span",{className:"rbc-btn-group"},this.viewNamesGroup(a)))}},{key:"viewNamesGroup",value:function(n){var a=this,s=this.props.views,i=this.props.view;if(s.length>1)return s.map(function(o){return Z.createElement("button",{type:"button",key:o,className:Ct({"rbc-active":i===o}),onClick:a.view.bind(null,o)},n[o])})}}])}(Z.Component);function ct(e,t){e&&e.apply(null,[].concat(t))}var mq={date:"Date",time:"Time",event:"Event",allDay:"All Day",week:"Week",work_week:"Work Week",day:"Day",month:"Month",previous:"Back",next:"Next",yesterday:"Yesterday",tomorrow:"Tomorrow",today:"Today",agenda:"Agenda",noEventsInRange:"There are no events in this range.",showMore:function(t){return"+".concat(t," more")}};function vq(e){return tt(tt({},mq),e)}function gq(e){var t=e.ref,r=e.callback;O.useEffect(function(){var n=function(s){t.current&&!t.current.contains(s.target)&&r()};return document.addEventListener("mousedown",n),function(){document.removeEventListener("mousedown",n)}},[t,r])}var xq=["style","className","event","selected","isAllDay","onSelect","onDoubleClick","onKeyPress","localizer","continuesPrior","continuesAfter","accessors","getters","children","components","slotStart","slotEnd"],JC=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.style,s=n.className,i=n.event,o=n.selected,l=n.isAllDay,c=n.onSelect,f=n.onDoubleClick,d=n.onKeyPress,h=n.localizer,p=n.continuesPrior,v=n.continuesAfter,m=n.accessors,_=n.getters,g=n.children,y=n.components,x=y.event,w=y.eventWrapper,E=n.slotStart,S=n.slotEnd,b=Aa(n,xq);delete b.resizable;var j=m.title(i),k=m.tooltip(i),C=m.end(i),P=m.start(i),I=m.allDay(i),D=l||I||h.diff(P,h.ceil(C,"day"),"day")>1,K=_.eventProp(i,P,C,o),Q=Z.createElement("div",{className:"rbc-event-content",title:k||void 0},x?Z.createElement(x,{event:i,continuesPrior:p,continuesAfter:v,title:j,isAllDay:I,localizer:h,slotStart:E,slotEnd:S}):j);return Z.createElement(w,Object.assign({},this.props,{type:"date"}),Z.createElement("div",Object.assign({},b,{style:tt(tt({},K.style),a),className:Ct("rbc-event",s,K.className,{"rbc-selected":o,"rbc-event-allday":D,"rbc-event-continues-prior":p,"rbc-event-continues-after":v}),onClick:function(q){return c&&c(i,q)},onDoubleClick:function(q){return f&&f(i,q)},onKeyDown:function(q){return d&&d(i,q)}}),typeof g=="function"?g(Q):Q))}}])}(Z.Component);function qh(e,t){return!e||t==null?!1:IU(e,t)}function ZC(e,t){var r=e.right-e.left,n=r/t;return n}function eN(e,t,r,n){var a=ZC(e,n);return r?n-1-Math.floor((t-e.left)/a):Math.floor((t-e.left)/a)}function yq(e,t){var r=t.x,n=t.y;return n>=e.top&&n<=e.bottom&&r>=e.left&&r<=e.right}function _q(e,t,r,n,a){var s=-1,i=-1,o=n-1,l=ZC(t,n),c=eN(t,r.x,a,n),f=t.top<r.y&&t.bottom>r.y,d=t.top<e.y&&t.bottom>e.y,h=e.y>t.bottom,p=t.top>e.y,v=r.top<t.top&&r.bottom>t.bottom;return v&&(s=0,i=o),f&&(p?(s=0,i=c):h&&(s=c,i=o)),d&&(s=i=a?o-Math.floor((e.x-t.left)/l):Math.floor((e.x-t.left)/l),f?c<s?s=c:i=c:e.y<r.y?i=o:s=0),{startIdx:s,endIdx:i}}function wq(e){var t=e.target,r=e.offset,n=e.container,a=e.box,s=Ri(t),i=s.top,o=s.left,l=s.width,c=s.height,f=Ri(n),d=f.top,h=f.left,p=f.width,v=f.height,m=Ri(a),_=m.width,g=m.height,y=d+v,x=h+p,w=i+g,E=o+_,S=r.x,b=r.y,j=w>y?i-g-b:i+b+c,k=E>x?o+S-_+l:o+S;return{topOffset:j,leftOffset:k}}function bq(e){var t=e.containerRef,r=e.accessors,n=e.getters,a=e.selected,s=e.components,i=e.localizer,o=e.position,l=e.show,c=e.events,f=e.slotStart,d=e.slotEnd,h=e.onSelect,p=e.onDoubleClick,v=e.onKeyPress,m=e.handleDragStart,_=e.popperRef,g=e.target,y=e.offset;gq({ref:_,callback:l}),O.useLayoutEffect(function(){var E=wq({target:g,offset:y,container:t.current,box:_.current}),S=E.topOffset,b=E.leftOffset;_.current.style.top="".concat(S,"px"),_.current.style.left="".concat(b,"px")},[y.x,y.y,g]);var x=o.width,w={minWidth:x+x/2};return Z.createElement("div",{style:w,className:"rbc-overlay",ref:_},Z.createElement("div",{className:"rbc-overlay-header"},i.format(f,"dayHeaderFormat")),c.map(function(E,S){return Z.createElement(JC,{key:S,type:"popup",localizer:i,event:E,getters:n,onSelect:h,accessors:r,components:s,onDoubleClick:p,onKeyPress:v,continuesPrior:i.lt(r.end(E),f,"day"),continuesAfter:i.gte(r.start(E),d,"day"),slotStart:f,slotEnd:d,selected:qh(E,a),draggable:!0,onDragStart:function(){return m(E)},onDragEnd:function(){return l()}})}))}var tN=Z.forwardRef(function(e,t){return Z.createElement(bq,Object.assign({},e,{popperRef:t}))});tN.propTypes={accessors:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,components:ue.object.isRequired,localizer:ue.object.isRequired,position:ue.object.isRequired,show:ue.func.isRequired,events:ue.array.isRequired,slotStart:ue.instanceOf(Date).isRequired,slotEnd:ue.instanceOf(Date),onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func,handleDragStart:ue.func,style:ue.object,offset:ue.shape({x:ue.number,y:ue.number})};function Eq(e){var t=e.containerRef,r=e.popupOffset,n=r===void 0?5:r,a=e.overlay,s=e.accessors,i=e.localizer,o=e.components,l=e.getters,c=e.selected,f=e.handleSelectEvent,d=e.handleDoubleClickEvent,h=e.handleKeyPressEvent,p=e.handleDragStart,v=e.onHide,m=e.overlayDisplay,_=O.useRef(null);if(!a.position)return null;var g=n;isNaN(n)||(g={x:n,y:n});var y=a.position,x=a.events,w=a.date,E=a.end;return Z.createElement(a1,{rootClose:!0,flip:!0,show:!0,placement:"bottom",onHide:v,target:a.target},function(S){var b=S.props;return Z.createElement(tN,Object.assign({},b,{containerRef:t,ref:_,target:a.target,offset:g,accessors:s,getters:l,selected:c,components:o,localizer:i,position:y,show:m,events:x,slotStart:w,slotEnd:E,onSelect:f,onDoubleClick:d,onKeyPress:h,handleDragStart:p}))})}var E1=Z.forwardRef(function(e,t){return Z.createElement(Eq,Object.assign({},e,{containerRef:t}))});E1.propTypes={popupOffset:ue.oneOfType([ue.number,ue.shape({x:ue.number,y:ue.number})]),overlay:ue.shape({position:ue.object,events:ue.array,date:ue.instanceOf(Date),end:ue.instanceOf(Date)}),accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,selected:ue.object,handleSelectEvent:ue.func,handleDoubleClickEvent:ue.func,handleKeyPressEvent:ue.func,handleDragStart:ue.func,onHide:ue.func,overlayDisplay:ue.func};function hr(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document;return Ac(r,e,t,{passive:!1})}function Sq(e,t,r){return!e||Mu(e,document.elementFromPoint(t,r))}function kq(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return CC(a,".rbc-event",e)}function Tq(e,t){var r=t.clientX,n=t.clientY,a=document.elementFromPoint(r,n);return CC(a,".rbc-show-more",e)}function F0(e,t){return!!kq(e,t)}function Cq(e,t){return!!Tq(e,t)}function _c(e){var t=e;return e.touches&&e.touches.length&&(t=e.touches[0]),{clientX:t.clientX,clientY:t.clientY,pageX:t.pageX,pageY:t.pageY}}var H2=5,Nq=250,rN=function(){function e(t){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=r.global,a=n===void 0?!1:n,s=r.longPressThreshold,i=s===void 0?250:s,o=r.validContainers,l=o===void 0?[]:o;Gt(this,e),this._initialEvent=null,this.selecting=!1,this.isDetached=!1,this.container=t,this.globalMouse=!t||a,this.longPressThreshold=i,this.validContainers=l,this._listeners=Object.create(null),this._handleInitialEvent=this._handleInitialEvent.bind(this),this._handleMoveEvent=this._handleMoveEvent.bind(this),this._handleTerminatingEvent=this._handleTerminatingEvent.bind(this),this._keyListener=this._keyListener.bind(this),this._dropFromOutsideListener=this._dropFromOutsideListener.bind(this),this._dragOverFromOutsideListener=this._dragOverFromOutsideListener.bind(this),this._removeTouchMoveWindowListener=hr("touchmove",function(){},window),this._removeKeyDownListener=hr("keydown",this._keyListener),this._removeKeyUpListener=hr("keyup",this._keyListener),this._removeDropFromOutsideListener=hr("drop",this._dropFromOutsideListener),this._removeDragOverFromOutsideListener=hr("dragover",this._dragOverFromOutsideListener),this._addInitialEventListener()}return Kt(e,[{key:"on",value:function(r,n){var a=this._listeners[r]||(this._listeners[r]=[]);return a.push(n),{remove:function(){var i=a.indexOf(n);i!==-1&&a.splice(i,1)}}}},{key:"emit",value:function(r){for(var n=arguments.length,a=new Array(n>1?n-1:0),s=1;s<n;s++)a[s-1]=arguments[s];var i,o=this._listeners[r]||[];return o.forEach(function(l){i===void 0&&(i=l.apply(void 0,a))}),i}},{key:"teardown",value:function(){this._initialEvent=null,this._initialEventData=null,this._selectRect=null,this.selecting=!1,this._lastClickData=null,this.isDetached=!0,this._listeners=Object.create(null),this._removeTouchMoveWindowListener&&this._removeTouchMoveWindowListener(),this._removeInitialEventListener&&this._removeInitialEventListener(),this._removeEndListener&&this._removeEndListener(),this._onEscListener&&this._onEscListener(),this._removeMoveListener&&this._removeMoveListener(),this._removeKeyUpListener&&this._removeKeyUpListener(),this._removeKeyDownListener&&this._removeKeyDownListener(),this._removeDropFromOutsideListener&&this._removeDropFromOutsideListener(),this._removeDragOverFromOutsideListener&&this._removeDragOverFromOutsideListener()}},{key:"isSelected",value:function(r){var n=this._selectRect;return!n||!this.selecting?!1:z2(n,Zi(r))}},{key:"filter",value:function(r){var n=this._selectRect;return!n||!this.selecting?[]:r.filter(this.isSelected,this)}},{key:"_addLongPressListener",value:function(r,n){var a=this,s=null,i=null,o=null,l=function(h){s=setTimeout(function(){f(),r(h)},a.longPressThreshold),i=hr("touchmove",function(){return f()}),o=hr("touchend",function(){return f()})},c=hr("touchstart",l),f=function(){s&&clearTimeout(s),i&&i(),o&&o(),s=null,i=null,o=null};return n&&l(n),function(){f(),c()}}},{key:"_addInitialEventListener",value:function(){var r=this,n=hr("mousedown",function(s){r._removeInitialEventListener(),r._handleInitialEvent(s),r._removeInitialEventListener=hr("mousedown",r._handleInitialEvent)}),a=hr("touchstart",function(s){r._removeInitialEventListener(),r._removeInitialEventListener=r._addLongPressListener(r._handleInitialEvent,s)});this._removeInitialEventListener=function(){n(),a()}}},{key:"_dropFromOutsideListener",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dropFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_dragOverFromOutsideListener",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY;this.emit("dragOverFromOutside",{x:a,y:s,clientX:i,clientY:o}),r.preventDefault()}},{key:"_handleInitialEvent",value:function(r){if(this._initialEvent=r,!this.isDetached){var n=_c(r),a=n.clientX,s=n.clientY,i=n.pageX,o=n.pageY,l=this.container(),c,f;if(!(r.which===3||r.button===2||!Sq(l,a,s))){if(!this.globalMouse&&l&&!Mu(l,r.target)){var d=Aq(0),h=d.top,p=d.left,v=d.bottom,m=d.right;if(f=Zi(l),c=z2({top:f.top-h,left:f.left-p,bottom:f.bottom+v,right:f.right+m},{top:o,left:i}),!c)return}var _=this.emit("beforeSelect",this._initialEventData={isTouch:/^touch/.test(r.type),x:i,y:o,clientX:a,clientY:s});if(_!==!1)switch(r.type){case"mousedown":this._removeEndListener=hr("mouseup",this._handleTerminatingEvent),this._onEscListener=hr("keydown",this._handleTerminatingEvent),this._removeMoveListener=hr("mousemove",this._handleMoveEvent);break;case"touchstart":this._handleMoveEvent(r),this._removeEndListener=hr("touchend",this._handleTerminatingEvent),this._removeMoveListener=hr("touchmove",this._handleMoveEvent);break}}}}},{key:"_isWithinValidContainer",value:function(r){var n=r.target,a=this.validContainers;return!a||!a.length||!n?!0:a.some(function(s){return!!n.closest(s)})}},{key:"_handleTerminatingEvent",value:function(r){var n=this.selecting,a=this._selectRect;if(!n&&r.type.includes("key")&&(r=this._initialEvent),this.selecting=!1,this._removeEndListener&&this._removeEndListener(),this._removeMoveListener&&this._removeMoveListener(),this._selectRect=null,this._initialEvent=null,this._initialEventData=null,!!r){var s=!this.container||Mu(this.container(),r.target),i=this._isWithinValidContainer(r);return r.key==="Escape"||!i?this.emit("reset"):!n&&s?this._handleClickEvent(r):n?this.emit("select",a):this.emit("reset")}}},{key:"_handleClickEvent",value:function(r){var n=_c(r),a=n.pageX,s=n.pageY,i=n.clientX,o=n.clientY,l=new Date().getTime();return this._lastClickData&&l-this._lastClickData.timestamp<Nq?(this._lastClickData=null,this.emit("doubleClick",{x:a,y:s,clientX:i,clientY:o})):(this._lastClickData={timestamp:l},this.emit("click",{x:a,y:s,clientX:i,clientY:o}))}},{key:"_handleMoveEvent",value:function(r){if(!(this._initialEventData===null||this.isDetached)){var n=this._initialEventData,a=n.x,s=n.y,i=_c(r),o=i.pageX,l=i.pageY,c=Math.abs(a-o),f=Math.abs(s-l),d=Math.min(o,a),h=Math.min(l,s),p=this.selecting,v=this.isClick(o,l);v&&!p&&!(c||f)||(!p&&!v&&this.emit("selectStart",this._initialEventData),v||(this.selecting=!0,this._selectRect={top:h,left:d,x:o,y:l,right:d+c,bottom:h+f},this.emit("selecting",this._selectRect)),r.preventDefault())}}},{key:"_keyListener",value:function(r){this.ctrl=r.metaKey||r.ctrlKey}},{key:"isClick",value:function(r,n){var a=this._initialEventData,s=a.x,i=a.y,o=a.isTouch;return!o&&Math.abs(r-s)<=H2&&Math.abs(n-i)<=H2}}])}();function Aq(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return fs(e)!=="object"&&(e={top:e,left:e,right:e,bottom:e}),e}function z2(e,t){var r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,n=Zi(e),a=n.top,s=n.left,i=n.right,o=i===void 0?s:i,l=n.bottom,c=l===void 0?a:l,f=Zi(t),d=f.top,h=f.left,p=f.right,v=p===void 0?h:p,m=f.bottom,_=m===void 0?d:m;return!(c-r<d||a+r>_||o-r<h||s+r>v)}function Zi(e){if(!e.getBoundingClientRect)return e;var t=e.getBoundingClientRect(),r=t.left+Y2("left"),n=t.top+Y2("top");return{top:n,left:r,right:(e.offsetWidth||0)+r,bottom:(e.offsetHeight||0)+n}}function Y2(e){if(e==="left")return window.pageXOffset||document.body.scrollLeft||0;if(e==="top")return window.pageYOffset||document.body.scrollTop||0}var Oq=function(e){function t(r,n){var a;return Gt(this,t),a=Sr(this,t,[r,n]),a.state={selecting:!1},a.containerRef=O.createRef(),a}return kr(t,e),Kt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable()}},{key:"componentDidUpdate",value:function(n){!n.selectable&&this.props.selectable&&this._selectable(),n.selectable&&!this.props.selectable&&this._teardownSelectable()}},{key:"render",value:function(){var n=this.props,a=n.range,s=n.getNow,i=n.getters,o=n.date,l=n.components.dateCellWrapper,c=n.localizer,f=this.state,d=f.selecting,h=f.startIdx,p=f.endIdx,v=s();return Z.createElement("div",{className:"rbc-row-bg",ref:this.containerRef},a.map(function(m,_){var g=d&&_>=h&&_<=p,y=i.dayProp(m),x=y.className,w=y.style;return Z.createElement(l,{key:_,value:m,range:a},Z.createElement("div",{style:w,className:Ct("rbc-day-bg",x,g&&"rbc-selected-cell",c.isSameDate(m,v)&&"rbc-today",o&&c.neq(o,m,"month")&&"rbc-off-range-bg")}))}))}},{key:"_selectable",value:function(){var n=this,a=this.containerRef.current,s=this._selector=new rN(this.props.container,{longPressThreshold:this.props.longPressThreshold}),i=function(l,c){if(!F0(a,l)&&!Cq(a,l)){var f=Zi(a),d=n.props,h=d.range,p=d.rtl;if(yq(f,l)){var v=eN(f,l.x,p,h.length);n._selectSlot({startIdx:v,endIdx:v,action:c,box:l})}}n._initial={},n.setState({selecting:!1})};s.on("selecting",function(o){var l=n.props,c=l.range,f=l.rtl,d=-1,h=-1;if(n.state.selecting||(ct(n.props.onSelectStart,[o]),n._initial={x:o.x,y:o.y}),s.isSelected(a)){var p=Zi(a),v=_q(n._initial,p,o,c.length,f);d=v.startIdx,h=v.endIdx}n.setState({selecting:!0,startIdx:d,endIdx:h})}),s.on("beforeSelect",function(o){if(n.props.selectable==="ignoreEvents")return!F0(n.containerRef.current,o)}),s.on("click",function(o){return i(o,"click")}),s.on("doubleClick",function(o){return i(o,"doubleClick")}),s.on("select",function(o){n._selectSlot(tt(tt({},n.state),{},{action:"select",bounds:o})),n._initial={},n.setState({selecting:!1}),ct(n.props.onSelectEnd,[n.state])})}},{key:"_teardownSelectable",value:function(){this._selector&&(this._selector.teardown(),this._selector=null)}},{key:"_selectSlot",value:function(n){var a=n.endIdx,s=n.startIdx,i=n.action,o=n.bounds,l=n.box;a!==-1&&s!==-1&&this.props.onSelectSlot&&this.props.onSelectSlot({start:s,end:a,action:i,bounds:o,box:l,resourceId:this.props.resourceId})}}])}(Z.Component),xa={propTypes:{slotMetrics:ue.object.isRequired,selected:ue.object,isAllDay:ue.bool,accessors:ue.object.isRequired,localizer:ue.object.isRequired,components:ue.object.isRequired,getters:ue.object.isRequired,onSelect:ue.func,onDoubleClick:ue.func,onKeyPress:ue.func},defaultProps:{segments:[],selected:{}},renderEvent:function(t,r){var n=t.selected;t.isAllDay;var a=t.accessors,s=t.getters,i=t.onSelect,o=t.onDoubleClick,l=t.onKeyPress,c=t.localizer,f=t.slotMetrics,d=t.components,h=t.resizable,p=f.continuesPrior(r),v=f.continuesAfter(r);return Z.createElement(JC,{event:r,getters:s,localizer:c,accessors:a,components:d,onSelect:i,onDoubleClick:o,onKeyPress:l,continuesPrior:p,continuesAfter:v,slotStart:f.first,slotEnd:f.last,selected:qh(r,n),resizable:h})},renderSpan:function(t,r,n){var a=arguments.length>3&&arguments[3]!==void 0?arguments[3]:" ",s=Math.abs(r)/t*100+"%";return Z.createElement("div",{key:n,className:"rbc-row-segment",style:{WebkitFlexBasis:s,flexBasis:s,maxWidth:s}},a)}},nN=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this,a=this.props,s=a.segments,i=a.slotMetrics.slots,o=a.className,l=1;return Z.createElement("div",{className:Ct(o,"rbc-row")},s.reduce(function(c,f,d){var h=f.event,p=f.left,v=f.right,m=f.span,_="_lvl_"+d,g=p-l,y=xa.renderEvent(n.props,h);return g&&c.push(xa.renderSpan(i,g,"".concat(_,"_gap"))),c.push(xa.renderSpan(i,m,_,y)),l=v+1,c},[]))}}])}(Z.Component);nN.defaultProps=tt({},xa.defaultProps);function aN(e){var t=e.dateRange,r=e.unit,n=r===void 0?"day":r,a=e.localizer;return{first:t[0],last:a.add(t[t.length-1],1,n)}}function Dq(e,t,r,n){var a=aN({dateRange:t,localizer:n}),s=a.first,i=a.last,o=n.diff(s,i,"day"),l=n.max(n.startOf(r.start(e),"day"),s),c=n.min(n.ceil(r.end(e),"day"),i),f=MW(t,function(h){return n.isSameDate(h,l)}),d=n.diff(l,c,"day");return d=Math.min(d,o),d=Math.max(d-n.segmentOffset,1),{event:e,span:d,left:f+1,right:Math.max(f+d,1)}}function sN(e){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0,r,n,a,s=[],i=[];for(r=0;r<e.length;r++){for(a=e[r],n=0;n<s.length&&jq(a,s[n]);n++);n>=t?i.push(a):(s[n]||(s[n]=[])).push(a)}for(r=0;r<s.length;r++)s[r].sort(function(o,l){return o.left-l.left});return{levels:s,extra:i}}function $u(e,t,r,n,a){var s={start:n.start(e),end:n.end(e)},i={start:t,end:r};return a.inEventRange({event:s,range:i})}function jq(e,t){return t.some(function(r){return r.left<=e.right&&r.right>=e.left})}function Pq(e,t,r){var n=$d(e),a=[],s=[];n.forEach(function(l){var c=t.start(l),f=t.end(l);r.daySpan(c,f)>1?a.push(l):s.push(l)});var i=a.sort(function(l,c){return ag(l,c,t,r)}),o=s.sort(function(l,c){return ag(l,c,t,r)});return[].concat($d(i),$d(o))}function ag(e,t,r,n){var a={start:r.start(e),end:r.end(e),allDay:r.allDay(e)},s={start:r.start(t),end:r.end(t),allDay:r.allDay(t)};return n.sortEvents({evtA:a,evtB:s})}var iN=function(t,r){return t.left<=r&&t.right>=r},G2=function(t,r){return t.filter(function(n){return iN(n,r)}).map(function(n){return n.event})},oN=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){for(var n=this.props,a=n.segments,s=n.slotMetrics.slots,i=sN(a).levels[0],o=1,l=1,c=[];o<=s;){var f="_lvl_"+o,d=i.filter(function(y){return iN(y,o)})[0]||{},h=d.event,p=d.left,v=d.right,m=d.span;if(!h){o++;continue}var _=Math.max(0,p-l);if(this.canRenderSlotEvent(p,m)){var g=xa.renderEvent(this.props,h);_&&c.push(xa.renderSpan(s,_,f+"_gap")),c.push(xa.renderSpan(s,m,f,g)),l=o=v+1}else _&&c.push(xa.renderSpan(s,_,f+"_gap")),c.push(xa.renderSpan(s,1,f,this.renderShowMore(a,o))),l=o=o+1}return Z.createElement("div",{className:"rbc-row"},c)}},{key:"canRenderSlotEvent",value:function(n,a){var s=this.props.segments;return KW(n,n+a).every(function(i){var o=G2(s,i).length;return o===1})}},{key:"renderShowMore",value:function(n,a){var s=this,i=this.props,o=i.localizer,l=i.slotMetrics,c=i.components,f=l.getEventsForSlot(a),d=G2(n,a),h=d.length;if(c!=null&&c.showMore){var p=c.showMore,v=l.getDateForSlot(a-1);return h?Z.createElement(p,{localizer:o,slotDate:v,slot:a,count:h,events:f,remainingEvents:d}):!1}return h?Z.createElement("button",{type:"button",key:"sm_"+a,className:Ct("rbc-button-link","rbc-show-more"),onClick:function(_){return s.showMore(a,_)}},o.messages.showMore(h,d,f)):!1}},{key:"showMore",value:function(n,a){a.preventDefault(),a.stopPropagation(),this.props.onShowMore(n,a.target)}}])}(Z.Component);oN.defaultProps=tt({},xa.defaultProps);var Fq=function(t){var r=t.children;return Z.createElement("div",{className:"rbc-row-content-scroll-container"},r)},Rq=function(t,r){return t.left<=r&&t.right>=r},Mq=function(t,r){return t[0].range===r[0].range&&t[0].events===r[0].events};function lN(){return jC(function(e){for(var t=e.range,r=e.events,n=e.maxRows,a=e.minRows,s=e.accessors,i=e.localizer,o=aN({dateRange:t,localizer:i}),l=o.first,c=o.last,f=r.map(function(m){return Dq(m,t,s,i)}),d=sN(f,Math.max(n-1,1)),h=d.levels,p=d.extra,v=p.length>0?a-1:a;h.length<v;)h.push([]);return{first:l,last:c,levels:h,extra:p,range:t,slots:t.length,clone:function(_){var g=lN();return g(tt(tt({},e),_))},getDateForSlot:function(_){return t[_]},getSlotForDate:function(_){return t.find(function(g){return i.isSameDate(g,_)})},getEventsForSlot:function(_){return f.filter(function(g){return Rq(g,_)}).map(function(g){return g.event})},continuesPrior:function(_){return i.continuesPrior(s.start(_),l)},continuesAfter:function(_){var g=s.start(_),y=s.end(_);return i.continuesAfter(g,y,c)}}},Mq)}var Bu=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleSelectSlot=function(i){var o=r.props,l=o.range,c=o.onSelectSlot;c(l.slice(i.start,i.end+1),i)},r.handleShowMore=function(i,o){var l=r.props,c=l.range,f=l.onShowMore,d=r.slotMetrics(r.props),h=M8(r.containerRef.current,".rbc-row-bg")[0],p;h&&(p=h.children[i-1]);var v=d.getEventsForSlot(i);f(v,c[i-1],p,i,o)},r.getContainer=function(){var i=r.props.container;return i?i():r.containerRef.current},r.renderHeadingCell=function(i,o){var l=r.props,c=l.renderHeader,f=l.getNow,d=l.localizer;return c({date:i,key:"header_".concat(o),className:Ct("rbc-date-cell",d.isSameDate(i,f())&&"rbc-now")})},r.renderDummy=function(){var i=r.props,o=i.className,l=i.range,c=i.renderHeader,f=i.showAllEvents;return Z.createElement("div",{className:o,ref:r.containerRef},Z.createElement("div",{className:Ct("rbc-row-content",f&&"rbc-row-content-scrollable")},c&&Z.createElement("div",{className:"rbc-row",ref:r.headingRowRef},l.map(r.renderHeadingCell)),Z.createElement("div",{className:"rbc-row",ref:r.eventRowRef},Z.createElement("div",{className:"rbc-row-segment"},Z.createElement("div",{className:"rbc-event"},Z.createElement("div",{className:"rbc-event-content"}," "))))))},r.containerRef=O.createRef(),r.headingRowRef=O.createRef(),r.eventRowRef=O.createRef(),r.slotMetrics=lN(),r}return kr(t,e),Kt(t,[{key:"getRowLimit",value:function(){var n,a=pm(this.eventRowRef.current),s=(n=this.headingRowRef)!==null&&n!==void 0&&n.current?pm(this.headingRowRef.current):0,i=pm(this.containerRef.current)-s;return Math.max(Math.floor(i/a),1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.rtl,i=n.range,o=n.className,l=n.selected,c=n.selectable,f=n.renderForMeasure,d=n.accessors,h=n.getters,p=n.components,v=n.getNow,m=n.renderHeader,_=n.onSelect,g=n.localizer,y=n.onSelectStart,x=n.onSelectEnd,w=n.onDoubleClick,E=n.onKeyPress,S=n.resourceId,b=n.longPressThreshold,j=n.isAllDay,k=n.resizable,C=n.showAllEvents;if(f)return this.renderDummy();var P=this.slotMetrics(this.props),I=P.levels,D=P.extra,K=C?Fq:Va,Q=p.weekWrapper,z={selected:l,accessors:d,getters:h,localizer:g,components:p,onSelect:_,onDoubleClick:w,onKeyPress:E,resourceId:S,slotMetrics:P,resizable:k};return Z.createElement("div",{className:o,role:"rowgroup",ref:this.containerRef},Z.createElement(Oq,{localizer:g,date:a,getNow:v,rtl:s,range:i,selectable:c,container:this.getContainer,getters:h,onSelectStart:y,onSelectEnd:x,onSelectSlot:this.handleSelectSlot,components:p,longPressThreshold:b,resourceId:S}),Z.createElement("div",{className:Ct("rbc-row-content",C&&"rbc-row-content-scrollable"),role:"row"},m&&Z.createElement("div",{className:"rbc-row ",ref:this.headingRowRef},i.map(this.renderHeadingCell)),Z.createElement(K,null,Z.createElement(Q,Object.assign({isAllDay:j},z,{rtl:this.props.rtl}),I.map(function(q,ee){return Z.createElement(nN,Object.assign({key:ee,segments:q},z))}),!!D.length&&Z.createElement(oN,Object.assign({segments:D,onShowMore:this.handleShowMore},z))))))}}])}(Z.Component);Bu.defaultProps={minRows:0,maxRows:1/0};var S1=function(t){var r=t.label;return Z.createElement("span",{role:"columnheader","aria-sort":"none"},r)},Iq=function(t){var r=t.label,n=t.drilldownView,a=t.onDrillDown;return n?Z.createElement("button",{type:"button",className:"rbc-button-link",onClick:a},r):Z.createElement("span",null,r)},Lq=["date","className"],$q=function(t,r,n,a,s){return t.filter(function(i){return $u(i,r,n,a,s)})},Xh=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.getContainer=function(){return r.containerRef.current},r.renderWeek=function(i,o){var l=r.props,c=l.events,f=l.components,d=l.selectable,h=l.getNow,p=l.selected,v=l.date,m=l.localizer,_=l.longPressThreshold,g=l.accessors,y=l.getters,x=l.showAllEvents,w=r.state,E=w.needLimitMeasure,S=w.rowLimit,b=$q($d(c),i[0],i[i.length-1],g,m),j=Pq(b,g,m);return Z.createElement(Bu,{key:o,ref:o===0?r.slotRowRef:void 0,container:r.getContainer,className:"rbc-month-row",getNow:h,date:v,range:i,events:j,maxRows:x?1/0:S,selected:p,selectable:d,components:f,accessors:g,getters:y,localizer:m,renderHeader:r.readerDateHeading,renderForMeasure:E,onShowMore:r.handleShowMore,onSelect:r.handleSelectEvent,onDoubleClick:r.handleDoubleClickEvent,onKeyPress:r.handleKeyPressEvent,onSelectSlot:r.handleSelectSlot,longPressThreshold:_,rtl:r.props.rtl,resizable:r.props.resizable,showAllEvents:x})},r.readerDateHeading=function(i){var o=i.date,l=i.className,c=Aa(i,Lq),f=r.props,d=f.date,h=f.getDrilldownView,p=f.localizer,v=p.neq(o,d,"month"),m=p.isSameDate(o,d),_=h(o),g=p.format(o,"dateFormat"),y=r.props.components.dateHeader||Iq;return Z.createElement("div",Object.assign({},c,{className:Ct(l,v&&"rbc-off-range",m&&"rbc-current"),role:"cell"}),Z.createElement(y,{label:g,date:o,drilldownView:_,isOffRange:v,onDrillDown:function(w){return r.handleHeadingClick(o,_,w)}}))},r.handleSelectSlot=function(i,o){r._pendingSelection=r._pendingSelection.concat(i),clearTimeout(r._selectTimer),r._selectTimer=setTimeout(function(){return r.selectDates(o)})},r.handleHeadingClick=function(i,o,l){l.preventDefault(),r.clearSelection(),ct(r.props.onDrillDown,[i,o])},r.handleSelectEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){r.clearSelection();for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleShowMore=function(i,o,l,c,f){var d=r.props,h=d.popup,p=d.onDrillDown,v=d.onShowMore,m=d.getDrilldownView,_=d.doShowMoreDrillDown;if(r.clearSelection(),h){var g=iC(l,r.containerRef.current);r.setState({overlay:{date:o,events:i,position:g,target:f}})}else _&&ct(p,[o,m(o)||Pt.DAY]);ct(v,[i,o,c])},r.overlayDisplay=function(){r.setState({overlay:null})},r.state={rowLimit:5,needLimitMeasure:!0,date:null},r.containerRef=O.createRef(),r.slotRowRef=O.createRef(),r._bgRows=[],r._pendingSelection=[],r}return kr(t,e),Kt(t,[{key:"componentDidMount",value:function(){var n=this,a;this.state.needLimitMeasure&&this.measureRowLimit(this.props),window.addEventListener("resize",this._resizeListener=function(){a||oC(function(){a=!1,n.setState({needLimitMeasure:!0})})},!1)}},{key:"componentDidUpdate",value:function(){this.state.needLimitMeasure&&this.measureRowLimit(this.props)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this._resizeListener,!1)}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.className,o=s.visibleDays(a,s),l=_8(o,7);return this._weekCount=l.length,Z.createElement("div",{className:Ct("rbc-month-view",i),role:"table","aria-label":"Month View",ref:this.containerRef},Z.createElement("div",{className:"rbc-row rbc-month-header",role:"row"},this.renderHeaders(l[0])),l.map(this.renderWeek),this.props.popup&&this.renderOverlay())}},{key:"renderHeaders",value:function(n){var a=this.props,s=a.localizer,i=a.components,o=n[0],l=n[n.length-1],c=i.header||S1;return s.range(o,l,"day").map(function(f,d){return Z.createElement("div",{key:"header_"+d,className:"rbc-header"},Z.createElement(c,{date:f,localizer:s,label:s.format(f,"weekdayFormat")}))})}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,p=o.popupOffset,v=o.handleDragStart,m=function(){return s.setState({overlay:null})};return Z.createElement(E1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:p,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:m})}},{key:"measureRowLimit",value:function(){this.setState({needLimitMeasure:!1,rowLimit:this.slotRowRef.current.getRowLimit()})}},{key:"selectDates",value:function(n){var a=this._pendingSelection.slice();this._pendingSelection=[],a.sort(function(o,l){return+o-+l});var s=new Date(a[0]),i=new Date(a[a.length-1]);i.setDate(a[a.length-1].getDate()+1),ct(this.props.onSelectSlot,{slots:a,start:s,end:i,action:n.action,bounds:n.bounds,box:n.box})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}}],[{key:"getDerivedStateFromProps",value:function(n,a){var s=n.date,i=n.localizer;return{date:s,needLimitMeasure:i.neq(s,a.date,"month")}}}])}(Z.Component);Xh.range=function(e,t){var r=t.localizer,n=r.firstVisibleDay(e,r),a=r.lastVisibleDay(e,r);return{start:n,end:a}};Xh.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"month");case qr.NEXT:return n.add(e,1,"month");default:return e}};Xh.title=function(e,t){var r=t.localizer;return r.format(e,"monthHeaderFormat")};var K2=function(t){var r=t.min,n=t.max,a=t.step,s=t.slots,i=t.localizer;return"".concat(+i.startOf(r,"minutes"))+"".concat(+i.startOf(n,"minutes"))+"".concat(a,"-").concat(s)};function k1(e){for(var t=e.min,r=e.max,n=e.step,a=e.timeslots,s=e.localizer,i=K2({step:n,localizer:s}),o=1+s.getTotalMin(t,r),l=s.getMinutesFromMidnight(t),c=Math.ceil((o-1)/(n*a)),f=c*a,d=new Array(c),h=new Array(f),p=0;p<c;p++){d[p]=new Array(a);for(var v=0;v<a;v++){var m=p*a+v,_=m*n;h[m]=d[p][v]=s.getSlotDate(t,l,_)}}var g=h.length*n;h.push(s.getSlotDate(t,l,g));function y(x){var w=s.diff(t,x,"minutes")+s.getDstOffset(t,x);return Math.min(w,o)}return{groups:d,update:function(w){return K2(w)!==i?k1(w):this},dateIsInGroup:function(w,E){var S=d[E+1];return s.inRange(w,d[E][0],S?S[0]:r,"minutes")},nextSlot:function(w){var E=h[Math.min(h.findIndex(function(S){return S===w||s.eq(S,w)})+1,h.length-1)];return s.eq(E,w)&&(E=s.add(w,n,"minutes")),E},closestSlotToPosition:function(w){var E=Math.min(h.length-1,Math.max(0,Math.floor(w*f)));return h[E]},closestSlotFromPoint:function(w,E){var S=Math.abs(E.top-E.bottom);return this.closestSlotToPosition((w.y-E.top)/S)},closestSlotFromDate:function(w){var E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;if(s.lt(w,t,"minutes"))return h[0];if(s.gt(w,r,"minutes"))return h[h.length-1];var S=s.diff(t,w,"minutes");return h[(S-S%n)/n+E]},startsBeforeDay:function(w){return s.lt(w,t,"day")},startsAfterDay:function(w){return s.gt(w,r,"day")},startsBefore:function(w){return s.lt(s.merge(t,w),t,"minutes")},startsAfter:function(w){return s.gt(s.merge(r,w),r,"minutes")},getRange:function(w,E,S,b){S||(w=s.min(r,s.max(t,w))),b||(E=s.min(r,s.max(t,E)));var j=y(w),k=y(E),C=k>n*f&&!s.eq(r,E)?(j-n)/(n*f)*100:j/(n*f)*100;return{top:C,height:k/(n*f)*100-C,start:y(w),startDate:w,end:y(E),endDate:E}},getCurrentTimePosition:function(w){var E=y(w),S=E/(n*f)*100;return S}}}var Bq=function(){function e(t,r){var n=r.accessors,a=r.slotMetrics;Gt(this,e);var s=a.getRange(n.start(t),n.end(t)),i=s.start,o=s.startDate,l=s.end,c=s.endDate,f=s.top,d=s.height;this.start=i,this.end=l,this.startMs=+o,this.endMs=+c,this.top=f,this.height=d,this.data=t}return Kt(e,[{key:"_width",get:function(){if(this.rows){var r=this.rows.reduce(function(a,s){return Math.max(a,s.leaves.length+1)},0)+1;return 100/r}if(this.leaves){var n=100-this.container._width;return n/(this.leaves.length+1)}return this.row._width}},{key:"width",get:function(){var r=this._width,n=Math.min(100,this._width*1.7);if(this.rows)return n;if(this.leaves)return this.leaves.length>0?n:r;var a=this.row.leaves,s=a.indexOf(this);return s===a.length-1?r:n}},{key:"xOffset",get:function(){if(this.rows)return 0;if(this.leaves)return this.container._width;var r=this.row,n=r.leaves,a=r.xOffset,s=r._width,i=n.indexOf(this)+1;return a+i*s}}])}();function Uq(e,t,r){return Math.abs(t.start-e.start)<r||t.start>e.start&&t.start<e.end}function Wq(e){for(var t=pH(e,["startMs",function(o){return-o.endMs}]),r=[];t.length>0;){var n=t.shift();r.push(n);for(var a=0;a<t.length;a++){var s=t[a];if(!(n.endMs>s.startMs)){if(a>0){var i=t.splice(a,1)[0];r.push(i)}break}}}return r}function cN(e){for(var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=t.map(function(f){return new Bq(f,{slotMetrics:n,accessors:a})}),i=Wq(s),o=[],l=function(){var d=i[c],h=o.find(function(m){return m.end>d.start||Math.abs(d.start-m.start)<r});if(!h)return d.rows=[],o.push(d),1;d.container=h;for(var p=null,v=h.rows.length-1;!p&&v>=0;v--)Uq(h.rows[v],d,r)&&(p=h.rows[v]);p?(p.leaves.push(d),d.row=p):(d.leaves=[],h.rows.push(d))},c=0;c<i.length;c++)l();return i.map(function(f){return{event:f.data,style:{top:f.top,height:f.height,width:f.width,xOffset:Math.max(0,f.xOffset)}}})}function uN(e,t,r){for(var n=0;n<e.friends.length;++n)if(!(r.indexOf(e.friends[n])>-1)){t=t>e.friends[n].idx?t:e.friends[n].idx,r.push(e.friends[n]);var a=uN(e.friends[n],t,r);t=t>a?t:a}return t}function Vq(e){var t=e.events,r=e.minimumStartDifference,n=e.slotMetrics,a=e.accessors,s=cN({events:t,minimumStartDifference:r,slotMetrics:n,accessors:a});s.sort(function(Q,z){return Q=Q.style,z=z.style,Q.top!==z.top?Q.top>z.top?1:-1:Q.height!==z.height?Q.top+Q.height<z.top+z.height?1:-1:0});for(var i=0;i<s.length;++i)s[i].friends=[],delete s[i].style.left,delete s[i].style.left,delete s[i].idx,delete s[i].size;for(var o=0;o<s.length-1;++o)for(var l=s[o],c=l.style.top,f=l.style.top+l.style.height,d=o+1;d<s.length;++d){var h=s[d],p=h.style.top,v=h.style.top+h.style.height;(p>=c&&v<=f||v>c&&v<=f||p>=c&&p<f)&&(l.friends.push(h),h.friends.push(l))}for(var m=0;m<s.length;++m){for(var _=s[m],g=[],y=0;y<100;++y)g.push(1);for(var x=0;x<_.friends.length;++x)_.friends[x].idx!==void 0&&(g[_.friends[x].idx]=0);_.idx=g.indexOf(1)}for(var w=0;w<s.length;++w){var E=0;if(!s[w].size){var S=[],b=uN(s[w],0,S);E=100/(b+1),s[w].size=E;for(var j=0;j<S.length;++j)S[j].size=E}}for(var k=0;k<s.length;++k){var C=s[k];C.style.left=C.idx*C.size;for(var P=0,I=0;I<C.friends.length;++I){var D=C.friends[I].idx;P=P>D?P:D}P<=C.idx&&(C.size=100-C.idx*C.size);var K=C.idx===0?0:3;C.style.width="calc(".concat(C.size,"% - ").concat(K,"px)"),C.style.height="calc(".concat(C.style.height,"% - 2px)"),C.style.xOffset="calc(".concat(C.style.left,"% + ").concat(K,"px)")}return s}var q2={overlap:cN,"no-overlap":Vq};function Hq(e){return!!(e&&e.constructor&&e.call&&e.apply)}function zq(e){e.events,e.minimumStartDifference,e.slotMetrics,e.accessors;var t=e.dayLayoutAlgorithm,r=t;return t in q2&&(r=q2[t]),Hq(r)?r.apply(this,arguments):[]}var fN=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.renderSlot,s=n.resource,i=n.group,o=n.getters,l=n.components,c=l===void 0?{}:l,f=c.timeSlotWrapper,d=f===void 0?Va:f,h=o?o.slotGroupProp(i):{};return Z.createElement("div",Object.assign({className:"rbc-timeslot-group"},h),i.map(function(p,v){var m=o?o.slotProp(p,s):{};return Z.createElement(d,{key:v,value:p,resource:s},Z.createElement("div",Object.assign({},m,{className:Ct("rbc-time-slot",m.className)}),a&&a(p,v)))}))}}])}(O.Component);function fd(e){return typeof e=="string"?e:e+"%"}function Yq(e){var t=e.style,r=e.className,n=e.event,a=e.accessors,s=e.rtl,i=e.selected,o=e.label,l=e.continuesPrior,c=e.continuesAfter,f=e.getters,d=e.onClick,h=e.onDoubleClick,p=e.isBackgroundEvent,v=e.onKeyPress,m=e.components,_=m.event,g=m.eventWrapper,y=a.title(n),x=a.tooltip(n),w=a.end(n),E=a.start(n),S=f.eventProp(n,E,w,i),b=[Z.createElement("div",{key:"1",className:"rbc-event-label"},o),Z.createElement("div",{key:"2",className:"rbc-event-content"},_?Z.createElement(_,{event:n,title:y}):y)],j=t.height,k=t.top,C=t.width,P=t.xOffset,I=tt(tt({},S.style),{},Ti({top:fd(k),height:fd(j),width:fd(C)},s?"right":"left",fd(P)));return Z.createElement(g,Object.assign({type:"time"},e),Z.createElement("div",{role:"button",tabIndex:0,onClick:d,onDoubleClick:h,style:I,onKeyDown:v,title:x?(typeof o=="string"?o+": ":"")+x:void 0,className:Ct(p?"rbc-background-event":"rbc-event",r,S.className,{"rbc-selected":i,"rbc-event-continues-earlier":l,"rbc-event-continues-later":c})},b))}var Gq=function(t){var r=t.children,n=t.className,a=t.style,s=t.innerRef;return Z.createElement("div",{className:n,style:a,ref:s},r)},Kq=Z.forwardRef(function(e,t){return Z.createElement(Gq,Object.assign({},e,{innerRef:t}))}),qq=["dayProp"],Xq=["eventContainerWrapper"],dN=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.state={selecting:!1,timeIndicatorPosition:null},r.intervalTriggered=!1,r.renderEvents=function(i){var o=i.events,l=i.isBackgroundEvent,c=r.props,f=c.rtl,d=c.selected,h=c.accessors,p=c.localizer,v=c.getters,m=c.components,_=c.step,g=c.timeslots,y=c.dayLayoutAlgorithm,x=c.resizable,w=r,E=w.slotMetrics,S=p.messages,b=zq({events:o,accessors:h,slotMetrics:E,minimumStartDifference:Math.ceil(_*g/2),dayLayoutAlgorithm:y});return b.map(function(j,k){var C,P=j.event,I=j.style,D=h.end(P),K=h.start(P),Q=(C=h.eventId(P))!==null&&C!==void 0?C:"evt_"+k,z="eventTimeRangeFormat",q,ee=E.startsBeforeDay(K),H=E.startsAfterDay(D);ee?z="eventTimeRangeEndFormat":H&&(z="eventTimeRangeStartFormat"),ee&&H?q=S.allDay:q=p.format({start:K,end:D},z);var ce=ee||E.startsBefore(K),J=H||E.startsAfter(D);return Z.createElement(Yq,{style:I,event:P,label:q,key:Q,getters:v,rtl:f,components:m,continuesPrior:ce,continuesAfter:J,accessors:h,resource:r.props.resource,selected:qh(P,d),onClick:function(F){return r._select(tt(tt(tt({},P),r.props.resource&&{sourceResource:r.props.resource}),l&&{isBackgroundEvent:!0}),F)},onDoubleClick:function(F){return r._doubleClick(P,F)},isBackgroundEvent:l,onKeyPress:function(F){return r._keyPress(P,F)},resizable:x})})},r._selectable=function(){var i=r.containerRef.current,o=r.props,l=o.longPressThreshold,c=o.localizer,f=r._selector=new rN(function(){return i},{longPressThreshold:l}),d=function(m){var _=r.props.onSelecting,g=r.state||{},y=h(m),x=y.startDate,w=y.endDate;_&&(c.eq(g.startDate,x,"minutes")&&c.eq(g.endDate,w,"minutes")||_({start:x,end:w,resourceId:r.props.resource})===!1)||(r.state.start!==y.start||r.state.end!==y.end||r.state.selecting!==y.selecting)&&r.setState(y)},h=function(m){var _=r.slotMetrics.closestSlotFromPoint(m,Zi(i));r.state.selecting||(r._initialSlot=_);var g=r._initialSlot;c.lte(g,_)?_=r.slotMetrics.nextSlot(_):c.gt(g,_)&&(g=r.slotMetrics.nextSlot(g));var y=r.slotMetrics.getRange(c.min(g,_),c.max(g,_));return tt(tt({},y),{},{selecting:!0,top:"".concat(y.top,"%"),height:"".concat(y.height,"%")})},p=function(m,_){if(!F0(r.containerRef.current,m)){var g=h(m),y=g.startDate,x=g.endDate;r._selectSlot({startDate:y,endDate:x,action:_,box:m})}r.setState({selecting:!1})};f.on("selecting",d),f.on("selectStart",d),f.on("beforeSelect",function(v){if(r.props.selectable==="ignoreEvents")return!F0(r.containerRef.current,v)}),f.on("click",function(v){return p(v,"click")}),f.on("doubleClick",function(v){return p(v,"doubleClick")}),f.on("select",function(v){r.state.selecting&&(r._selectSlot(tt(tt({},r.state),{},{action:"select",bounds:v})),r.setState({selecting:!1}))}),f.on("reset",function(){r.state.selecting&&r.setState({selecting:!1})})},r._teardownSelectable=function(){r._selector&&(r._selector.teardown(),r._selector=null)},r._selectSlot=function(i){for(var o=i.startDate,l=i.endDate,c=i.action,f=i.bounds,d=i.box,h=o,p=[];r.props.localizer.lte(h,l);)p.push(h),h=new Date(+h+r.props.step*60*1e3);ct(r.props.onSelectSlot,{slots:p,start:o,end:l,resourceId:r.props.resource,action:c,bounds:f,box:d})},r._select=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r._doubleClick=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r._keyPress=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.slotMetrics=k1(r.props),r.containerRef=O.createRef(),r}return kr(t,e),Kt(t,[{key:"componentDidMount",value:function(){this.props.selectable&&this._selectable(),this.props.isNow&&this.setTimeIndicatorPositionUpdateInterval()}},{key:"componentWillUnmount",value:function(){this._teardownSelectable(),this.clearTimeIndicatorInterval()}},{key:"componentDidUpdate",value:function(n,a){this.props.selectable&&!n.selectable&&this._selectable(),!this.props.selectable&&n.selectable&&this._teardownSelectable();var s=this.props,i=s.getNow,o=s.isNow,l=s.localizer,c=s.date,f=s.min,d=s.max,h=l.neq(n.getNow(),i(),"minutes");if(n.isNow!==o||h){if(this.clearTimeIndicatorInterval(),o){var p=!h&&l.eq(n.date,c,"minutes")&&a.timeIndicatorPosition===this.state.timeIndicatorPosition;this.setTimeIndicatorPositionUpdateInterval(p)}}else o&&(l.neq(n.min,f,"minutes")||l.neq(n.max,d,"minutes"))&&this.positionTimeIndicator()}},{key:"setTimeIndicatorPositionUpdateInterval",value:function(){var n=this,a=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;!this.intervalTriggered&&!a&&this.positionTimeIndicator(),this._timeIndicatorTimeout=window.setTimeout(function(){n.intervalTriggered=!0,n.positionTimeIndicator(),n.setTimeIndicatorPositionUpdateInterval()},6e4)}},{key:"clearTimeIndicatorInterval",value:function(){this.intervalTriggered=!1,window.clearTimeout(this._timeIndicatorTimeout)}},{key:"positionTimeIndicator",value:function(){var n=this.props,a=n.min,s=n.max,i=n.getNow,o=i();if(o>=a&&o<=s){var l=this.slotMetrics.getCurrentTimePosition(o);this.intervalTriggered=!0,this.setState({timeIndicatorPosition:l})}else this.clearTimeIndicatorInterval()}},{key:"render",value:function(){var n=this.props,a=n.date,s=n.max,i=n.rtl,o=n.isNow,l=n.resource,c=n.accessors,f=n.localizer,d=n.getters,h=d.dayProp,p=Aa(d,qq),v=n.components,m=v.eventContainerWrapper,_=Aa(v,Xq);this.slotMetrics=this.slotMetrics.update(this.props);var g=this.slotMetrics,y=this.state,x=y.selecting,w=y.top,E=y.height,S=y.startDate,b=y.endDate,j={start:S,end:b},k=h(s,l),C=k.className,P=k.style,I=_.dayColumnWrapper||Kq;return Z.createElement(I,{ref:this.containerRef,date:a,style:P,className:Ct(C,"rbc-day-slot","rbc-time-column",o&&"rbc-now",o&&"rbc-today",x&&"rbc-slot-selecting"),slotMetrics:g,resource:l},g.groups.map(function(D,K){return Z.createElement(fN,{key:K,group:D,resource:l,getters:p,components:_})}),Z.createElement(m,{localizer:f,resource:l,accessors:c,getters:p,components:_,slotMetrics:g},Z.createElement("div",{className:Ct("rbc-events-container",i&&"rtl")},this.renderEvents({events:this.props.backgroundEvents,isBackgroundEvent:!0}),this.renderEvents({events:this.props.events}))),x&&Z.createElement("div",{className:"rbc-slot-selection",style:{top:w,height:E}},Z.createElement("span",null,f.format(j,"selectRangeFormat"))),o&&this.intervalTriggered&&Z.createElement("div",{className:"rbc-current-time-indicator",style:{top:"".concat(this.state.timeIndicatorPosition,"%")}}))}}])}(Z.Component);dN.defaultProps={dragThroughEvents:!0,timeslots:2};var hN=function(t){var r=t.label;return Z.createElement(Z.Fragment,null,r)},Qq=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r.renderRow=function(i){var o=r.props,l=o.events,c=o.rtl,f=o.selectable,d=o.getNow,h=o.range,p=o.getters,v=o.localizer,m=o.accessors,_=o.components,g=o.resizable,y=m.resourceId(i),x=i?l.filter(function(w){return m.resource(w)===y}):l;return Z.createElement(Bu,{isAllDay:!0,rtl:c,getNow:d,minRows:2,maxRows:r.props.allDayMaxRows+1,range:h,events:x,resourceId:y,className:"rbc-allday-cell",selectable:f,selected:r.props.selected,components:_,accessors:m,getters:p,localizer:v,onSelect:r.props.onSelectEvent,onShowMore:r.props.onShowMore,onDoubleClick:r.props.onDoubleClickEvent,onKeyPress:r.props.onKeyPressEvent,onSelectSlot:r.props.onSelectSlot,longPressThreshold:r.props.longPressThreshold,resizable:g})},r}return kr(t,e),Kt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components.header,d=f===void 0?S1:f,h=l();return n.map(function(p,v){var m=o(p),_=i.format(p,"dayFormat"),g=c(p),y=g.className,x=g.style,w=Z.createElement(d,{date:p,label:_,localizer:i});return Z.createElement("div",{key:v,style:x,className:Ct("rbc-header",y,i.isSameDate(p,h)&&"rbc-today")},m?Z.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(S){return a.handleHeaderClick(p,m,S)}},w):Z.createElement("span",null,w))})}},{key:"render",value:function(){var n=this,a=this.props,s=a.width,i=a.rtl,o=a.resources,l=a.range,c=a.events,f=a.getNow,d=a.accessors,h=a.selectable,p=a.components,v=a.getters,m=a.scrollRef,_=a.localizer,g=a.isOverflowing,y=a.components,x=y.timeGutterHeader,w=y.resourceHeader,E=w===void 0?hN:w,S=a.resizable,b={};g&&(b[i?"marginLeft":"marginRight"]="".concat(n1()-1,"px"));var j=o.groupEvents(c);return Z.createElement("div",{style:b,ref:m,className:Ct("rbc-time-header",g&&"rbc-overflowing")},Z.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:s,minWidth:s,maxWidth:s}},x&&Z.createElement(x,null)),o.map(function(k,C){var P=wn(k,2),I=P[0],D=P[1];return Z.createElement("div",{className:"rbc-time-header-content",key:I||C},D&&Z.createElement("div",{className:"rbc-row rbc-row-resource",key:"resource_".concat(C)},Z.createElement("div",{className:"rbc-header"},Z.createElement(E,{index:C,label:d.resourceTitle(D),resource:D}))),Z.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(l.length<=1?" rbc-time-header-cell-single-day":"")},n.renderHeaderCells(l)),Z.createElement(Bu,{isAllDay:!0,rtl:i,getNow:f,minRows:2,maxRows:n.props.allDayMaxRows+1,range:l,events:j.get(I)||[],resourceId:D&&I,className:"rbc-allday-cell",selectable:h,selected:n.props.selected,components:p,accessors:d,getters:v,localizer:_,onSelect:n.props.onSelectEvent,onShowMore:n.props.onShowMore,onDoubleClick:n.props.onDoubleClickEvent,onKeyDown:n.props.onKeyPressEvent,onSelectSlot:n.props.onSelectSlot,longPressThreshold:n.props.longPressThreshold,resizable:S}))}))}}])}(Z.Component),Jq=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.handleHeaderClick=function(i,o,l){l.preventDefault(),ct(r.props.onDrillDown,[i,o])},r}return kr(t,e),Kt(t,[{key:"renderHeaderCells",value:function(n){var a=this,s=this.props,i=s.localizer,o=s.getDrilldownView,l=s.getNow,c=s.getters.dayProp,f=s.components,d=f.header,h=d===void 0?S1:d,p=f.resourceHeader,v=p===void 0?hN:p,m=s.resources,_=s.accessors,g=s.events,y=s.rtl,x=s.selectable,w=s.components,E=s.getters,S=s.resizable,b=l(),j=m.groupEvents(g);return n.map(function(k,C){var P=o(k),I=i.format(k,"dayFormat"),D=c(k),K=D.className,Q=D.style,z=Z.createElement(h,{date:k,label:I,localizer:i});return Z.createElement("div",{key:C,className:"rbc-time-header-content rbc-resource-grouping"},Z.createElement("div",{className:"rbc-row rbc-time-header-cell".concat(n.length<=1?" rbc-time-header-cell-single-day":"")},Z.createElement("div",{style:Q,className:Ct("rbc-header",K,i.isSameDate(k,b)&&"rbc-today")},P?Z.createElement("button",{type:"button",className:"rbc-button-link",onClick:function(ee){return a.handleHeaderClick(k,P,ee)}},z):Z.createElement("span",null,z))),Z.createElement("div",{className:"rbc-row"},m.map(function(q,ee){var H=wn(q,2),ce=H[0],J=H[1];return Z.createElement("div",{key:"resource_".concat(ce,"_").concat(ee),className:Ct("rbc-header",K,i.isSameDate(k,b)&&"rbc-today")},Z.createElement(v,{index:ee,label:_.resourceTitle(J),resource:J}))})),Z.createElement("div",{className:"rbc-row rbc-m-b-negative-3 rbc-h-full"},m.map(function(q,ee){var H=wn(q,2),ce=H[0],J=H[1],N=(j.get(ce)||[]).filter(function(F){return i.isSameDate(F.start,k)||i.isSameDate(F.end,k)});return Z.createElement(Bu,{key:"resource_".concat(ce,"_").concat(ee),isAllDay:!0,rtl:y,getNow:l,minRows:2,maxRows:a.props.allDayMaxRows+1,range:[k],events:N,resourceId:J&&ce,className:"rbc-allday-cell",selectable:x,selected:a.props.selected,components:w,accessors:_,getters:E,localizer:i,onSelect:a.props.onSelectEvent,onShowMore:a.props.onShowMore,onDoubleClick:a.props.onDoubleClickEvent,onKeyDown:a.props.onKeyPressEvent,onSelectSlot:a.props.onSelectSlot,longPressThreshold:a.props.longPressThreshold,resizable:S})})))})}},{key:"render",value:function(){var n=this.props,a=n.width,s=n.rtl,i=n.range,o=n.scrollRef,l=n.isOverflowing,c=n.components.timeGutterHeader,f={};return l&&(f[s?"marginLeft":"marginRight"]="".concat(n1()-1,"px")),Z.createElement("div",{style:f,ref:o,className:Ct("rbc-time-header",l&&"rbc-overflowing")},Z.createElement("div",{className:"rbc-label rbc-time-header-gutter",style:{width:a,minWidth:a,maxWidth:a}},c&&Z.createElement(c,null)),this.renderHeaderCells(i))}}])}(Z.Component);function Zq(e){var t=e.min,r=e.max,n=e.localizer;return n.getTimezoneOffset(t)!==n.getTimezoneOffset(r)?{start:n.add(t,-1,"day"),end:n.add(r,-1,"day")}:{start:t,end:r}}var eX=function(t){var r=t.min,n=t.max,a=t.timeslots,s=t.step,i=t.localizer,o=t.getNow,l=t.resource,c=t.components,f=t.getters,d=t.gutterRef,h=c.timeGutterWrapper,p=O.useMemo(function(){return Zq({min:r,max:n,localizer:i})},[r==null?void 0:r.toISOString(),n==null?void 0:n.toISOString(),i]),v=p.start,m=p.end,_=O.useState(k1({min:v,max:m,timeslots:a,step:s,localizer:i})),g=wn(_,2),y=g[0],x=g[1];O.useEffect(function(){y&&x(y.update({min:v,max:m,timeslots:a,step:s,localizer:i}))},[v==null?void 0:v.toISOString(),m==null?void 0:m.toISOString(),a,s]);var w=O.useCallback(function(E,S){if(S)return null;var b=y.dateIsInGroup(o(),S);return Z.createElement("span",{className:Ct("rbc-label",b&&"rbc-now")},i.format(E,"timeGutterFormat"))},[y,i,o]);return Z.createElement(h,{slotMetrics:y},Z.createElement("div",{className:"rbc-time-gutter rbc-time-column",ref:d},y.groups.map(function(E,S){return Z.createElement(fN,{key:S,group:E,resource:l,components:c,renderSlot:w,getters:f})})))},tX=Z.forwardRef(function(e,t){return Z.createElement(eX,Object.assign({gutterRef:t},e))}),gm={};function rX(e,t){return{map:function(n){return e?e.map(function(a,s){return n([t.resourceId(a),a],s)}):[n([gm,null],0)]},groupEvents:function(n){var a=new Map;return e?(n.forEach(function(s){var i=t.resource(s)||gm;if(Array.isArray(i))i.forEach(function(l){var c=a.get(l)||[];c.push(s),a.set(l,c)});else{var o=a.get(i)||[];o.push(s),a.set(i,o)}}),a):(a.set(gm,n),a)}}}var Xl=function(e){function t(r){var n;return Gt(this,t),n=Sr(this,t,[r]),n.handleScroll=function(a){n.scrollRef.current&&(n.scrollRef.current.scrollLeft=a.target.scrollLeft)},n.handleResize=function(){Fw(n.rafHandle),n.rafHandle=oC(n.checkOverflow)},n.handleKeyPressEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onKeyPressEvent,s)},n.handleSelectEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onSelectEvent,s)},n.handleDoubleClickEvent=function(){n.clearSelection();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];ct(n.props.onDoubleClickEvent,s)},n.handleShowMore=function(a,s,i,o,l){var c=n.props,f=c.popup,d=c.onDrillDown,h=c.onShowMore,p=c.getDrilldownView,v=c.doShowMoreDrillDown;if(n.clearSelection(),f){var m=iC(i,n.containerRef.current);n.setState({overlay:{date:s,events:a,position:tt(tt({},m),{},{width:"200px"}),target:l}})}else v&&ct(d,[s,p(s)||Pt.DAY]);ct(h,[a,s,o])},n.handleSelectAllDaySlot=function(a,s){var i=n.props.onSelectSlot,o=new Date(a[0]),l=new Date(a[a.length-1]);l.setDate(a[a.length-1].getDate()+1),ct(i,{slots:a,start:o,end:l,action:s.action,resourceId:s.resourceId})},n.overlayDisplay=function(){n.setState({overlay:null})},n.checkOverflow=function(){if(!n._updatingOverflow){var a=n.contentRef.current;if(a!=null&&a.scrollHeight){var s=a.scrollHeight>a.clientHeight;n.state.isOverflowing!==s&&(n._updatingOverflow=!0,n.setState({isOverflowing:s},function(){n._updatingOverflow=!1}))}}},n.memoizedResources=jC(function(a,s){return rX(a,s)}),n.state={gutterWidth:void 0,isOverflowing:null},n.scrollRef=Z.createRef(),n.contentRef=Z.createRef(),n.containerRef=Z.createRef(),n._scrollRatio=null,n.gutterRef=O.createRef(),n}return kr(t,e),Kt(t,[{key:"getSnapshotBeforeUpdate",value:function(){return this.checkOverflow(),null}},{key:"componentDidMount",value:function(){this.props.width==null&&this.measureGutter(),this.calculateScroll(),this.applyScroll(),window.addEventListener("resize",this.handleResize)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.handleResize),Fw(this.rafHandle),this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest)}},{key:"componentDidUpdate",value:function(){this.applyScroll()}},{key:"renderDayColumn",value:function(n,a,s,i,o,l,c,f,d,h){var p=this.props,v=p.min,m=p.max,_=(i.get(a)||[]).filter(function(y){return l.inRange(n,c.start(y),c.end(y),"day")}),g=(o.get(a)||[]).filter(function(y){return l.inRange(n,c.start(y),c.end(y),"day")});return Z.createElement(dN,Object.assign({},this.props,{localizer:l,min:l.merge(n,v),max:l.merge(n,m),resource:s&&a,components:f,isNow:l.isSameDate(n,h),key:"".concat(a,"-").concat(n),date:n,events:_,backgroundEvents:g,dayLayoutAlgorithm:d}))}},{key:"renderResourcesFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return a.map(function(p){var v=wn(p,2),m=v[0],_=v[1];return n.map(function(g){return h.renderDayColumn(g,m,_,s,i,o,l,f,d,c)})})}},{key:"renderRangeFirst",value:function(n,a,s,i,o,l,c,f,d){var h=this;return n.map(function(p){return Z.createElement("div",{style:{display:"flex",minHeight:"100%",flex:1},key:p},a.map(function(v){var m=wn(v,2),_=m[0],g=m[1];return Z.createElement("div",{style:{flex:1},key:l.resourceId(g)},h.renderDayColumn(p,_,g,s,i,o,l,f,d,c))}))})}},{key:"renderEvents",value:function(n,a,s,i){var o=this.props,l=o.accessors,c=o.localizer,f=o.resourceGroupingLayout,d=o.components,h=o.dayLayoutAlgorithm,p=this.memoizedResources(this.props.resources,l),v=p.groupEvents(a),m=p.groupEvents(s);return f?this.renderRangeFirst(n,p,v,m,c,l,i,d,h):this.renderResourcesFirst(n,p,v,m,c,l,i,d,h)}},{key:"render",value:function(){var n,a=this.props,s=a.events,i=a.backgroundEvents,o=a.range,l=a.width,c=a.rtl,f=a.selected,d=a.getNow,h=a.resources,p=a.components,v=a.accessors,m=a.getters,_=a.localizer,g=a.min,y=a.max,x=a.showMultiDayTimes,w=a.longPressThreshold,E=a.resizable,S=a.resourceGroupingLayout;l=l||this.state.gutterWidth;var b=o[0],j=o[o.length-1];this.slots=o.length;var k=[],C=[],P=[];s.forEach(function(D){if($u(D,b,j,v,_)){var K=v.start(D),Q=v.end(D);v.allDay(D)||_.startAndEndAreDateOnly(K,Q)||!x&&!_.isSameDate(K,Q)?k.push(D):C.push(D)}}),i.forEach(function(D){$u(D,b,j,v,_)&&P.push(D)}),k.sort(function(D,K){return ag(D,K,v,_)});var I={range:o,events:k,width:l,rtl:c,getNow:d,localizer:_,selected:f,allDayMaxRows:this.props.showAllEvents?1/0:(n=this.props.allDayMaxRows)!==null&&n!==void 0?n:1/0,resources:this.memoizedResources(h,v),selectable:this.props.selectable,accessors:v,getters:m,components:p,scrollRef:this.scrollRef,isOverflowing:this.state.isOverflowing,longPressThreshold:w,onSelectSlot:this.handleSelectAllDaySlot,onSelectEvent:this.handleSelectEvent,onShowMore:this.handleShowMore,onDoubleClickEvent:this.props.onDoubleClickEvent,onKeyPressEvent:this.props.onKeyPressEvent,onDrillDown:this.props.onDrillDown,getDrilldownView:this.props.getDrilldownView,resizable:E};return Z.createElement("div",{className:Ct("rbc-time-view",h&&"rbc-time-view-resources"),ref:this.containerRef},h&&h.length>1&&S?Z.createElement(Jq,I):Z.createElement(Qq,I),this.props.popup&&this.renderOverlay(),Z.createElement("div",{ref:this.contentRef,className:"rbc-time-content",onScroll:this.handleScroll},Z.createElement(tX,{date:b,ref:this.gutterRef,localizer:_,min:_.merge(b,g),max:_.merge(b,y),step:this.props.step,getNow:this.props.getNow,timeslots:this.props.timeslots,components:p,className:"rbc-time-gutter",getters:m}),this.renderEvents(o,C,P,d())))}},{key:"renderOverlay",value:function(){var n,a,s=this,i=(n=(a=this.state)===null||a===void 0?void 0:a.overlay)!==null&&n!==void 0?n:{},o=this.props,l=o.accessors,c=o.localizer,f=o.components,d=o.getters,h=o.selected,p=o.popupOffset,v=o.handleDragStart,m=function(){return s.setState({overlay:null})};return Z.createElement(E1,{overlay:i,accessors:l,localizer:c,components:f,getters:d,selected:h,popupOffset:p,ref:this.containerRef,handleKeyPressEvent:this.handleKeyPressEvent,handleSelectEvent:this.handleSelectEvent,handleDoubleClickEvent:this.handleDoubleClickEvent,handleDragStart:v,show:!!i.position,overlayDisplay:this.overlayDisplay,onHide:m})}},{key:"clearSelection",value:function(){clearTimeout(this._selectTimer),this._pendingSelection=[]}},{key:"measureGutter",value:function(){var n=this;this.measureGutterAnimationFrameRequest&&window.cancelAnimationFrame(this.measureGutterAnimationFrameRequest),this.measureGutterAnimationFrameRequest=window.requestAnimationFrame(function(){var a,s=(a=n.gutterRef)!==null&&a!==void 0&&a.current?rg(n.gutterRef.current):void 0;s&&n.state.gutterWidth!==s&&n.setState({gutterWidth:s})})}},{key:"applyScroll",value:function(){if(this._scrollRatio!=null&&this.props.enableAutoScroll===!0){var n=this.contentRef.current;n.scrollTop=n.scrollHeight*this._scrollRatio,this._scrollRatio=null}}},{key:"calculateScroll",value:function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,a=n.min,s=n.max,i=n.scrollToTime,o=n.localizer,l=o.diff(o.merge(i,a),i,"milliseconds"),c=o.diff(a,s,"milliseconds");this._scrollRatio=l/c}}])}(O.Component);Xl.defaultProps={step:30,timeslots:2,resourceGroupingLayout:!1};var nX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],Qh=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,p=h===void 0?!0:h,v=Aa(n,nX),m=t.range(a,{localizer:s});return Z.createElement(Xl,Object.assign({},v,{range:m,eventOffset:10,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:p}))}}])}(Z.Component);Qh.range=function(e,t){var r=t.localizer;return[r.startOf(e,"day")]};Qh.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"day");case qr.NEXT:return n.add(e,1,"day");default:return e}};Qh.title=function(e,t){var r=t.localizer;return r.format(e,"dayHeaderFormat")};var aX=["date","localizer","min","max","scrollToTime","enableAutoScroll"],ni=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,p=h===void 0?!0:h,v=Aa(n,aX),m=t.range(a,this.props);return Z.createElement(Xl,Object.assign({},v,{range:m,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:p}))}}])}(Z.Component);ni.defaultProps=Xl.defaultProps;ni.navigate=function(e,t,r){var n=r.localizer;switch(t){case qr.PREVIOUS:return n.add(e,-1,"week");case qr.NEXT:return n.add(e,1,"week");default:return e}};ni.range=function(e,t){var r=t.localizer,n=r.startOfWeek(),a=r.startOf(e,"week",n),s=r.endOf(e,"week",n);return r.range(a,s)};ni.title=function(e,t){var r=t.localizer,n=ni.range(e,{localizer:r}),a=$C(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var sX=["date","localizer","min","max","scrollToTime","enableAutoScroll"];function T1(e,t){return ni.range(e,t).filter(function(r){return[6,0].indexOf(r.getDay())===-1})}var bf=function(e){function t(){return Gt(this,t),Sr(this,t,arguments)}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.date,s=n.localizer,i=n.min,o=i===void 0?s.startOf(new Date,"day"):i,l=n.max,c=l===void 0?s.endOf(new Date,"day"):l,f=n.scrollToTime,d=f===void 0?s.startOf(new Date,"day"):f,h=n.enableAutoScroll,p=h===void 0?!0:h,v=Aa(n,sX),m=T1(a,this.props);return Z.createElement(Xl,Object.assign({},v,{range:m,eventOffset:15,localizer:s,min:o,max:c,scrollToTime:d,enableAutoScroll:p}))}}])}(Z.Component);bf.defaultProps=Xl.defaultProps;bf.range=T1;bf.navigate=ni.navigate;bf.title=function(e,t){var r=t.localizer,n=T1(e,{localizer:r}),a=$C(n),s=a[0],i=a.slice(1);return r.format({start:s,end:i.pop()},"dayRangeHeaderFormat")};var Jh=30;function Zh(e){var t=e.accessors,r=e.components,n=e.date,a=e.events,s=e.getters,i=e.length,o=i===void 0?Jh:i,l=e.localizer,c=e.onDoubleClickEvent,f=e.onSelectEvent,d=e.selected,h=O.useRef(null),p=O.useRef(null),v=O.useRef(null),m=O.useRef(null),_=O.useRef(null);O.useEffect(function(){x()});var g=function(j,k,C){var P=r.event,I=r.date;return k=k.filter(function(D){return $u(D,l.startOf(j,"day"),l.endOf(j,"day"),t,l)}),k.map(function(D,K){var Q=t.title(D),z=t.end(D),q=t.start(D),ee=s.eventProp(D,q,z,qh(D,d)),H=K===0&&l.format(j,"agendaDateFormat"),ce=K===0?Z.createElement("td",{rowSpan:k.length,className:"rbc-agenda-date-cell"},I?Z.createElement(I,{day:j,label:H}):H):!1;return Z.createElement("tr",{key:C+"_"+K,className:ee.className,style:ee.style},ce,Z.createElement("td",{className:"rbc-agenda-time-cell"},y(j,D)),Z.createElement("td",{className:"rbc-agenda-event-cell",onClick:function(N){return f&&f(D,N)},onDoubleClick:function(N){return c&&c(D,N)}},P?Z.createElement(P,{event:D,title:Q}):Q))},[])},y=function(j,k){var C="",P=r.time,I=l.messages.allDay,D=t.end(k),K=t.start(k);return t.allDay(k)||(l.eq(K,D)?I=l.format(K,"agendaTimeFormat"):l.isSameDate(K,D)?I=l.format({start:K,end:D},"agendaTimeRangeFormat"):l.isSameDate(j,K)?I=l.format(K,"agendaTimeFormat"):l.isSameDate(j,D)&&(I=l.format(D,"agendaTimeFormat"))),l.gt(j,K,"day")&&(C="rbc-continues-prior"),l.lt(j,D,"day")&&(C+=" rbc-continues-after"),Z.createElement("span",{className:C.trim()},P?Z.createElement(P,{event:k,day:j,label:I}):I)},x=function(){if(_.current){var j=h.current,k=_.current.firstChild;if(k){var C=m.current.scrollHeight>m.current.clientHeight,P=[],I=P;P=[rg(k.children[0]),rg(k.children[1])],(I[0]!==P[0]||I[1]!==P[1])&&(p.current.style.width=P[0]+"px",v.current.style.width=P[1]+"px"),C?(oL(j,"rbc-header-overflowing"),j.style.marginRight=n1()+"px"):lL(j,"rbc-header-overflowing")}}},w=l.messages,E=l.add(n,o,"day"),S=l.range(n,E,"day");return a=a.filter(function(b){return $u(b,l.startOf(n,"day"),l.endOf(E,"day"),t,l)}),a.sort(function(b,j){return+t.start(b)-+t.start(j)}),Z.createElement("div",{className:"rbc-agenda-view"},a.length!==0?Z.createElement(Z.Fragment,null,Z.createElement("table",{ref:h,className:"rbc-agenda-table"},Z.createElement("thead",null,Z.createElement("tr",null,Z.createElement("th",{className:"rbc-header",ref:p},w.date),Z.createElement("th",{className:"rbc-header",ref:v},w.time),Z.createElement("th",{className:"rbc-header"},w.event)))),Z.createElement("div",{className:"rbc-agenda-content",ref:m},Z.createElement("table",{className:"rbc-agenda-table"},Z.createElement("tbody",{ref:_},S.map(function(b,j){return g(b,a,j)}))))):Z.createElement("span",{className:"rbc-agenda-empty"},w.noEventsInRange))}Zh.range=function(e,t){var r=t.length,n=r===void 0?Jh:r,a=t.localizer,s=a.add(e,n,"day");return{start:e,end:s}};Zh.navigate=function(e,t,r){var n=r.length,a=n===void 0?Jh:n,s=r.localizer;switch(t){case qr.PREVIOUS:return s.add(e,-a,"day");case qr.NEXT:return s.add(e,a,"day");default:return e}};Zh.title=function(e,t){var r=t.length,n=r===void 0?Jh:r,a=t.localizer,s=a.add(e,n,"day");return a.format({start:e,end:s},"agendaHeaderFormat")};var Wd=Ti(Ti(Ti(Ti(Ti({},Pt.MONTH,Xh),Pt.WEEK,ni),Pt.WORK_WEEK,bf),Pt.DAY,Qh),Pt.AGENDA,Zh),iX=["action","date","today"];function oX(e,t){var r=t.action,n=t.date,a=t.today,s=Aa(t,iX);switch(e=typeof e=="string"?Wd[e]:e,r){case qr.TODAY:n=a||new Date;break;case qr.DATE:break;default:Cu(e&&typeof e.navigate=="function","Calendar View components must implement a static `.navigate(date, action)` method.s"),n=e.navigate(n,r,s)}return n}function lX(e,t){var r=null;return typeof t=="function"?r=t(e):typeof t=="string"&&fs(e)==="object"&&e!=null&&t in e&&(r=e[t]),r}var $a=function(t){return function(r){return lX(r,t)}},cX=["view","date","getNow","onNavigate"],uX=["view","toolbar","events","backgroundEvents","resourceGroupingLayout","style","className","elementProps","date","getNow","length","showMultiDayTimes","onShowMore","doShowMoreDrillDown","components","formats","messages","culture"];function pN(e){if(Array.isArray(e))return e;for(var t=[],r=0,n=Object.entries(e);r<n.length;r++){var a=wn(n[r],2),s=a[0],i=a[1];i&&t.push(s)}return t}function fX(e,t){var r=t.views,n=pN(r);return n.indexOf(e)!==-1}var mN=function(e){function t(){var r;Gt(this,t);for(var n=arguments.length,a=new Array(n),s=0;s<n;s++)a[s]=arguments[s];return r=Sr(this,t,[].concat(a)),r.getViews=function(){var i=r.props.views;return Array.isArray(i)?WK(i,function(o,l){return o[l]=Wd[l]},{}):fs(i)==="object"?WH(i,function(o,l){return o===!0?Wd[l]:o}):Wd},r.getView=function(){var i=r.getViews();return i[r.props.view]},r.getDrilldownView=function(i){var o=r.props,l=o.view,c=o.drilldownView,f=o.getDrilldownView;return f?f(i,l,Object.keys(r.getViews())):c},r.handleRangeChange=function(i,o,l){var c=r.props,f=c.onRangeChange,d=c.localizer;f&&o.range&&f(o.range(i,{localizer:d}),l)},r.handleNavigate=function(i,o){var l=r.props,c=l.view,f=l.date,d=l.getNow,h=l.onNavigate,p=Aa(l,cX),v=r.getView(),m=d();f=oX(v,tt(tt({},p),{},{action:i,date:o||f||m,today:m})),h(f,c,i),r.handleRangeChange(f,v)},r.handleViewChange=function(i){i!==r.props.view&&fX(i,r.props)&&r.props.onView(i);var o=r.getViews();r.handleRangeChange(r.props.date||r.props.getNow(),o[i],i)},r.handleSelectEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onSelectEvent,o)},r.handleDoubleClickEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onDoubleClickEvent,o)},r.handleKeyPressEvent=function(){for(var i=arguments.length,o=new Array(i),l=0;l<i;l++)o[l]=arguments[l];ct(r.props.onKeyPressEvent,o)},r.handleSelectSlot=function(i){ct(r.props.onSelectSlot,i)},r.handleDrillDown=function(i,o){var l=r.props.onDrillDown;if(l){l(i,o,r.drilldownView);return}o&&r.handleViewChange(o),r.handleNavigate(qr.DATE,i)},r.state={context:t.getContext(r.props)},r}return kr(t,e),Kt(t,[{key:"render",value:function(){var n=this.props,a=n.view,s=n.toolbar,i=n.events,o=n.backgroundEvents,l=n.resourceGroupingLayout,c=n.style,f=n.className,d=n.elementProps,h=n.date,p=n.getNow,v=n.length,m=n.showMultiDayTimes,_=n.onShowMore,g=n.doShowMoreDrillDown;n.components,n.formats,n.messages,n.culture;var y=Aa(n,uX);h=h||p();var x=this.getView(),w=this.state.context,E=w.accessors,S=w.components,b=w.getters,j=w.localizer,k=w.viewNames,C=S.toolbar||pq,P=x.title(h,{localizer:j,length:v});return Z.createElement("div",Object.assign({},d,{className:Ct(f,"rbc-calendar",y.rtl&&"rbc-rtl"),style:c}),s&&Z.createElement(C,{date:h,view:a,views:k,label:P,onView:this.handleViewChange,onNavigate:this.handleNavigate,localizer:j}),Z.createElement(x,Object.assign({},y,{events:i,backgroundEvents:o,date:h,getNow:p,length:v,localizer:j,getters:b,components:S,accessors:E,showMultiDayTimes:m,getDrilldownView:this.getDrilldownView,onNavigate:this.handleNavigate,onDrillDown:this.handleDrillDown,onSelectEvent:this.handleSelectEvent,onDoubleClickEvent:this.handleDoubleClickEvent,onKeyPressEvent:this.handleKeyPressEvent,onSelectSlot:this.handleSelectSlot,onShowMore:_,doShowMoreDrillDown:g,resourceGroupingLayout:l})))}}],[{key:"getDerivedStateFromProps",value:function(n){return{context:t.getContext(n)}}},{key:"getContext",value:function(n){var a=n.startAccessor,s=n.endAccessor,i=n.allDayAccessor,o=n.tooltipAccessor,l=n.titleAccessor,c=n.resourceAccessor,f=n.resourceIdAccessor,d=n.resourceTitleAccessor,h=n.eventIdAccessor,p=n.eventPropGetter,v=n.backgroundEventPropGetter,m=n.slotPropGetter,_=n.slotGroupPropGetter,g=n.dayPropGetter,y=n.view,x=n.views,w=n.localizer,E=n.culture,S=n.messages,b=S===void 0?{}:S,j=n.components,k=j===void 0?{}:j,C=n.formats,P=C===void 0?{}:C,I=pN(x),D=vq(b);return{viewNames:I,localizer:hq(w,E,P,D),getters:{eventProp:function(){return p&&p.apply(void 0,arguments)||{}},backgroundEventProp:function(){return v&&v.apply(void 0,arguments)||{}},slotProp:function(){return m&&m.apply(void 0,arguments)||{}},slotGroupProp:function(){return _&&_.apply(void 0,arguments)||{}},dayProp:function(){return g&&g.apply(void 0,arguments)||{}}},components:RH(k[y]||{},AK(k,I),{eventWrapper:Va,backgroundEventWrapper:Va,eventContainerWrapper:Va,dateCellWrapper:Va,weekWrapper:Va,timeSlotWrapper:Va,timeGutterWrapper:Va}),accessors:{start:$a(a),end:$a(s),allDay:$a(i),tooltip:$a(o),title:$a(l),resource:$a(c),resourceId:$a(f),resourceTitle:$a(d),eventId:$a(h)}}}}])}(Z.Component);mN.defaultProps={events:[],backgroundEvents:[],elementProps:{},popup:!1,toolbar:!0,view:Pt.MONTH,views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],step:30,length:30,allDayMaxRows:1/0,doShowMoreDrillDown:!0,drilldownView:Pt.DAY,titleAccessor:"title",tooltipAccessor:"title",allDayAccessor:"allDay",startAccessor:"start",endAccessor:"end",resourceAccessor:"resourceId",resourceIdAccessor:"id",resourceTitleAccessor:"title",eventIdAccessor:"id",longPressThreshold:250,getNow:function(){return new Date},dayLayoutAlgorithm:"overlap"};var dX=BT(mN,{view:"onView",date:"onNavigate",selected:"onSelectEvent"}),hX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"MMMM DD",r)+" – "+n.format(s,n.eq(a,s,"month")?"DD":"MMMM DD",r)},pX=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"L",r)+" – "+n.format(s,"L",r)},xm=function(t,r,n){var a=t.start,s=t.end;return n.format(a,"LT",r)+" – "+n.format(s,"LT",r)},mX=function(t,r,n){var a=t.start;return n.format(a,"LT",r)+" – "},vX=function(t,r,n){var a=t.end;return" – "+n.format(a,"LT",r)},gX={dateFormat:"DD",dayFormat:"DD ddd",weekdayFormat:"ddd",selectRangeFormat:xm,eventTimeRangeFormat:xm,eventTimeRangeStartFormat:mX,eventTimeRangeEndFormat:vX,timeGutterFormat:"LT",monthHeaderFormat:"MMMM YYYY",dayHeaderFormat:"dddd MMM DD",dayRangeHeaderFormat:hX,agendaHeaderFormat:pX,agendaDateFormat:"ddd MMM DD",agendaTimeFormat:"LT",agendaTimeRangeFormat:xm};function Ss(e){var t=e&&e.toLowerCase();return t==="FullYear"?t="year":t||(t=void 0),t}function xX(e){var t=function(N,F){return F?N.locale(F):N};function r(J){return e(J).toDate().getTimezoneOffset()}function n(J,N){var F,T,R=e(J).local(),G=e(N).local();if(!e.tz)return R.toDate().getTimezoneOffset()-G.toDate().getTimezoneOffset();var X=(F=R==null||(T=R._z)===null||T===void 0?void 0:T.name)!==null&&F!==void 0?F:e.tz.guess(),Y=e.tz.zone(X).utcOffset(+R),ae=e.tz.zone(X).utcOffset(+G);return Y-ae}function a(J){var N=e(J).startOf("day");return n(N,J)}function s(J,N,F){var T=Ss(F),R=T?e(J).startOf(T):e(J),G=T?e(N).startOf(T):e(N);return[R,G,T]}function i(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,N=arguments.length>1?arguments[1]:void 0,F=Ss(N);return F?e(J).startOf(F).toDate():e(J).toDate()}function o(){var J=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,N=arguments.length>1?arguments[1]:void 0,F=Ss(N);return F?e(J).endOf(F).toDate():e(J).toDate()}function l(J,N,F){var T=s(J,N,F),R=wn(T,3),G=R[0],X=R[1],Y=R[2];return G.isSame(X,Y)}function c(J,N,F){return!l(J,N,F)}function f(J,N,F){var T=s(J,N,F),R=wn(T,3),G=R[0],X=R[1],Y=R[2];return G.isAfter(X,Y)}function d(J,N,F){var T=s(J,N,F),R=wn(T,3),G=R[0],X=R[1],Y=R[2];return G.isBefore(X,Y)}function h(J,N,F){var T=s(J,N,F),R=wn(T,3),G=R[0],X=R[1],Y=R[2];return G.isSameOrBefore(X,Y)}function p(J,N,F){var T=s(J,N,F),R=wn(T,3),G=R[0],X=R[1],Y=R[2];return G.isSameOrBefore(X,Y)}function v(J,N,F){var T=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"day",R=Ss(T),G=e(J),X=e(N),Y=e(F);return G.isBetween(X,Y,R,"[]")}function m(J,N){var F=e(J),T=e(N),R=e.min(F,T);return R.toDate()}function _(J,N){var F=e(J),T=e(N),R=e.max(F,T);return R.toDate()}function g(J,N){if(!J&&!N)return null;var F=e(N).format("HH:mm:ss"),T=e(J).startOf("day").format("MM/DD/YYYY");return e("".concat(T," ").concat(F),"MM/DD/YYYY HH:mm:ss").toDate()}function y(J,N,F){var T=Ss(F);return e(J).add(N,T).toDate()}function x(J,N){for(var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",T=Ss(F),R=e(J).toDate(),G=[];p(R,N);)G.push(R),R=y(R,1,T);return G}function w(J,N){var F=Ss(N),T=i(J,F);return l(T,J)?T:y(T,1,F)}function E(J,N){var F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"day",T=Ss(F),R=e(J),G=e(N);return G.diff(R,T)}function S(J){var N=e(J);return N.minutes()}function b(J){var N=J?e.localeData(J):e.localeData();return N?N.firstDayOfWeek():0}function j(J){return e(J).startOf("month").startOf("week").toDate()}function k(J){return e(J).endOf("month").endOf("week").toDate()}function C(J){for(var N=j(J),F=k(J),T=[];p(N,F);)T.push(N),N=y(N,1,"d");return T}function P(J,N,F){return e(J).startOf("day").minute(N+F).toDate()}function I(J,N){return E(J,N,"minutes")}function D(J){var N=e(J).startOf("day"),F=e(J);return F.diff(N,"minutes")+a(J)}function K(J,N){var F=e(J),T=e(N);return F.isBefore(T,"day")}function Q(J,N,F){var T=e(N),R=e(F);return T.isSameOrAfter(R,"minutes")}function z(J,N){var F=e(J),T=e(N),R=e.duration(T.diff(F));return R.days()}function q(J){var N=J.evtA,F=N.start,T=N.end,R=N.allDay,G=J.evtB,X=G.start,Y=G.end,ae=G.allDay,oe=+i(F,"day")-+i(X,"day"),ve=z(F,T),B=z(X,Y);return oe||B-ve||!!ae-!!R||+F-+X||+T-+Y}function ee(J){var N=J.event,F=N.start,T=N.end,R=J.range,G=R.start,X=R.end,Y=e(F).startOf("day"),ae=e(T),oe=e(G),ve=e(X),B=Y.isSameOrBefore(ve,"day"),Te=!Y.isSame(ae,"minutes"),ke=Te?ae.isAfter(oe,"minutes"):ae.isSameOrAfter(oe,"minutes");return B&&ke}function H(J,N){var F=e(J),T=e(N);return F.isSame(T,"day")}function ce(){var J=new Date,N=/-/.test(J.toString())?"-":"",F=J.getTimezoneOffset(),T=Number("".concat(N).concat(Math.abs(F))),R=e().utcOffset();return R>T?1:0}return new dq({formats:gX,firstOfWeek:b,firstVisibleDay:j,lastVisibleDay:k,visibleDays:C,format:function(N,F,T){return t(e(N),T).format(F)},lt:d,lte:p,gt:f,gte:h,eq:l,neq:c,merge:g,inRange:v,startOf:i,endOf:o,range:x,add:y,diff:E,ceil:w,min:m,max:_,minutes:S,getSlotDate:P,getTimezoneOffset:r,getDstOffset:n,getTotalMin:I,getMinutesFromMidnight:D,continuesPrior:K,continuesAfter:Q,sortEvents:q,inEventRange:ee,isSameDate:H,daySpan:z,browserTZOffset:ce})}//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var vN;function ye(){return vN.apply(null,arguments)}function yX(e){vN=e}function sa(e){return e instanceof Array||Object.prototype.toString.call(e)==="[object Array]"}function Ii(e){return e!=null&&Object.prototype.toString.call(e)==="[object Object]"}function Ke(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function C1(e){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(e).length===0;var t;for(t in e)if(Ke(e,t))return!1;return!0}function $r(e){return e===void 0}function hs(e){return typeof e=="number"||Object.prototype.toString.call(e)==="[object Number]"}function Ef(e){return e instanceof Date||Object.prototype.toString.call(e)==="[object Date]"}function gN(e,t){var r=[],n,a=e.length;for(n=0;n<a;++n)r.push(t(e[n],n));return r}function Ls(e,t){for(var r in t)Ke(t,r)&&(e[r]=t[r]);return Ke(t,"toString")&&(e.toString=t.toString),Ke(t,"valueOf")&&(e.valueOf=t.valueOf),e}function Fa(e,t,r,n){return BN(e,t,r,n,!0).utc()}function _X(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function Fe(e){return e._pf==null&&(e._pf=_X()),e._pf}var sg;Array.prototype.some?sg=Array.prototype.some:sg=function(e){var t=Object(this),r=t.length>>>0,n;for(n=0;n<r;n++)if(n in t&&e.call(this,t[n],n,t))return!0;return!1};function N1(e){var t=null,r=!1,n=e._d&&!isNaN(e._d.getTime());if(n&&(t=Fe(e),r=sg.call(t.parsedDateParts,function(a){return a!=null}),n=t.overflow<0&&!t.empty&&!t.invalidEra&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&r),e._strict&&(n=n&&t.charsLeftOver===0&&t.unusedTokens.length===0&&t.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(e))e._isValid=n;else return n;return e._isValid}function ep(e){var t=Fa(NaN);return e!=null?Ls(Fe(t),e):Fe(t).userInvalidated=!0,t}var X2=ye.momentProperties=[],ym=!1;function A1(e,t){var r,n,a,s=X2.length;if($r(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),$r(t._i)||(e._i=t._i),$r(t._f)||(e._f=t._f),$r(t._l)||(e._l=t._l),$r(t._strict)||(e._strict=t._strict),$r(t._tzm)||(e._tzm=t._tzm),$r(t._isUTC)||(e._isUTC=t._isUTC),$r(t._offset)||(e._offset=t._offset),$r(t._pf)||(e._pf=Fe(t)),$r(t._locale)||(e._locale=t._locale),s>0)for(r=0;r<s;r++)n=X2[r],a=t[n],$r(a)||(e[n]=a);return e}function Sf(e){A1(this,e),this._d=new Date(e._d!=null?e._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),ym===!1&&(ym=!0,ye.updateOffset(this),ym=!1)}function ia(e){return e instanceof Sf||e!=null&&e._isAMomentObject!=null}function xN(e){ye.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+e)}function Rn(e,t){var r=!0;return Ls(function(){if(ye.deprecationHandler!=null&&ye.deprecationHandler(null,e),r){var n=[],a,s,i,o=arguments.length;for(s=0;s<o;s++){if(a="",typeof arguments[s]=="object"){a+=`
[`+s+"] ";for(i in arguments[0])Ke(arguments[0],i)&&(a+=i+": "+arguments[0][i]+", ");a=a.slice(0,-2)}else a=arguments[s];n.push(a)}xN(e+`
Arguments: `+Array.prototype.slice.call(n).join("")+`
`+new Error().stack),r=!1}return t.apply(this,arguments)},t)}var Q2={};function yN(e,t){ye.deprecationHandler!=null&&ye.deprecationHandler(e,t),Q2[e]||(xN(t),Q2[e]=!0)}ye.suppressDeprecationWarnings=!1;ye.deprecationHandler=null;function Ra(e){return typeof Function<"u"&&e instanceof Function||Object.prototype.toString.call(e)==="[object Function]"}function wX(e){var t,r;for(r in e)Ke(e,r)&&(t=e[r],Ra(t)?this[r]=t:this["_"+r]=t);this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function ig(e,t){var r=Ls({},e),n;for(n in t)Ke(t,n)&&(Ii(e[n])&&Ii(t[n])?(r[n]={},Ls(r[n],e[n]),Ls(r[n],t[n])):t[n]!=null?r[n]=t[n]:delete r[n]);for(n in e)Ke(e,n)&&!Ke(t,n)&&Ii(e[n])&&(r[n]=Ls({},r[n]));return r}function O1(e){e!=null&&this.set(e)}var og;Object.keys?og=Object.keys:og=function(e){var t,r=[];for(t in e)Ke(e,t)&&r.push(t);return r};var bX={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function EX(e,t,r){var n=this._calendar[e]||this._calendar.sameElse;return Ra(n)?n.call(t,r):n}function Oa(e,t,r){var n=""+Math.abs(e),a=t-n.length,s=e>=0;return(s?r?"+":"":"-")+Math.pow(10,Math.max(0,a)).toString().substr(1)+n}var D1=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,dd=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,_m={},sl={};function Se(e,t,r,n){var a=n;typeof n=="string"&&(a=function(){return this[n]()}),e&&(sl[e]=a),t&&(sl[t[0]]=function(){return Oa(a.apply(this,arguments),t[1],t[2])}),r&&(sl[r]=function(){return this.localeData().ordinal(a.apply(this,arguments),e)})}function SX(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function kX(e){var t=e.match(D1),r,n;for(r=0,n=t.length;r<n;r++)sl[t[r]]?t[r]=sl[t[r]]:t[r]=SX(t[r]);return function(a){var s="",i;for(i=0;i<n;i++)s+=Ra(t[i])?t[i].call(a,e):t[i];return s}}function Vd(e,t){return e.isValid()?(t=_N(t,e.localeData()),_m[t]=_m[t]||kX(t),_m[t](e)):e.localeData().invalidDate()}function _N(e,t){var r=5;function n(a){return t.longDateFormat(a)||a}for(dd.lastIndex=0;r>=0&&dd.test(e);)e=e.replace(dd,n),dd.lastIndex=0,r-=1;return e}var TX={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function CX(e){var t=this._longDateFormat[e],r=this._longDateFormat[e.toUpperCase()];return t||!r?t:(this._longDateFormat[e]=r.match(D1).map(function(n){return n==="MMMM"||n==="MM"||n==="DD"||n==="dddd"?n.slice(1):n}).join(""),this._longDateFormat[e])}var NX="Invalid date";function AX(){return this._invalidDate}var OX="%d",DX=/\d{1,2}/;function jX(e){return this._ordinal.replace("%d",e)}var PX={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function FX(e,t,r,n){var a=this._relativeTime[r];return Ra(a)?a(e,t,r,n):a.replace(/%d/i,e)}function RX(e,t){var r=this._relativeTime[e>0?"future":"past"];return Ra(r)?r(t):r.replace(/%s/i,t)}var J2={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Mn(e){return typeof e=="string"?J2[e]||J2[e.toLowerCase()]:void 0}function j1(e){var t={},r,n;for(n in e)Ke(e,n)&&(r=Mn(n),r&&(t[r]=e[n]));return t}var MX={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function IX(e){var t=[],r;for(r in e)Ke(e,r)&&t.push({unit:r,priority:MX[r]});return t.sort(function(n,a){return n.priority-a.priority}),t}var wN=/\d/,fn=/\d\d/,bN=/\d{3}/,P1=/\d{4}/,tp=/[+-]?\d{6}/,dt=/\d\d?/,EN=/\d\d\d\d?/,SN=/\d\d\d\d\d\d?/,rp=/\d{1,3}/,F1=/\d{1,4}/,np=/[+-]?\d{1,6}/,Ql=/\d+/,ap=/[+-]?\d+/,LX=/Z|[+-]\d\d:?\d\d/gi,sp=/Z|[+-]\d\d(?::?\d\d)?/gi,$X=/[+-]?\d+(\.\d{1,3})?/,kf=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,Jl=/^[1-9]\d?/,R1=/^([1-9]\d|\d)/,R0;R0={};function be(e,t,r){R0[e]=Ra(t)?t:function(n,a){return n&&r?r:t}}function BX(e,t){return Ke(R0,e)?R0[e](t._strict,t._locale):new RegExp(UX(e))}function UX(e){return es(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,r,n,a,s){return r||n||a||s}))}function es(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function _n(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function Le(e){var t=+e,r=0;return t!==0&&isFinite(t)&&(r=_n(t)),r}var lg={};function et(e,t){var r,n=t,a;for(typeof e=="string"&&(e=[e]),hs(t)&&(n=function(s,i){i[t]=Le(s)}),a=e.length,r=0;r<a;r++)lg[e[r]]=n}function Tf(e,t){et(e,function(r,n,a,s){a._w=a._w||{},t(r,a._w,a,s)})}function WX(e,t,r){t!=null&&Ke(lg,e)&&lg[e](t,r._a,r,e)}function ip(e){return e%4===0&&e%100!==0||e%400===0}var yr=0,Xa=1,ya=2,Ht=3,Kn=4,Qa=5,Di=6,VX=7,HX=8;Se("Y",0,0,function(){var e=this.year();return e<=9999?Oa(e,4):"+"+e});Se(0,["YY",2],0,function(){return this.year()%100});Se(0,["YYYY",4],0,"year");Se(0,["YYYYY",5],0,"year");Se(0,["YYYYYY",6,!0],0,"year");be("Y",ap);be("YY",dt,fn);be("YYYY",F1,P1);be("YYYYY",np,tp);be("YYYYYY",np,tp);et(["YYYYY","YYYYYY"],yr);et("YYYY",function(e,t){t[yr]=e.length===2?ye.parseTwoDigitYear(e):Le(e)});et("YY",function(e,t){t[yr]=ye.parseTwoDigitYear(e)});et("Y",function(e,t){t[yr]=parseInt(e,10)});function qc(e){return ip(e)?366:365}ye.parseTwoDigitYear=function(e){return Le(e)+(Le(e)>68?1900:2e3)};var kN=Zl("FullYear",!0);function zX(){return ip(this.year())}function Zl(e,t){return function(r){return r!=null?(TN(this,e,r),ye.updateOffset(this,t),this):Uu(this,e)}}function Uu(e,t){if(!e.isValid())return NaN;var r=e._d,n=e._isUTC;switch(t){case"Milliseconds":return n?r.getUTCMilliseconds():r.getMilliseconds();case"Seconds":return n?r.getUTCSeconds():r.getSeconds();case"Minutes":return n?r.getUTCMinutes():r.getMinutes();case"Hours":return n?r.getUTCHours():r.getHours();case"Date":return n?r.getUTCDate():r.getDate();case"Day":return n?r.getUTCDay():r.getDay();case"Month":return n?r.getUTCMonth():r.getMonth();case"FullYear":return n?r.getUTCFullYear():r.getFullYear();default:return NaN}}function TN(e,t,r){var n,a,s,i,o;if(!(!e.isValid()||isNaN(r))){switch(n=e._d,a=e._isUTC,t){case"Milliseconds":return void(a?n.setUTCMilliseconds(r):n.setMilliseconds(r));case"Seconds":return void(a?n.setUTCSeconds(r):n.setSeconds(r));case"Minutes":return void(a?n.setUTCMinutes(r):n.setMinutes(r));case"Hours":return void(a?n.setUTCHours(r):n.setHours(r));case"Date":return void(a?n.setUTCDate(r):n.setDate(r));case"FullYear":break;default:return}s=r,i=e.month(),o=e.date(),o=o===29&&i===1&&!ip(s)?28:o,a?n.setUTCFullYear(s,i,o):n.setFullYear(s,i,o)}}function YX(e){return e=Mn(e),Ra(this[e])?this[e]():this}function GX(e,t){if(typeof e=="object"){e=j1(e);var r=IX(e),n,a=r.length;for(n=0;n<a;n++)this[r[n].unit](e[r[n].unit])}else if(e=Mn(e),Ra(this[e]))return this[e](t);return this}function KX(e,t){return(e%t+t)%t}var Dt;Array.prototype.indexOf?Dt=Array.prototype.indexOf:Dt=function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1};function M1(e,t){if(isNaN(e)||isNaN(t))return NaN;var r=KX(t,12);return e+=(t-r)/12,r===1?ip(e)?29:28:31-r%7%2}Se("M",["MM",2],"Mo",function(){return this.month()+1});Se("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)});Se("MMMM",0,0,function(e){return this.localeData().months(this,e)});be("M",dt,Jl);be("MM",dt,fn);be("MMM",function(e,t){return t.monthsShortRegex(e)});be("MMMM",function(e,t){return t.monthsRegex(e)});et(["M","MM"],function(e,t){t[Xa]=Le(e)-1});et(["MMM","MMMM"],function(e,t,r,n){var a=r._locale.monthsParse(e,n,r._strict);a!=null?t[Xa]=a:Fe(r).invalidMonth=e});var qX="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),CN="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),NN=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,XX=kf,QX=kf;function JX(e,t){return e?sa(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||NN).test(t)?"format":"standalone"][e.month()]:sa(this._months)?this._months:this._months.standalone}function ZX(e,t){return e?sa(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[NN.test(t)?"format":"standalone"][e.month()]:sa(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function eQ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],n=0;n<12;++n)s=Fa([2e3,n]),this._shortMonthsParse[n]=this.monthsShort(s,"").toLocaleLowerCase(),this._longMonthsParse[n]=this.months(s,"").toLocaleLowerCase();return r?t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null):t==="MMM"?(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:(a=Dt.call(this._longMonthsParse,i),a!==-1?a:null)):(a=Dt.call(this._longMonthsParse,i),a!==-1?a:(a=Dt.call(this._shortMonthsParse,i),a!==-1?a:null))}function tQ(e,t,r){var n,a,s;if(this._monthsParseExact)return eQ.call(this,e,t,r);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),n=0;n<12;n++){if(a=Fa([2e3,n]),r&&!this._longMonthsParse[n]&&(this._longMonthsParse[n]=new RegExp("^"+this.months(a,"").replace(".","")+"$","i"),this._shortMonthsParse[n]=new RegExp("^"+this.monthsShort(a,"").replace(".","")+"$","i")),!r&&!this._monthsParse[n]&&(s="^"+this.months(a,"")+"|^"+this.monthsShort(a,""),this._monthsParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="MMMM"&&this._longMonthsParse[n].test(e))return n;if(r&&t==="MMM"&&this._shortMonthsParse[n].test(e))return n;if(!r&&this._monthsParse[n].test(e))return n}}function AN(e,t){if(!e.isValid())return e;if(typeof t=="string"){if(/^\d+$/.test(t))t=Le(t);else if(t=e.localeData().monthsParse(t),!hs(t))return e}var r=t,n=e.date();return n=n<29?n:Math.min(n,M1(e.year(),r)),e._isUTC?e._d.setUTCMonth(r,n):e._d.setMonth(r,n),e}function ON(e){return e!=null?(AN(this,e),ye.updateOffset(this,!0),this):Uu(this,"Month")}function rQ(){return M1(this.year(),this.month())}function nQ(e){return this._monthsParseExact?(Ke(this,"_monthsRegex")||DN.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(Ke(this,"_monthsShortRegex")||(this._monthsShortRegex=XX),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)}function aQ(e){return this._monthsParseExact?(Ke(this,"_monthsRegex")||DN.call(this),e?this._monthsStrictRegex:this._monthsRegex):(Ke(this,"_monthsRegex")||(this._monthsRegex=QX),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)}function DN(){function e(l,c){return c.length-l.length}var t=[],r=[],n=[],a,s,i,o;for(a=0;a<12;a++)s=Fa([2e3,a]),i=es(this.monthsShort(s,"")),o=es(this.months(s,"")),t.push(i),r.push(o),n.push(o),n.push(i);t.sort(e),r.sort(e),n.sort(e),this._monthsRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+t.join("|")+")","i")}function sQ(e,t,r,n,a,s,i){var o;return e<100&&e>=0?(o=new Date(e+400,t,r,n,a,s,i),isFinite(o.getFullYear())&&o.setFullYear(e)):o=new Date(e,t,r,n,a,s,i),o}function Wu(e){var t,r;return e<100&&e>=0?(r=Array.prototype.slice.call(arguments),r[0]=e+400,t=new Date(Date.UTC.apply(null,r)),isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e)):t=new Date(Date.UTC.apply(null,arguments)),t}function M0(e,t,r){var n=7+t-r,a=(7+Wu(e,0,n).getUTCDay()-t)%7;return-a+n-1}function jN(e,t,r,n,a){var s=(7+r-n)%7,i=M0(e,n,a),o=1+7*(t-1)+s+i,l,c;return o<=0?(l=e-1,c=qc(l)+o):o>qc(e)?(l=e+1,c=o-qc(e)):(l=e,c=o),{year:l,dayOfYear:c}}function Vu(e,t,r){var n=M0(e.year(),t,r),a=Math.floor((e.dayOfYear()-n-1)/7)+1,s,i;return a<1?(i=e.year()-1,s=a+ts(i,t,r)):a>ts(e.year(),t,r)?(s=a-ts(e.year(),t,r),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function ts(e,t,r){var n=M0(e,t,r),a=M0(e+1,t,r);return(qc(e)-n+a)/7}Se("w",["ww",2],"wo","week");Se("W",["WW",2],"Wo","isoWeek");be("w",dt,Jl);be("ww",dt,fn);be("W",dt,Jl);be("WW",dt,fn);Tf(["w","ww","W","WW"],function(e,t,r,n){t[n.substr(0,1)]=Le(e)});function iQ(e){return Vu(e,this._week.dow,this._week.doy).week}var oQ={dow:0,doy:6};function lQ(){return this._week.dow}function cQ(){return this._week.doy}function uQ(e){var t=this.localeData().week(this);return e==null?t:this.add((e-t)*7,"d")}function fQ(e){var t=Vu(this,1,4).week;return e==null?t:this.add((e-t)*7,"d")}Se("d",0,"do","day");Se("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)});Se("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)});Se("dddd",0,0,function(e){return this.localeData().weekdays(this,e)});Se("e",0,0,"weekday");Se("E",0,0,"isoWeekday");be("d",dt);be("e",dt);be("E",dt);be("dd",function(e,t){return t.weekdaysMinRegex(e)});be("ddd",function(e,t){return t.weekdaysShortRegex(e)});be("dddd",function(e,t){return t.weekdaysRegex(e)});Tf(["dd","ddd","dddd"],function(e,t,r,n){var a=r._locale.weekdaysParse(e,n,r._strict);a!=null?t.d=a:Fe(r).invalidWeekday=e});Tf(["d","e","E"],function(e,t,r,n){t[n]=Le(e)});function dQ(e,t){return typeof e!="string"?e:isNaN(e)?(e=t.weekdaysParse(e),typeof e=="number"?e:null):parseInt(e,10)}function hQ(e,t){return typeof e=="string"?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function I1(e,t){return e.slice(t,7).concat(e.slice(0,t))}var pQ="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),PN="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),mQ="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),vQ=kf,gQ=kf,xQ=kf;function yQ(e,t){var r=sa(this._weekdays)?this._weekdays:this._weekdays[e&&e!==!0&&this._weekdays.isFormat.test(t)?"format":"standalone"];return e===!0?I1(r,this._week.dow):e?r[e.day()]:r}function _Q(e){return e===!0?I1(this._weekdaysShort,this._week.dow):e?this._weekdaysShort[e.day()]:this._weekdaysShort}function wQ(e){return e===!0?I1(this._weekdaysMin,this._week.dow):e?this._weekdaysMin[e.day()]:this._weekdaysMin}function bQ(e,t,r){var n,a,s,i=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],n=0;n<7;++n)s=Fa([2e3,1]).day(n),this._minWeekdaysParse[n]=this.weekdaysMin(s,"").toLocaleLowerCase(),this._shortWeekdaysParse[n]=this.weekdaysShort(s,"").toLocaleLowerCase(),this._weekdaysParse[n]=this.weekdays(s,"").toLocaleLowerCase();return r?t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1?a:null):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null):(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null):t==="dddd"?(a=Dt.call(this._weekdaysParse,i),a!==-1||(a=Dt.call(this._shortWeekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):t==="ddd"?(a=Dt.call(this._shortWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._minWeekdaysParse,i),a!==-1?a:null)):(a=Dt.call(this._minWeekdaysParse,i),a!==-1||(a=Dt.call(this._weekdaysParse,i),a!==-1)?a:(a=Dt.call(this._shortWeekdaysParse,i),a!==-1?a:null))}function EQ(e,t,r){var n,a,s;if(this._weekdaysParseExact)return bQ.call(this,e,t,r);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),n=0;n<7;n++){if(a=Fa([2e3,1]).day(n),r&&!this._fullWeekdaysParse[n]&&(this._fullWeekdaysParse[n]=new RegExp("^"+this.weekdays(a,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[n]=new RegExp("^"+this.weekdaysShort(a,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[n]=new RegExp("^"+this.weekdaysMin(a,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[n]||(s="^"+this.weekdays(a,"")+"|^"+this.weekdaysShort(a,"")+"|^"+this.weekdaysMin(a,""),this._weekdaysParse[n]=new RegExp(s.replace(".",""),"i")),r&&t==="dddd"&&this._fullWeekdaysParse[n].test(e))return n;if(r&&t==="ddd"&&this._shortWeekdaysParse[n].test(e))return n;if(r&&t==="dd"&&this._minWeekdaysParse[n].test(e))return n;if(!r&&this._weekdaysParse[n].test(e))return n}}function SQ(e){if(!this.isValid())return e!=null?this:NaN;var t=Uu(this,"Day");return e!=null?(e=dQ(e,this.localeData()),this.add(e-t,"d")):t}function kQ(e){if(!this.isValid())return e!=null?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return e==null?t:this.add(e-t,"d")}function TQ(e){if(!this.isValid())return e!=null?this:NaN;if(e!=null){var t=hQ(e,this.localeData());return this.day(this.day()%7?t:t-7)}else return this.day()||7}function CQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||L1.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(Ke(this,"_weekdaysRegex")||(this._weekdaysRegex=vQ),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)}function NQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||L1.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Ke(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=gQ),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function AQ(e){return this._weekdaysParseExact?(Ke(this,"_weekdaysRegex")||L1.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Ke(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=xQ),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function L1(){function e(f,d){return d.length-f.length}var t=[],r=[],n=[],a=[],s,i,o,l,c;for(s=0;s<7;s++)i=Fa([2e3,1]).day(s),o=es(this.weekdaysMin(i,"")),l=es(this.weekdaysShort(i,"")),c=es(this.weekdays(i,"")),t.push(o),r.push(l),n.push(c),a.push(o),a.push(l),a.push(c);t.sort(e),r.sort(e),n.sort(e),a.sort(e),this._weekdaysRegex=new RegExp("^("+a.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+t.join("|")+")","i")}function $1(){return this.hours()%12||12}function OQ(){return this.hours()||24}Se("H",["HH",2],0,"hour");Se("h",["hh",2],0,$1);Se("k",["kk",2],0,OQ);Se("hmm",0,0,function(){return""+$1.apply(this)+Oa(this.minutes(),2)});Se("hmmss",0,0,function(){return""+$1.apply(this)+Oa(this.minutes(),2)+Oa(this.seconds(),2)});Se("Hmm",0,0,function(){return""+this.hours()+Oa(this.minutes(),2)});Se("Hmmss",0,0,function(){return""+this.hours()+Oa(this.minutes(),2)+Oa(this.seconds(),2)});function FN(e,t){Se(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}FN("a",!0);FN("A",!1);function RN(e,t){return t._meridiemParse}be("a",RN);be("A",RN);be("H",dt,R1);be("h",dt,Jl);be("k",dt,Jl);be("HH",dt,fn);be("hh",dt,fn);be("kk",dt,fn);be("hmm",EN);be("hmmss",SN);be("Hmm",EN);be("Hmmss",SN);et(["H","HH"],Ht);et(["k","kk"],function(e,t,r){var n=Le(e);t[Ht]=n===24?0:n});et(["a","A"],function(e,t,r){r._isPm=r._locale.isPM(e),r._meridiem=e});et(["h","hh"],function(e,t,r){t[Ht]=Le(e),Fe(r).bigHour=!0});et("hmm",function(e,t,r){var n=e.length-2;t[Ht]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n)),Fe(r).bigHour=!0});et("hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Ht]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n,2)),t[Qa]=Le(e.substr(a)),Fe(r).bigHour=!0});et("Hmm",function(e,t,r){var n=e.length-2;t[Ht]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n))});et("Hmmss",function(e,t,r){var n=e.length-4,a=e.length-2;t[Ht]=Le(e.substr(0,n)),t[Kn]=Le(e.substr(n,2)),t[Qa]=Le(e.substr(a))});function DQ(e){return(e+"").toLowerCase().charAt(0)==="p"}var jQ=/[ap]\.?m?\.?/i,PQ=Zl("Hours",!0);function FQ(e,t,r){return e>11?r?"pm":"PM":r?"am":"AM"}var MN={calendar:bX,longDateFormat:TX,invalidDate:NX,ordinal:OX,dayOfMonthOrdinalParse:DX,relativeTime:PX,months:qX,monthsShort:CN,week:oQ,weekdays:pQ,weekdaysMin:mQ,weekdaysShort:PN,meridiemParse:jQ},pt={},wc={},Hu;function RQ(e,t){var r,n=Math.min(e.length,t.length);for(r=0;r<n;r+=1)if(e[r]!==t[r])return r;return n}function Z2(e){return e&&e.toLowerCase().replace("_","-")}function MQ(e){for(var t=0,r,n,a,s;t<e.length;){for(s=Z2(e[t]).split("-"),r=s.length,n=Z2(e[t+1]),n=n?n.split("-"):null;r>0;){if(a=op(s.slice(0,r).join("-")),a)return a;if(n&&n.length>=r&&RQ(s,n)>=r-1)break;r--}t++}return Hu}function IQ(e){return!!(e&&e.match("^[^/\\\\]*$"))}function op(e){var t=null,r;if(pt[e]===void 0&&typeof module<"u"&&module&&module.exports&&IQ(e))try{t=Hu._abbr,r=require,r("./locale/"+e),Js(t)}catch{pt[e]=null}return pt[e]}function Js(e,t){var r;return e&&($r(t)?r=xs(e):r=B1(e,t),r?Hu=r:typeof console<"u"&&console.warn&&console.warn("Locale "+e+" not found. Did you forget to load it?")),Hu._abbr}function B1(e,t){if(t!==null){var r,n=MN;if(t.abbr=e,pt[e]!=null)yN("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=pt[e]._config;else if(t.parentLocale!=null)if(pt[t.parentLocale]!=null)n=pt[t.parentLocale]._config;else if(r=op(t.parentLocale),r!=null)n=r._config;else return wc[t.parentLocale]||(wc[t.parentLocale]=[]),wc[t.parentLocale].push({name:e,config:t}),null;return pt[e]=new O1(ig(n,t)),wc[e]&&wc[e].forEach(function(a){B1(a.name,a.config)}),Js(e),pt[e]}else return delete pt[e],null}function LQ(e,t){if(t!=null){var r,n,a=MN;pt[e]!=null&&pt[e].parentLocale!=null?pt[e].set(ig(pt[e]._config,t)):(n=op(e),n!=null&&(a=n._config),t=ig(a,t),n==null&&(t.abbr=e),r=new O1(t),r.parentLocale=pt[e],pt[e]=r),Js(e)}else pt[e]!=null&&(pt[e].parentLocale!=null?(pt[e]=pt[e].parentLocale,e===Js()&&Js(e)):pt[e]!=null&&delete pt[e]);return pt[e]}function xs(e){var t;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Hu;if(!sa(e)){if(t=op(e),t)return t;e=[e]}return MQ(e)}function $Q(){return og(pt)}function U1(e){var t,r=e._a;return r&&Fe(e).overflow===-2&&(t=r[Xa]<0||r[Xa]>11?Xa:r[ya]<1||r[ya]>M1(r[yr],r[Xa])?ya:r[Ht]<0||r[Ht]>24||r[Ht]===24&&(r[Kn]!==0||r[Qa]!==0||r[Di]!==0)?Ht:r[Kn]<0||r[Kn]>59?Kn:r[Qa]<0||r[Qa]>59?Qa:r[Di]<0||r[Di]>999?Di:-1,Fe(e)._overflowDayOfYear&&(t<yr||t>ya)&&(t=ya),Fe(e)._overflowWeeks&&t===-1&&(t=VX),Fe(e)._overflowWeekday&&t===-1&&(t=HX),Fe(e).overflow=t),e}var BQ=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,UQ=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,WQ=/Z|[+-]\d\d(?::?\d\d)?/,hd=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],wm=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],VQ=/^\/?Date\((-?\d+)/i,HQ=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,zQ={UT:0,GMT:0,EDT:-4*60,EST:-5*60,CDT:-5*60,CST:-6*60,MDT:-6*60,MST:-7*60,PDT:-7*60,PST:-8*60};function IN(e){var t,r,n=e._i,a=BQ.exec(n)||UQ.exec(n),s,i,o,l,c=hd.length,f=wm.length;if(a){for(Fe(e).iso=!0,t=0,r=c;t<r;t++)if(hd[t][1].exec(a[1])){i=hd[t][0],s=hd[t][2]!==!1;break}if(i==null){e._isValid=!1;return}if(a[3]){for(t=0,r=f;t<r;t++)if(wm[t][1].exec(a[3])){o=(a[2]||" ")+wm[t][0];break}if(o==null){e._isValid=!1;return}}if(!s&&o!=null){e._isValid=!1;return}if(a[4])if(WQ.exec(a[4]))l="Z";else{e._isValid=!1;return}e._f=i+(o||"")+(l||""),V1(e)}else e._isValid=!1}function YQ(e,t,r,n,a,s){var i=[GQ(e),CN.indexOf(t),parseInt(r,10),parseInt(n,10),parseInt(a,10)];return s&&i.push(parseInt(s,10)),i}function GQ(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function KQ(e){return e.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function qQ(e,t,r){if(e){var n=PN.indexOf(e),a=new Date(t[0],t[1],t[2]).getDay();if(n!==a)return Fe(r).weekdayMismatch=!0,r._isValid=!1,!1}return!0}function XQ(e,t,r){if(e)return zQ[e];if(t)return 0;var n=parseInt(r,10),a=n%100,s=(n-a)/100;return s*60+a}function LN(e){var t=HQ.exec(KQ(e._i)),r;if(t){if(r=YQ(t[4],t[3],t[2],t[5],t[6],t[7]),!qQ(t[1],r,e))return;e._a=r,e._tzm=XQ(t[8],t[9],t[10]),e._d=Wu.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),Fe(e).rfc2822=!0}else e._isValid=!1}function QQ(e){var t=VQ.exec(e._i);if(t!==null){e._d=new Date(+t[1]);return}if(IN(e),e._isValid===!1)delete e._isValid;else return;if(LN(e),e._isValid===!1)delete e._isValid;else return;e._strict?e._isValid=!1:ye.createFromInputFallback(e)}ye.createFromInputFallback=Rn("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))});function jo(e,t,r){return e??t??r}function JQ(e){var t=new Date(ye.now());return e._useUTC?[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()]:[t.getFullYear(),t.getMonth(),t.getDate()]}function W1(e){var t,r,n=[],a,s,i;if(!e._d){for(a=JQ(e),e._w&&e._a[ya]==null&&e._a[Xa]==null&&ZQ(e),e._dayOfYear!=null&&(i=jo(e._a[yr],a[yr]),(e._dayOfYear>qc(i)||e._dayOfYear===0)&&(Fe(e)._overflowDayOfYear=!0),r=Wu(i,0,e._dayOfYear),e._a[Xa]=r.getUTCMonth(),e._a[ya]=r.getUTCDate()),t=0;t<3&&e._a[t]==null;++t)e._a[t]=n[t]=a[t];for(;t<7;t++)e._a[t]=n[t]=e._a[t]==null?t===2?1:0:e._a[t];e._a[Ht]===24&&e._a[Kn]===0&&e._a[Qa]===0&&e._a[Di]===0&&(e._nextDay=!0,e._a[Ht]=0),e._d=(e._useUTC?Wu:sQ).apply(null,n),s=e._useUTC?e._d.getUTCDay():e._d.getDay(),e._tzm!=null&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[Ht]=24),e._w&&typeof e._w.d<"u"&&e._w.d!==s&&(Fe(e).weekdayMismatch=!0)}}function ZQ(e){var t,r,n,a,s,i,o,l,c;t=e._w,t.GG!=null||t.W!=null||t.E!=null?(s=1,i=4,r=jo(t.GG,e._a[yr],Vu(ft(),1,4).year),n=jo(t.W,1),a=jo(t.E,1),(a<1||a>7)&&(l=!0)):(s=e._locale._week.dow,i=e._locale._week.doy,c=Vu(ft(),s,i),r=jo(t.gg,e._a[yr],c.year),n=jo(t.w,c.week),t.d!=null?(a=t.d,(a<0||a>6)&&(l=!0)):t.e!=null?(a=t.e+s,(t.e<0||t.e>6)&&(l=!0)):a=s),n<1||n>ts(r,s,i)?Fe(e)._overflowWeeks=!0:l!=null?Fe(e)._overflowWeekday=!0:(o=jN(r,n,a,s,i),e._a[yr]=o.year,e._dayOfYear=o.dayOfYear)}ye.ISO_8601=function(){};ye.RFC_2822=function(){};function V1(e){if(e._f===ye.ISO_8601){IN(e);return}if(e._f===ye.RFC_2822){LN(e);return}e._a=[],Fe(e).empty=!0;var t=""+e._i,r,n,a,s,i,o=t.length,l=0,c,f;for(a=_N(e._f,e._locale).match(D1)||[],f=a.length,r=0;r<f;r++)s=a[r],n=(t.match(BX(s,e))||[])[0],n&&(i=t.substr(0,t.indexOf(n)),i.length>0&&Fe(e).unusedInput.push(i),t=t.slice(t.indexOf(n)+n.length),l+=n.length),sl[s]?(n?Fe(e).empty=!1:Fe(e).unusedTokens.push(s),WX(s,n,e)):e._strict&&!n&&Fe(e).unusedTokens.push(s);Fe(e).charsLeftOver=o-l,t.length>0&&Fe(e).unusedInput.push(t),e._a[Ht]<=12&&Fe(e).bigHour===!0&&e._a[Ht]>0&&(Fe(e).bigHour=void 0),Fe(e).parsedDateParts=e._a.slice(0),Fe(e).meridiem=e._meridiem,e._a[Ht]=eJ(e._locale,e._a[Ht],e._meridiem),c=Fe(e).era,c!==null&&(e._a[yr]=e._locale.erasConvertYear(c,e._a[yr])),W1(e),U1(e)}function eJ(e,t,r){var n;return r==null?t:e.meridiemHour!=null?e.meridiemHour(t,r):(e.isPM!=null&&(n=e.isPM(r),n&&t<12&&(t+=12),!n&&t===12&&(t=0)),t)}function tJ(e){var t,r,n,a,s,i,o=!1,l=e._f.length;if(l===0){Fe(e).invalidFormat=!0,e._d=new Date(NaN);return}for(a=0;a<l;a++)s=0,i=!1,t=A1({},e),e._useUTC!=null&&(t._useUTC=e._useUTC),t._f=e._f[a],V1(t),N1(t)&&(i=!0),s+=Fe(t).charsLeftOver,s+=Fe(t).unusedTokens.length*10,Fe(t).score=s,o?s<n&&(n=s,r=t):(n==null||s<n||i)&&(n=s,r=t,i&&(o=!0));Ls(e,r||t)}function rJ(e){if(!e._d){var t=j1(e._i),r=t.day===void 0?t.date:t.day;e._a=gN([t.year,t.month,r,t.hour,t.minute,t.second,t.millisecond],function(n){return n&&parseInt(n,10)}),W1(e)}}function nJ(e){var t=new Sf(U1($N(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function $N(e){var t=e._i,r=e._f;return e._locale=e._locale||xs(e._l),t===null||r===void 0&&t===""?ep({nullInput:!0}):(typeof t=="string"&&(e._i=t=e._locale.preparse(t)),ia(t)?new Sf(U1(t)):(Ef(t)?e._d=t:sa(r)?tJ(e):r?V1(e):aJ(e),N1(e)||(e._d=null),e))}function aJ(e){var t=e._i;$r(t)?e._d=new Date(ye.now()):Ef(t)?e._d=new Date(t.valueOf()):typeof t=="string"?QQ(e):sa(t)?(e._a=gN(t.slice(0),function(r){return parseInt(r,10)}),W1(e)):Ii(t)?rJ(e):hs(t)?e._d=new Date(t):ye.createFromInputFallback(e)}function BN(e,t,r,n,a){var s={};return(t===!0||t===!1)&&(n=t,t=void 0),(r===!0||r===!1)&&(n=r,r=void 0),(Ii(e)&&C1(e)||sa(e)&&e.length===0)&&(e=void 0),s._isAMomentObject=!0,s._useUTC=s._isUTC=a,s._l=r,s._i=e,s._f=t,s._strict=n,nJ(s)}function ft(e,t,r,n){return BN(e,t,r,n,!1)}var sJ=Rn("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:ep()}),iJ=Rn("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=ft.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:ep()});function UN(e,t){var r,n;if(t.length===1&&sa(t[0])&&(t=t[0]),!t.length)return ft();for(r=t[0],n=1;n<t.length;++n)(!t[n].isValid()||t[n][e](r))&&(r=t[n]);return r}function oJ(){var e=[].slice.call(arguments,0);return UN("isBefore",e)}function lJ(){var e=[].slice.call(arguments,0);return UN("isAfter",e)}var cJ=function(){return Date.now?Date.now():+new Date},bc=["year","quarter","month","week","day","hour","minute","second","millisecond"];function uJ(e){var t,r=!1,n,a=bc.length;for(t in e)if(Ke(e,t)&&!(Dt.call(bc,t)!==-1&&(e[t]==null||!isNaN(e[t]))))return!1;for(n=0;n<a;++n)if(e[bc[n]]){if(r)return!1;parseFloat(e[bc[n]])!==Le(e[bc[n]])&&(r=!0)}return!0}function fJ(){return this._isValid}function dJ(){return ca(NaN)}function lp(e){var t=j1(e),r=t.year||0,n=t.quarter||0,a=t.month||0,s=t.week||t.isoWeek||0,i=t.day||0,o=t.hour||0,l=t.minute||0,c=t.second||0,f=t.millisecond||0;this._isValid=uJ(t),this._milliseconds=+f+c*1e3+l*6e4+o*1e3*60*60,this._days=+i+s*7,this._months=+a+n*3+r*12,this._data={},this._locale=xs(),this._bubble()}function Hd(e){return e instanceof lp}function cg(e){return e<0?Math.round(-1*e)*-1:Math.round(e)}function hJ(e,t,r){var n=Math.min(e.length,t.length),a=Math.abs(e.length-t.length),s=0,i;for(i=0;i<n;i++)Le(e[i])!==Le(t[i])&&s++;return s+a}function WN(e,t){Se(e,0,0,function(){var r=this.utcOffset(),n="+";return r<0&&(r=-r,n="-"),n+Oa(~~(r/60),2)+t+Oa(~~r%60,2)})}WN("Z",":");WN("ZZ","");be("Z",sp);be("ZZ",sp);et(["Z","ZZ"],function(e,t,r){r._useUTC=!0,r._tzm=H1(sp,e)});var pJ=/([\+\-]|\d\d)/gi;function H1(e,t){var r=(t||"").match(e),n,a,s;return r===null?null:(n=r[r.length-1]||[],a=(n+"").match(pJ)||["-",0,0],s=+(a[1]*60)+Le(a[2]),s===0?0:a[0]==="+"?s:-s)}function z1(e,t){var r,n;return t._isUTC?(r=t.clone(),n=(ia(e)||Ef(e)?e.valueOf():ft(e).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+n),ye.updateOffset(r,!1),r):ft(e).local()}function ug(e){return-Math.round(e._d.getTimezoneOffset())}ye.updateOffset=function(){};function mJ(e,t,r){var n=this._offset||0,a;if(!this.isValid())return e!=null?this:NaN;if(e!=null){if(typeof e=="string"){if(e=H1(sp,e),e===null)return this}else Math.abs(e)<16&&!r&&(e=e*60);return!this._isUTC&&t&&(a=ug(this)),this._offset=e,this._isUTC=!0,a!=null&&this.add(a,"m"),n!==e&&(!t||this._changeInProgress?zN(this,ca(e-n,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,ye.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?n:ug(this)}function vJ(e,t){return e!=null?(typeof e!="string"&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}function gJ(e){return this.utcOffset(0,e)}function xJ(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(ug(this),"m")),this}function yJ(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var e=H1(LX,this._i);e!=null?this.utcOffset(e):this.utcOffset(0,!0)}return this}function _J(e){return this.isValid()?(e=e?ft(e).utcOffset():0,(this.utcOffset()-e)%60===0):!1}function wJ(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function bJ(){if(!$r(this._isDSTShifted))return this._isDSTShifted;var e={},t;return A1(e,this),e=$N(e),e._a?(t=e._isUTC?Fa(e._a):ft(e._a),this._isDSTShifted=this.isValid()&&hJ(e._a,t.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function EJ(){return this.isValid()?!this._isUTC:!1}function SJ(){return this.isValid()?this._isUTC:!1}function VN(){return this.isValid()?this._isUTC&&this._offset===0:!1}var kJ=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,TJ=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ca(e,t){var r=e,n=null,a,s,i;return Hd(e)?r={ms:e._milliseconds,d:e._days,M:e._months}:hs(e)||!isNaN(+e)?(r={},t?r[t]=+e:r.milliseconds=+e):(n=kJ.exec(e))?(a=n[1]==="-"?-1:1,r={y:0,d:Le(n[ya])*a,h:Le(n[Ht])*a,m:Le(n[Kn])*a,s:Le(n[Qa])*a,ms:Le(cg(n[Di]*1e3))*a}):(n=TJ.exec(e))?(a=n[1]==="-"?-1:1,r={y:_i(n[2],a),M:_i(n[3],a),w:_i(n[4],a),d:_i(n[5],a),h:_i(n[6],a),m:_i(n[7],a),s:_i(n[8],a)}):r==null?r={}:typeof r=="object"&&("from"in r||"to"in r)&&(i=CJ(ft(r.from),ft(r.to)),r={},r.ms=i.milliseconds,r.M=i.months),s=new lp(r),Hd(e)&&Ke(e,"_locale")&&(s._locale=e._locale),Hd(e)&&Ke(e,"_isValid")&&(s._isValid=e._isValid),s}ca.fn=lp.prototype;ca.invalid=dJ;function _i(e,t){var r=e&&parseFloat(e.replace(",","."));return(isNaN(r)?0:r)*t}function eb(e,t){var r={};return r.months=t.month()-e.month()+(t.year()-e.year())*12,e.clone().add(r.months,"M").isAfter(t)&&--r.months,r.milliseconds=+t-+e.clone().add(r.months,"M"),r}function CJ(e,t){var r;return e.isValid()&&t.isValid()?(t=z1(t,e),e.isBefore(t)?r=eb(e,t):(r=eb(t,e),r.milliseconds=-r.milliseconds,r.months=-r.months),r):{milliseconds:0,months:0}}function HN(e,t){return function(r,n){var a,s;return n!==null&&!isNaN(+n)&&(yN(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),s=r,r=n,n=s),a=ca(r,n),zN(this,a,e),this}}function zN(e,t,r,n){var a=t._milliseconds,s=cg(t._days),i=cg(t._months);e.isValid()&&(n=n??!0,i&&AN(e,Uu(e,"Month")+i*r),s&&TN(e,"Date",Uu(e,"Date")+s*r),a&&e._d.setTime(e._d.valueOf()+a*r),n&&ye.updateOffset(e,s||i))}var NJ=HN(1,"add"),AJ=HN(-1,"subtract");function YN(e){return typeof e=="string"||e instanceof String}function OJ(e){return ia(e)||Ef(e)||YN(e)||hs(e)||jJ(e)||DJ(e)||e===null||e===void 0}function DJ(e){var t=Ii(e)&&!C1(e),r=!1,n=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],a,s,i=n.length;for(a=0;a<i;a+=1)s=n[a],r=r||Ke(e,s);return t&&r}function jJ(e){var t=sa(e),r=!1;return t&&(r=e.filter(function(n){return!hs(n)&&YN(e)}).length===0),t&&r}function PJ(e){var t=Ii(e)&&!C1(e),r=!1,n=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],a,s;for(a=0;a<n.length;a+=1)s=n[a],r=r||Ke(e,s);return t&&r}function FJ(e,t){var r=e.diff(t,"days",!0);return r<-6?"sameElse":r<-1?"lastWeek":r<0?"lastDay":r<1?"sameDay":r<2?"nextDay":r<7?"nextWeek":"sameElse"}function RJ(e,t){arguments.length===1&&(arguments[0]?OJ(arguments[0])?(e=arguments[0],t=void 0):PJ(arguments[0])&&(t=arguments[0],e=void 0):(e=void 0,t=void 0));var r=e||ft(),n=z1(r,this).startOf("day"),a=ye.calendarFormat(this,n)||"sameElse",s=t&&(Ra(t[a])?t[a].call(this,r):t[a]);return this.format(s||this.localeData().calendar(a,this,ft(r)))}function MJ(){return new Sf(this)}function IJ(e,t){var r=ia(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()>r.valueOf():r.valueOf()<this.clone().startOf(t).valueOf()):!1}function LJ(e,t){var r=ia(e)?e:ft(e);return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()<r.valueOf():this.clone().endOf(t).valueOf()<r.valueOf()):!1}function $J(e,t,r,n){var a=ia(e)?e:ft(e),s=ia(t)?t:ft(t);return this.isValid()&&a.isValid()&&s.isValid()?(n=n||"()",(n[0]==="("?this.isAfter(a,r):!this.isBefore(a,r))&&(n[1]===")"?this.isBefore(s,r):!this.isAfter(s,r))):!1}function BJ(e,t){var r=ia(e)?e:ft(e),n;return this.isValid()&&r.isValid()?(t=Mn(t)||"millisecond",t==="millisecond"?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf())):!1}function UJ(e,t){return this.isSame(e,t)||this.isAfter(e,t)}function WJ(e,t){return this.isSame(e,t)||this.isBefore(e,t)}function VJ(e,t,r){var n,a,s;if(!this.isValid())return NaN;if(n=z1(e,this),!n.isValid())return NaN;switch(a=(n.utcOffset()-this.utcOffset())*6e4,t=Mn(t),t){case"year":s=zd(this,n)/12;break;case"month":s=zd(this,n);break;case"quarter":s=zd(this,n)/3;break;case"second":s=(this-n)/1e3;break;case"minute":s=(this-n)/6e4;break;case"hour":s=(this-n)/36e5;break;case"day":s=(this-n-a)/864e5;break;case"week":s=(this-n-a)/6048e5;break;default:s=this-n}return r?s:_n(s)}function zd(e,t){if(e.date()<t.date())return-zd(t,e);var r=(t.year()-e.year())*12+(t.month()-e.month()),n=e.clone().add(r,"months"),a,s;return t-n<0?(a=e.clone().add(r-1,"months"),s=(t-n)/(n-a)):(a=e.clone().add(r+1,"months"),s=(t-n)/(a-n)),-(r+s)||0}ye.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";ye.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function HJ(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function zJ(e){if(!this.isValid())return null;var t=e!==!0,r=t?this.clone().utc():this;return r.year()<0||r.year()>9999?Vd(r,t?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):Ra(Date.prototype.toISOString)?t?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",Vd(r,"Z")):Vd(r,t?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function YJ(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="",r,n,a,s;return this.isLocal()||(e=this.utcOffset()===0?"moment.utc":"moment.parseZone",t="Z"),r="["+e+'("]',n=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",a="-MM-DD[T]HH:mm:ss.SSS",s=t+'[")]',this.format(r+n+a+s)}function GJ(e){e||(e=this.isUtc()?ye.defaultFormatUtc:ye.defaultFormat);var t=Vd(this,e);return this.localeData().postformat(t)}function KJ(e,t){return this.isValid()&&(ia(e)&&e.isValid()||ft(e).isValid())?ca({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function qJ(e){return this.from(ft(),e)}function XJ(e,t){return this.isValid()&&(ia(e)&&e.isValid()||ft(e).isValid())?ca({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()}function QJ(e){return this.to(ft(),e)}function GN(e){var t;return e===void 0?this._locale._abbr:(t=xs(e),t!=null&&(this._locale=t),this)}var KN=Rn("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return e===void 0?this.localeData():this.locale(e)});function qN(){return this._locale}var I0=1e3,il=60*I0,L0=60*il,XN=(365*400+97)*24*L0;function ol(e,t){return(e%t+t)%t}function QN(e,t,r){return e<100&&e>=0?new Date(e+400,t,r)-XN:new Date(e,t,r).valueOf()}function JN(e,t,r){return e<100&&e>=0?Date.UTC(e+400,t,r)-XN:Date.UTC(e,t,r)}function JJ(e){var t,r;if(e=Mn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?JN:QN,e){case"year":t=r(this.year(),0,1);break;case"quarter":t=r(this.year(),this.month()-this.month()%3,1);break;case"month":t=r(this.year(),this.month(),1);break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":t=r(this.year(),this.month(),this.date());break;case"hour":t=this._d.valueOf(),t-=ol(t+(this._isUTC?0:this.utcOffset()*il),L0);break;case"minute":t=this._d.valueOf(),t-=ol(t,il);break;case"second":t=this._d.valueOf(),t-=ol(t,I0);break}return this._d.setTime(t),ye.updateOffset(this,!0),this}function ZJ(e){var t,r;if(e=Mn(e),e===void 0||e==="millisecond"||!this.isValid())return this;switch(r=this._isUTC?JN:QN,e){case"year":t=r(this.year()+1,0,1)-1;break;case"quarter":t=r(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":t=r(this.year(),this.month()+1,1)-1;break;case"week":t=r(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":t=r(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":t=r(this.year(),this.month(),this.date()+1)-1;break;case"hour":t=this._d.valueOf(),t+=L0-ol(t+(this._isUTC?0:this.utcOffset()*il),L0)-1;break;case"minute":t=this._d.valueOf(),t+=il-ol(t,il)-1;break;case"second":t=this._d.valueOf(),t+=I0-ol(t,I0)-1;break}return this._d.setTime(t),ye.updateOffset(this,!0),this}function eZ(){return this._d.valueOf()-(this._offset||0)*6e4}function tZ(){return Math.floor(this.valueOf()/1e3)}function rZ(){return new Date(this.valueOf())}function nZ(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]}function aZ(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}}function sZ(){return this.isValid()?this.toISOString():null}function iZ(){return N1(this)}function oZ(){return Ls({},Fe(this))}function lZ(){return Fe(this).overflow}function cZ(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Se("N",0,0,"eraAbbr");Se("NN",0,0,"eraAbbr");Se("NNN",0,0,"eraAbbr");Se("NNNN",0,0,"eraName");Se("NNNNN",0,0,"eraNarrow");Se("y",["y",1],"yo","eraYear");Se("y",["yy",2],0,"eraYear");Se("y",["yyy",3],0,"eraYear");Se("y",["yyyy",4],0,"eraYear");be("N",Y1);be("NN",Y1);be("NNN",Y1);be("NNNN",_Z);be("NNNNN",wZ);et(["N","NN","NNN","NNNN","NNNNN"],function(e,t,r,n){var a=r._locale.erasParse(e,n,r._strict);a?Fe(r).era=a:Fe(r).invalidEra=e});be("y",Ql);be("yy",Ql);be("yyy",Ql);be("yyyy",Ql);be("yo",bZ);et(["y","yy","yyy","yyyy"],yr);et(["yo"],function(e,t,r,n){var a;r._locale._eraYearOrdinalRegex&&(a=e.match(r._locale._eraYearOrdinalRegex)),r._locale.eraYearOrdinalParse?t[yr]=r._locale.eraYearOrdinalParse(e,a):t[yr]=parseInt(e,10)});function uZ(e,t){var r,n,a,s=this._eras||xs("en")._eras;for(r=0,n=s.length;r<n;++r){switch(typeof s[r].since){case"string":a=ye(s[r].since).startOf("day"),s[r].since=a.valueOf();break}switch(typeof s[r].until){case"undefined":s[r].until=1/0;break;case"string":a=ye(s[r].until).startOf("day").valueOf(),s[r].until=a.valueOf();break}}return s}function fZ(e,t,r){var n,a,s=this.eras(),i,o,l;for(e=e.toUpperCase(),n=0,a=s.length;n<a;++n)if(i=s[n].name.toUpperCase(),o=s[n].abbr.toUpperCase(),l=s[n].narrow.toUpperCase(),r)switch(t){case"N":case"NN":case"NNN":if(o===e)return s[n];break;case"NNNN":if(i===e)return s[n];break;case"NNNNN":if(l===e)return s[n];break}else if([i,o,l].indexOf(e)>=0)return s[n]}function dZ(e,t){var r=e.since<=e.until?1:-1;return t===void 0?ye(e.since).year():ye(e.since).year()+(t-e.offset)*r}function hZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].name;return""}function pZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].narrow;return""}function mZ(){var e,t,r,n=this.localeData().eras();for(e=0,t=n.length;e<t;++e)if(r=this.clone().startOf("day").valueOf(),n[e].since<=r&&r<=n[e].until||n[e].until<=r&&r<=n[e].since)return n[e].abbr;return""}function vZ(){var e,t,r,n,a=this.localeData().eras();for(e=0,t=a.length;e<t;++e)if(r=a[e].since<=a[e].until?1:-1,n=this.clone().startOf("day").valueOf(),a[e].since<=n&&n<=a[e].until||a[e].until<=n&&n<=a[e].since)return(this.year()-ye(a[e].since).year())*r+a[e].offset;return this.year()}function gZ(e){return Ke(this,"_erasNameRegex")||G1.call(this),e?this._erasNameRegex:this._erasRegex}function xZ(e){return Ke(this,"_erasAbbrRegex")||G1.call(this),e?this._erasAbbrRegex:this._erasRegex}function yZ(e){return Ke(this,"_erasNarrowRegex")||G1.call(this),e?this._erasNarrowRegex:this._erasRegex}function Y1(e,t){return t.erasAbbrRegex(e)}function _Z(e,t){return t.erasNameRegex(e)}function wZ(e,t){return t.erasNarrowRegex(e)}function bZ(e,t){return t._eraYearOrdinalRegex||Ql}function G1(){var e=[],t=[],r=[],n=[],a,s,i,o,l,c=this.eras();for(a=0,s=c.length;a<s;++a)i=es(c[a].name),o=es(c[a].abbr),l=es(c[a].narrow),t.push(i),e.push(o),r.push(l),n.push(i),n.push(o),n.push(l);this._erasRegex=new RegExp("^("+n.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+t.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+e.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+r.join("|")+")","i")}Se(0,["gg",2],0,function(){return this.weekYear()%100});Se(0,["GG",2],0,function(){return this.isoWeekYear()%100});function cp(e,t){Se(0,[e,e.length],0,t)}cp("gggg","weekYear");cp("ggggg","weekYear");cp("GGGG","isoWeekYear");cp("GGGGG","isoWeekYear");be("G",ap);be("g",ap);be("GG",dt,fn);be("gg",dt,fn);be("GGGG",F1,P1);be("gggg",F1,P1);be("GGGGG",np,tp);be("ggggg",np,tp);Tf(["gggg","ggggg","GGGG","GGGGG"],function(e,t,r,n){t[n.substr(0,2)]=Le(e)});Tf(["gg","GG"],function(e,t,r,n){t[n]=ye.parseTwoDigitYear(e)});function EZ(e){return ZN.call(this,e,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function SZ(e){return ZN.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)}function kZ(){return ts(this.year(),1,4)}function TZ(){return ts(this.isoWeekYear(),1,4)}function CZ(){var e=this.localeData()._week;return ts(this.year(),e.dow,e.doy)}function NZ(){var e=this.localeData()._week;return ts(this.weekYear(),e.dow,e.doy)}function ZN(e,t,r,n,a){var s;return e==null?Vu(this,n,a).year:(s=ts(e,n,a),t>s&&(t=s),AZ.call(this,e,t,r,n,a))}function AZ(e,t,r,n,a){var s=jN(e,t,r,n,a),i=Wu(s.year,0,s.dayOfYear);return this.year(i.getUTCFullYear()),this.month(i.getUTCMonth()),this.date(i.getUTCDate()),this}Se("Q",0,"Qo","quarter");be("Q",wN);et("Q",function(e,t){t[Xa]=(Le(e)-1)*3});function OZ(e){return e==null?Math.ceil((this.month()+1)/3):this.month((e-1)*3+this.month()%3)}Se("D",["DD",2],"Do","date");be("D",dt,Jl);be("DD",dt,fn);be("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient});et(["D","DD"],ya);et("Do",function(e,t){t[ya]=Le(e.match(dt)[0])});var e4=Zl("Date",!0);Se("DDD",["DDDD",3],"DDDo","dayOfYear");be("DDD",rp);be("DDDD",bN);et(["DDD","DDDD"],function(e,t,r){r._dayOfYear=Le(e)});function DZ(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return e==null?t:this.add(e-t,"d")}Se("m",["mm",2],0,"minute");be("m",dt,R1);be("mm",dt,fn);et(["m","mm"],Kn);var jZ=Zl("Minutes",!1);Se("s",["ss",2],0,"second");be("s",dt,R1);be("ss",dt,fn);et(["s","ss"],Qa);var PZ=Zl("Seconds",!1);Se("S",0,0,function(){return~~(this.millisecond()/100)});Se(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Se(0,["SSS",3],0,"millisecond");Se(0,["SSSS",4],0,function(){return this.millisecond()*10});Se(0,["SSSSS",5],0,function(){return this.millisecond()*100});Se(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Se(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Se(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Se(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});be("S",rp,wN);be("SS",rp,fn);be("SSS",rp,bN);var $s,t4;for($s="SSSS";$s.length<=9;$s+="S")be($s,Ql);function FZ(e,t){t[Di]=Le(("0."+e)*1e3)}for($s="S";$s.length<=9;$s+="S")et($s,FZ);t4=Zl("Milliseconds",!1);Se("z",0,0,"zoneAbbr");Se("zz",0,0,"zoneName");function RZ(){return this._isUTC?"UTC":""}function MZ(){return this._isUTC?"Coordinated Universal Time":""}var he=Sf.prototype;he.add=NJ;he.calendar=RJ;he.clone=MJ;he.diff=VJ;he.endOf=ZJ;he.format=GJ;he.from=KJ;he.fromNow=qJ;he.to=XJ;he.toNow=QJ;he.get=YX;he.invalidAt=lZ;he.isAfter=IJ;he.isBefore=LJ;he.isBetween=$J;he.isSame=BJ;he.isSameOrAfter=UJ;he.isSameOrBefore=WJ;he.isValid=iZ;he.lang=KN;he.locale=GN;he.localeData=qN;he.max=iJ;he.min=sJ;he.parsingFlags=oZ;he.set=GX;he.startOf=JJ;he.subtract=AJ;he.toArray=nZ;he.toObject=aZ;he.toDate=rZ;he.toISOString=zJ;he.inspect=YJ;typeof Symbol<"u"&&Symbol.for!=null&&(he[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});he.toJSON=sZ;he.toString=HJ;he.unix=tZ;he.valueOf=eZ;he.creationData=cZ;he.eraName=hZ;he.eraNarrow=pZ;he.eraAbbr=mZ;he.eraYear=vZ;he.year=kN;he.isLeapYear=zX;he.weekYear=EZ;he.isoWeekYear=SZ;he.quarter=he.quarters=OZ;he.month=ON;he.daysInMonth=rQ;he.week=he.weeks=uQ;he.isoWeek=he.isoWeeks=fQ;he.weeksInYear=CZ;he.weeksInWeekYear=NZ;he.isoWeeksInYear=kZ;he.isoWeeksInISOWeekYear=TZ;he.date=e4;he.day=he.days=SQ;he.weekday=kQ;he.isoWeekday=TQ;he.dayOfYear=DZ;he.hour=he.hours=PQ;he.minute=he.minutes=jZ;he.second=he.seconds=PZ;he.millisecond=he.milliseconds=t4;he.utcOffset=mJ;he.utc=gJ;he.local=xJ;he.parseZone=yJ;he.hasAlignedHourOffset=_J;he.isDST=wJ;he.isLocal=EJ;he.isUtcOffset=SJ;he.isUtc=VN;he.isUTC=VN;he.zoneAbbr=RZ;he.zoneName=MZ;he.dates=Rn("dates accessor is deprecated. Use date instead.",e4);he.months=Rn("months accessor is deprecated. Use month instead",ON);he.years=Rn("years accessor is deprecated. Use year instead",kN);he.zone=Rn("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",vJ);he.isDSTShifted=Rn("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",bJ);function IZ(e){return ft(e*1e3)}function LZ(){return ft.apply(null,arguments).parseZone()}function r4(e){return e}var qe=O1.prototype;qe.calendar=EX;qe.longDateFormat=CX;qe.invalidDate=AX;qe.ordinal=jX;qe.preparse=r4;qe.postformat=r4;qe.relativeTime=FX;qe.pastFuture=RX;qe.set=wX;qe.eras=uZ;qe.erasParse=fZ;qe.erasConvertYear=dZ;qe.erasAbbrRegex=xZ;qe.erasNameRegex=gZ;qe.erasNarrowRegex=yZ;qe.months=JX;qe.monthsShort=ZX;qe.monthsParse=tQ;qe.monthsRegex=aQ;qe.monthsShortRegex=nQ;qe.week=iQ;qe.firstDayOfYear=cQ;qe.firstDayOfWeek=lQ;qe.weekdays=yQ;qe.weekdaysMin=wQ;qe.weekdaysShort=_Q;qe.weekdaysParse=EQ;qe.weekdaysRegex=CQ;qe.weekdaysShortRegex=NQ;qe.weekdaysMinRegex=AQ;qe.isPM=DQ;qe.meridiem=FQ;function $0(e,t,r,n){var a=xs(),s=Fa().set(n,t);return a[r](s,e)}function n4(e,t,r){if(hs(e)&&(t=e,e=void 0),e=e||"",t!=null)return $0(e,t,r,"month");var n,a=[];for(n=0;n<12;n++)a[n]=$0(e,n,r,"month");return a}function K1(e,t,r,n){typeof e=="boolean"?(hs(t)&&(r=t,t=void 0),t=t||""):(t=e,r=t,e=!1,hs(t)&&(r=t,t=void 0),t=t||"");var a=xs(),s=e?a._week.dow:0,i,o=[];if(r!=null)return $0(t,(r+s)%7,n,"day");for(i=0;i<7;i++)o[i]=$0(t,(i+s)%7,n,"day");return o}function $Z(e,t){return n4(e,t,"months")}function BZ(e,t){return n4(e,t,"monthsShort")}function UZ(e,t,r){return K1(e,t,r,"weekdays")}function WZ(e,t,r){return K1(e,t,r,"weekdaysShort")}function VZ(e,t,r){return K1(e,t,r,"weekdaysMin")}Js("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10,r=Le(e%100/10)===1?"th":t===1?"st":t===2?"nd":t===3?"rd":"th";return e+r}});ye.lang=Rn("moment.lang is deprecated. Use moment.locale instead.",Js);ye.langData=Rn("moment.langData is deprecated. Use moment.localeData instead.",xs);var Ba=Math.abs;function HZ(){var e=this._data;return this._milliseconds=Ba(this._milliseconds),this._days=Ba(this._days),this._months=Ba(this._months),e.milliseconds=Ba(e.milliseconds),e.seconds=Ba(e.seconds),e.minutes=Ba(e.minutes),e.hours=Ba(e.hours),e.months=Ba(e.months),e.years=Ba(e.years),this}function a4(e,t,r,n){var a=ca(t,r);return e._milliseconds+=n*a._milliseconds,e._days+=n*a._days,e._months+=n*a._months,e._bubble()}function zZ(e,t){return a4(this,e,t,1)}function YZ(e,t){return a4(this,e,t,-1)}function tb(e){return e<0?Math.floor(e):Math.ceil(e)}function GZ(){var e=this._milliseconds,t=this._days,r=this._months,n=this._data,a,s,i,o,l;return e>=0&&t>=0&&r>=0||e<=0&&t<=0&&r<=0||(e+=tb(fg(r)+t)*864e5,t=0,r=0),n.milliseconds=e%1e3,a=_n(e/1e3),n.seconds=a%60,s=_n(a/60),n.minutes=s%60,i=_n(s/60),n.hours=i%24,t+=_n(i/24),l=_n(s4(t)),r+=l,t-=tb(fg(l)),o=_n(r/12),r%=12,n.days=t,n.months=r,n.years=o,this}function s4(e){return e*4800/146097}function fg(e){return e*146097/4800}function KZ(e){if(!this.isValid())return NaN;var t,r,n=this._milliseconds;if(e=Mn(e),e==="month"||e==="quarter"||e==="year")switch(t=this._days+n/864e5,r=this._months+s4(t),e){case"month":return r;case"quarter":return r/3;case"year":return r/12}else switch(t=this._days+Math.round(fg(this._months)),e){case"week":return t/7+n/6048e5;case"day":return t+n/864e5;case"hour":return t*24+n/36e5;case"minute":return t*1440+n/6e4;case"second":return t*86400+n/1e3;case"millisecond":return Math.floor(t*864e5)+n;default:throw new Error("Unknown unit "+e)}}function ys(e){return function(){return this.as(e)}}var i4=ys("ms"),qZ=ys("s"),XZ=ys("m"),QZ=ys("h"),JZ=ys("d"),ZZ=ys("w"),eee=ys("M"),tee=ys("Q"),ree=ys("y"),nee=i4;function aee(){return ca(this)}function see(e){return e=Mn(e),this.isValid()?this[e+"s"]():NaN}function fo(e){return function(){return this.isValid()?this._data[e]:NaN}}var iee=fo("milliseconds"),oee=fo("seconds"),lee=fo("minutes"),cee=fo("hours"),uee=fo("days"),fee=fo("months"),dee=fo("years");function hee(){return _n(this.days()/7)}var Ha=Math.round,Yo={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function pee(e,t,r,n,a){return a.relativeTime(t||1,!!r,e,n)}function mee(e,t,r,n){var a=ca(e).abs(),s=Ha(a.as("s")),i=Ha(a.as("m")),o=Ha(a.as("h")),l=Ha(a.as("d")),c=Ha(a.as("M")),f=Ha(a.as("w")),d=Ha(a.as("y")),h=s<=r.ss&&["s",s]||s<r.s&&["ss",s]||i<=1&&["m"]||i<r.m&&["mm",i]||o<=1&&["h"]||o<r.h&&["hh",o]||l<=1&&["d"]||l<r.d&&["dd",l];return r.w!=null&&(h=h||f<=1&&["w"]||f<r.w&&["ww",f]),h=h||c<=1&&["M"]||c<r.M&&["MM",c]||d<=1&&["y"]||["yy",d],h[2]=t,h[3]=+e>0,h[4]=n,pee.apply(null,h)}function vee(e){return e===void 0?Ha:typeof e=="function"?(Ha=e,!0):!1}function gee(e,t){return Yo[e]===void 0?!1:t===void 0?Yo[e]:(Yo[e]=t,e==="s"&&(Yo.ss=t-1),!0)}function xee(e,t){if(!this.isValid())return this.localeData().invalidDate();var r=!1,n=Yo,a,s;return typeof e=="object"&&(t=e,e=!1),typeof e=="boolean"&&(r=e),typeof t=="object"&&(n=Object.assign({},Yo,t),t.s!=null&&t.ss==null&&(n.ss=t.s-1)),a=this.localeData(),s=mee(this,!r,n,a),r&&(s=a.pastFuture(+this,s)),a.postformat(s)}var bm=Math.abs;function Co(e){return(e>0)-(e<0)||+e}function up(){if(!this.isValid())return this.localeData().invalidDate();var e=bm(this._milliseconds)/1e3,t=bm(this._days),r=bm(this._months),n,a,s,i,o=this.asSeconds(),l,c,f,d;return o?(n=_n(e/60),a=_n(n/60),e%=60,n%=60,s=_n(r/12),r%=12,i=e?e.toFixed(3).replace(/\.?0+$/,""):"",l=o<0?"-":"",c=Co(this._months)!==Co(o)?"-":"",f=Co(this._days)!==Co(o)?"-":"",d=Co(this._milliseconds)!==Co(o)?"-":"",l+"P"+(s?c+s+"Y":"")+(r?c+r+"M":"")+(t?f+t+"D":"")+(a||n||e?"T":"")+(a?d+a+"H":"")+(n?d+n+"M":"")+(e?d+i+"S":"")):"P0D"}var Ve=lp.prototype;Ve.isValid=fJ;Ve.abs=HZ;Ve.add=zZ;Ve.subtract=YZ;Ve.as=KZ;Ve.asMilliseconds=i4;Ve.asSeconds=qZ;Ve.asMinutes=XZ;Ve.asHours=QZ;Ve.asDays=JZ;Ve.asWeeks=ZZ;Ve.asMonths=eee;Ve.asQuarters=tee;Ve.asYears=ree;Ve.valueOf=nee;Ve._bubble=GZ;Ve.clone=aee;Ve.get=see;Ve.milliseconds=iee;Ve.seconds=oee;Ve.minutes=lee;Ve.hours=cee;Ve.days=uee;Ve.weeks=hee;Ve.months=fee;Ve.years=dee;Ve.humanize=xee;Ve.toISOString=up;Ve.toString=up;Ve.toJSON=up;Ve.locale=GN;Ve.localeData=qN;Ve.toIsoString=Rn("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",up);Ve.lang=KN;Se("X",0,0,"unix");Se("x",0,0,"valueOf");be("x",ap);be("X",$X);et("X",function(e,t,r){r._d=new Date(parseFloat(e)*1e3)});et("x",function(e,t,r){r._d=new Date(Le(e))});//! moment.js
ye.version="2.30.1";yX(ft);ye.fn=he;ye.min=oJ;ye.max=lJ;ye.now=cJ;ye.utc=Fa;ye.unix=IZ;ye.months=$Z;ye.isDate=Ef;ye.locale=Js;ye.invalid=ep;ye.duration=ca;ye.isMoment=ia;ye.weekdays=UZ;ye.parseZone=LZ;ye.localeData=xs;ye.isDuration=Hd;ye.monthsShort=BZ;ye.weekdaysMin=VZ;ye.defineLocale=B1;ye.updateLocale=LQ;ye.locales=$Q;ye.weekdaysShort=WZ;ye.normalizeUnits=Mn;ye.relativeTimeRounding=vee;ye.relativeTimeThreshold=gee;ye.calendarFormat=FJ;ye.prototype=he;ye.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var q1={};q1.match=See;q1.parse=o4;var yee=/(?:(only|not)?\s*([^\s\(\)]+)(?:\s*and)?\s*)?(.+)?/i,_ee=/\(\s*([^\s\:\)]+)\s*(?:\:\s*([^\s\)]+))?\s*\)/,wee=/^(?:(min|max)-)?(.+)/,bee=/(em|rem|px|cm|mm|in|pt|pc)?$/,Eee=/(dpi|dpcm|dppx)?$/;function See(e,t){return o4(e).some(function(r){var n=r.inverse,a=r.type==="all"||t.type===r.type;if(a&&n||!(a||n))return!1;var s=r.expressions.every(function(i){var o=i.feature,l=i.modifier,c=i.value,f=t[o];if(!f)return!1;switch(o){case"orientation":case"scan":return f.toLowerCase()===c.toLowerCase();case"width":case"height":case"device-width":case"device-height":c=ab(c),f=ab(f);break;case"resolution":c=nb(c),f=nb(f);break;case"aspect-ratio":case"device-aspect-ratio":case"device-pixel-ratio":c=rb(c),f=rb(f);break;case"grid":case"color":case"color-index":case"monochrome":c=parseInt(c,10)||1,f=parseInt(f,10)||0;break}switch(l){case"min":return f>=c;case"max":return f<=c;default:return f===c}});return s&&!n||!s&&n})}function o4(e){return e.split(",").map(function(t){t=t.trim();var r=t.match(yee),n=r[1],a=r[2],s=r[3]||"",i={};return i.inverse=!!n&&n.toLowerCase()==="not",i.type=a?a.toLowerCase():"all",s=s.match(/\([^\)]+\)/g)||[],i.expressions=s.map(function(o){var l=o.match(_ee),c=l[1].toLowerCase().match(wee);return{modifier:c[1],feature:c[2],value:l[2]}}),i})}function rb(e){var t=Number(e),r;return t||(r=e.match(/^(\d+)\s*\/\s*(\d+)$/),t=r[1]/r[2]),t}function nb(e){var t=parseFloat(e),r=String(e).match(Eee)[1];switch(r){case"dpcm":return t/2.54;case"dppx":return t*96;default:return t}}function ab(e){var t=parseFloat(e),r=String(e).match(bee)[1];switch(r){case"em":return t*16;case"rem":return t*16;case"cm":return t*96/2.54;case"mm":return t*96/2.54/10;case"in":return t*96;case"pt":return t*72;case"pc":return t*72/12;default:return t}}var kee=q1.match,sb=typeof window<"u"?window.matchMedia:null;function Tee(e,t,r){var n=this,a;sb&&!r&&(a=sb.call(window,e)),a?(this.matches=a.matches,this.media=a.media,a.addListener(o)):(this.matches=kee(e,t),this.media=e),this.addListener=s,this.removeListener=i,this.dispose=l;function s(c){a&&a.addListener(c)}function i(c){a&&a.removeListener(c)}function o(c){n.matches=c.matches,n.media=c.media}function l(){a&&a.removeListener(o)}}function Cee(e,t,r){return new Tee(e,t,r)}var Nee=Cee;const Aee=Er(Nee);var Oee=/[A-Z]/g,Dee=/^ms-/,Em={};function jee(e){return"-"+e.toLowerCase()}function l4(e){if(Em.hasOwnProperty(e))return Em[e];var t=e.replace(Oee,jee);return Em[e]=Dee.test(t)?"-"+t:t}function Pee(e,t){if(e===t)return!0;if(!e||!t)return!1;const r=Object.keys(e),n=Object.keys(t),a=r.length;if(n.length!==a)return!1;for(let s=0;s<a;s++){const i=r[s];if(e[i]!==t[i]||!Object.prototype.hasOwnProperty.call(t,i))return!1}return!0}const Cr=ue.oneOfType([ue.string,ue.number]),c4={all:ue.bool,grid:ue.bool,aural:ue.bool,braille:ue.bool,handheld:ue.bool,print:ue.bool,projection:ue.bool,screen:ue.bool,tty:ue.bool,tv:ue.bool,embossed:ue.bool},Fee={orientation:ue.oneOf(["portrait","landscape"]),scan:ue.oneOf(["progressive","interlace"]),aspectRatio:ue.string,deviceAspectRatio:ue.string,height:Cr,deviceHeight:Cr,width:Cr,deviceWidth:Cr,color:ue.bool,colorIndex:ue.bool,monochrome:ue.bool,resolution:Cr,type:Object.keys(c4)},{type:$de,...Ree}=Fee,Mee={minAspectRatio:ue.string,maxAspectRatio:ue.string,minDeviceAspectRatio:ue.string,maxDeviceAspectRatio:ue.string,minHeight:Cr,maxHeight:Cr,minDeviceHeight:Cr,maxDeviceHeight:Cr,minWidth:Cr,maxWidth:Cr,minDeviceWidth:Cr,maxDeviceWidth:Cr,minColor:ue.number,maxColor:ue.number,minColorIndex:ue.number,maxColorIndex:ue.number,minMonochrome:ue.number,maxMonochrome:ue.number,minResolution:Cr,maxResolution:Cr,...Ree},Iee={...c4,...Mee};var Lee={all:Iee};const $ee=e=>`not ${e}`,Bee=(e,t)=>{const r=l4(e);return typeof t=="number"&&(t=`${t}px`),t===!0?r:t===!1?$ee(r):`(${r}: ${t})`},Uee=e=>e.join(" and "),Wee=e=>{const t=[];return Object.keys(Lee.all).forEach(r=>{const n=e[r];n!=null&&t.push(Bee(r,n))}),Uee(t)},Vee=O.createContext(void 0),Hee=e=>e.query||Wee(e),ib=e=>e?Object.keys(e).reduce((r,n)=>(r[l4(n)]=e[n],r),{}):void 0,u4=()=>{const e=O.useRef(!1);return O.useEffect(()=>{e.current=!0},[]),e.current},zee=e=>{const t=O.useContext(Vee),r=()=>ib(e)||ib(t),[n,a]=O.useState(r);return O.useEffect(()=>{const s=r();Pee(n,s)||a(s)},[e,t]),n},Yee=e=>{const t=()=>Hee(e),[r,n]=O.useState(t);return O.useEffect(()=>{const a=t();r!==a&&n(a)},[e]),r},Gee=(e,t)=>{const r=()=>Aee(e,t||{},!!t),[n,a]=O.useState(r),s=u4();return O.useEffect(()=>{if(s){const i=r();return a(i),()=>{i&&i.dispose()}}},[e,t]),n},Kee=e=>{const[t,r]=O.useState(e.matches);return O.useEffect(()=>{const n=a=>{r(a.matches)};return e.addListener(n),r(e.matches),()=>{e.removeListener(n)}},[e]),t},ob=(e,t,r)=>{const n=zee(t),a=Yee(e);if(!a)throw new Error("Invalid or missing MediaQuery!");const s=Gee(a,n),i=Kee(s);return u4(),O.useEffect(()=>{},[i]),O.useEffect(()=>()=>{s&&s.dispose()},[]),i},qee=xX(ye);function Xee(){const[e,t]=O.useState({totalClients:0,totalEmployees:0,totalQuotations:0,totalSiteVisits:0,totalpos:0,pendingNotifications:0,totalInvoices:0,totalPayments:0,totalProjects:0}),[r,n]=O.useState([]),[a,s]=O.useState([]),[i,o]=O.useState([]),[l,c]=O.useState([]),[f,d]=O.useState([]),[h,p]=O.useState([]),[v,m]=O.useState("stats"),[_,g]=O.useState(!1),y=Qe(D=>D.role),x=Qe(D=>D.user),w=ob({maxWidth:767}),E=ob({minWidth:768,maxWidth:1023});O.useEffect(()=>{S()},[y,x==null?void 0:x.id]);async function S(){try{if(y==="head"||y==="admin"||y==="e.head"){const z=[ie.from("clients").select("*",{count:"exact",head:!0}),ie.from("employees").select("*",{count:"exact",head:!0}),ie.from("quotations").select("*",{count:"exact",head:!0}),ie.from("site_visit").select("*",{count:"exact",head:!0}),ie.from("quotations").select("*",{count:"exact",head:!0}).eq("status","approved"),ie.from("notifications").select("*",{count:"exact",head:!0}).eq("is_delivered",!1)];y==="e.head"&&z.push(ie.from("projects").select("*",{count:"exact",head:!0}),ie.from("invoices").select("*",{count:"exact",head:!0}),ie.from("payments").select("*",{count:"exact",head:!0}));const[{count:q},{count:ee},{count:H},{count:ce},{count:J},{count:N},{count:F},{count:T},{count:R}]=await Promise.all(z);t(G=>({...G,totalClients:q||0,totalEmployees:ee||0,totalQuotations:H||0,totalSiteVisits:ce||0,totalpos:J||0,pendingNotifications:N||0,totalProjects:F||0,totalInvoices:T||0,totalPayments:R||0}))}else if(y==="finance.employee"){const[{count:z},{count:q},{count:ee}]=await Promise.all([ie.from("invoices").select("*",{count:"exact",head:!0}),ie.from("payments").select("*",{count:"exact",head:!0}),ie.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).eq("is_delivered",!1)]);t(H=>({...H,totalInvoices:z||0,totalPayments:q||0,pendingNotifications:ee||0}))}else{const[{count:z},{count:q},{count:ee},{count:H},{count:ce},{count:J}]=await Promise.all([ie.from("client_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),ie.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),ie.from("site_visit").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id),ie.from("quotations").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id).eq("status","approved"),ie.from("notifications").select("*",{count:"exact",head:!0}).or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).eq("is_delivered",!1),y==="e.employee"?ie.from("project_assignments").select("*",{count:"exact",head:!0}).eq("employee_id",x==null?void 0:x.id):Promise.resolve({count:0})]);t(N=>({...N,totalClients:z||0,totalEmployees:0,totalQuotations:q||0,totalSiteVisits:ee||0,totalpos:H||0,pendingNotifications:ce||0,totalProjects:J||0}))}if(y!=="finance.employee"){const{data:z}=await ie.from("quotations").select(`
            *,
            clients (
              name,
              company
            )
          `).order("created_at",{ascending:!1}).limit(5);n(z||[]);const{data:q}=await ie.from("site_visit").select(`
            *,
            clients (
              name,
              company
            ),
            employees (
              full_name
            ),
            address,
          `).order("created_at",{ascending:!1}).limit(5);s(q||[])}else{const{data:z}=await ie.from("invoices").select(`
            *,
            clients (
              name,
              company
            ),
            projects (
              name
            )
          `).order("created_at",{ascending:!1}).limit(5);c(z||[]);const{data:q}=await ie.from("payments").select(`
            *,
            invoices (
              invoice_number,
              clients (
                name,
                company
              )
            )
          `).order("created_at",{ascending:!1}).limit(5);d(q||[])}const D=y==="head"||y==="admin"||y==="e.head"?ie.from("notifications").select("*").order("scheduled_at",{ascending:!1}).limit(5):ie.from("notifications").select("*").or(`assigned_to.eq.${x==null?void 0:x.id},target_role.eq.${y}`).order("scheduled_at",{ascending:!1}).limit(5),{data:K}=await D;o(K||[]);const Q=(K||[]).map(z=>({id:z.id,title:z.title,start:new Date(z.scheduled_at),end:new Date(new Date(z.scheduled_at).getTime()+60*60*1e3),description:z.description,assignedTo:z.assigned_to,isDelivered:z.is_delivered}));p(Q)}catch(D){console.error("Error loading dashboard data:",D)}}const b=D=>{let K=D.isDelivered?"#d1fae5":"#fee2e2";return new Date(D.start)>new Date&&(K="#bfdbfe"),{style:{backgroundColor:K,borderRadius:"4px",opacity:.8,color:"#1f2937",border:"0px",display:"block"}}},j=()=>u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Invoices"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalInvoices})]}),u.jsx(gw,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Payments"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalPayments})]}),u.jsx(yw,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})})]}),k=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(ww,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),C=()=>u.jsx(u.Fragment,{children:u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Assigned Projects"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalProjects})]}),u.jsx(ww,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})}),P=()=>u.jsxs("div",{className:"grid grid-cols-1 gap-4 md:gap-6 lg:grid-cols-2",children:[u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(gw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Recent Invoices"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:l.map(D=>{var K,Q;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(K=D.clients)==null?void 0:K.name," - ",D.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]}),((Q=D.projects)==null?void 0:Q.name)&&u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Project: ",D.projects.name]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.status==="paid"?"bg-green-100 text-green-800":D.status==="overdue"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:D.status.charAt(0).toUpperCase()+D.status.slice(1)})]})},D.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(yw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-green-600"}),"Recent Payments"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:f.map(D=>{var K,Q,z;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(Q=(K=D.invoices)==null?void 0:K.clients)==null?void 0:Q.name," - ",(z=D.invoices)==null?void 0:z.invoice_number]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Method: ",D.method]})]}),u.jsx("span",{className:"text-xs text-gray-400 mt-1",children:ye(D.payment_date).format("MMM D, YYYY")})]})},D.id)})})]})]}),I=()=>u.jsxs("div",{className:"flex space-x-2",children:[u.jsx("button",{onClick:()=>{m("stats"),w&&g(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="stats"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Overview"}),u.jsx("button",{onClick:()=>{m("calendar"),w&&g(!1)},className:`px-3 py-1 md:px-4 md:py-2 text-sm md:text-base rounded-md ${v==="calendar"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"}`,children:"Calendar"})]});return u.jsxs("div",{className:"space-y-4 md:space-y-6 p-2 md:p-4",children:[w&&u.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded-lg shadow-md sticky top-0 z-10",children:[u.jsx("h1",{className:"text-xl font-bold text-gray-800",children:"Dashboard"}),u.jsx("button",{onClick:()=>g(!_),className:"p-1 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:_?u.jsx(Bl,{className:"w-6 h-6 text-gray-600"}):u.jsx(OT,{className:"w-6 h-6 text-gray-600"})})]}),!w&&u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Dashboard"}),I()]}),w&&_&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 mb-4",children:I()}),v==="stats"?u.jsxs(u.Fragment,{children:[u.jsxs("div",{className:`grid ${w?"grid-cols-1 gap-3":E?"grid-cols-2 gap-4":"grid-cols-2 lg:grid-cols-4 gap-4 md:gap-6"}`,children:[y!=="finance.employee"&&y!==null&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Clients"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalClients})]}),u.jsx(Yc,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})}),(y==="head"||y==="admin"||y==="e.head")&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Employees"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalEmployees})]}),u.jsx(Yi,{className:"w-6 h-6 md:w-8 md:h-8 text-green-600"})]})}),y!=="finance.employee"&&u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total Quotations"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalQuotations})]}),u.jsx(al,{className:"w-6 h-6 md:w-8 md:h-8 text-purple-600"})]})})]}),y==="finance.employee"&&j(),y==="e.head"&&k(),y==="e.employee"&&C(),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Pending Tasks"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.pendingNotifications})]}),u.jsx(Wv,{className:"w-6 h-6 md:w-8 md:h-8 text-orange-600"})]})}),(y==="e.employee"||y==="employee")&&u.jsxs(u.Fragment,{children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Site Visits"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalSiteVisits})]}),u.jsx(vw,{className:"w-6 h-6 md:w-8 md:h-8 text-yellow-600"})]})}),u.jsx("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base text-gray-500",children:"Total PO's"}),u.jsx("h3",{className:"text-xl md:text-2xl font-bold text-gray-800",children:e.totalpos})]}),u.jsx(al,{className:"w-6 h-6 md:w-8 md:h-8 text-blue-600"})]})})]})]}),u.jsx("div",{className:`grid ${w?"grid-cols-1 gap-4":E?"grid-cols-1 lg:grid-cols-2 gap-4":"grid-cols-1 lg:grid-cols-3 gap-4 md:gap-6"}`,children:y==="finance.employee"?P():u.jsxs(u.Fragment,{children:[y!=="finance.employee"&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(al,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-purple-600"}),"Recent Quotations"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:r.map(D=>{var K,Q;return u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(K=D.clients)==null?void 0:K.name," - ",(Q=D.clients)==null?void 0:Q.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Amount: $",D.amount]})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.status==="approved"?"bg-green-100 text-green-800":D.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:D.status.charAt(0).toUpperCase()+D.status.slice(1)})]})},D.id)})})]}),(y==="e.employee"||y==="employee")&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(vw,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-yellow-600"}),"Recent Site Visits"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:a.map(D=>{var K,Q,z;return u.jsxs("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:[u.jsxs("p",{className:"text-sm md:text-base font-medium text-gray-800",children:[(K=D.clients)==null?void 0:K.name," - ",(Q=D.clients)==null?void 0:Q.company]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["By: ",(z=D.employees)==null?void 0:z.full_name]}),u.jsxs("p",{className:"text-xs md:text-sm text-gray-500",children:["Location: ",D.address]})]},D.id)})})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Wv,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-orange-600"}),"Recent Tasks"]}),u.jsx("div",{className:"space-y-3 md:space-y-4",children:i.map(D=>u.jsx("div",{className:"border-b pb-3 md:pb-4 last:border-b-0",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm md:text-base font-medium text-gray-800",children:D.title}),u.jsx("p",{className:"text-xs md:text-sm text-gray-500",children:D.description}),u.jsx("p",{className:"text-xs text-gray-400 mt-1",children:ye(D.scheduled_at).format("MMM D, h:mm A")})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${D.is_delivered?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:D.is_delivered?"Completed":"Pending"})]})},D.id))})]})]})})]}):u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-4 md:p-6 h-[70vh] min-h-[500px]",children:[u.jsxs("h2",{className:"text-lg md:text-xl font-semibold text-gray-800 mb-3 md:mb-4 flex items-center",children:[u.jsx(Dh,{className:"w-4 h-4 md:w-5 md:h-5 mr-2 text-blue-600"}),"Task Calendar"]}),u.jsx(dX,{localizer:qee,events:h,startAccessor:"start",endAccessor:"end",style:{height:w?"60vh":"65vh"},views:[Pt.MONTH,Pt.WEEK,Pt.DAY,Pt.AGENDA],defaultView:w?Pt.AGENDA:Pt.MONTH,eventPropGetter:b,onSelectEvent:D=>{alert(`Task: ${D.title}

Description: ${D.description||"No description"}

Status: ${D.isDelivered?"Completed":"Pending"}

Time: ${ye(D.start).format("MMM D, h:mm A")}`)}})]})]})}function Qee(){const[e,t]=O.useState([]),[r,n]=O.useState(!1),[a,s]=O.useState({email:"",password:"",full_name:"",role:"employee"}),[i,o]=O.useState(!1),[l,c]=O.useState(""),[f,d]=O.useState(""),[h,p]=O.useState([]);O.useEffect(()=>{v()},[]),O.useEffect(()=>{_()},[e,f]);async function v(){const{data:g,error:y}=await ie.from("employees").select("*").order("created_at",{ascending:!1});if(y){console.error("Error loading employees:",y);return}t(g||[]),p(g||[])}async function m(g){var y;g.preventDefault(),o(!0),c("");try{const{data:x,error:w}=await ie.auth.signUp({email:a.email,password:a.password});if(w)throw w;const{error:E}=await ie.from("employees").insert([{id:(y=x.user)==null?void 0:y.id,email:a.email,full_name:a.full_name,role:a.role}]);if(E)throw E;s({email:"",password:"",full_name:"",role:"employee"}),n(!1),v()}catch(x){c(x.message)}finally{o(!1)}}const _=()=>{if(!f){p(e);return}const g=e.filter(y=>y.full_name.toLowerCase().includes(f.toLowerCase()));p(g)};return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Employees"}),u.jsxs("div",{className:"flex items-center",children:[u.jsx("input",{type:"text",placeholder:"Search employees...",className:"p-2 border rounded mr-2",value:f,onChange:g=>d(g.target.value)}),u.jsxs("button",{onClick:()=>n(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Employee"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(g=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsxs("div",{className:"flex items-start justify-between",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800",children:g.full_name}),u.jsx("p",{className:"text-gray-500",children:g.role})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${g.role==="head"?"bg-purple-100 text-purple-800":g.role==="admin"?"bg-green-100 text-green-800":g.role==="e.head"?"bg-orange-100 text-orange-800":g.role==="e.employee"?"bg-yellow-100 text-yellow-800":g.role==="finance.employee"?"bg-teal-100 text-teal-800":"bg-blue-100 text-blue-800"}`,children:g.role})]}),u.jsxs("div",{className:"mt-4 space-y-2",children:[u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),g.email]}),u.jsxs("div",{className:"flex items-center text-gray-600",children:[u.jsx(Dh,{className:"w-4 h-4 mr-2"}),"Joined ",new Date(g.created_at).toLocaleDateString()]})]})]},g.id))}),r&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Employee"}),l&&u.jsx("div",{className:"bg-red-50 text-red-600 p-3 rounded mb-4",children:l}),u.jsxs("form",{onSubmit:m,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Full Name"}),u.jsx("input",{type:"text",value:a.full_name,onChange:g=>s({...a,full_name:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:a.email,onChange:g=>s({...a,email:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Password"}),u.jsx("input",{type:"password",value:a.password,onChange:g=>s({...a,password:g.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Role"}),u.jsxs("select",{value:a.role,onChange:g=>s({...a,role:g.target.value}),className:"w-full p-2 border rounded",children:[u.jsx("option",{value:"employee",children:"Employee"}),u.jsx("option",{value:"head",children:"Head"}),u.jsx("option",{value:"admin",children:"Admin"}),u.jsx("option",{value:"e.employee",children:"E.Employee"}),u.jsx("option",{value:"e.head",children:"E.Head"}),u.jsx("option",{value:"finance.employee",children:"Finance Employee"})]})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>n(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:i?"Creating...":"Create"})]})]})]})})]})}function Jee(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[f,d]=O.useState(null),[h,p]=O.useState([]),[v,m]=O.useState(""),[_,g]=O.useState([]),y=Pn(),x=Qe(C=>C.role),w=Qe(C=>C.user);O.useEffect(()=>{E(),(x==="head"||x==="admin"||x==="employee")&&b()},[x,w==null?void 0:w.id]),O.useEffect(()=>{S()},[e,r]);async function E(){try{if(x==="employee"&&(w!=null&&w.id)){const{data:C,error:P}=await ie.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",w.id).eq("client.status","ongoing");if(P)throw P;const I=(C==null?void 0:C.map(D=>D.client).filter(D=>D!==null))||[];t(I)}else if(x==="head"||x==="admin"){const{data:C,error:P}=await ie.from("clients").select("*, client_assignments(employee_id)").eq("status","ongoing");if(P)throw P;t(C||[])}}catch(C){console.error("Error loading clients:",C)}}const S=()=>{if(!r){s(e);return}const C=e.filter(P=>{var I,D,K;return((I=P==null?void 0:P.name)==null?void 0:I.toLowerCase().includes(r.toLowerCase()))||((D=P==null?void 0:P.company)==null?void 0:D.toLowerCase().includes(r.toLowerCase()))||((K=P==null?void 0:P.address)==null?void 0:K.toLowerCase().includes(r.toLowerCase()))});s(C)};async function b(){const{data:C,error:P}=await ie.from("employees").select("*").eq("role","employee");if(P){console.error("Error loading employees:",P);return}p(C||[])}async function j(){if(f)try{const C=_.map(I=>({client_id:f.id,employee_id:I}));await ie.from("client_assignments").delete().eq("client_id",f.id);const{error:P}=await ie.from("client_assignments").insert(C);if(P)throw P;c(!1),E()}catch(C){console.error("Error assigning employees:",C)}}const k=h.filter(C=>{var P;return(P=C==null?void 0:C.full_name)==null?void 0:P.toLowerCase().includes(v.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"My Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:C=>n(C.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(C=>C&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:C.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:C.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:C.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>y(`/clients/${C.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(x==="head"||x==="admin")&&u.jsxs("button",{onClick:()=>{var P;d(C),g(((P=C.client_assignments)==null?void 0:P.map(I=>I.employee_id))||[]),c(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Yi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},C.id))}),l&&f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",f.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:v,onChange:C=>m(C.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:_,onChange:C=>{const P=Array.from(C.target.selectedOptions,I=>I.value);g(P)},className:"w-full p-2 border rounded h-40",size:5,children:k.map(C=>u.jsx("option",{value:C.id,children:C.full_name},C.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function Zee(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState(null),[f,d]=O.useState([]),[h,p]=O.useState(""),[v,m]=O.useState({name:"",company:"",address:""}),[_,g]=O.useState([]),y=Pn(),x=Qe(k=>k.role),w=Qe(k=>k.user);O.useEffect(()=>{E(),(x==="head"||x==="employee"||x==="admin")&&b()},[x]),O.useEffect(()=>{S()},[e,r]);async function E(){const{data:k,error:C}=await ie.from("clients").select("*, client_assignments(employee_id)");if(C){console.error("Error loading clients:",C);return}t(k||[])}const S=()=>{if(!r){s(e);return}const k=e.filter(C=>C.name.toLowerCase().includes(r.toLowerCase())||C.company.toLowerCase().includes(r.toLowerCase())||C.address.toLowerCase().includes(r.toLowerCase()));s(k)};async function b(){const{data:k,error:C}=await ie.from("employees").select("*").eq("role","employee");if(C){console.error("Error loading employees:",C);return}d(k||[])}async function j(k){k.preventDefault();const{data:C,error:P}=await ie.from("clients").insert([{...v,created_by:w==null?void 0:w.id,status:"ongoing"}]).select().single();if(P){console.error("Error creating client:",P);return}t([...e,C]),m({name:"",company:"",address:""}),o(!1)}return f.filter(k=>k.full_name.toLowerCase().includes(h.toLowerCase())),u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"Clients"}),u.jsxs("div",{className:"flex items-center",children:[u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:k=>n(k.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Client"]})]})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(k=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:k.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:k.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:k.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>y(`/allclients/${k.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},k.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add New Client"}),u.jsxs("form",{onSubmit:j,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:v.name,onChange:k=>m({...v,name:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Company"}),u.jsx("input",{type:"text",value:v.company,onChange:k=>m({...v,company:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address"}),u.jsx("input",{type:"text",value:v.address,onChange:k=>m({...v,address:k.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Create"})]})]})]})})]})}function ete(){const{id:e}=Ml(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState(!1),[o,l]=O.useState(null),c=Qe(y=>y.role);Qe(y=>y.user);const[f,d]=O.useState(null),[h,p]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&v()},[e]);async function v(){const{data:y}=await ie.from("clients").select("*").eq("id",e).single();r(y);const{data:x}=await ie.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(x||[]),y!=null&&y.created_by&&await m(y.created_by)}async function m(y){const{data:x}=await ie.from("employees").select("full_name").eq("id",y).single();d(x)}async function _(y){y.preventDefault();const{error:x}=await ie.from("contact_persons").insert([{...h,client_id:e}]);if(x){console.error("Error adding contact person:",x);return}p({name:"",position:"",email:"",phone:""}),i(!1),v()}async function g(y){y.preventDefault();const{error:x}=await ie.from("contact_persons").update({name:o.name,position:o.position,email:o.email,phone:o.phone}).eq("id",o.id);if(x){console.error("Error updating contact person:",x);return}l(null),v()}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsxs("button",{onClick:()=>i(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})]})}),c==="head"&&t.created_by&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Client Created By"}),f?u.jsxs("p",{className:"text-gray-600",children:["Employee Name: ",f==null?void 0:f.full_name]}):u.jsxs("p",{className:"text-gray-600",children:["User ID: ",t.created_by]})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(y=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:y.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:y.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),y.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(uf,{className:"w-4 h-4 mr-2"}),y.phone]})]}),c==="head"&&u.jsx("button",{onClick:()=>l(y),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},y.id))})]}),s&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:_,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:h.name,onChange:y=>p({...h,name:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:h.position,onChange:y=>p({...h,position:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:h.email,onChange:y=>p({...h,email:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:h.phone,onChange:y=>p({...h,phone:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>i(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add Contact"})]})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:g,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:o.name,onChange:y=>l({...o,name:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:o.position,onChange:y=>l({...o,position:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:o.email,onChange:y=>l({...o,email:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:o.phone,onChange:y=>l({...o,phone:y.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Save Changes"})]})]})]})})]}):null}function tte(){const{id:e}=Ml(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState([]),[c,f]=O.useState(!1),[d,h]=O.useState(!1),[p,v]=O.useState(!1),[m,_]=O.useState(!1),[g,y]=O.useState([]),[x,w]=O.useState(null),[E,S]=O.useState(!1),[b,j]=O.useState({contact:!1,quotation:!1,endClient:!1,poReceived:!1}),k=Qe(T=>T.role),C=Qe(T=>T.user),[P,I]=O.useState({name:"",position:"",email:"",phone:""}),[D,K]=O.useState({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),Q=(T,R)=>{window.open(`https://www.google.com/maps?q=${T},${R}`,"_blank")},z=(T,R)=>{const G=encodeURIComponent(`Quotation #${R.id} Details`),X=encodeURIComponent(`Dear Client,

Please find below the quotation details:

Amount: ₹${R.amount}/-
Valid From: ${new Date(R.start_date).toLocaleDateString()}
Valid Until: ${new Date(R.end_date).toLocaleDateString()}
Description: ${R.description}

Assets Included:
${R.quotation_assets.map(Y=>`- ${Y.assets.item} (Qty: ${Y.quantity})`).join(`
`)}

Best regards,
${(C==null?void 0:C.full_name)||"Your Representative"}
${(C==null?void 0:C.email)||""}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${T}&su=${G}&body=${X}`)};O.useEffect(()=>{e&&(q(),ee(),H())},[e,E]);async function q(){try{const{data:T}=await ie.from("clients").select("*").eq("id",e).single();r(T);const{data:R}=await ie.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(R||[]),k==="admin"||k==="head"||E){const{data:G}=await ie.from("quotations").select(`
            *,
            employees (
              full_name
            ),
            quotation_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_id",e).order("created_at",{ascending:!1});i(G||[]);const{data:X}=await ie.from("site_visit").select(`
            *,
            employees (
              full_name
            ),
            site_visit_form (
              address,
              contact_no,
              notes,
              exit_location,
              created_at
            ),
            site_visit_assets (
              asset_id,
              quantity,
              assets (
                item
              )
            )
          `).eq("client_Id",e).order("created_at",{ascending:!1});l(X||[])}}catch(T){console.error("Error loading client data:",T)}}async function ee(){try{const{data:T}=await ie.from("assets").select("*").order("item");y(T||[])}catch(T){console.error("Error loading assets:",T)}}async function H(){try{if(k==="admin"||k==="head"){S(!0);return}if(!(C!=null&&C.id)||!e){S(!1);return}const{data:T,error:R}=await ie.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",C.id).single();S(!!T)}catch(T){console.error("Error checking assignment:",T)}}async function ce(T){T.preventDefault(),j(R=>({...R,contact:!0}));try{const{error:R}=await ie.from("contact_persons").insert([{...P,client_id:e}]);if(R)throw R;I({name:"",position:"",email:"",phone:""}),f(!1),await q()}catch(R){console.error("Error adding contact:",R)}finally{j(R=>({...R,contact:!1}))}}async function J(T){T.preventDefault(),j(R=>({...R,contact:!0}));try{const{error:R}=await ie.from("contact_persons").update({name:x.name,position:x.position,email:x.email,phone:x.phone}).eq("id",x.id);if(R)throw R;w(null),await q()}catch(R){console.error("Error updating contact:",R)}finally{j(R=>({...R,contact:!1}))}}async function N(T){T.preventDefault(),j(R=>({...R,quotation:!0}));try{const{data:R,error:G}=await ie.from("quotations").insert([{client_id:e,employee_id:C==null?void 0:C.id,amount:parseFloat(D.amount),description:D.description,start_date:D.start_date,end_date:D.end_date,status:"pending"}]).select().single();if(G)throw G;if(D.selectedAssets.length>0){const{error:X}=await ie.from("quotation_assets").insert(D.selectedAssets.map(Y=>({quotation_id:R.id,asset_id:Y.assetId,quantity:Y.quantity})));if(X)throw X}K({amount:"",description:"",start_date:"",end_date:"",selectedAssets:[]}),h(!1),await q()}catch(R){console.error("Error adding quotation:",R)}finally{j(R=>({...R,quotation:!1}))}}async function F(T,R){try{const{error:G}=await ie.from("quotations").update({status:R}).eq("id",T);if(G)throw G;await q()}catch(G){console.error("Error updating quotation status:",G)}}return t?u.jsxs("div",{className:"space-y-6 p-4",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex flex-wrap gap-2 w-full md:w-auto",children:[u.jsx("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.contact,children:b.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),(k==="employee"||k==="admin")&&E&&u.jsx("button",{onClick:()=>h(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.quotation,children:b.quotation?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Quotation"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(T=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:T.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:T.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`mailto:${T.email}`,className:"hover:underline",children:T.email})]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(uf,{className:"w-4 h-4 mr-2"}),u.jsx("a",{href:`tel:${T.phone}`,className:"hover:underline",children:T.phone})]})]}),k==="head"&&u.jsx("button",{onClick:()=>w(T),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},T.id))})]}),(k==="admin"||k==="head"||E)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No quotations found"}):u.jsx("div",{className:"space-y-4",children:s.map(T=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start gap-4",children:[u.jsxs("div",{className:"flex-1",children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: ₹",T.amount,"/-"]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",T.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:T.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(T.start_date).toLocaleDateString()," - ",new Date(T.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:T.quotation_assets.map(R=>u.jsxs("li",{children:[R.assets.item," (Qty: ",R.quantity,")"]},R.asset_id))})]})]}),u.jsxs("div",{className:"flex flex-col gap-2 w-full md:w-auto",children:[u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${T.status==="approved"?"bg-green-100 text-green-800":T.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:T.status.charAt(0).toUpperCase()+T.status.slice(1)}),k==="admin"&&u.jsxs("button",{onClick:()=>z(n[0].email,T),className:"flex items-center justify-center gap-1 px-3 py-1 bg-blue-600 text-white text-sm rounded hover:bg-blue-700",children:[u.jsx(DT,{className:"w-4 h-4"}),"Send Quotation"]}),k==="admin"&&T.status==="pending"&&u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>F(T.id,"approved"),className:"px-2 py-1 bg-green-600 text-white text-sm rounded hover:bg-green-700",children:"Approve"}),u.jsx("button",{onClick:()=>F(T.id,"rejected"),className:"px-2 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700",children:"Reject"})]})]})]})},T.id))})]}),(k==="admin"||k==="head"||E)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),o.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:o.map(T=>{var R,G;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((R=T.employees)==null?void 0:R.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(T.created_at).toLocaleDateString()})]}),T.latitude&&T.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(E0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>Q(parseFloat(T.latitude),parseFloat(T.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(E0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:T.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:T.longitude})]})]})]}),T.site_visit_form&&T.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",T.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",T.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",T.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",T.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(G=T.site_visit_assets)==null?void 0:G.map(X=>{var Y;return u.jsxs("li",{children:[(Y=X.assets)==null?void 0:Y.item," (Qty: ",X.quantity,")"]},X.asset_id)}),(!T.site_visit_assets||T.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},T.id)})})]}),k==="head"&&u.jsx("button",{onClick:()=>v(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.endClient,children:b.endClient?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(b0,{className:"w-4 h-4 mr-2"}),"End Client"]})}),k==="admin"&&u.jsx("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:b.poReceived,children:b.poReceived?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(b0,{className:"w-4 h-4 mr-2"}),"PO Received"]})}),p&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.endClient,children:"Cancel"}),u.jsx("button",{onClick:async()=>{j(T=>({...T,endClient:!0}));try{const{error:T}=await ie.from("clients").update({status:"completed"}).eq("id",e);if(T)throw T;v(!1),await q()}catch(T){console.error("Error updating client status:",T)}finally{j(T=>({...T,endClient:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:b.endClient,children:b.endClient?"Processing...":"End Client"})]})]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"PO Received"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Mark this client as PO Received?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.poReceived,children:"Cancel"}),u.jsx("button",{onClick:async()=>{j(T=>({...T,poReceived:!0}));try{const{error:T}=await ie.from("clients").update({status:"poreceived"}).eq("id",e);if(T)throw T;_(!1),await q()}catch(T){console.error("Error updating client status:",T)}finally{j(T=>({...T,poReceived:!1}))}},className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:b.poReceived,children:b.poReceived?"Processing...":"PO Received"})]})]})}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:ce,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:P.name,onChange:T=>I({...P,name:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:P.position,onChange:T=>I({...P,position:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:P.email,onChange:T=>I({...P,email:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:P.phone,onChange:T=>I({...P,phone:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.contact,children:b.contact?"Adding...":"Add Contact"})]})]})]})}),x&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:J,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:x.name,onChange:T=>w({...x,name:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:x.position,onChange:T=>w({...x,position:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:x.email,onChange:T=>w({...x,email:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:x.phone,onChange:T=>w({...x,phone:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>w(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.contact,children:b.contact?"Saving...":"Save Changes"})]})]})]})}),d&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Quotation"}),u.jsxs("form",{onSubmit:N,children:[u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Amount"}),u.jsx("input",{type:"number",step:"0.01",value:D.amount,onChange:T=>K({...D,amount:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Start Date"}),u.jsx("input",{type:"date",value:D.start_date,onChange:T=>K({...D,start_date:T.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"md:col-span-2",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description"}),u.jsx("textarea",{value:D.description,onChange:T=>K({...D,description:T.target.value}),className:"w-full p-2 border rounded h-24",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"End Date"}),u.jsx("input",{type:"date",value:D.end_date,onChange:T=>K({...D,end_date:T.target.value}),className:"w-full p-2 border rounded",required:!0})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Assets"}),u.jsx("div",{className:"border rounded-lg p-4 max-h-64 overflow-y-auto",children:g.length===0?u.jsx("p",{className:"text-gray-500",children:"No assets available"}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.map(T=>{var R;return u.jsxs("div",{className:"flex items-start gap-3",children:[u.jsx("input",{type:"checkbox",id:`asset-${T.id}`,checked:D.selectedAssets.some(G=>G.assetId===T.id),onChange:G=>{G.target.checked?K({...D,selectedAssets:[...D.selectedAssets,{assetId:T.id,quantity:1}]}):K({...D,selectedAssets:D.selectedAssets.filter(X=>X.assetId!==T.id)})},className:"mt-1"}),u.jsxs("div",{className:"flex-1",children:[u.jsx("label",{htmlFor:`asset-${T.id}`,className:"font-medium",children:T.item}),D.selectedAssets.some(G=>G.assetId===T.id)&&u.jsxs("div",{className:"mt-1",children:[u.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Quantity"}),u.jsx("input",{type:"number",min:"1",value:((R=D.selectedAssets.find(G=>G.assetId===T.id))==null?void 0:R.quantity)||1,onChange:G=>{K({...D,selectedAssets:D.selectedAssets.map(X=>X.assetId===T.id?{...X,quantity:parseInt(G.target.value)||1}:X)})},className:"w-full p-1 border rounded text-sm"})]})]})]},T.id)})})})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:b.quotation,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:b.quotation,children:b.quotation?"Creating...":"Create Quotation"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function rte(){const{id:e}=Ml(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState(!1),[c,f]=O.useState(!1),[d,h]=O.useState(!1),[p,v]=O.useState([]),[m,_]=O.useState(null),[g,y]=O.useState(!1),[x,w]=O.useState({contact:!1,status:!1}),E=Qe(z=>z.role),S=Qe(z=>z.user),b=(z,q)=>{window.open(`https://www.google.com/maps?q=${z},${q}`,"_blank")},[j,k]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&(C(),P(),I())},[e,g]);async function C(){try{const{data:z}=await ie.from("clients").select("*").eq("id",e).single();r(z);const{data:q}=await ie.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});if(a(q||[]),E==="admin"||E==="e.head"||g){const{data:ee}=await ie.from("site_visit").select(`
                        *,
                        employees (
                            full_name,
                            role
                        ),
                        site_visit_form (
                            address,
                            contact_no,
                            notes,
                            exit_location,
                            created_at
                        ),
                        site_visit_assets (
                            asset_id,
                            quantity,
                            assets (
                                item
                            )
                        )
                    `).eq("client_Id",e).order("created_at",{ascending:!1}),H=(ee==null?void 0:ee.filter(ce=>{var J;return((J=ce.employees)==null?void 0:J.role)==="e.employee"}))||[];i(H)}}catch(z){console.error("Error loading client data:",z)}}async function P(){try{const{data:z}=await ie.from("assets").select("*").order("item");v(z||[])}catch(z){console.error("Error loading assets:",z)}}async function I(){try{if(E==="admin"||E==="e.head"){y(!0);return}if(!(S!=null&&S.id)||!e){y(!1);return}const{data:z,error:q}=await ie.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",S.id).single();y(!!z)}catch(z){console.error("Error checking assignment:",z)}}async function D(z){z.preventDefault(),w({...x,contact:!0});try{const{error:q}=await ie.from("contact_persons").insert([{...j,client_id:e}]);if(q)throw q;k({name:"",position:"",email:"",phone:""}),l(!1),await C()}catch(q){console.error("Error adding contact person:",q)}finally{w({...x,contact:!1})}}async function K(z){z.preventDefault(),w({...x,contact:!0});try{const{error:q}=await ie.from("contact_persons").update({name:m.name,position:m.position,email:m.email,phone:m.phone}).eq("id",m.id);if(q)throw q;_(null),await C()}catch(q){console.error("Error updating contact person:",q)}finally{w({...x,contact:!1})}}async function Q(z){w({...x,status:!0});try{const{error:q}=await ie.from("clients").update({status:z}).eq("id",e);if(q)throw q;f(!1),h(!1),await C()}catch(q){console.error("Error updating client status:",q)}finally{w({...x,status:!1})}}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsx("div",{className:"flex gap-2",children:u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.contact,children:x.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})})})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(z=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:z.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:z.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),z.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(uf,{className:"w-4 h-4 mr-2"}),z.phone]})]}),E==="e.head"&&u.jsx("button",{onClick:()=>_(z),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},z.id))})]}),(E==="admin"||E==="head"||g)&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No site visits found"}):u.jsx("div",{className:"space-y-4",children:s.map(z=>{var q,ee;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsx("div",{className:"flex flex-col md:flex-row justify-between gap-4",children:u.jsxs("div",{className:"flex-1",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:((q=z.employees)==null?void 0:q.full_name)||"Unknown Employee"}),u.jsx("span",{className:"text-sm text-gray-500",children:new Date(z.created_at).toLocaleDateString()})]}),z.latitude&&z.longitude&&u.jsxs("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg border border-gray-200",children:[u.jsxs("div",{className:"flex items-center justify-between",children:[u.jsxs("div",{className:"flex items-center text-gray-700 mb-2",children:[u.jsx(E0,{className:"w-4 h-4 mr-2"}),u.jsx("span",{className:"font-medium",children:"Visit Location"})]}),u.jsxs("button",{onClick:()=>b(parseFloat(z.latitude),parseFloat(z.longitude)),className:"text-sm text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[u.jsx(E0,{className:"w-3 h-3 mr-1"}),"View on Google Maps"]})]}),u.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3 mt-2",children:[u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Latitude"}),u.jsx("div",{className:"font-mono text-sm",children:z.latitude})]}),u.jsxs("div",{className:"bg-white p-2 rounded border",children:[u.jsx("div",{className:"text-xs text-gray-500",children:"Longitude"}),u.jsx("div",{className:"font-mono text-sm",children:z.longitude})]})]})]}),z.site_visit_form&&z.site_visit_form.length>0&&u.jsxs("div",{className:"mt-3 space-y-2",children:[u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Address:"})," ",z.site_visit_form[0].address]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Contact:"})," ",z.site_visit_form[0].contact_no]}),u.jsxs("p",{className:"text-gray-500",children:[u.jsx("span",{className:"font-medium",children:"Notes:"})," ",z.site_visit_form[0].notes]}),u.jsxs("p",{className:"text-gray-600",children:[u.jsx("span",{className:"font-medium",children:"Exit Location:"})," ",z.site_visit_form[0].exit_location]})]}),u.jsxs("div",{className:"mt-4",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-1",children:[(ee=z.site_visit_assets)==null?void 0:ee.map(H=>{var ce;return u.jsxs("li",{children:[(ce=H.assets)==null?void 0:ce.item," (Qty: ",H.quantity,")"]},H.asset_id)}),(!z.site_visit_assets||z.site_visit_assets.length===0)&&u.jsx("li",{children:"No assets used"})]})]})]})})},z.id)})})]}),E==="e.head"&&u.jsx("button",{onClick:()=>h(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:x.status,children:x.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(b0,{className:"w-4 h-4 mr-2"}),"E Complete"]})}),c&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as completed?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.status,children:"Cancel"}),u.jsx("button",{onClick:()=>Q("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:x.status,children:"Confirm"})]})]})}),d&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Ecomplete"}),u.jsx("p",{className:"text-gray-600 mb-4",children:"Are you sure you want to mark this client as Ecomplete?"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>h(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.status,children:"Cancel"}),u.jsx("button",{onClick:()=>Q("ecomplete"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:x.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:D,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:j.name,onChange:z=>k({...j,name:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:j.position,onChange:z=>k({...j,position:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:j.email,onChange:z=>k({...j,email:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:j.phone,onChange:z=>k({...j,phone:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Adding...":"Add Contact"})]})]})]})}),m&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:K,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:m.name,onChange:z=>_({...m,name:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:m.position,onChange:z=>_({...m,position:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:m.email,onChange:z=>_({...m,email:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:m.phone,onChange:z=>_({...m,phone:z.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>_(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:x.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:x.contact,children:x.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function nte(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState({client_Id:"",latitude:"",longitude:"",accuracy:""}),[f,d]=O.useState([]),[h,p]=O.useState([]),[v,m]=O.useState(!1),[_,g]=O.useState(""),[y,x]=O.useState(!1),[w,E]=O.useState(null),[S,b]=O.useState(!1),[j,k]=O.useState(""),[C,P]=O.useState(""),[I,D]=O.useState(null),[K,Q]=O.useState({}),z=Pn(),q=Qe(Y=>Y.role),ee=Qe(Y=>Y.user);O.useEffect(()=>{H(),ce(),(q==="employee"||q==="e.employee")&&(ee!=null&&ee.id)&&J()},[q,ee==null?void 0:ee.id]),O.useEffect(()=>{N()},[e,r]);async function H(){try{const{data:Y,error:ae}=await ie.from("site_visit").select("*").eq("status","start").order("created_at",{ascending:!1});if(ae)throw ae;if(t(Y||[]),Y&&Y.length>0){const oe=Y.map(ke=>ke.id),{data:ve,error:B}=await ie.from("pd_kit_uploads").select("*").in("visit_id",oe);if(B)throw B;const Te={};ve==null||ve.forEach(ke=>{ke.visit_id&&(Te[ke.visit_id]||(Te[ke.visit_id]=[]),Te[ke.visit_id].push(ke))}),Q(Te)}}catch(Y){console.error("Error loading site visits:",Y)}}async function ce(){try{const{data:Y,error:ae}=await ie.from("clients").select("*").order("name");if(ae)throw ae;d(Y||[])}catch(Y){console.error("Error loading clients:",Y)}}async function J(){try{if(!(ee!=null&&ee.id))return;const{data:Y,error:ae}=await ie.from("client_assignments").select("client_id").eq("employee_id",ee.id);if(ae)throw ae;if(Y&&Y.length>0){const{data:oe,error:ve}=await ie.from("clients").select("*").in("id",Y.map(B=>B.client_id)).order("name");if(ve)throw ve;p(oe||[])}}catch(Y){console.error("Error loading assigned clients:",Y)}}const N=()=>{if(!r){s(e);return}const Y=r.toLowerCase(),ae=e.filter(oe=>{const ve=(q==="e.head"||q==="admin"||q==="head"?f:h).find(ke=>ke.id===oe.client_Id),B=(ve==null?void 0:ve.name.toLowerCase())||"",Te=(ve==null?void 0:ve.company.toLowerCase())||"";return B.includes(Y)||Te.includes(Y)||oe.created_at.toLowerCase().includes(Y)});s(ae)},F=async()=>{if(!navigator.geolocation){g("Geolocation is not supported by your browser.");return}m(!0),g("");try{const Y=await new Promise((ae,oe)=>{navigator.geolocation.getCurrentPosition(ae,oe,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});c(ae=>({...ae,latitude:Y.coords.latitude.toFixed(6),longitude:Y.coords.longitude.toFixed(6),accuracy:`${Y.coords.accuracy.toFixed(1)} meters`}))}catch(Y){console.error("Geolocation error:",Y),g(Y.message||"Failed to get location")}finally{m(!1)}};async function T(Y){if(Y.preventDefault(),!ee){alert("You must be logged in to create a site visit");return}x(!0);try{const{data:ae,error:oe}=await ie.from("site_visit").insert([{client_Id:l.client_Id,latitude:l.latitude,longitude:l.longitude,employee_Id:ee.id,status:"start"}]).select().single();if(oe)throw oe;t([ae,...e]),c({client_Id:"",latitude:"",longitude:"",accuracy:""}),o(!1)}catch(ae){console.error("Error creating site visit:",ae),alert("Failed to create site visit")}finally{x(!1)}}const R=async(Y,ae)=>{if(!w||!ee||!Y){k("No file selected or visit not specified");return}b(!0),k(""),P("");try{const{data:oe,error:ve}=await ie.from("site_visit").select("client_Id").eq("id",Y).single();if(ve)throw ve;if(!oe)throw new Error("Visit not found");const B=w.name.split(".").pop(),ke=`pd-kits/${`${ee.id}-${Y}-${Date.now()}.${B}`}`,{data:$e,error:Ne}=await ie.storage.from("pd-kits").upload(ke,w,{cacheControl:"3600",upsert:!1});if(Ne)throw Ne;const{data:me,error:Xe}=await ie.from("pd_kit_uploads").insert([{employee_id:ee.id,file_path:ke,client_id:oe.client_Id,visit_id:Y,upload_type:ae}]).select();if(Xe)throw Xe;Q($t=>{const gt={...$t};return gt[Y]||(gt[Y]=[]),gt[Y].push(me[0]),gt}),P("PD Kit uploaded successfully!"),E(null),setTimeout(()=>{D(null),P("")},2e3)}catch(oe){console.error("Error in handlePdKitUpload:",oe),k(oe.message||"Failed to upload PD Kit. Please try again.")}finally{b(!1)}},G=()=>q==="admin"||q==="e.head"||q==="head"?f:h,X=Y=>{const{data:ae}=ie.storage.from("pd-kits").getPublicUrl(Y);return ae.publicUrl};return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Site Visits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client or date",value:r,onChange:Y=>n(Y.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsx("div",{className:"flex gap-2 w-full sm:w-auto",children:u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",children:[u.jsx(us,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Site Visit"})]})}),a.map(Y=>u.jsx("button",{onClick:()=>z(`/site-visits/${Y.id}/pd-kits`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"View PD Kits"},Y.id))]})]}),a.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No site visits found"}),r&&u.jsx("button",{onClick:()=>n(""),className:"text-blue-600 hover:underline mt-2",children:"Clear search"})]}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(Y=>{const oe=(q==="admin"||q==="head"?f:h).find(Te=>Te.id===Y.client_Id),ve=new Date(Y.created_at).toLocaleString(),B=K[Y.id]||[];return u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow flex flex-col",children:[u.jsxs("div",{className:"flex-grow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-1",children:oe?oe.name:"Unknown Client"}),(oe==null?void 0:oe.company)&&u.jsx("p",{className:"text-gray-600 text-sm mb-2",children:oe.company}),u.jsx("p",{className:"text-gray-500 text-xs mb-4",children:ve}),B.length>0&&u.jsxs("div",{className:"mb-4",children:[u.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"PD Kits:"}),u.jsx("ul",{className:"space-y-2",children:B.map(Te=>u.jsxs("li",{className:"flex items-center",children:[u.jsx(al,{className:"w-4 h-4 text-gray-500 mr-2"}),u.jsxs("a",{href:X(Te.file_path),target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:[new Date(Te.uploaded_at).toLocaleString()," (",Te.upload_type,")"]})]},Te.id))})]})]}),u.jsxs("div",{className:"flex justify-between items-center mt-4",children:[u.jsx("button",{onClick:()=>z(`/site-visits/${Y.id}`),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Site Visit"}),q==="e.employee"&&u.jsxs("button",{onClick:()=>D(Y.id),className:"text-green-600 hover:text-green-800 text-sm font-medium flex items-center gap-1",children:[u.jsx(Bx,{className:"w-4 h-4"}),u.jsx("span",{children:"Upload PD Kit"})]})]})]},Y.id)})}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Add New Site Visit"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),u.jsxs("form",{onSubmit:T,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Client"}),u.jsxs("select",{value:l.client_Id,onChange:Y=>c({...l,client_Id:Y.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:y||(q==="employee"||q==="e.employee")&&h.length===0,children:[u.jsx("option",{value:"",children:"Select Client"}),G().map(Y=>u.jsxs("option",{value:Y.id,children:[Y.name," (",Y.company,")"]},Y.id))]}),(q==="employee"||q==="e.employee")&&h.length===0&&u.jsx("p",{className:"text-red-500 text-sm mt-1",children:"You don't have any assigned clients"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Location"}),u.jsxs("div",{className:"space-y-3",children:[u.jsx("button",{type:"button",onClick:F,disabled:v||y,className:"w-full px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center justify-center gap-2",children:v?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),l.latitude&&l.longitude&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Latitude:"})," ",l.latitude]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Longitude:"})," ",l.longitude]}),l.accuracy&&u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Accuracy:"})," ",l.accuracy]})]}),_&&u.jsx("p",{className:"text-red-500 text-sm",children:_})]})]}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:y,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:!l.client_Id||!l.latitude||y,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:y?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Site Visit"})]})]})]})}),I&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Upload PD Kit"}),u.jsx("button",{onClick:()=>{D(null),E(null),k(""),P("")},className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Select File (Image or PDF)"}),u.jsx("input",{type:"file",accept:"image/*,.pdf",onChange:Y=>{var ae;return E(((ae=Y.target.files)==null?void 0:ae[0])||null)},className:`block w-full text-sm text-gray-500
                    file:mr-4 file:py-2 file:px-4
                    file:rounded-md file:border-0
                    file:text-sm file:font-semibold
                    file:bg-blue-50 file:text-blue-700
                    hover:file:bg-blue-100`,disabled:S})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Upload Type"}),u.jsx("select",{className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",disabled:S,children:u.jsx("option",{value:"start",children:"Start of Visit"})})]}),w&&u.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Selected file:"})," ",w.name]}),u.jsxs("p",{className:"text-sm",children:[u.jsx("span",{className:"font-medium",children:"Size:"})," ",(w.size/1024).toFixed(2)," KB"]})]}),j&&u.jsx("p",{className:"text-red-500 text-sm",children:j}),C&&u.jsx("p",{className:"text-green-500 text-sm",children:C}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>{D(null),E(null),k(""),P("")},disabled:S,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"button",onClick:()=>{const Y=document.querySelector("select"),ae=Y==null?void 0:Y.value;R(I,ae)},disabled:!w||S,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2",children:S?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload PD Kit"})]})]})]})})]})}function ate(){const{id:e}=Ml(),t=Pn(),[r,n]=O.useState(1),[a,s]=O.useState(!0),[i,o]=O.useState([]),[l,c]=O.useState(!1),[f,d]=O.useState(""),[h,p]=O.useState(""),[v,m]=O.useState(!1),[_,g]=O.useState(""),[y,x]=O.useState(null),[w,E]=O.useState(null),[S,b]=O.useState(!1),[j,k]=O.useState(""),[C,P]=O.useState(!1),[I,D]=O.useState(null),[K]=Qe(X=>[X.role]),[Q,z]=O.useState({address:"",contactNo:"",notes:"",exitLocation:"",selectedAssets:[],latitude:"",longitude:"",pdKitFile:null,pdKitEndFile:null});O.useEffect(()=>{(async()=>{const{data:{user:Y}}=await ie.auth.getUser();Y?D(Y):t("/login")})()},[t]),O.useEffect(()=>{async function X(){if(I){s(!0),p("");try{const{data:Y,error:ae}=await ie.from("assets").select("*").order("item");if(ae)throw ae;if(o(Y||[]),e){const{data:oe,error:ve}=await ie.from("site_visit").select("status, client_Id").eq("id",e).single();if(ve)throw ve;if(oe.status==="end"){t(`/site-visits/${e}`,{replace:!0});return}const{data:B,error:Te}=await ie.from("site_visit_form").select("*").eq("visit_id",e).maybeSingle();if(Te)throw Te;B&&z({address:B.address||"",contactNo:B.contact_no||"",notes:B.notes||"",exitLocation:B.exit_location||"",selectedAssets:[],latitude:B.latitude||"",longitude:B.longitude||"",pdKitFile:null,pdKitEndFile:null});const{data:ke,error:$e}=await ie.from("site_visit_assets").select("asset_id, quantity").eq("site_visit_id",e);if($e)throw $e;ke&&z(Xe=>({...Xe,selectedAssets:ke.map($t=>({assetId:$t.asset_id,quantity:$t.quantity}))}));const{data:Ne,error:me}=await ie.from("pd_kit_uploads").select("file_path").eq("visit_id",e).eq("upload_type","end").maybeSingle();if(!me&&Ne){const{data:Xe}=ie.storage.from("pd-kits").getPublicUrl(Ne.file_path);E(Xe.publicUrl),P(!0)}}}catch(Y){console.error("Error loading data:",Y),p(Y.message||"Failed to load data")}finally{s(!1)}}}X()},[e,t,I]);function q(X){z(Y=>({...Y,...X}))}const ee=async()=>{if(!navigator.geolocation){d("Geolocation is not supported by your browser.");return}c(!0),d("");try{const X=await new Promise((Y,ae)=>{navigator.geolocation.getCurrentPosition(Y,ae,{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})});q({latitude:X.coords.latitude.toString(),longitude:X.coords.longitude.toString()})}catch(X){console.error("Geolocation error:",X),d(X.message||"Failed to get location")}finally{c(!1)}},H=X=>{if(X.target.files&&X.target.files[0]){const Y=X.target.files[0];q({pdKitEndFile:Y});const ae=new FileReader;ae.onload=oe=>{var ve;E((ve=oe.target)==null?void 0:ve.result)},ae.readAsDataURL(Y),P(!1)}},ce=()=>{q({pdKitEndFile:null}),E(null),k(""),P(!1)},J=async()=>{if(!I){k("User not authenticated");return}if(!Q.pdKitEndFile||!e){k("Please select a file first");return}b(!0),k("");try{const{data:X,error:Y}=await ie.from("site_visit").select("client_Id").eq("id",e).single();if(Y)throw Y;if(!X)throw new Error("Visit not found");const ae=Q.pdKitEndFile.name.split(".").pop(),ve=`pd-kits/${`${I.id}-${e}-${Date.now()}.${ae}`}`,{error:B}=await ie.storage.from("pd-kits").upload(ve,Q.pdKitEndFile);if(B)throw B;if(w&&w.includes("pd-kits/")){const $e=w.split("pd-kits/")[1].split("?")[0];await ie.storage.from("pd-kits").remove([$e])}const{error:Te}=await ie.from("pd_kit_uploads").upsert({employee_id:I.id,client_id:X.client_Id,visit_id:e,file_path:ve,upload_type:"end"});if(Te)throw Te;const{data:ke}=ie.storage.from("pd-kits").getPublicUrl(ve);E(ke.publicUrl),P(!0)}catch(X){console.error("Error uploading PD Kit:",X),k(X.message||"Failed to upload PD Kit")}finally{b(!1)}},N=X=>X===1&&!Q.notes?(p("Please enter notes"),!1):X===2&&!Q.address?(p("Please enter an address"),!1):X===3&&!Q.exitLocation?(p("Please enter exit location"),!1):X===3&&(!Q.latitude||!Q.longitude)?(p("Please update your location coordinates"),!1):(p(""),!0);async function F(X){if(X.preventDefault(),!!N(3)){s(!0),p("");try{if(!I)throw new Error("User not authenticated");let Y=e;if(!e){const{data:ve,error:B}=await ie.from("site_visit").insert([{employee_id:I.id,status:"start",visit_date:new Date().toISOString()}]).select().single();if(B)throw B;Y=ve.id}const{error:ae}=await ie.from("site_visit").update({status:"end"}).eq("id",Y);if(ae)throw ae;const{error:oe}=await ie.from("site_visit_form").upsert({id:e||void 0,visit_id:Y,address:Q.address,contact_no:Q.contactNo,notes:Q.notes,exit_location:Q.exitLocation,latitude:Q.latitude,longitude:Q.longitude});if(oe)throw oe;if(Q.selectedAssets.length>0){if(e){const{error:Te}=await ie.from("site_visit_assets").delete().eq("site_visit_id",Y);if(Te)throw Te}const ve=Q.selectedAssets.map(Te=>({site_visit_id:Y,asset_id:Te.assetId,quantity:Math.max(1,Te.quantity)})),{error:B}=await ie.from("site_visit_assets").insert(ve);if(B)throw B}Q.pdKitEndFile&&!C&&await J(),localStorage.removeItem("draftSiteVisitForm"),window.dispatchEvent(new CustomEvent("siteVisitUpdated",{detail:{visitId:Y}})),alert(`Site visit ${e?"completed":"created"} successfully!`),t("/site-visits",{replace:!0})}catch(Y){console.error("Error saving site visit:",Y),p(Y.message||"Failed to save site visit")}finally{s(!1)}}}function T(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Notes *"}),u.jsx("textarea",{value:Q.notes,onChange:X=>q({notes:X.target.value}),className:"w-full p-2 border rounded h-32",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Contact No"}),u.jsx("input",{type:"text",value:Q.contactNo,onChange:X=>q({contactNo:X.target.value}),className:"w-full p-2 border rounded"})]})]})}function R(){return u.jsxs("div",{className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Address *"}),u.jsx("input",{type:"text",value:Q.address,onChange:X=>q({address:X.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mt-6",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assets"}),u.jsx("div",{className:"space-y-3",children:i.map(X=>{var Y;return u.jsxs("div",{className:"flex items-center gap-4 p-2 border rounded",children:[u.jsx("input",{type:"checkbox",id:`asset-${X.id}`,checked:Q.selectedAssets.some(ae=>ae.assetId===X.id),onChange:ae=>{const oe=ae.target.checked?[...Q.selectedAssets,{assetId:X.id,quantity:1}]:Q.selectedAssets.filter(ve=>ve.assetId!==X.id);q({selectedAssets:oe})},className:"h-5 w-5"}),u.jsx("label",{htmlFor:`asset-${X.id}`,className:"flex-1",children:X.item}),Q.selectedAssets.some(ae=>ae.assetId===X.id)&&u.jsx("input",{type:"number",min:"1",value:((Y=Q.selectedAssets.find(ae=>ae.assetId===X.id))==null?void 0:Y.quantity)||1,onChange:ae=>{const oe=Q.selectedAssets.map(ve=>ve.assetId===X.id?{...ve,quantity:Math.max(1,parseInt(ae.target.value)||1)}:ve);q({selectedAssets:oe})},className:"w-20 p-1 border rounded"})]},X.id)})})]})]})}function G(){return u.jsxs("div",{className:"space-y-6",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Exit Location *"}),u.jsx("input",{type:"text",value:Q.exitLocation,onChange:X=>q({exitLocation:X.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Location Coordinates *"}),u.jsx("button",{type:"button",onClick:ee,disabled:l,className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700 disabled:bg-green-400 flex items-center gap-2 mb-2",children:l?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Getting Location..."]}):"Update Current Location"}),f&&u.jsx("p",{className:"text-red-500 text-sm",children:f}),u.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-2",children:[u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Latitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:Q.latitude||"Not set"})]}),u.jsxs("div",{children:[u.jsx("p",{className:"text-sm font-medium",children:"Longitude"}),u.jsx("p",{className:"text-sm text-gray-700 bg-gray-100 p-2 rounded",children:Q.longitude||"Not set"})]})]})]}),K==="e.employee"&&u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"PD Kit (End of Visit)"}),u.jsxs("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center",children:[w?u.jsxs("div",{className:"flex flex-col items-center",children:[u.jsxs("div",{className:"relative",children:[u.jsx("img",{src:w,alt:"PD Kit End Preview",className:"max-h-48 mb-2 rounded"}),u.jsx("button",{type:"button",onClick:ce,className:"absolute top-0 right-0 bg-white rounded-full p-1 shadow",children:u.jsx(Bl,{className:"w-4 h-4 text-red-500"})})]}),u.jsx("button",{type:"button",onClick:()=>{var X;return(X=document.getElementById("pd-kit-end-upload"))==null?void 0:X.click()},className:"text-blue-600 hover:underline text-sm mb-2",children:"Change PD Kit"}),!C&&u.jsx("button",{type:"button",onClick:J,disabled:S,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:S?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Uploading..."]}):"Upload PD Kit"}),C&&u.jsx("p",{className:"text-green-600 text-sm mt-2",children:"PD Kit uploaded successfully!"})]}):u.jsx("label",{htmlFor:"pd-kit-end-upload",className:"cursor-pointer",children:u.jsxs("div",{className:"flex flex-col items-center justify-center space-y-2",children:[u.jsx(Bx,{className:"w-8 h-8 text-gray-400"}),u.jsx("p",{className:"text-sm text-gray-600",children:"Click to upload PD Kit image"}),u.jsx("p",{className:"text-xs text-gray-500",children:"(Optional for employees)"})]})}),u.jsx("input",{id:"pd-kit-end-upload",type:"file",accept:"image/*",onChange:H,className:"hidden"})]}),j&&u.jsx("p",{className:"text-red-500 text-sm mt-2",children:j})]})]})}return a?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsxs("div",{className:"max-w-2xl mx-auto p-6 bg-white shadow-md rounded-lg mt-6",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:e?"Complete Site Visit":"Create New Site Visit"}),h&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:h}),u.jsxs("div",{className:"mb-6",children:[u.jsxs("div",{className:"flex justify-between mb-2 text-sm font-medium",children:[u.jsx("span",{className:r===1?"text-blue-600":"text-gray-500",children:"Step 1: Details"}),u.jsx("span",{className:r===2?"text-blue-600":"text-gray-500",children:"Step 2: Assets"}),u.jsx("span",{className:r===3?"text-blue-600":"text-gray-500",children:"Step 3: Completion"})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full transition-all duration-300",style:{width:`${(r-1)/2*100}%`}})})]}),u.jsxs("form",{onSubmit:F,className:"space-y-6",children:[r===1&&T(),r===2&&R(),r===3&&G(),u.jsxs("div",{className:"flex justify-between pt-4 border-t",children:[r>1?u.jsx("button",{type:"button",onClick:()=>n(r-1),className:"px-4 py-2 bg-gray-500 text-white rounded hover:bg-gray-600",disabled:a,children:"Back"}):u.jsx("div",{}),r<3?u.jsx("button",{type:"button",onClick:()=>{N(r)&&n(r+1)},className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:a,children:"Continue"}):u.jsx("button",{type:"submit",className:"px-4 py-2 bg-green-600 text-white rounded hover:bg-green-700",disabled:a||S,children:a?u.jsxs("span",{className:"flex items-center",children:[u.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Saving..."]}):e?"Complete Visit":"Create Visit"})]})]})]})}function ste(){const[e,t]=O.useState([]),r=Pn();O.useEffect(()=>{n()},[]);async function n(){const{data:a,error:s}=await ie.from("clients").select("*, client_assignments(employee_id)").eq("status","completed");if(s){console.error("Error loading clients:",s);return}t(a||[])}return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsx("div",{className:"flex justify-between items-center mb-6",children:u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Clients History"})}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(a=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:a.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:a.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:a.address}),u.jsx("div",{className:"flex justify-between items-center",children:u.jsx("button",{onClick:()=>r(`/clientshistoryprofile/${a.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"})})]},a.id))})]})}function ite(){const[e,t]=O.useState([]),[r,n]=O.useState([]),[a,s]=O.useState(""),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[f,d]=O.useState(null),[h,p]=O.useState([]),v=Qe(D=>D.user),[m,_]=O.useState({title:"",description:"",date:"",time:"",assignTo:"self"}),[g,y]=O.useState(!1),[x,w]=O.useState("");O.useEffect(()=>{S(),E();const D=setInterval(b,6e4);return()=>clearInterval(D)},[]),O.useEffect(()=>{b()},[e]);async function E(){const{data:D,error:K}=await ie.from("employees").select("*");K||p(D||[])}async function S(){y(!0);try{const{data:D,error:K}=await ie.from("notifications").select("*").order("scheduled_at",{ascending:!1});if(K)throw K;t(D||[])}catch(D){console.error("Error loading notifications:",D),w("Failed to load notifications")}finally{y(!1)}}function b(){const D=new Date,K=e.filter(Q=>new Date(Q.scheduled_at)<=D&&!Q.is_delivered);n(K)}async function j(D){D.preventDefault(),y(!0),w("");try{const K=new Date(`${m.date}T${m.time}`).toISOString(),Q=m.assignTo==="all"?h.map(ee=>ee.id):[v==null?void 0:v.id],{data:z,error:q}=await ie.from("notifications").insert(Q.map(ee=>({title:m.title,description:m.description,scheduled_at:K,created_by:v==null?void 0:v.id,assigned_to:ee,is_delivered:!1}))).select();if(q)throw q;t([...z,...e]),_({title:"",description:"",date:"",time:"",assignTo:"self"}),o(!1)}catch(K){console.error("Error creating notification:",K),w("Failed to create notification")}finally{y(!1)}}async function k(D){try{await ie.from("notifications").update({is_delivered:!0}).eq("id",D),t(e.map(K=>K.id===D?{...K,is_delivered:!0}:K))}catch(K){console.error("Error marking notification:",K)}}async function C(D,K){y(!0);try{const Q=K==="all"?h.map(ee=>ee.id):[v==null?void 0:v.id];await ie.from("notifications").delete().eq("id",D);const{data:z,error:q}=await ie.from("notifications").insert(Q.map(ee=>({...f,id:void 0,assigned_to:ee,is_delivered:!1}))).select();if(q)throw q;t([...z,...e.filter(ee=>ee.id!==D)]),c(!1)}catch(Q){console.error("Error assigning notification:",Q),w("Failed to assign notification")}finally{y(!1)}}const P=D=>new Date(D).toLocaleDateString(),I=D=>new Date(D).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Notification Center"}),u.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-4 w-full sm:w-auto",children:[u.jsxs("div",{className:"relative w-full sm:w-64",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Notifications",value:a,onChange:D=>s(D.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>o(!0),className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg flex items-center gap-2 w-full sm:w-auto justify-center",disabled:g,children:[u.jsx(us,{className:"w-4 h-4"}),u.jsx("span",{children:"Add Notification"})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:x}),g&&!e.length?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):r.length===0?u.jsx("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:u.jsx("p",{className:"text-gray-500",children:"No active notifications"})}):u.jsx("div",{className:"space-y-4",children:r.filter(D=>D.title.toLowerCase().includes(a.toLowerCase())||D.description&&D.description.toLowerCase().includes(a.toLowerCase())).map(D=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow w-full relative",children:[u.jsx("button",{onClick:()=>k(D.id),className:"absolute top-4 right-4 text-gray-400 hover:text-gray-600",title:"Dismiss notification",children:u.jsx(Bl,{className:"w-5 h-5"})}),u.jsxs("div",{className:"flex justify-between items-start pr-6",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:D.title}),D.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:D.description}),u.jsx("div",{className:"flex items-center gap-2",children:u.jsxs("span",{className:"text-xs text-gray-500",children:["Scheduled: ",P(D.scheduled_at)," at ",I(D.scheduled_at)]})})]}),u.jsx("div",{className:"flex gap-2",children:((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="employee")&&u.jsxs("button",{onClick:()=>{d(D),c(!0)},className:"text-blue-600 hover:text-blue-800 text-sm font-medium flex items-center gap-1",title:"Reassign notification",children:[D.assigned_to===(v==null?void 0:v.id)?u.jsx(Vv,{className:"w-4 h-4"}):u.jsx(Yi,{className:"w-4 h-4"}),"Reassign"]})})]})]},D.id))}),i&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Create Notification"}),u.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700",disabled:g,children:"✕"})]}),u.jsxs("form",{onSubmit:j,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Title *"}),u.jsx("input",{type:"text",value:m.title,onChange:D=>_({...m,title:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Description"}),u.jsx("textarea",{value:m.description,onChange:D=>_({...m,description:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",rows:3,disabled:g})]}),u.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Date *"}),u.jsx("input",{type:"date",value:m.date,onChange:D=>_({...m,date:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Time *"}),u.jsx("input",{type:"time",value:m.time,onChange:D=>_({...m,time:D.target.value}),className:"w-full p-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",required:!0,disabled:g})]})]}),((v==null?void 0:v.role)==="head"||(v==null?void 0:v.role)==="admin"||(v==null?void 0:v.role)==="e.head")&&u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex gap-4",children:[u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"self",checked:m.assignTo==="self",onChange:()=>_({...m,assignTo:"self"}),className:"h-4 w-4",disabled:g}),u.jsx("span",{children:"Only me"})]}),u.jsxs("label",{className:"flex items-center gap-2",children:[u.jsx("input",{type:"radio",name:"assignTo",value:"all",checked:m.assignTo==="all",onChange:()=>_({...m,assignTo:"all"}),className:"h-4 w-4",disabled:g}),u.jsx("span",{children:"All employees"})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:x}),u.jsxs("div",{className:"flex justify-end gap-3 pt-4",children:[u.jsx("button",{type:"button",onClick:()=>o(!1),disabled:g,className:"px-4 py-2 text-gray-600 hover:text-gray-800 disabled:opacity-50",children:"Cancel"}),u.jsx("button",{type:"submit",disabled:g||!m.title||!m.date||!m.time,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 flex items-center gap-2",children:g?u.jsxs(u.Fragment,{children:[u.jsxs("svg",{className:"animate-spin h-4 w-4",viewBox:"0 0 24 24",children:[u.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),u.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Notification"})]})]})]})}),l&&f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("div",{className:"flex justify-between items-center mb-4",children:[u.jsx("h2",{className:"text-xl font-bold",children:"Reassign Notification"}),u.jsx("button",{onClick:()=>c(!1),className:"text-gray-500 hover:text-gray-700",disabled:g,children:"✕"})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("h3",{className:"text-lg font-semibold mb-2",children:f.title}),f.description&&u.jsx("p",{className:"text-gray-600 mb-4",children:f.description})]}),u.jsxs("div",{className:"mb-6",children:[u.jsx("label",{className:"block text-gray-700 mb-4 font-medium",children:"Assign To"}),u.jsxs("div",{className:"flex flex-col gap-3",children:[u.jsxs("button",{onClick:()=>C(f.id,"self"),disabled:g,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-blue-100 rounded-full",children:u.jsx(Vv,{className:"w-5 h-5 text-blue-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"Only me"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification only to yourself"})]})]}),u.jsxs("button",{onClick:()=>C(f.id,"all"),disabled:g,className:"flex items-center gap-3 p-3 border rounded-lg hover:bg-gray-50 disabled:opacity-50",children:[u.jsx("div",{className:"p-2 bg-green-100 rounded-full",children:u.jsx(Yi,{className:"w-5 h-5 text-green-600"})}),u.jsxs("div",{className:"text-left",children:[u.jsx("p",{className:"font-medium",children:"All employees"}),u.jsx("p",{className:"text-sm text-gray-500",children:"Assign this notification to all employees"})]})]})]})]}),x&&u.jsx("div",{className:"mb-4 p-2 bg-red-100 text-red-700 text-sm rounded",children:x})]})})]})}/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var f4=1252,ote=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],X1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},Q1=function(e){ote.indexOf(e)!=-1&&(f4=X1[0]=e)};function lte(){Q1(1252)}var qn=function(e){Q1(e)};function d4(){qn(1200),lte()}function lb(e){for(var t=[],r=0,n=e.length;r<n;++r)t[r]=e.charCodeAt(r);return t}function cte(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r)+(e.charCodeAt(2*r+1)<<8));return t.join("")}function h4(e){for(var t=[],r=0;r<e.length>>1;++r)t[r]=String.fromCharCode(e.charCodeAt(2*r+1)+(e.charCodeAt(2*r)<<8));return t.join("")}var Oc=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1);return t==255&&r==254?cte(e.slice(2)):t==254&&r==255?h4(e.slice(2)):t==65279?e.slice(1):e},pd=function(t){return String.fromCharCode(t)},cb=function(t){return String.fromCharCode(t)},dg,Bs="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ub(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0,c=0;c<e.length;)r=e.charCodeAt(c++),s=r>>2,n=e.charCodeAt(c++),i=(r&3)<<4|n>>4,a=e.charCodeAt(c++),o=(n&15)<<2|a>>6,l=a&63,isNaN(n)?o=l=64:isNaN(a)&&(l=64),t+=Bs.charAt(s)+Bs.charAt(i)+Bs.charAt(o)+Bs.charAt(l);return t}function ln(e){var t="",r=0,n=0,a=0,s=0,i=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var c=0;c<e.length;)s=Bs.indexOf(e.charAt(c++)),i=Bs.indexOf(e.charAt(c++)),r=s<<2|i>>4,t+=String.fromCharCode(r),o=Bs.indexOf(e.charAt(c++)),n=(i&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(n)),l=Bs.indexOf(e.charAt(c++)),a=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(a));return t}var Be=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),ho=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,r){return r?new Buffer(t,r):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function ai(e){return Be?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function fb(e){return Be?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gn=function(t){return Be?ho(t,"binary"):t.split("").map(function(r){return r.charCodeAt(0)&255})};function po(e){if(Array.isArray(e))return e.map(function(n){return String.fromCharCode(n)}).join("");for(var t=[],r=0;r<e.length;++r)t[r]=String.fromCharCode(e[r]);return t.join("")}function J1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return J1(new Uint8Array(e));for(var t=new Array(e.length),r=0;r<e.length;++r)t[r]=e[r];return t}var Fs=Be?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:ho(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,r=0;for(t=0;t<e.length;++t)r+=e[t].length;var n=new Uint8Array(r),a=0;for(t=0,r=0;t<e.length;r+=a,++t)if(a=e[t].length,e[t]instanceof Uint8Array)n.set(e[t],r);else{if(typeof e[t]=="string")throw"wtf";n.set(new Uint8Array(e[t]),r)}return n}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function ute(e){for(var t=[],r=0,n=e.length+250,a=ai(e.length+255),s=0;s<e.length;++s){var i=e.charCodeAt(s);if(i<128)a[r++]=i;else if(i<2048)a[r++]=192|i>>6&31,a[r++]=128|i&63;else if(i>=55296&&i<57344){i=(i&1023)+64;var o=e.charCodeAt(++s)&1023;a[r++]=240|i>>8&7,a[r++]=128|i>>2&63,a[r++]=128|o>>6&15|(i&3)<<4,a[r++]=128|o&63}else a[r++]=224|i>>12&15,a[r++]=128|i>>6&63,a[r++]=128|i&63;r>n&&(t.push(a.slice(0,r)),r=0,a=ai(65535),n=65530)}return t.push(a.slice(0,r)),Fs(t)}var Pr=/\u0000/g,Dc=/[\u0001-\u0006]/g;function ll(e){for(var t="",r=e.length-1;r>=0;)t+=e.charAt(r--);return t}function Xn(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}function Z1(e,t){var r=""+e;return r.length>=t?r:Tt(" ",t-r.length)+r}function B0(e,t){var r=""+e;return r.length>=t?r:r+Tt(" ",t-r.length)}function fte(e,t){var r=""+Math.round(e);return r.length>=t?r:Tt("0",t-r.length)+r}function dte(e,t){var r=""+e;return r.length>=t?r:Tt("0",t-r.length)+r}var db=Math.pow(2,32);function No(e,t){if(e>db||e<-db)return fte(e,t);var r=Math.round(e);return dte(r,t)}function U0(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var hb=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],Sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function hte(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"上午/下午 "hh"時"mm"分"ss"秒 "',e}var je={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"上午/下午 "hh"時"mm"分"ss"秒 "'},pb={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},pte={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function W0(e,t,r){for(var n=e<0?-1:1,a=e*n,s=0,i=1,o=0,l=1,c=0,f=0,d=Math.floor(a);c<t&&(d=Math.floor(a),o=d*i+s,f=d*c+l,!(a-d<5e-8));)a=1/(a-d),s=i,i=o,l=c,c=f;if(f>t&&(c>t?(f=l,o=s):(f=c,o=i)),!r)return[0,n*o,f];var h=Math.floor(n*o/f);return[h,n*o-h*f,f]}function ji(e,t,r){if(e>2958465||e<0)return null;var n=e|0,a=Math.floor(86400*(e-n)),s=0,i=[],o={D:n,T:a,u:86400*(e-n)-a,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(n+=1462),o.u>.9999&&(o.u=0,++a==86400&&(o.T=a=0,++n,++o.D)),n===60)i=r?[1317,10,29]:[1900,2,29],s=3;else if(n===0)i=r?[1317,8,29]:[1900,1,0],s=6;else{n>60&&--n;var l=new Date(1900,0,1);l.setDate(l.getDate()+n-1),i=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),n<60&&(s=(s+6)%7),r&&(s=_te(l,i))}return o.y=i[0],o.m=i[1],o.d=i[2],o.S=a%60,a=Math.floor(a/60),o.M=a%60,a=Math.floor(a/60),o.H=a,o.q=s,o}var p4=new Date(1899,11,31,0,0,0),mte=p4.getTime(),vte=new Date(1900,2,1,0,0,0);function m4(e,t){var r=e.getTime();return t?r-=1461*24*60*60*1e3:e>=vte&&(r+=24*60*60*1e3),(r-(mte+(e.getTimezoneOffset()-p4.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function ey(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function gte(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function xte(e){var t=e<0?12:11,r=ey(e.toFixed(12));return r.length<=t||(r=e.toPrecision(10),r.length<=t)?r:e.toExponential(5)}function yte(e){var t=ey(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function zu(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),r;return t>=-4&&t<=-1?r=e.toPrecision(10+t):Math.abs(t)<=9?r=xte(e):t===10?r=e.toFixed(10).substr(0,12):r=yte(e),ey(gte(r.toUpperCase()))}function eo(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):zu(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return jn(14,m4(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function _te(e,t){t[0]-=581;var r=e.getDay();return e<60&&(r=(r+6)%7),r}function wte(e,t,r,n){var a="",s=0,i=0,o=r.y,l,c=0;switch(e){case 98:o=r.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,c=2;break;default:l=o%1e4,c=4;break}break;case 109:switch(t.length){case 1:case 2:l=r.m,c=t.length;break;case 3:return Sm[r.m-1][1];case 5:return Sm[r.m-1][0];default:return Sm[r.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=r.d,c=t.length;break;case 3:return hb[r.q][0];default:return hb[r.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(r.H+11)%12,c=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=r.H,c=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=r.M,c=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return r.u===0&&(t=="s"||t=="ss")?Xn(r.S,t.length):(n>=2?i=n===3?1e3:100:i=n===1?10:1,s=Math.round(i*(r.S+r.u)),s>=60*i&&(s=0),t==="s"?s===0?"0":""+s/i:(a=Xn(s,2+n),t==="ss"?a.substr(0,2):"."+a.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=r.D*24+r.H;break;case"[m]":case"[mm]":l=(r.D*24+r.H)*60+r.M;break;case"[s]":case"[ss]":l=((r.D*24+r.H)*60+r.M)*60+Math.round(r.S+r.u);break;default:throw"bad abstime format: "+t}c=t.length===3?1:2;break;case 101:l=o,c=1;break}var f=c>0?Xn(l,c):"";return f}function Us(e){var t=3;if(e.length<=t)return e;for(var r=e.length%t,n=e.substr(0,r);r!=e.length;r+=t)n+=(n.length>0?",":"")+e.substr(r,t);return n}var v4=/%/g;function bte(e,t,r){var n=t.replace(v4,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function Ete(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function g4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+g4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),r.indexOf("e")===-1){var i=Math.floor(Math.log(t)*Math.LOG10E);for(r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s);r.substr(0,2)==="0.";)r=r.charAt(0)+r.substr(2,a)+"."+r.substr(2+a),r=r.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}var x4=/# (\?+)( ?)\/( ?)(\d+)/;function Ste(e,t,r){var n=parseInt(e[4],10),a=Math.round(t*n),s=Math.floor(a/n),i=a-s*n,o=n;return r+(s===0?"":""+s)+" "+(i===0?Tt(" ",e[1].length+1+e[4].length):Z1(i,e[1].length)+e[2]+"/"+e[3]+Xn(o,e[4].length))}function kte(e,t,r){return r+(t===0?"":""+t)+Tt(" ",e[1].length+2+e[4].length)}var y4=/^#*0*\.([0#]+)/,_4=/\).*[0#]/,w4=/\(###\) ###\\?-####/;function Ar(e){for(var t="",r,n=0;n!=e.length;++n)switch(r=e.charCodeAt(n)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(r)}return t}function mb(e,t){var r=Math.pow(10,t);return""+Math.round(e*r)/r}function vb(e,t){var r=e-Math.floor(e),n=Math.pow(10,t);return t<(""+Math.round(r*n)).length?0:Math.round(r*n)}function Tte(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function Cte(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function vn(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?vn("n",n,r):"("+vn("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Ete(e,t,r);if(t.indexOf("%")!==-1)return bte(e,t,r);if(t.indexOf("E")!==-1)return g4(t,r);if(t.charCodeAt(0)===36)return"$"+vn(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+No(l,t.length);if(t.match(/^[#?]+$/))return a=No(r,0),a==="0"&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(x4))return Ste(s,l,c);if(t.match(/^#+0+$/))return c+No(l,t.length-t.indexOf("0"));if(s=t.match(y4))return a=mb(r,s[1].length).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])).replace(/\.(\d*)$/,function(v,m){return"."+m+Tt("0",Ar(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+mb(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Us(No(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+vn(e,t,-r):Us(""+(Math.floor(r)+Tte(r,s[1].length)))+"."+Xn(vb(r,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return vn(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ll(vn(e,t.replace(/[\\-]/g,""),r)),i=0,ll(ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(w4))return a=vn(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=W0(l,Math.pow(10,i)-1,!1),a=""+c,f=rs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=B0(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=W0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Z1(o[1],i)+s[2]+"/"+s[3]+B0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=No(r,0),t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return i=vb(r,s[1].length),r<0?"-"+vn(e,t,-r):Us(Cte(r)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xn(0,3-v.length):"")+v})+"."+Xn(i,s[1].length);switch(t){case"###,##0.00":return vn(e,"#,##0.00",r);case"###,###":case"##,###":case"#,###":var p=Us(No(l,0));return p!=="0"?c+p:"";case"###,###.00":return vn(e,"###,##0.00",r).replace(/^0\./,".");case"#,###.00":return vn(e,"#,##0.00",r).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function Nte(e,t,r){for(var n=t.length-1;t.charCodeAt(n-1)===44;)--n;return rs(e,t.substr(0,n),r/Math.pow(10,3*(t.length-n)))}function Ate(e,t,r){var n=t.replace(v4,""),a=t.length-n.length;return rs(e,n,r*Math.pow(10,2*a))+Tt("%",a)}function b4(e,t){var r,n=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+b4(e,-t);var a=e.indexOf(".");a===-1&&(a=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%a;if(s<0&&(s+=a),r=(t/Math.pow(10,s)).toPrecision(n+1+(a+s)%a),!r.match(/[Ee]/)){var i=Math.floor(Math.log(t)*Math.LOG10E);r.indexOf(".")===-1?r=r.charAt(0)+"."+r.substr(1)+"E+"+(i-r.length+s):r+="E+"+(i-s),r=r.replace(/\+-/,"-")}r=r.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,c,f){return l+c+f.substr(0,(a+s)%a)+"."+f.substr(s)+"E"})}else r=t.toExponential(n);return e.match(/E\+00$/)&&r.match(/e[+-]\d$/)&&(r=r.substr(0,r.length-1)+"0"+r.charAt(r.length-1)),e.match(/E\-/)&&r.match(/e\+/)&&(r=r.replace(/e\+/,"e")),r.replace("e","E")}function ma(e,t,r){if(e.charCodeAt(0)===40&&!t.match(_4)){var n=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return r>=0?ma("n",n,r):"("+ma("n",n,-r)+")"}if(t.charCodeAt(t.length-1)===44)return Nte(e,t,r);if(t.indexOf("%")!==-1)return Ate(e,t,r);if(t.indexOf("E")!==-1)return b4(t,r);if(t.charCodeAt(0)===36)return"$"+ma(e,t.substr(t.charAt(1)==" "?2:1),r);var a,s,i,o,l=Math.abs(r),c=r<0?"-":"";if(t.match(/^00+$/))return c+Xn(l,t.length);if(t.match(/^[#?]+$/))return a=""+r,r===0&&(a=""),a.length>t.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(x4))return kte(s,l,c);if(t.match(/^#+0+$/))return c+Xn(l,t.length-t.indexOf("0"));if(s=t.match(y4))return a=(""+r).replace(/^([^\.]+)$/,"$1."+Ar(s[1])).replace(/\.$/,"."+Ar(s[1])),a=a.replace(/\.(\d*)$/,function(v,m){return"."+m+Tt("0",Ar(s[1]).length-m.length)}),t.indexOf("0.")!==-1?a:a.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return c+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return c+Us(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return r<0?"-"+ma(e,t,-r):Us(""+r)+"."+Tt("0",s[1].length);if(s=t.match(/^#,#*,#0/))return ma(e,t.replace(/^#,#*,/,""),r);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return a=ll(ma(e,t.replace(/[\\-]/g,""),r)),i=0,ll(ll(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return i<a.length?a.charAt(i++):v==="0"?"0":""}));if(t.match(w4))return a=ma(e,"##########",r),"("+a.substr(0,3)+") "+a.substr(3,3)+"-"+a.substr(6);var f="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(s[4].length,7),o=W0(l,Math.pow(10,i)-1,!1),a=""+c,f=rs("n",s[1],o[1]),f.charAt(f.length-1)==" "&&(f=f.substr(0,f.length-1)+"0"),a+=f+s[2]+"/"+s[3],f=B0(o[2],i),f.length<s[4].length&&(f=Ar(s[4].substr(s[4].length-f.length))+f),a+=f,a;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return i=Math.min(Math.max(s[1].length,s[4].length),7),o=W0(l,Math.pow(10,i)-1,!0),c+(o[0]||(o[1]?"":"0"))+" "+(o[1]?Z1(o[1],i)+s[2]+"/"+s[3]+B0(o[2],i):Tt(" ",2*i+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return a=""+r,t.length<=a.length?a:Ar(t.substr(0,t.length-a.length))+a;if(s=t.match(/^([#0]+)\.([#0]+)$/)){a=""+r.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),i=a.indexOf(".");var d=t.indexOf(".")-i,h=t.length-a.length-d;return Ar(t.substr(0,d)+a+t.substr(t.length-h))}if(s=t.match(/^00,000\.([#0]*0)$/))return r<0?"-"+ma(e,t,-r):Us(""+r).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Xn(0,3-v.length):"")+v})+"."+Xn(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var p=Us(""+l);return p!=="0"?c+p:"";default:if(t.match(/\.[0#?]*$/))return ma(e,t.slice(0,t.lastIndexOf(".")),r)+Ar(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function rs(e,t,r){return(r|0)===r?ma(e,t,r):vn(e,t,r)}function Ote(e){for(var t=[],r=!1,n=0,a=0;n<e.length;++n)switch(e.charCodeAt(n)){case 34:r=!r;break;case 95:case 42:case 92:++n;break;case 59:t[t.length]=e.substr(a,n-a),a=n+1}if(t[t.length]=e.substr(a),r===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var E4=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ec(e){for(var t=0,r="",n="";t<e.length;)switch(r=e.charAt(t)){case"G":U0(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"上":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="上午/下午")return!0;++t;break;case"[":for(n=r;e.charAt(t++)!=="]"&&t<e.length;)n+=e.charAt(t);if(n.match(E4))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(r=e.charAt(++t))>-1||r=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===r;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function Dte(e,t,r,n){for(var a=[],s="",i=0,o="",l="t",c,f,d,h="H";i<e.length;)switch(o=e.charAt(i)){case"G":if(!U0(e,i))throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"G",v:"General"},i+=7;break;case'"':for(s="";(d=e.charCodeAt(++i))!==34&&i<e.length;)s+=String.fromCharCode(d);a[a.length]={t:"t",v:s},++i;break;case"\\":var p=e.charAt(++i),v=p==="("||p===")"?p:"t";a[a.length]={t:v,v:p},++i;break;case"_":a[a.length]={t:"t",v:" "},i+=2;break;case"@":a[a.length]={t:"T",v:t},++i;break;case"B":case"b":if(e.charAt(i+1)==="1"||e.charAt(i+1)==="2"){if(c==null&&(c=ji(t,r,e.charAt(i+1)==="2"),c==null))return"";a[a.length]={t:"X",v:e.substr(i,2)},l=o,i+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||c==null&&(c=ji(t,r),c==null))return"";for(s=o;++i<e.length&&e.charAt(i).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=h),a[a.length]={t:o,v:s},l=o;break;case"A":case"a":case"上":var m={t:o,v:o};if(c==null&&(c=ji(t,r)),e.substr(i,3).toUpperCase()==="A/P"?(c!=null&&(m.v=c.H>=12?"P":"A"),m.t="T",h="h",i+=3):e.substr(i,5).toUpperCase()==="AM/PM"?(c!=null&&(m.v=c.H>=12?"PM":"AM"),m.t="T",i+=5,h="h"):e.substr(i,5).toUpperCase()==="上午/下午"?(c!=null&&(m.v=c.H>=12?"下午":"上午"),m.t="T",i+=5,h="h"):(m.t="t",++i),c==null&&m.t==="T")return"";a[a.length]=m,l=o;break;case"[":for(s=o;e.charAt(i++)!=="]"&&i<e.length;)s+=e.charAt(i);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(E4)){if(c==null&&(c=ji(t,r),c==null))return"";a[a.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ec(e)||(a[a.length]={t:"t",v:s}));break;case".":if(c!=null){for(s=o;++i<e.length&&(o=e.charAt(i))==="0";)s+=o;a[a.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++i<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(i))>-1;)s+=o;a[a.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++i)===o;)s+=o;a[a.length]={t:o,v:s},l=o;break;case"*":++i,(e.charAt(i)==" "||e.charAt(i)=="*")&&++i;break;case"(":case")":a[a.length]={t:n===1?"t":o,v:o},++i;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;i<e.length&&"0123456789".indexOf(e.charAt(++i))>-1;)s+=e.charAt(i);a[a.length]={t:"D",v:s};break;case" ":a[a.length]={t:o,v:o},++i;break;case"$":a[a.length]={t:"t",v:"$"},++i;break;default:if(",$-+/():!^&'~{}<>=€acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);a[a.length]={t:"t",v:o},++i;break}var _=0,g=0,y;for(i=a.length-1,l="t";i>=0;--i)switch(a[i].t){case"h":case"H":a[i].t=h,l="h",_<1&&(_=1);break;case"s":(y=a[i].v.match(/\.0+$/))&&(g=Math.max(g,y[0].length-1)),_<3&&(_=3);case"d":case"y":case"M":case"e":l=a[i].t;break;case"m":l==="s"&&(a[i].t="M",_<2&&(_=2));break;case"X":break;case"Z":_<1&&a[i].v.match(/[Hh]/)&&(_=1),_<2&&a[i].v.match(/[Mm]/)&&(_=2),_<3&&a[i].v.match(/[Ss]/)&&(_=3)}switch(_){case 0:break;case 1:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M),c.M>=60&&(c.M=0,++c.H);break;case 2:c.u>=.5&&(c.u=0,++c.S),c.S>=60&&(c.S=0,++c.M);break}var x="",w;for(i=0;i<a.length;++i)switch(a[i].t){case"t":case"T":case" ":case"D":break;case"X":a[i].v="",a[i].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":a[i].v=wte(a[i].t.charCodeAt(0),a[i].v,c,g),a[i].t="t";break;case"n":case"?":for(w=i+1;a[w]!=null&&((o=a[w].t)==="?"||o==="D"||(o===" "||o==="t")&&a[w+1]!=null&&(a[w+1].t==="?"||a[w+1].t==="t"&&a[w+1].v==="/")||a[i].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(a[w].v==="/"||a[w].v===" "&&a[w+1]!=null&&a[w+1].t=="?"));)a[i].v+=a[w].v,a[w]={v:"",t:";"},++w;x+=a[i].v,i=w-1;break;case"G":a[i].t="t",a[i].v=eo(t,r);break}var E="",S,b;if(x.length>0){x.charCodeAt(0)==40?(S=t<0&&x.charCodeAt(0)===45?-t:t,b=rs("n",x,S)):(S=t<0&&n>1?-t:t,b=rs("n",x,S),S<0&&a[0]&&a[0].t=="t"&&(b=b.substr(1),a[0].v="-"+a[0].v)),w=b.length-1;var j=a.length;for(i=0;i<a.length;++i)if(a[i]!=null&&a[i].t!="t"&&a[i].v.indexOf(".")>-1){j=i;break}var k=a.length;if(j===a.length&&b.indexOf("E")===-1){for(i=a.length-1;i>=0;--i)a[i]==null||"n?".indexOf(a[i].t)===-1||(w>=a[i].v.length-1?(w-=a[i].v.length,a[i].v=b.substr(w+1,a[i].v.length)):w<0?a[i].v="":(a[i].v=b.substr(0,w+1),w=-1),a[i].t="t",k=i);w>=0&&k<a.length&&(a[k].v=b.substr(0,w+1)+a[k].v)}else if(j!==a.length&&b.indexOf("E")===-1){for(w=b.indexOf(".")-1,i=j;i>=0;--i)if(!(a[i]==null||"n?".indexOf(a[i].t)===-1)){for(f=a[i].v.indexOf(".")>-1&&i===j?a[i].v.indexOf(".")-1:a[i].v.length-1,E=a[i].v.substr(f+1);f>=0;--f)w>=0&&(a[i].v.charAt(f)==="0"||a[i].v.charAt(f)==="#")&&(E=b.charAt(w--)+E);a[i].v=E,a[i].t="t",k=i}for(w>=0&&k<a.length&&(a[k].v=b.substr(0,w+1)+a[k].v),w=b.indexOf(".")+1,i=j;i<a.length;++i)if(!(a[i]==null||"n?(".indexOf(a[i].t)===-1&&i!==j)){for(f=a[i].v.indexOf(".")>-1&&i===j?a[i].v.indexOf(".")+1:0,E=a[i].v.substr(0,f);f<a[i].v.length;++f)w<b.length&&(E+=b.charAt(w++));a[i].v=E,a[i].t="t",k=i}}}for(i=0;i<a.length;++i)a[i]!=null&&"n?".indexOf(a[i].t)>-1&&(S=n>1&&t<0&&i>0&&a[i-1].v==="-"?-t:t,a[i].v=rs(a[i].t,a[i].v,S),a[i].t="t");var C="";for(i=0;i!==a.length;++i)a[i]!=null&&(C+=a[i].v);return C}var gb=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function xb(e,t){if(t==null)return!1;var r=parseFloat(t[2]);switch(t[1]){case"=":if(e==r)return!0;break;case">":if(e>r)return!0;break;case"<":if(e<r)return!0;break;case"<>":if(e!=r)return!0;break;case">=":if(e>=r)return!0;break;case"<=":if(e<=r)return!0;break}return!1}function jte(e,t){var r=Ote(e),n=r.length,a=r[n-1].indexOf("@");if(n<4&&a>-1&&--n,r.length>4)throw new Error("cannot find right format for |"+r.join("|")+"|");if(typeof t!="number")return[4,r.length===4||a>-1?r[r.length-1]:"@"];switch(r.length){case 1:r=a>-1?["General","General","General",r[0]]:[r[0],r[0],r[0],"@"];break;case 2:r=a>-1?[r[0],r[0],r[0],r[1]]:[r[0],r[1],r[0],"@"];break;case 3:r=a>-1?[r[0],r[1],r[0],r[2]]:[r[0],r[1],r[2],"@"];break}var s=t>0?r[0]:t<0?r[1]:r[2];if(r[0].indexOf("[")===-1&&r[1].indexOf("[")===-1)return[n,s];if(r[0].match(/\[[=<>]/)!=null||r[1].match(/\[[=<>]/)!=null){var i=r[0].match(gb),o=r[1].match(gb);return xb(t,i)?[n,r[0]]:xb(t,o)?[n,r[1]]:[n,r[i!=null&&o!=null?2:1]]}return[n,s]}function jn(e,t,r){r==null&&(r={});var n="";switch(typeof e){case"string":e=="m/d/yy"&&r.dateNF?n=r.dateNF:n=e;break;case"number":e==14&&r.dateNF?n=r.dateNF:n=(r.table!=null?r.table:je)[e],n==null&&(n=r.table&&r.table[pb[e]]||je[pb[e]]),n==null&&(n=pte[e]||"General");break}if(U0(n,0))return eo(t,r);t instanceof Date&&(t=m4(t,r.date1904));var a=jte(n,t);if(U0(a[1]))return eo(t,r);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return Dte(a[1],t,r,a[0])}function Li(e,t){if(typeof t!="number"){t=+t||-1;for(var r=0;r<392;++r){if(je[r]==null){t<0&&(t=r);continue}if(je[r]==e){t=r;break}}t<0&&(t=391)}return je[t]=e,t}function S4(){je=hte()}var Pte={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},k4=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function Fte(e){var t=typeof e=="number"?je[e]:e;return t=t.replace(k4,"(\\d+)"),new RegExp("^"+t+"$")}function Rte(e,t,r){var n=-1,a=-1,s=-1,i=-1,o=-1,l=-1;(t.match(k4)||[]).forEach(function(d,h){var p=parseInt(r[h+1],10);switch(d.toLowerCase().charAt(0)){case"y":n=p;break;case"d":s=p;break;case"h":i=p;break;case"s":l=p;break;case"m":i>=0?o=p:a=p;break}}),l>=0&&o==-1&&a>=0&&(o=a,a=-1);var c=(""+(n>=0?n:new Date().getFullYear())).slice(-4)+"-"+("00"+(a>=1?a:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);c.length==7&&(c="0"+c),c.length==8&&(c="20"+c);var f=("00"+(i>=0?i:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return i==-1&&o==-1&&l==-1?c:n==-1&&a==-1&&s==-1?f:c+"T"+f}var Mte=function(){var e={};e.version="1.2.0";function t(){for(var b=0,j=new Array(256),k=0;k!=256;++k)b=k,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,b=b&1?-306674912^b>>>1:b>>>1,j[k]=b;return typeof Int32Array<"u"?new Int32Array(j):j}var r=t();function n(b){var j=0,k=0,C=0,P=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(C=0;C!=256;++C)P[C]=b[C];for(C=0;C!=256;++C)for(k=b[C],j=256+C;j<4096;j+=256)k=P[j]=k>>>8^b[k&255];var I=[];for(C=1;C!=16;++C)I[C-1]=typeof Int32Array<"u"?P.subarray(C*256,C*256+256):P.slice(C*256,C*256+256);return I}var a=n(r),s=a[0],i=a[1],o=a[2],l=a[3],c=a[4],f=a[5],d=a[6],h=a[7],p=a[8],v=a[9],m=a[10],_=a[11],g=a[12],y=a[13],x=a[14];function w(b,j){for(var k=j^-1,C=0,P=b.length;C<P;)k=k>>>8^r[(k^b.charCodeAt(C++))&255];return~k}function E(b,j){for(var k=j^-1,C=b.length-15,P=0;P<C;)k=x[b[P++]^k&255]^y[b[P++]^k>>8&255]^g[b[P++]^k>>16&255]^_[b[P++]^k>>>24]^m[b[P++]]^v[b[P++]]^p[b[P++]]^h[b[P++]]^d[b[P++]]^f[b[P++]]^c[b[P++]]^l[b[P++]]^o[b[P++]]^i[b[P++]]^s[b[P++]]^r[b[P++]];for(C+=15;P<C;)k=k>>>8^r[(k^b[P++])&255];return~k}function S(b,j){for(var k=j^-1,C=0,P=b.length,I=0,D=0;C<P;)I=b.charCodeAt(C++),I<128?k=k>>>8^r[(k^I)&255]:I<2048?(k=k>>>8^r[(k^(192|I>>6&31))&255],k=k>>>8^r[(k^(128|I&63))&255]):I>=55296&&I<57344?(I=(I&1023)+64,D=b.charCodeAt(C++)&1023,k=k>>>8^r[(k^(240|I>>8&7))&255],k=k>>>8^r[(k^(128|I>>2&63))&255],k=k>>>8^r[(k^(128|D>>6&15|(I&3)<<4))&255],k=k>>>8^r[(k^(128|D&63))&255]):(k=k>>>8^r[(k^(224|I>>12&15))&255],k=k>>>8^r[(k^(128|I>>6&63))&255],k=k>>>8^r[(k^(128|I&63))&255]);return~k}return e.table=r,e.bstr=w,e.buf=E,e.str=S,e}(),Ue=function(){var t={};t.version="1.2.1";function r(A,U){for(var M=A.split("/"),L=U.split("/"),W=0,V=0,re=Math.min(M.length,L.length);W<re;++W){if(V=M[W].length-L[W].length)return V;if(M[W]!=L[W])return M[W]<L[W]?-1:1}return M.length-L.length}function n(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:n(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(0,U+1)}function a(A){if(A.charAt(A.length-1)=="/")return a(A.slice(0,-1));var U=A.lastIndexOf("/");return U===-1?A:A.slice(U+1)}function s(A,U){typeof U=="string"&&(U=new Date(U));var M=U.getHours();M=M<<6|U.getMinutes(),M=M<<5|U.getSeconds()>>>1,A.write_shift(2,M);var L=U.getFullYear()-1980;L=L<<4|U.getMonth()+1,L=L<<5|U.getDate(),A.write_shift(2,L)}function i(A){var U=A.read_shift(2)&65535,M=A.read_shift(2)&65535,L=new Date,W=M&31;M>>>=5;var V=M&15;M>>>=4,L.setMilliseconds(0),L.setFullYear(M+1980),L.setMonth(V-1),L.setDate(W);var re=U&31;U>>>=5;var le=U&63;return U>>>=6,L.setHours(U),L.setMinutes(le),L.setSeconds(re<<1),L}function o(A){nr(A,0);for(var U={},M=0;A.l<=A.length-4;){var L=A.read_shift(2),W=A.read_shift(2),V=A.l+W,re={};switch(L){case 21589:M=A.read_shift(1),M&1&&(re.mtime=A.read_shift(4)),W>5&&(M&2&&(re.atime=A.read_shift(4)),M&4&&(re.ctime=A.read_shift(4))),re.mtime&&(re.mt=new Date(re.mtime*1e3));break}A.l=V,U[L]=re}return U}var l;function c(){return l||(l={})}function f(A,U){if(A[0]==80&&A[1]==75)return Fy(A,U);if((A[0]|32)==109&&(A[1]|32)==105)return HO(A,U);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var M=3,L=512,W=0,V=0,re=0,le=0,te=0,ne=[],se=A.slice(0,512);nr(se,0);var fe=d(se);switch(M=fe[0],M){case 3:L=512;break;case 4:L=4096;break;case 0:if(fe[1]==0)return Fy(A,U);default:throw new Error("Major Version: Expected 3 or 4 saw "+M)}L!==512&&(se=A.slice(0,L),nr(se,28));var ge=A.slice(0,L);h(se,M);var we=se.read_shift(4,"i");if(M===3&&we!==0)throw new Error("# Directory Sectors: Expected 0 saw "+we);se.l+=4,re=se.read_shift(4,"i"),se.l+=4,se.chk("00100000","Mini Stream Cutoff Size: "),le=se.read_shift(4,"i"),W=se.read_shift(4,"i"),te=se.read_shift(4,"i"),V=se.read_shift(4,"i");for(var pe=-1,_e=0;_e<109&&(pe=se.read_shift(4,"i"),!(pe<0));++_e)ne[_e]=pe;var De=p(A,L);_(te,V,De,L,ne);var xt=y(De,re,ne,L);xt[re].name="!Directory",W>0&&le!==D&&(xt[le].name="!MiniFAT"),xt[ne[0]].name="!FAT",xt.fat_addrs=ne,xt.ssz=L;var yt={},ur=[],ic=[],oc=[];x(re,xt,De,ur,W,yt,ic,le),v(ic,oc,ur),ur.shift();var lc={FileIndex:ic,FullPaths:oc};return U&&U.raw&&(lc.raw={header:ge,sectors:De}),lc}function d(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(K,"Header Signature: "),A.l+=16;var U=A.read_shift(2,"u");return[A.read_shift(2,"u"),U]}function h(A,U){var M=9;switch(A.l+=2,M=A.read_shift(2)){case 9:if(U!=3)throw new Error("Sector Shift: Expected 9 saw "+M);break;case 12:if(U!=4)throw new Error("Sector Shift: Expected 12 saw "+M);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+M)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function p(A,U){for(var M=Math.ceil(A.length/U)-1,L=[],W=1;W<M;++W)L[W-1]=A.slice(W*U,(W+1)*U);return L[M-1]=A.slice(M*U),L}function v(A,U,M){for(var L=0,W=0,V=0,re=0,le=0,te=M.length,ne=[],se=[];L<te;++L)ne[L]=se[L]=L,U[L]=M[L];for(;le<se.length;++le)L=se[le],W=A[L].L,V=A[L].R,re=A[L].C,ne[L]===L&&(W!==-1&&ne[W]!==W&&(ne[L]=ne[W]),V!==-1&&ne[V]!==V&&(ne[L]=ne[V])),re!==-1&&(ne[re]=L),W!==-1&&L!=ne[L]&&(ne[W]=ne[L],se.lastIndexOf(W)<le&&se.push(W)),V!==-1&&L!=ne[L]&&(ne[V]=ne[L],se.lastIndexOf(V)<le&&se.push(V));for(L=1;L<te;++L)ne[L]===L&&(V!==-1&&ne[V]!==V?ne[L]=ne[V]:W!==-1&&ne[W]!==W&&(ne[L]=ne[W]));for(L=1;L<te;++L)if(A[L].type!==0){if(le=L,le!=ne[le])do le=ne[le],U[L]=U[le]+"/"+U[L];while(le!==0&&ne[le]!==-1&&le!=ne[le]);ne[L]=-1}for(U[0]+="/",L=1;L<te;++L)A[L].type!==2&&(U[L]+="/")}function m(A,U,M){for(var L=A.start,W=A.size,V=[],re=L;M&&W>0&&re>=0;)V.push(U.slice(re*I,re*I+I)),W-=I,re=Ci(M,re*4);return V.length===0?Ut(0):Fs(V).slice(0,A.size)}function _(A,U,M,L,W){var V=D;if(A===D){if(U!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var re=M[A],le=(L>>>2)-1;if(!re)return;for(var te=0;te<le&&(V=Ci(re,te*4))!==D;++te)W.push(V);_(Ci(re,L-4),U-1,M,L,W)}}function g(A,U,M,L,W){var V=[],re=[];W||(W=[]);var le=L-1,te=0,ne=0;for(te=U;te>=0;){W[te]=!0,V[V.length]=te,re.push(A[te]);var se=M[Math.floor(te*4/L)];if(ne=te*4&le,L<4+ne)throw new Error("FAT boundary crossed: "+te+" 4 "+L);if(!A[se])break;te=Ci(A[se],ne)}return{nodes:V,data:Nb([re])}}function y(A,U,M,L){var W=A.length,V=[],re=[],le=[],te=[],ne=L-1,se=0,fe=0,ge=0,we=0;for(se=0;se<W;++se)if(le=[],ge=se+U,ge>=W&&(ge-=W),!re[ge]){te=[];var pe=[];for(fe=ge;fe>=0;){pe[fe]=!0,re[fe]=!0,le[le.length]=fe,te.push(A[fe]);var _e=M[Math.floor(fe*4/L)];if(we=fe*4&ne,L<4+we)throw new Error("FAT boundary crossed: "+fe+" 4 "+L);if(!A[_e]||(fe=Ci(A[_e],we),pe[fe]))break}V[ge]={nodes:le,data:Nb([te])}}return V}function x(A,U,M,L,W,V,re,le){for(var te=0,ne=L.length?2:0,se=U[A].data,fe=0,ge=0,we;fe<se.length;fe+=128){var pe=se.slice(fe,fe+128);nr(pe,64),ge=pe.read_shift(2),we=sy(pe,0,ge-ne),L.push(we);var _e={name:we,type:pe.read_shift(1),color:pe.read_shift(1),L:pe.read_shift(4,"i"),R:pe.read_shift(4,"i"),C:pe.read_shift(4,"i"),clsid:pe.read_shift(16),state:pe.read_shift(4,"i"),start:0,size:0},De=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);De!==0&&(_e.ct=w(pe,pe.l-8));var xt=pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2)+pe.read_shift(2);xt!==0&&(_e.mt=w(pe,pe.l-8)),_e.start=pe.read_shift(4,"i"),_e.size=pe.read_shift(4,"i"),_e.size<0&&_e.start<0&&(_e.size=_e.type=0,_e.start=D,_e.name=""),_e.type===5?(te=_e.start,W>0&&te!==D&&(U[te].name="!StreamData")):_e.size>=4096?(_e.storage="fat",U[_e.start]===void 0&&(U[_e.start]=g(M,_e.start,U.fat_addrs,U.ssz)),U[_e.start].name=_e.name,_e.content=U[_e.start].data.slice(0,_e.size)):(_e.storage="minifat",_e.size<0?_e.size=0:te!==D&&_e.start!==D&&U[te]&&(_e.content=m(_e,U[te].data,(U[le]||{}).data))),_e.content&&nr(_e.content,0),V[we]=_e,re.push(_e)}}function w(A,U){return new Date((Zr(A,U+4)/1e7*Math.pow(2,32)+Zr(A,U)/1e7-11644473600)*1e3)}function E(A,U){return c(),f(l.readFileSync(A),U)}function S(A,U){var M=U&&U.type;switch(M||Be&&Buffer.isBuffer(A)&&(M="buffer"),M||"base64"){case"file":return E(A,U);case"base64":return f(Gn(ln(A)),U);case"binary":return f(Gn(A),U)}return f(A,U)}function b(A,U){var M=U||{},L=M.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=L+"/",A.FileIndex[0]={name:L,type:5}),M.CLSID&&(A.FileIndex[0].clsid=M.CLSID),j(A)}function j(A){var U="Sh33tJ5";if(!Ue.find(A,"/"+U)){var M=Ut(4);M[0]=55,M[1]=M[3]=50,M[2]=54,A.FileIndex.push({name:U,type:2,content:M,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+U),k(A)}}function k(A,U){b(A);for(var M=!1,L=!1,W=A.FullPaths.length-1;W>=0;--W){var V=A.FileIndex[W];switch(V.type){case 0:L?M=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:L=!0,isNaN(V.R*V.L*V.C)&&(M=!0),V.R>-1&&V.L>-1&&V.R==V.L&&(M=!0);break;default:M=!0;break}}if(!(!M&&!U)){var re=new Date(1987,1,19),le=0,te=Object.create?Object.create(null):{},ne=[];for(W=0;W<A.FullPaths.length;++W)te[A.FullPaths[W]]=!0,A.FileIndex[W].type!==0&&ne.push([A.FullPaths[W],A.FileIndex[W]]);for(W=0;W<ne.length;++W){var se=n(ne[W][0]);L=te[se],L||(ne.push([se,{name:a(se).replace("/",""),type:1,clsid:z,ct:re,mt:re,content:null}]),te[se]=!0)}for(ne.sort(function(we,pe){return r(we[0],pe[0])}),A.FullPaths=[],A.FileIndex=[],W=0;W<ne.length;++W)A.FullPaths[W]=ne[W][0],A.FileIndex[W]=ne[W][1];for(W=0;W<ne.length;++W){var fe=A.FileIndex[W],ge=A.FullPaths[W];if(fe.name=a(ge).replace("/",""),fe.L=fe.R=fe.C=-(fe.color=1),fe.size=fe.content?fe.content.length:0,fe.start=0,fe.clsid=fe.clsid||z,W===0)fe.C=ne.length>1?1:-1,fe.size=0,fe.type=5;else if(ge.slice(-1)=="/"){for(le=W+1;le<ne.length&&n(A.FullPaths[le])!=ge;++le);for(fe.C=le>=ne.length?-1:le,le=W+1;le<ne.length&&n(A.FullPaths[le])!=n(ge);++le);fe.R=le>=ne.length?-1:le,fe.type=1}else n(A.FullPaths[W+1]||"")==n(ge)&&(fe.R=W+1),fe.type=2}}}function C(A,U){var M=U||{};if(M.fileType=="mad")return zO(A,M);switch(k(A),M.fileType){case"zip":return LO(A,M)}var L=function(we){for(var pe=0,_e=0,De=0;De<we.FileIndex.length;++De){var xt=we.FileIndex[De];if(xt.content){var yt=xt.content.length;yt>0&&(yt<4096?pe+=yt+63>>6:_e+=yt+511>>9)}}for(var ur=we.FullPaths.length+3>>2,ic=pe+7>>3,oc=pe+127>>7,lc=ic+_e+ur+oc,xi=lc+127>>7,Cp=xi<=109?0:Math.ceil((xi-109)/127);lc+xi+Cp+127>>7>xi;)Cp=++xi<=109?0:Math.ceil((xi-109)/127);var La=[1,Cp,xi,oc,ur,_e,pe,0];return we.FileIndex[0].size=pe<<6,La[7]=(we.FileIndex[0].start=La[0]+La[1]+La[2]+La[3]+La[4]+La[5])+(La[6]+7>>3),La}(A),W=Ut(L[7]<<9),V=0,re=0;{for(V=0;V<8;++V)W.write_shift(1,Q[V]);for(V=0;V<8;++V)W.write_shift(2,0);for(W.write_shift(2,62),W.write_shift(2,3),W.write_shift(2,65534),W.write_shift(2,9),W.write_shift(2,6),V=0;V<3;++V)W.write_shift(2,0);for(W.write_shift(4,0),W.write_shift(4,L[2]),W.write_shift(4,L[0]+L[1]+L[2]+L[3]-1),W.write_shift(4,0),W.write_shift(4,4096),W.write_shift(4,L[3]?L[0]+L[1]+L[2]-1:D),W.write_shift(4,L[3]),W.write_shift(-4,L[1]?L[0]-1:D),W.write_shift(4,L[1]),V=0;V<109;++V)W.write_shift(-4,V<L[2]?L[1]+V:-1)}if(L[1])for(re=0;re<L[1];++re){for(;V<236+re*127;++V)W.write_shift(-4,V<L[2]?L[1]+V:-1);W.write_shift(-4,re===L[1]-1?D:re+1)}var le=function(we){for(re+=we;V<re-1;++V)W.write_shift(-4,V+1);we&&(++V,W.write_shift(-4,D))};for(re=V=0,re+=L[1];V<re;++V)W.write_shift(-4,q.DIFSECT);for(re+=L[2];V<re;++V)W.write_shift(-4,q.FATSECT);le(L[3]),le(L[4]);for(var te=0,ne=0,se=A.FileIndex[0];te<A.FileIndex.length;++te)se=A.FileIndex[te],se.content&&(ne=se.content.length,!(ne<4096)&&(se.start=re,le(ne+511>>9)));for(le(L[6]+7>>3);W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(re=V=0,te=0;te<A.FileIndex.length;++te)se=A.FileIndex[te],se.content&&(ne=se.content.length,!(!ne||ne>=4096)&&(se.start=re,le(ne+63>>6)));for(;W.l&511;)W.write_shift(-4,q.ENDOFCHAIN);for(V=0;V<L[4]<<2;++V){var fe=A.FullPaths[V];if(!fe||fe.length===0){for(te=0;te<17;++te)W.write_shift(4,0);for(te=0;te<3;++te)W.write_shift(4,-1);for(te=0;te<12;++te)W.write_shift(4,0);continue}se=A.FileIndex[V],V===0&&(se.start=se.size?se.start-1:D);var ge=V===0&&M.root||se.name;if(ne=2*(ge.length+1),W.write_shift(64,ge,"utf16le"),W.write_shift(2,ne),W.write_shift(1,se.type),W.write_shift(1,se.color),W.write_shift(-4,se.L),W.write_shift(-4,se.R),W.write_shift(-4,se.C),se.clsid)W.write_shift(16,se.clsid,"hex");else for(te=0;te<4;++te)W.write_shift(4,0);W.write_shift(4,se.state||0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,0),W.write_shift(4,se.start),W.write_shift(4,se.size),W.write_shift(4,0)}for(V=1;V<A.FileIndex.length;++V)if(se=A.FileIndex[V],se.size>=4096)if(W.l=se.start+1<<9,Be&&Buffer.isBuffer(se.content))se.content.copy(W,W.l,0,se.size),W.l+=se.size+511&-512;else{for(te=0;te<se.size;++te)W.write_shift(1,se.content[te]);for(;te&511;++te)W.write_shift(1,0)}for(V=1;V<A.FileIndex.length;++V)if(se=A.FileIndex[V],se.size>0&&se.size<4096)if(Be&&Buffer.isBuffer(se.content))se.content.copy(W,W.l,0,se.size),W.l+=se.size+63&-64;else{for(te=0;te<se.size;++te)W.write_shift(1,se.content[te]);for(;te&63;++te)W.write_shift(1,0)}if(Be)W.l=W.length;else for(;W.l<W.length;)W.write_shift(1,0);return W}function P(A,U){var M=A.FullPaths.map(function(te){return te.toUpperCase()}),L=M.map(function(te){var ne=te.split("/");return ne[ne.length-(te.slice(-1)=="/"?2:1)]}),W=!1;U.charCodeAt(0)===47?(W=!0,U=M[0].slice(0,-1)+U):W=U.indexOf("/")!==-1;var V=U.toUpperCase(),re=W===!0?M.indexOf(V):L.indexOf(V);if(re!==-1)return A.FileIndex[re];var le=!V.match(Dc);for(V=V.replace(Pr,""),le&&(V=V.replace(Dc,"!")),re=0;re<M.length;++re)if((le?M[re].replace(Dc,"!"):M[re]).replace(Pr,"")==V||(le?L[re].replace(Dc,"!"):L[re]).replace(Pr,"")==V)return A.FileIndex[re];return null}var I=64,D=-2,K="d0cf11e0a1b11ae1",Q=[208,207,17,224,161,177,26,225],z="00000000000000000000000000000000",q={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:D,FREESECT:-1,HEADER_SIGNATURE:K,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:z,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ee(A,U,M){c();var L=C(A,M);l.writeFileSync(U,L)}function H(A){for(var U=new Array(A.length),M=0;M<A.length;++M)U[M]=String.fromCharCode(A[M]);return U.join("")}function ce(A,U){var M=C(A,U);switch(U&&U.type||"buffer"){case"file":return c(),l.writeFileSync(U.filename,M),M;case"binary":return typeof M=="string"?M:H(M);case"base64":return ub(typeof M=="string"?M:H(M));case"buffer":if(Be)return Buffer.isBuffer(M)?M:ho(M);case"array":return typeof M=="string"?Gn(M):M}return M}var J;function N(A){try{var U=A.InflateRaw,M=new U;if(M._processChunk(new Uint8Array([3,0]),M._finishFlushFlag),M.bytesRead)J=A;else throw new Error("zlib does not expose bytesRead")}catch(L){console.error("cannot use native zlib: "+(L.message||L))}}function F(A,U){if(!J)return jy(A,U);var M=J.InflateRaw,L=new M,W=L._processChunk(A.slice(A.l),L._finishFlushFlag);return A.l+=L.bytesRead,W}function T(A){return J?J.deflateRawSync(A):Re(A)}var R=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],G=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],X=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function Y(A){var U=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(U>>16|U>>8|U)&255}for(var ae=typeof Uint8Array<"u",oe=ae?new Uint8Array(256):[],ve=0;ve<256;++ve)oe[ve]=Y(ve);function B(A,U){var M=oe[A&255];return U<=8?M>>>8-U:(M=M<<8|oe[A>>8&255],U<=16?M>>>16-U:(M=M<<8|oe[A>>16&255],M>>>24-U))}function Te(A,U){var M=U&7,L=U>>>3;return(A[L]|(M<=6?0:A[L+1]<<8))>>>M&3}function ke(A,U){var M=U&7,L=U>>>3;return(A[L]|(M<=5?0:A[L+1]<<8))>>>M&7}function $e(A,U){var M=U&7,L=U>>>3;return(A[L]|(M<=4?0:A[L+1]<<8))>>>M&15}function Ne(A,U){var M=U&7,L=U>>>3;return(A[L]|(M<=3?0:A[L+1]<<8))>>>M&31}function me(A,U){var M=U&7,L=U>>>3;return(A[L]|(M<=1?0:A[L+1]<<8))>>>M&127}function Xe(A,U,M){var L=U&7,W=U>>>3,V=(1<<M)-1,re=A[W]>>>L;return M<8-L||(re|=A[W+1]<<8-L,M<16-L)||(re|=A[W+2]<<16-L,M<24-L)||(re|=A[W+3]<<24-L),re&V}function $t(A,U,M){var L=U&7,W=U>>>3;return L<=5?A[W]|=(M&7)<<L:(A[W]|=M<<L&255,A[W+1]=(M&7)>>8-L),U+3}function gt(A,U,M){var L=U&7,W=U>>>3;return M=(M&1)<<L,A[W]|=M,U+1}function Ir(A,U,M){var L=U&7,W=U>>>3;return M<<=L,A[W]|=M&255,M>>>=8,A[W+1]=M,U+8}function ws(A,U,M){var L=U&7,W=U>>>3;return M<<=L,A[W]|=M&255,M>>>=8,A[W+1]=M&255,A[W+2]=M>>>8,U+16}function Ln(A,U){var M=A.length,L=2*M>U?2*M:U+5,W=0;if(M>=U)return A;if(Be){var V=fb(L);if(A.copy)A.copy(V);else for(;W<A.length;++W)V[W]=A[W];return V}else if(ae){var re=new Uint8Array(L);if(re.set)re.set(A);else for(;W<M;++W)re[W]=A[W];return re}return A.length=L,A}function tr(A){for(var U=new Array(A),M=0;M<A;++M)U[M]=0;return U}function hn(A,U,M){var L=1,W=0,V=0,re=0,le=0,te=A.length,ne=ae?new Uint16Array(32):tr(32);for(V=0;V<32;++V)ne[V]=0;for(V=te;V<M;++V)A[V]=0;te=A.length;var se=ae?new Uint16Array(te):tr(te);for(V=0;V<te;++V)ne[W=A[V]]++,L<W&&(L=W),se[V]=0;for(ne[0]=0,V=1;V<=L;++V)ne[V+16]=le=le+ne[V-1]<<1;for(V=0;V<te;++V)le=A[V],le!=0&&(se[V]=ne[le+16]++);var fe=0;for(V=0;V<te;++V)if(fe=A[V],fe!=0)for(le=B(se[V],L)>>L-fe,re=(1<<L+4-fe)-1;re>=0;--re)U[le|re<<fe]=fe&15|V<<4;return L}var $n=ae?new Uint16Array(512):tr(512),bs=ae?new Uint16Array(32):tr(32);if(!ae){for(var qt=0;qt<512;++qt)$n[qt]=0;for(qt=0;qt<32;++qt)bs[qt]=0}(function(){for(var A=[],U=0;U<32;U++)A.push(5);hn(A,bs,32);var M=[];for(U=0;U<=143;U++)M.push(8);for(;U<=255;U++)M.push(9);for(;U<=279;U++)M.push(7);for(;U<=287;U++)M.push(8);hn(M,$n,288)})();var fa=function(){for(var U=ae?new Uint8Array(32768):[],M=0,L=0;M<X.length-1;++M)for(;L<X[M+1];++L)U[L]=M;for(;L<32768;++L)U[L]=29;var W=ae?new Uint8Array(259):[];for(M=0,L=0;M<G.length-1;++M)for(;L<G[M+1];++L)W[L]=M;function V(le,te){for(var ne=0;ne<le.length;){var se=Math.min(65535,le.length-ne),fe=ne+se==le.length;for(te.write_shift(1,+fe),te.write_shift(2,se),te.write_shift(2,~se&65535);se-- >0;)te[te.l++]=le[ne++]}return te.l}function re(le,te){for(var ne=0,se=0,fe=ae?new Uint16Array(32768):[];se<le.length;){var ge=Math.min(65535,le.length-se);if(ge<10){for(ne=$t(te,ne,+(se+ge==le.length)),ne&7&&(ne+=8-(ne&7)),te.l=ne/8|0,te.write_shift(2,ge),te.write_shift(2,~ge&65535);ge-- >0;)te[te.l++]=le[se++];ne=te.l*8;continue}ne=$t(te,ne,+(se+ge==le.length)+2);for(var we=0;ge-- >0;){var pe=le[se];we=(we<<5^pe)&32767;var _e=-1,De=0;if((_e=fe[we])&&(_e|=se&-32768,_e>se&&(_e-=32768),_e<se))for(;le[_e+De]==le[se+De]&&De<250;)++De;if(De>2){pe=W[De],pe<=22?ne=Ir(te,ne,oe[pe+1]>>1)-1:(Ir(te,ne,3),ne+=5,Ir(te,ne,oe[pe-23]>>5),ne+=3);var xt=pe<8?0:pe-4>>2;xt>0&&(ws(te,ne,De-G[pe]),ne+=xt),pe=U[se-_e],ne=Ir(te,ne,oe[pe]>>3),ne-=3;var yt=pe<4?0:pe-2>>1;yt>0&&(ws(te,ne,se-_e-X[pe]),ne+=yt);for(var ur=0;ur<De;++ur)fe[we]=se&32767,we=(we<<5^le[se])&32767,++se;ge-=De-1}else pe<=143?pe=pe+48:ne=gt(te,ne,1),ne=Ir(te,ne,oe[pe]),fe[we]=se&32767,++se}ne=Ir(te,ne,0)-1}return te.l=(ne+7)/8|0,te.l}return function(te,ne){return te.length<8?V(te,ne):re(te,ne)}}();function Re(A){var U=Ut(50+Math.floor(A.length*1.1)),M=fa(A,U);return U.slice(0,M)}var At=ae?new Uint16Array(32768):tr(32768),pn=ae?new Uint16Array(32768):tr(32768),Bt=ae?new Uint16Array(128):tr(128),gi=1,Dy=1;function RO(A,U){var M=Ne(A,U)+257;U+=5;var L=Ne(A,U)+1;U+=5;var W=$e(A,U)+4;U+=4;for(var V=0,re=ae?new Uint8Array(19):tr(19),le=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],te=1,ne=ae?new Uint8Array(8):tr(8),se=ae?new Uint8Array(8):tr(8),fe=re.length,ge=0;ge<W;++ge)re[R[ge]]=V=ke(A,U),te<V&&(te=V),ne[V]++,U+=3;var we=0;for(ne[0]=0,ge=1;ge<=te;++ge)se[ge]=we=we+ne[ge-1]<<1;for(ge=0;ge<fe;++ge)(we=re[ge])!=0&&(le[ge]=se[we]++);var pe=0;for(ge=0;ge<fe;++ge)if(pe=re[ge],pe!=0){we=oe[le[ge]]>>8-pe;for(var _e=(1<<7-pe)-1;_e>=0;--_e)Bt[we|_e<<pe]=pe&7|ge<<3}var De=[];for(te=1;De.length<M+L;)switch(we=Bt[me(A,U)],U+=we&7,we>>>=3){case 16:for(V=3+Te(A,U),U+=2,we=De[De.length-1];V-- >0;)De.push(we);break;case 17:for(V=3+ke(A,U),U+=3;V-- >0;)De.push(0);break;case 18:for(V=11+me(A,U),U+=7;V-- >0;)De.push(0);break;default:De.push(we),te<we&&(te=we);break}var xt=De.slice(0,M),yt=De.slice(M);for(ge=M;ge<286;++ge)xt[ge]=0;for(ge=L;ge<30;++ge)yt[ge]=0;return gi=hn(xt,At,286),Dy=hn(yt,pn,30),U}function MO(A,U){if(A[0]==3&&!(A[1]&3))return[ai(U),2];for(var M=0,L=0,W=fb(U||1<<18),V=0,re=W.length>>>0,le=0,te=0;!(L&1);){if(L=ke(A,M),M+=3,L>>>1)L>>1==1?(le=9,te=5):(M=RO(A,M),le=gi,te=Dy);else{M&7&&(M+=8-(M&7));var ne=A[M>>>3]|A[(M>>>3)+1]<<8;if(M+=32,ne>0)for(!U&&re<V+ne&&(W=Ln(W,V+ne),re=W.length);ne-- >0;)W[V++]=A[M>>>3],M+=8;continue}for(;;){!U&&re<V+32767&&(W=Ln(W,V+32767),re=W.length);var se=Xe(A,M,le),fe=L>>>1==1?$n[se]:At[se];if(M+=fe&15,fe>>>=4,!(fe>>>8&255))W[V++]=fe;else{if(fe==256)break;fe-=257;var ge=fe<8?0:fe-4>>2;ge>5&&(ge=0);var we=V+G[fe];ge>0&&(we+=Xe(A,M,ge),M+=ge),se=Xe(A,M,te),fe=L>>>1==1?bs[se]:pn[se],M+=fe&15,fe>>>=4;var pe=fe<4?0:fe-2>>1,_e=X[fe];for(pe>0&&(_e+=Xe(A,M,pe),M+=pe),!U&&re<we&&(W=Ln(W,we+100),re=W.length);V<we;)W[V]=W[V-_e],++V}}}return U?[W,M+7>>>3]:[W.slice(0,V),M+7>>>3]}function jy(A,U){var M=A.slice(A.l||0),L=MO(M,U);return A.l+=L[1],L[0]}function Py(A,U){if(A)typeof console<"u"&&console.error(U);else throw new Error(U)}function Fy(A,U){var M=A;nr(M,0);var L=[],W=[],V={FileIndex:L,FullPaths:W};b(V,{root:U.root});for(var re=M.length-4;(M[re]!=80||M[re+1]!=75||M[re+2]!=5||M[re+3]!=6)&&re>=0;)--re;M.l=re+4,M.l+=4;var le=M.read_shift(2);M.l+=6;var te=M.read_shift(4);for(M.l=te,re=0;re<le;++re){M.l+=20;var ne=M.read_shift(4),se=M.read_shift(4),fe=M.read_shift(2),ge=M.read_shift(2),we=M.read_shift(2);M.l+=8;var pe=M.read_shift(4),_e=o(M.slice(M.l+fe,M.l+fe+ge));M.l+=fe+ge+we;var De=M.l;M.l=pe+4,IO(M,ne,se,V,_e),M.l=De}return V}function IO(A,U,M,L,W){A.l+=2;var V=A.read_shift(2),re=A.read_shift(2),le=i(A);if(V&8257)throw new Error("Unsupported ZIP encryption");for(var te=A.read_shift(4),ne=A.read_shift(4),se=A.read_shift(4),fe=A.read_shift(2),ge=A.read_shift(2),we="",pe=0;pe<fe;++pe)we+=String.fromCharCode(A[A.l++]);if(ge){var _e=o(A.slice(A.l,A.l+ge));(_e[21589]||{}).mt&&(le=_e[21589].mt),((W||{})[21589]||{}).mt&&(le=W[21589].mt)}A.l+=ge;var De=A.slice(A.l,A.l+ne);switch(re){case 8:De=F(A,se);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+re)}var xt=!1;V&8&&(te=A.read_shift(4),te==134695760&&(te=A.read_shift(4),xt=!0),ne=A.read_shift(4),se=A.read_shift(4)),ne!=U&&Py(xt,"Bad compressed size: "+U+" != "+ne),se!=M&&Py(xt,"Bad uncompressed size: "+M+" != "+se),Tp(L,we,De,{unsafe:!0,mt:le})}function LO(A,U){var M=U||{},L=[],W=[],V=Ut(1),re=M.compression?8:0,le=0,te=0,ne=0,se=0,fe=0,ge=A.FullPaths[0],we=ge,pe=A.FileIndex[0],_e=[],De=0;for(te=1;te<A.FullPaths.length;++te)if(we=A.FullPaths[te].slice(ge.length),pe=A.FileIndex[te],!(!pe.size||!pe.content||we=="Sh33tJ5")){var xt=se,yt=Ut(we.length);for(ne=0;ne<we.length;++ne)yt.write_shift(1,we.charCodeAt(ne)&127);yt=yt.slice(0,yt.l),_e[fe]=Mte.buf(pe.content,0);var ur=pe.content;re==8&&(ur=T(ur)),V=Ut(30),V.write_shift(4,67324752),V.write_shift(2,20),V.write_shift(2,le),V.write_shift(2,re),pe.mt?s(V,pe.mt):V.write_shift(4,0),V.write_shift(-4,_e[fe]),V.write_shift(4,ur.length),V.write_shift(4,pe.content.length),V.write_shift(2,yt.length),V.write_shift(2,0),se+=V.length,L.push(V),se+=yt.length,L.push(yt),se+=ur.length,L.push(ur),V=Ut(46),V.write_shift(4,33639248),V.write_shift(2,0),V.write_shift(2,20),V.write_shift(2,le),V.write_shift(2,re),V.write_shift(4,0),V.write_shift(-4,_e[fe]),V.write_shift(4,ur.length),V.write_shift(4,pe.content.length),V.write_shift(2,yt.length),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(4,0),V.write_shift(4,xt),De+=V.l,W.push(V),De+=yt.length,W.push(yt),++fe}return V=Ut(22),V.write_shift(4,101010256),V.write_shift(2,0),V.write_shift(2,0),V.write_shift(2,fe),V.write_shift(2,fe),V.write_shift(4,De),V.write_shift(4,se),V.write_shift(2,0),Fs([Fs(L),Fs(W),V])}var Lf={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function $O(A,U){if(A.ctype)return A.ctype;var M=A.name||"",L=M.match(/\.([^\.]+)$/);return L&&Lf[L[1]]||U&&(L=(M=U).match(/[\.\\]([^\.\\])+$/),L&&Lf[L[1]])?Lf[L[1]]:"application/octet-stream"}function BO(A){for(var U=ub(A),M=[],L=0;L<U.length;L+=76)M.push(U.slice(L,L+76));return M.join(`\r
`)+`\r
`}function UO(A){var U=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(ne){var se=ne.charCodeAt(0).toString(16).toUpperCase();return"="+(se.length==1?"0"+se:se)});U=U.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),U.charAt(0)==`
`&&(U="=0D"+U.slice(1)),U=U.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var M=[],L=U.split(`\r
`),W=0;W<L.length;++W){var V=L[W];if(V.length==0){M.push("");continue}for(var re=0;re<V.length;){var le=76,te=V.slice(re,re+le);te.charAt(le-1)=="="?le--:te.charAt(le-2)=="="?le-=2:te.charAt(le-3)=="="&&(le-=3),te=V.slice(re,re+le),re+=le,re<V.length&&(te+="="),M.push(te)}}return M.join(`\r
`)}function WO(A){for(var U=[],M=0;M<A.length;++M){for(var L=A[M];M<=A.length&&L.charAt(L.length-1)=="=";)L=L.slice(0,L.length-1)+A[++M];U.push(L)}for(var W=0;W<U.length;++W)U[W]=U[W].replace(/[=][0-9A-Fa-f]{2}/g,function(V){return String.fromCharCode(parseInt(V.slice(1),16))});return Gn(U.join(`\r
`))}function VO(A,U,M){for(var L="",W="",V="",re,le=0;le<10;++le){var te=U[le];if(!te||te.match(/^\s*$/))break;var ne=te.match(/^(.*?):\s*([^\s].*)$/);if(ne)switch(ne[1].toLowerCase()){case"content-location":L=ne[2].trim();break;case"content-type":V=ne[2].trim();break;case"content-transfer-encoding":W=ne[2].trim();break}}switch(++le,W.toLowerCase()){case"base64":re=Gn(ln(U.slice(le).join("")));break;case"quoted-printable":re=WO(U.slice(le));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+W)}var se=Tp(A,L.slice(M.length),re,{unsafe:!0});V&&(se.ctype=V)}function HO(A,U){if(H(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var M=U&&U.root||"",L=(Be&&Buffer.isBuffer(A)?A.toString("binary"):H(A)).split(`\r
`),W=0,V="";for(W=0;W<L.length;++W)if(V=L[W],!!/^Content-Location:/i.test(V)&&(V=V.slice(V.indexOf("file")),M||(M=V.slice(0,V.lastIndexOf("/")+1)),V.slice(0,M.length)!=M))for(;M.length>0&&(M=M.slice(0,M.length-1),M=M.slice(0,M.lastIndexOf("/")+1),V.slice(0,M.length)!=M););var re=(L[1]||"").match(/boundary="(.*?)"/);if(!re)throw new Error("MAD cannot find boundary");var le="--"+(re[1]||""),te=[],ne=[],se={FileIndex:te,FullPaths:ne};b(se);var fe,ge=0;for(W=0;W<L.length;++W){var we=L[W];we!==le&&we!==le+"--"||(ge++&&VO(se,L.slice(fe,W),M),fe=W)}return se}function zO(A,U){var M=U||{},L=M.boundary||"SheetJS";L="------="+L;for(var W=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+L.slice(2)+'"',"","",""],V=A.FullPaths[0],re=V,le=A.FileIndex[0],te=1;te<A.FullPaths.length;++te)if(re=A.FullPaths[te].slice(V.length),le=A.FileIndex[te],!(!le.size||!le.content||re=="Sh33tJ5")){re=re.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(De){return"_x"+De.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(De){return"_u"+De.charCodeAt(0).toString(16)+"_"});for(var ne=le.content,se=Be&&Buffer.isBuffer(ne)?ne.toString("binary"):H(ne),fe=0,ge=Math.min(1024,se.length),we=0,pe=0;pe<=ge;++pe)(we=se.charCodeAt(pe))>=32&&we<128&&++fe;var _e=fe>=ge*4/5;W.push(L),W.push("Content-Location: "+(M.root||"file:///C:/SheetJS/")+re),W.push("Content-Transfer-Encoding: "+(_e?"quoted-printable":"base64")),W.push("Content-Type: "+$O(le,re)),W.push(""),W.push(_e?UO(se):BO(se))}return W.push(L+`--\r
`),W.join(`\r
`)}function YO(A){var U={};return b(U,A),U}function Tp(A,U,M,L){var W=L&&L.unsafe;W||b(A);var V=!W&&Ue.find(A,U);if(!V){var re=A.FullPaths[0];U.slice(0,re.length)==re?re=U:(re.slice(-1)!="/"&&(re+="/"),re=(re+U).replace("//","/")),V={name:a(U),type:2},A.FileIndex.push(V),A.FullPaths.push(re),W||Ue.utils.cfb_gc(A)}return V.content=M,V.size=M?M.length:0,L&&(L.CLSID&&(V.clsid=L.CLSID),L.mt&&(V.mt=L.mt),L.ct&&(V.ct=L.ct)),V}function GO(A,U){b(A);var M=Ue.find(A,U);if(M){for(var L=0;L<A.FileIndex.length;++L)if(A.FileIndex[L]==M)return A.FileIndex.splice(L,1),A.FullPaths.splice(L,1),!0}return!1}function KO(A,U,M){b(A);var L=Ue.find(A,U);if(L){for(var W=0;W<A.FileIndex.length;++W)if(A.FileIndex[W]==L)return A.FileIndex[W].name=a(M),A.FullPaths[W]=M,!0}return!1}function qO(A){k(A,!0)}return t.find=P,t.read=S,t.parse=f,t.write=ce,t.writeFile=ee,t.utils={cfb_new:YO,cfb_add:Tp,cfb_del:GO,cfb_mov:KO,cfb_gc:qO,ReadShift:Xc,CheckField:G4,prep_blob:nr,bconcat:Fs,use_zlib:N,_deflateRaw:Re,_inflateRaw:jy,consts:q},t}();function Ite(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var r=t.read();return t.close(),r}catch(n){if(!n.message||!n.message.match(/onstruct/))throw n}throw new Error("Cannot access file "+e)}function Da(e){for(var t=Object.keys(e),r=[],n=0;n<t.length;++n)Object.prototype.hasOwnProperty.call(e,t[n])&&r.push(t[n]);return r}function ty(e){for(var t=[],r=Da(e),n=0;n!==r.length;++n)t[e[r[n]]]=r[n];return t}var V0=new Date(1899,11,30,0,0,0);function Fr(e,t){var r=e.getTime(),n=V0.getTime()+(e.getTimezoneOffset()-V0.getTimezoneOffset())*6e4;return(r-n)/(24*60*60*1e3)}var T4=new Date,Lte=V0.getTime()+(T4.getTimezoneOffset()-V0.getTimezoneOffset())*6e4,yb=T4.getTimezoneOffset();function fp(e){var t=new Date;return t.setTime(e*24*60*60*1e3+Lte),t.getTimezoneOffset()!==yb&&t.setTime(t.getTime()+(t.getTimezoneOffset()-yb)*6e4),t}function $te(e){var t=0,r=0,n=!1,a=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!a)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=a.length;++s)if(a[s]){switch(r=1,s>3&&(n=!0),a[s].slice(a[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+a[s].slice(a[s].length-1));case"D":r*=24;case"H":r*=60;case"M":if(n)r*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=r*parseInt(a[s],10)}return t}var _b=new Date("2017-02-19T19:06:09.000Z"),C4=isNaN(_b.getFullYear())?new Date("2/19/17"):_b,Bte=C4.getFullYear()==2017;function er(e,t){var r=new Date(e);if(Bte)return t>0?r.setTime(r.getTime()+r.getTimezoneOffset()*60*1e3):t<0&&r.setTime(r.getTime()-r.getTimezoneOffset()*60*1e3),r;if(e instanceof Date)return e;if(C4.getFullYear()==1917&&!isNaN(r.getFullYear())){var n=r.getFullYear();return e.indexOf(""+n)>-1||r.setFullYear(r.getFullYear()+100),r}var a=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+a[0],+a[1]-1,+a[2],+a[3]||0,+a[4]||0,+a[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function to(e,t){if(Be&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return Pc(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return Pc(h4(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return Pc(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return Pc(new TextDecoder("utf-16be").decode(e.slice(2)))}var r={"€":"","‚":"",ƒ:"","„":"","…":"","†":"","‡":"","ˆ":"","‰":"",Š:"","‹":"",Œ:"",Ž:"","‘":"","’":"","“":"","”":"","•":"","–":"","—":"","˜":"","™":"",š:"","›":"",œ:"",ž:"",Ÿ:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[€‚ƒ„…†‡ˆ‰Š‹ŒŽ‘’“”•–—˜™š›œžŸ]/g,function(s){return r[s]||s})}catch{}for(var n=[],a=0;a!=e.length;++a)n.push(String.fromCharCode(e[a]));return n.join("")}function ir(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=ir(e[r]));return t}function Tt(e,t){for(var r="";r.length<t;)r+=e;return r}function Zn(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var r=1,n=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return r*=100,""});return!isNaN(t=Number(n))||(n=n.replace(/[(](.*)[)]/,function(a,s){return r=-r,s}),!isNaN(t=Number(n)))?t/r:t}var Ute=["january","february","march","april","may","june","july","august","september","october","november","december"];function Cl(e){var t=new Date(e),r=new Date(NaN),n=t.getYear(),a=t.getMonth(),s=t.getDate();if(isNaN(s))return r;var i=e.toLowerCase();if(i.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(i=i.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),i.length>3&&Ute.indexOf(i)==-1)return r}else if(i.match(/[a-z]/))return r;return n<0||n>8099?r:(a>0||s>1)&&n!=101?t:e.match(/[^-0-9:,\/\\]/)?r:t}var Wte=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(r,n,a){if(e||typeof n=="string")return r.split(n);for(var s=r.split(n),i=[s[0]],o=1;o<s.length;++o)i.push(a),i.push(s[o]);return i}}();function N4(e){return e?e.content&&e.type?to(e.content,!0):e.data?Oc(e.data):e.asNodeBuffer&&Be?Oc(e.asNodeBuffer().toString("binary")):e.asBinary?Oc(e.asBinary()):e._data&&e._data.getContent?Oc(to(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function A4(e){if(!e)return null;if(e.data)return lb(e.data);if(e.asNodeBuffer&&Be)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?lb(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function Vte(e){return e&&e.name.slice(-4)===".bin"?A4(e):N4(e)}function gn(e,t){for(var r=e.FullPaths||Da(e.files),n=t.toLowerCase().replace(/[\/]/g,"\\"),a=n.replace(/\\/g,"/"),s=0;s<r.length;++s){var i=r[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(n==i||a==i)return e.files?e.files[r[s]]:e.FileIndex[s]}return null}function ry(e,t){var r=gn(e,t);if(r==null)throw new Error("Cannot find file "+t+" in zip");return r}function Mt(e,t,r){if(!r)return Vte(ry(e,t));if(!t)return null;try{return Mt(e,t)}catch{return null}}function en(e,t,r){if(!r)return N4(ry(e,t));if(!t)return null;try{return en(e,t)}catch{return null}}function Hte(e,t,r){return A4(ry(e,t))}function wb(e){for(var t=e.FullPaths||Da(e.files),r=[],n=0;n<t.length;++n)t[n].slice(-1)!="/"&&r.push(t[n].replace(/^Root Entry[\/]/,""));return r.sort()}function zte(e,t,r){if(e.FullPaths){if(typeof r=="string"){var n;return Be?n=ho(r):n=ute(r),Ue.utils.cfb_add(e,t,n)}Ue.utils.cfb_add(e,t,r)}else e.file(t,r)}function O4(e,t){switch(t.type){case"base64":return Ue.read(e,{type:"base64"});case"binary":return Ue.read(e,{type:"binary"});case"buffer":case"array":return Ue.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function jc(e,t){if(e.charAt(0)=="/")return e.slice(1);var r=t.split("/");t.slice(-1)!="/"&&r.pop();for(var n=e.split("/");n.length!==0;){var a=n.shift();a===".."?r.pop():a!=="."&&r.push(a)}return r.join("/")}var D4=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,Yte=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,bb=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,Gte=/<[^>]*>/g,Tr=D4.match(bb)?bb:Gte,Kte=/<\w*:/,qte=/<(\/?)\w+:/;function Ce(e,t,r){for(var n={},a=0,s=0;a!==e.length&&!((s=e.charCodeAt(a))===32||s===10||s===13);++a);if(t||(n[0]=e.slice(0,a)),a===e.length)return n;var i=e.match(Yte),o=0,l="",c=0,f="",d="",h=1;if(i)for(c=0;c!=i.length;++c){for(d=i[c],s=0;s!=d.length&&d.charCodeAt(s)!==61;++s);for(f=d.slice(0,s).trim();d.charCodeAt(s+1)==32;)++s;for(h=(a=d.charCodeAt(s+1))==34||a==39?1:0,l=d.slice(s+1+h,d.length-h),o=0;o!=f.length&&f.charCodeAt(o)!==58;++o);if(o===f.length)f.indexOf("_")>0&&(f=f.slice(0,f.indexOf("_"))),n[f]=l,n[f.toLowerCase()]=l;else{var p=(o===5&&f.slice(0,5)==="xmlns"?"xmlns":"")+f.slice(o+1);if(n[p]&&f.slice(o-3,o)=="ext")continue;n[p]=l,n[p.toLowerCase()]=l}}return n}function Ma(e){return e.replace(qte,"<$1")}var j4={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},Xte=ty(j4),ze=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function r(n){var a=n+"",s=a.indexOf("<![CDATA[");if(s==-1)return a.replace(e,function(o,l){return j4[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var i=a.indexOf("]]>");return r(a.slice(0,s))+a.slice(s+9,i)+r(a.slice(i+3))}}(),Qte=/[&<>'"]/g,Jte=/[\u0000-\u001f]/g;function ny(e){var t=e+"";return t.replace(Qte,function(r){return Xte[r]}).replace(/\n/g,"<br/>").replace(Jte,function(r){return"&#x"+("000"+r.charCodeAt(0).toString(16)).slice(-4)+";"})}var Eb=function(){var e=/&#(\d+);/g;function t(r,n){return String.fromCharCode(parseInt(n,10))}return function(n){return n.replace(e,t)}}();function mt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function km(e){for(var t="",r=0,n=0,a=0,s=0,i=0,o=0;r<e.length;){if(n=e.charCodeAt(r++),n<128){t+=String.fromCharCode(n);continue}if(a=e.charCodeAt(r++),n>191&&n<224){i=(n&31)<<6,i|=a&63,t+=String.fromCharCode(i);continue}if(s=e.charCodeAt(r++),n<240){t+=String.fromCharCode((n&15)<<12|(a&63)<<6|s&63);continue}i=e.charCodeAt(r++),o=((n&7)<<18|(a&63)<<12|(s&63)<<6|i&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function Sb(e){var t=ai(2*e.length),r,n,a=1,s=0,i=0,o;for(n=0;n<e.length;n+=a)a=1,(o=e.charCodeAt(n))<128?r=o:o<224?(r=(o&31)*64+(e.charCodeAt(n+1)&63),a=2):o<240?(r=(o&15)*4096+(e.charCodeAt(n+1)&63)*64+(e.charCodeAt(n+2)&63),a=3):(a=4,r=(o&7)*262144+(e.charCodeAt(n+1)&63)*4096+(e.charCodeAt(n+2)&63)*64+(e.charCodeAt(n+3)&63),r-=65536,i=55296+(r>>>10&1023),r=56320+(r&1023)),i!==0&&(t[s++]=i&255,t[s++]=i>>>8,i=0),t[s++]=r%256,t[s++]=r>>>8;return t.slice(0,s).toString("ucs2")}function kb(e){return ho(e,"binary").toString("utf8")}var md="foo bar bazâð£",st=Be&&(kb(md)==km(md)&&kb||Sb(md)==km(md)&&Sb)||km,Pc=Be?function(e){return ho(e,"utf8").toString("binary")}:function(e){for(var t=[],r=0,n=0,a=0;r<e.length;)switch(n=e.charCodeAt(r++),!0){case n<128:t.push(String.fromCharCode(n));break;case n<2048:t.push(String.fromCharCode(192+(n>>6))),t.push(String.fromCharCode(128+(n&63)));break;case(n>=55296&&n<57344):n-=55296,a=e.charCodeAt(r++)-56320+(n<<10),t.push(String.fromCharCode(240+(a>>18&7))),t.push(String.fromCharCode(144+(a>>12&63))),t.push(String.fromCharCode(128+(a>>6&63))),t.push(String.fromCharCode(128+(a&63)));break;default:t.push(String.fromCharCode(224+(n>>12))),t.push(String.fromCharCode(128+(n>>6&63))),t.push(String.fromCharCode(128+(n&63)))}return t.join("")},Yu=function(){var e={};return function(r,n){var a=r+"|"+(n||"");return e[a]?e[a]:e[a]=new RegExp("<(?:\\w+:)?"+r+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+r+">",n||"")}}(),P4=function(){var e=[["nbsp"," "],["middot","·"],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(r){for(var n=r.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),a=0;a<e.length;++a)n=n.replace(e[a][0],e[a][1]);return n}}(),Zte=function(){var e={};return function(r){return e[r]!==void 0?e[r]:e[r]=new RegExp("<(?:vt:)?"+r+">([\\s\\S]*?)</(?:vt:)?"+r+">","g")}}(),ere=/<\/?(?:vt:)?variant>/g,tre=/<(?:vt:)([^>]*)>([\s\S]*)</;function Tb(e,t){var r=Ce(e),n=e.match(Zte(r.baseType))||[],a=[];if(n.length!=r.size){if(t.WTF)throw new Error("unexpected vector length "+n.length+" != "+r.size);return a}return n.forEach(function(s){var i=s.replace(ere,"").match(tre);i&&a.push({v:st(i[2]),t:i[1]})}),a}var rre=/(^\s|\s$|\n)/;function nre(e){return Da(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function are(e,t,r){return"<"+e+(r!=null?nre(r):"")+(t!=null?(t.match(rre)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function ay(e){if(Be&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return st(po(J1(e)));throw new Error("Bad input format: expected Buffer or string")}var Gu=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,sre={CT:"http://schemas.openxmlformats.org/package/2006/content-types"},ire=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"];function ore(e,t){for(var r=1-2*(e[t+7]>>>7),n=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),a=e[t+6]&15,s=5;s>=0;--s)a=a*256+e[t+s];return n==2047?a==0?r*(1/0):NaN:(n==0?n=-1022:(n-=1023,a+=Math.pow(2,52)),r*Math.pow(2,n-52)*a)}function lre(e,t,r){var n=(t<0||1/t==-1/0?1:0)<<7,a=0,s=0,i=n?-t:t;isFinite(i)?i==0?a=s=0:(a=Math.floor(Math.log(i)/Math.LN2),s=i*Math.pow(2,52-a),a<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?a=-1022:(s-=Math.pow(2,52),a+=1023)):(a=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[r+o]=s&255;e[r+6]=(a&15)<<4|s&15,e[r+7]=a>>4|n}var Cb=function(e){for(var t=[],r=10240,n=0;n<e[0].length;++n)if(e[0][n])for(var a=0,s=e[0][n].length;a<s;a+=r)t.push.apply(t,e[0][n].slice(a,a+r));return t},Nb=Be?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:ho(t)})):Cb(e)}:Cb,Ab=function(e,t,r){for(var n=[],a=t;a<r;a+=2)n.push(String.fromCharCode(Ja(e,a)));return n.join("").replace(Pr,"")},sy=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("utf16le",t,r).replace(Pr,""):Ab(e,t,r)}:Ab,Ob=function(e,t,r){for(var n=[],a=t;a<t+r;++a)n.push(("0"+e[a].toString(16)).slice(-2));return n.join("")},F4=Be?function(e,t,r){return Buffer.isBuffer(e)?e.toString("hex",t,t+r):Ob(e,t,r)}:Ob,Db=function(e,t,r){for(var n=[],a=t;a<r;a++)n.push(String.fromCharCode(Po(e,a)));return n.join("")},Cf=Be?function(t,r,n){return Buffer.isBuffer(t)?t.toString("utf8",r,n):Db(t,r,n)}:Db,R4=function(e,t){var r=Zr(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},M4=R4,I4=function(e,t){var r=Zr(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},L4=I4,$4=function(e,t){var r=2*Zr(e,t);return r>0?Cf(e,t+4,t+4+r-1):""},B4=$4,U4=function(t,r){var n=Zr(t,r);return n>0?sy(t,r+4,r+4+n):""},W4=U4,V4=function(e,t){var r=Zr(e,t);return r>0?Cf(e,t+4,t+4+r):""},H4=V4,z4=function(e,t){return ore(e,t)},H0=z4,Y4=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};Be&&(M4=function(t,r){if(!Buffer.isBuffer(t))return R4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},L4=function(t,r){if(!Buffer.isBuffer(t))return I4(t,r);var n=t.readUInt32LE(r);return n>0?t.toString("utf8",r+4,r+4+n-1):""},B4=function(t,r){if(!Buffer.isBuffer(t))return $4(t,r);var n=2*t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n-1)},W4=function(t,r){if(!Buffer.isBuffer(t))return U4(t,r);var n=t.readUInt32LE(r);return t.toString("utf16le",r+4,r+4+n)},H4=function(t,r){if(!Buffer.isBuffer(t))return V4(t,r);var n=t.readUInt32LE(r);return t.toString("utf8",r+4,r+4+n)},H0=function(t,r){return Buffer.isBuffer(t)?t.readDoubleLE(r):z4(t,r)},Y4=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var Po=function(e,t){return e[t]},Ja=function(e,t){return e[t+1]*256+e[t]},cre=function(e,t){var r=e[t+1]*256+e[t];return r<32768?r:(65535-r+1)*-1},Zr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Ci=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},ure=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function Xc(e,t){var r="",n,a,s=[],i,o,l,c;switch(t){case"dbcs":if(c=this.l,Be&&Buffer.isBuffer(this))r=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)r+=String.fromCharCode(Ja(this,c)),c+=2;e*=2;break;case"utf8":r=Cf(this,this.l,this.l+e);break;case"utf16le":e*=2,r=sy(this,this.l,this.l+e);break;case"wstr":return Xc.call(this,e,"dbcs");case"lpstr-ansi":r=M4(this,this.l),e=4+Zr(this,this.l);break;case"lpstr-cp":r=L4(this,this.l),e=4+Zr(this,this.l);break;case"lpwstr":r=B4(this,this.l),e=4+2*Zr(this,this.l);break;case"lpp4":e=4+Zr(this,this.l),r=W4(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Zr(this,this.l),r=H4(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,r="";(i=Po(this,this.l+e++))!==0;)s.push(pd(i));r=s.join("");break;case"_wstr":for(e=0,r="";(i=Ja(this,this.l+e))!==0;)s.push(pd(i)),e+=2;e+=2,r=s.join("");break;case"dbcs-cont":for(r="",c=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Po(this,c),this.l=c+1,o=Xc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(pd(Ja(this,c))),c+=2}r=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(r="",c=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(c)!==-1)return i=Po(this,c),this.l=c+1,o=Xc.call(this,e-l,i?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(pd(Po(this,c))),c+=1}r=s.join("");break;default:switch(e){case 1:return n=Po(this,this.l),this.l++,n;case 2:return n=(t==="i"?cre:Ja)(this,this.l),this.l+=2,n;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(n=(e>0?Ci:ure)(this,this.l),this.l+=4,n):(a=Zr(this,this.l),this.l+=4,a);case 8:case-8:if(t==="f")return e==8?a=H0(this,this.l):a=H0([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,a;e=8;case 16:r=F4(this,this.l,e);break}}return this.l+=e,r}var fre=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24&255},dre=function(e,t,r){e[r]=t&255,e[r+1]=t>>8&255,e[r+2]=t>>16&255,e[r+3]=t>>24&255},hre=function(e,t,r){e[r]=t&255,e[r+1]=t>>>8&255};function pre(e,t,r){var n=0,a=0;if(r==="dbcs"){for(a=0;a!=t.length;++a)hre(this,t.charCodeAt(a),this.l+2*a);n=2*t.length}else if(r==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),a=0;a!=t.length;++a)this[this.l+a]=t.charCodeAt(a)&255;n=t.length}else if(r==="hex"){for(;a<e;++a)this[this.l++]=parseInt(t.slice(2*a,2*a+2),16)||0;return this}else if(r==="utf16le"){var s=Math.min(this.l+e,this.length);for(a=0;a<Math.min(t.length,e);++a){var i=t.charCodeAt(a);this[this.l++]=i&255,this[this.l++]=i>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:n=1,this[this.l]=t&255;break;case 2:n=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:n=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:n=4,fre(this,t,this.l);break;case 8:if(n=8,r==="f"){lre(this,t,this.l);break}case 16:break;case-4:n=4,dre(this,t,this.l);break}return this.l+=n,this}function G4(e,t){var r=F4(this,this.l,e.length>>1);if(r!==e)throw new Error(t+"Expected "+e+" saw "+r);this.l+=e.length>>1}function nr(e,t){e.l=t,e.read_shift=Xc,e.chk=G4,e.write_shift=pre}function br(e,t){e.l+=t}function Ut(e){var t=ai(e);return nr(t,0),t}function _s(e,t,r){if(e){var n,a,s;nr(e,e.l||0);for(var i=e.length,o=0,l=0;e.l<i;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var c=X0[o]||X0[65535];for(n=e.read_shift(1),s=n&127,a=1;a<4&&n&128;++a)s+=((n=e.read_shift(1))&127)<<7*a;l=e.l+s;var f=c.f&&c.f(e,s,r);if(e.l=l,t(f,c,o))return}}}function hg(){var e=[],t=Be?256:2048,r=function(c){var f=Ut(c);return nr(f,0),f},n=r(t),a=function(){n&&(n.length>n.l&&(n=n.slice(0,n.l),n.l=n.length),n.length>0&&e.push(n),n=null)},s=function(c){return n&&c<n.length-n.l?n:(a(),n=r(Math.max(c+1,t)))},i=function(){return a(),Fs(e)},o=function(c){a(),n=c,n.l==null&&(n.l=n.length),s(t)};return{next:s,push:o,end:i,_bufs:e}}function Qc(e,t,r){var n=ir(e);if(t.s?(n.cRel&&(n.c+=t.s.c),n.rRel&&(n.r+=t.s.r)):(n.cRel&&(n.c+=t.c),n.rRel&&(n.r+=t.r)),!r||r.biff<12){for(;n.c>=256;)n.c-=256;for(;n.r>=65536;)n.r-=65536}return n}function jb(e,t,r){var n=ir(e);return n.s=Qc(n.s,t.s,r),n.e=Qc(n.e,t.s,r),n}function Jc(e,t){if(e.cRel&&e.c<0)for(e=ir(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=ir(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var r=Oe(e);return!e.cRel&&e.cRel!=null&&(r=gre(r)),!e.rRel&&e.rRel!=null&&(r=mre(r)),r}function Tm(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+zt(e.s.c)+":"+(e.e.cRel?"":"$")+zt(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+or(e.s.r)+":"+(e.e.rRel?"":"$")+or(e.e.r):Jc(e.s,t.biff)+":"+Jc(e.e,t.biff)}function iy(e){return parseInt(vre(e),10)-1}function or(e){return""+(e+1)}function mre(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function vre(e){return e.replace(/\$(\d+)$/,"$1")}function oy(e){for(var t=xre(e),r=0,n=0;n!==t.length;++n)r=26*r+t.charCodeAt(n)-64;return r-1}function zt(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function gre(e){return e.replace(/^([A-Z])/,"$$$1")}function xre(e){return e.replace(/^\$([A-Z])/,"$1")}function yre(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function Dr(e){for(var t=0,r=0,n=0;n<e.length;++n){var a=e.charCodeAt(n);a>=48&&a<=57?t=10*t+(a-48):a>=65&&a<=90&&(r=26*r+(a-64))}return{c:r-1,r:t-1}}function Oe(e){for(var t=e.c+1,r="";t;t=(t-1)/26|0)r=String.fromCharCode((t-1)%26+65)+r;return r+(e.r+1)}function tc(e){var t=e.indexOf(":");return t==-1?{s:Dr(e),e:Dr(e)}:{s:Dr(e.slice(0,t)),e:Dr(e.slice(t+1))}}function We(e,t){return typeof t>"u"||typeof t=="number"?We(e.s,e.e):(typeof e!="string"&&(e=Oe(e)),typeof t!="string"&&(t=Oe(t)),e==t?e:e+":"+t)}function Nt(e){var t={s:{c:0,r:0},e:{c:0,r:0}},r=0,n=0,a=0,s=e.length;for(r=0;n<s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.s.c=--r,r=0;n<s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;if(t.s.r=--r,n===s||a!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++n,r=0;n!=s&&!((a=e.charCodeAt(n)-64)<1||a>26);++n)r=26*r+a;for(t.e.c=--r,r=0;n!=s&&!((a=e.charCodeAt(n)-48)<0||a>9);++n)r=10*r+a;return t.e.r=--r,t}function Pb(e,t){var r=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=jn(e.z,r?Fr(t):t)}catch{}try{return e.w=jn((e.XF||{}).numFmtId||(r?14:0),r?Fr(t):t)}catch{return""+t}}function ps(e,t,r){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&r&&r.dateNF&&(e.z=r.dateNF),e.t=="e"?go[e.v]||e.v:t==null?Pb(e,e.v):Pb(e,t))}function mi(e,t){var r=t&&t.sheet?t.sheet:"Sheet1",n={};return n[r]=e,{SheetNames:[r],Sheets:n}}function K4(e,t,r){var n=r||{},a=e?Array.isArray(e):n.dense,s=e||(a?[]:{}),i=0,o=0;if(s&&n.origin!=null){if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var c={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var f=Nt(s["!ref"]);c.s.c=f.s.c,c.s.r=f.s.r,c.e.c=Math.max(c.e.c,f.e.c),c.e.r=Math.max(c.e.r,f.e.r),i==-1&&(c.e.r=i=f.e.r+1)}for(var d=0;d!=t.length;++d)if(t[d]){if(!Array.isArray(t[d]))throw new Error("aoa_to_sheet expects an array of arrays");for(var h=0;h!=t[d].length;++h)if(!(typeof t[d][h]>"u")){var p={v:t[d][h]},v=i+d,m=o+h;if(c.s.r>v&&(c.s.r=v),c.s.c>m&&(c.s.c=m),c.e.r<v&&(c.e.r=v),c.e.c<m&&(c.e.c=m),t[d][h]&&typeof t[d][h]=="object"&&!Array.isArray(t[d][h])&&!(t[d][h]instanceof Date))p=t[d][h];else if(Array.isArray(p.v)&&(p.f=t[d][h][1],p.v=p.v[0]),p.v===null)if(p.f)p.t="n";else if(n.nullError)p.t="e",p.v=0;else if(n.sheetStubs)p.t="z";else continue;else typeof p.v=="number"?p.t="n":typeof p.v=="boolean"?p.t="b":p.v instanceof Date?(p.z=n.dateNF||je[14],n.cellDates?(p.t="d",p.w=jn(p.z,Fr(p.v))):(p.t="n",p.v=Fr(p.v),p.w=jn(p.z,p.v))):p.t="s";if(a)s[v]||(s[v]=[]),s[v][m]&&s[v][m].z&&(p.z=s[v][m].z),s[v][m]=p;else{var _=Oe({c:m,r:v});s[_]&&s[_].z&&(p.z=s[_].z),s[_]=p}}}return c.s.c<1e7&&(s["!ref"]=We(c)),s}function rc(e,t){return K4(null,e,t)}function _re(e){return e.read_shift(4,"i")}function _r(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function wre(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function ly(e,t){var r=e.l,n=e.read_shift(1),a=_r(e),s=[],i={t:a,h:a};if(n&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(wre(e));i.r=s}else i.r=[{ich:0,ifnt:0}];return e.l=r+t,i}var bre=ly;function In(e){var t=e.read_shift(4),r=e.read_shift(2);return r+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:r}}function mo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}var Ere=_r;function cy(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}var Sre=_r,pg=cy;function uy(e){var t=e.slice(e.l,e.l+4),r=t[0]&1,n=t[0]&2;e.l+=4;var a=n===0?H0([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Ci(t,0)>>2;return r?a/100:a}function q4(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}var vo=q4;function gr(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function kre(e){var t={},r=e.read_shift(1),n=r>>>1,a=e.read_shift(1),s=e.read_shift(2,"i"),i=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,n){case 0:t.auto=1;break;case 1:t.index=a;var c=$i[a];c&&(t.rgb=qu(c));break;case 2:t.rgb=qu([i,o,l]);break;case 3:t.theme=a;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function Tre(e){var t=e.read_shift(1);e.l++;var r={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return r}function X4(e,t){var r={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},n=e.read_shift(4);switch(n){case 0:return"";case 4294967295:case 4294967294:return r[e.read_shift(4)]||""}if(n>400)throw new Error("Unsupported Clipboard: "+n.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function Cre(e){return X4(e,1)}function Nre(e){return X4(e,2)}var fy=2,Br=3,vd=11,Fb=12,z0=19,gd=64,Are=65,Ore=71,Dre=4108,jre=4126,Qt=80,Q4=81,Pre=[Qt,Q4],Fre={1:{n:"CodePage",t:fy},2:{n:"Category",t:Qt},3:{n:"PresentationFormat",t:Qt},4:{n:"ByteCount",t:Br},5:{n:"LineCount",t:Br},6:{n:"ParagraphCount",t:Br},7:{n:"SlideCount",t:Br},8:{n:"NoteCount",t:Br},9:{n:"HiddenCount",t:Br},10:{n:"MultimediaClipCount",t:Br},11:{n:"ScaleCrop",t:vd},12:{n:"HeadingPairs",t:Dre},13:{n:"TitlesOfParts",t:jre},14:{n:"Manager",t:Qt},15:{n:"Company",t:Qt},16:{n:"LinksUpToDate",t:vd},17:{n:"CharacterCount",t:Br},19:{n:"SharedDoc",t:vd},22:{n:"HyperlinksChanged",t:vd},23:{n:"AppVersion",t:Br,p:"version"},24:{n:"DigSig",t:Are},26:{n:"ContentType",t:Qt},27:{n:"ContentStatus",t:Qt},28:{n:"Language",t:Qt},29:{n:"Version",t:Qt},255:{},2147483648:{n:"Locale",t:z0},2147483651:{n:"Behavior",t:z0},1919054434:{}},Rre={1:{n:"CodePage",t:fy},2:{n:"Title",t:Qt},3:{n:"Subject",t:Qt},4:{n:"Author",t:Qt},5:{n:"Keywords",t:Qt},6:{n:"Comments",t:Qt},7:{n:"Template",t:Qt},8:{n:"LastAuthor",t:Qt},9:{n:"RevNumber",t:Qt},10:{n:"EditTime",t:gd},11:{n:"LastPrinted",t:gd},12:{n:"CreatedDate",t:gd},13:{n:"ModifiedDate",t:gd},14:{n:"PageCount",t:Br},15:{n:"WordCount",t:Br},16:{n:"CharCount",t:Br},17:{n:"Thumbnail",t:Ore},18:{n:"Application",t:Qt},19:{n:"DocSecurity",t:Br},255:{},2147483648:{n:"Locale",t:z0},2147483651:{n:"Behavior",t:z0},1919054434:{}},Rb={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},Mre=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function Ire(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var Lre=Ire([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),$i=ir(Lre),go={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},J4={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},Mb={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"};function $re(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function Bre(e){var t=$re();if(!e||!e.match)return t;var r={};if((e.match(Tr)||[]).forEach(function(n){var a=Ce(n);switch(a[0].replace(Kte,"<")){case"<?xml":break;case"<Types":t.xmlns=a["xmlns"+(a[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":r[a.Extension]=a.ContentType;break;case"<Override":t[Mb[a.ContentType]]!==void 0&&t[Mb[a.ContentType]].push(a.PartName);break}}),t.xmlns!==sre.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=r,delete t.calcchains,t}var Go={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function mg(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Zc(e,t){var r={"!id":{}};if(!e)return r;t.charAt(0)!=="/"&&(t="/"+t);var n={};return(e.match(Tr)||[]).forEach(function(a){var s=Ce(a);if(s[0]==="<Relationship"){var i={};i.Type=s.Type,i.Target=s.Target,i.Id=s.Id,s.TargetMode&&(i.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:jc(s.Target,t);r[o]=i,n[s.Id]=i}}),r["!id"]=n,r}var Ure="application/vnd.oasis.opendocument.spreadsheet";function Wre(e,t){for(var r=ay(e),n,a;n=Gu.exec(r);)switch(n[3]){case"manifest":break;case"file-entry":if(a=Ce(n[0],!1),a.path=="/"&&a.type!==Ure)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw n}}var eu=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],Vre=function(){for(var e=new Array(eu.length),t=0;t<eu.length;++t){var r=eu[t],n="(?:"+r[0].slice(0,r[0].indexOf(":"))+":)"+r[0].slice(r[0].indexOf(":")+1);e[t]=new RegExp("<"+n+"[^>]*>([\\s\\S]*?)</"+n+">")}return e}();function Z4(e){var t={};e=st(e);for(var r=0;r<eu.length;++r){var n=eu[r],a=e.match(Vre[r]);a!=null&&a.length>0&&(t[n[1]]=ze(a[1])),n[2]==="date"&&t[n[1]]&&(t[n[1]]=er(t[n[1]]))}return t}var Hre=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]];function eA(e,t,r,n){var a=[];if(typeof e=="string")a=Tb(e,n);else for(var s=0;s<e.length;++s)a=a.concat(e[s].map(function(f){return{v:f}}));var i=typeof t=="string"?Tb(t,n).map(function(f){return f.v}):t,o=0,l=0;if(i.length>0)for(var c=0;c!==a.length;c+=2){switch(l=+a[c+1].v,a[c].v){case"Worksheets":case"工作表":case"Листы":case"أوراق العمل":case"ワークシート":case"גליונות עבודה":case"Arbeitsblätter":case"Çalışma Sayfaları":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de cálculo":case"Planilhas":case"Regneark":case"Hojas de cálculo":case"Werkbladen":r.Worksheets=l,r.SheetNames=i.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"名前付き一覧":case"Benannte Bereiche":case"Navngivne områder":r.NamedRanges=l,r.DefinedNames=i.slice(o,o+l);break;case"Charts":case"Diagramme":r.Chartsheets=l,r.ChartNames=i.slice(o,o+l);break}o+=l}}function zre(e,t,r){var n={};return t||(t={}),e=st(e),Hre.forEach(function(a){var s=(e.match(Yu(a[0]))||[])[1];switch(a[2]){case"string":s&&(t[a[1]]=ze(s));break;case"bool":t[a[1]]=s==="true";break;case"raw":var i=e.match(new RegExp("<"+a[0]+"[^>]*>([\\s\\S]*?)</"+a[0]+">"));i&&i.length>0&&(n[a[1]]=i[1]);break}}),n.HeadingPairs&&n.TitlesOfParts&&eA(n.HeadingPairs,n.TitlesOfParts,t,r),t}var Yre=/<[^>]+>[^<]*/g;function Gre(e,t){var r={},n="",a=e.match(Yre);if(a)for(var s=0;s!=a.length;++s){var i=a[s],o=Ce(i);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":n=ze(o.name);break;case"</property>":n=null;break;default:if(i.indexOf("<vt:")===0){var l=i.split(">"),c=l[0].slice(4),f=l[1];switch(c){case"lpstr":case"bstr":case"lpwstr":r[n]=ze(f);break;case"bool":r[n]=mt(f);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":r[n]=parseInt(f,10);break;case"r4":case"r8":case"decimal":r[n]=parseFloat(f);break;case"filetime":case"date":r[n]=er(f);break;case"cy":case"error":r[n]=ze(f);break;default:if(c.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",i,c,l)}}else if(i.slice(0,2)!=="</"){if(t.WTF)throw new Error(i)}}}return r}var Kre={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},Cm;function qre(e,t,r){Cm||(Cm=ty(Kre)),t=Cm[t]||t,e[t]=r}function dy(e){var t=e.read_shift(4),r=e.read_shift(4);return new Date((r/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function tA(e,t,r){var n=e.l,a=e.read_shift(0,"lpstr-cp");if(r)for(;e.l-n&3;)++e.l;return a}function rA(e,t,r){var n=e.read_shift(0,"lpwstr");return n}function nA(e,t,r){return t===31?rA(e):tA(e,t,r)}function vg(e,t,r){return nA(e,t,r===!1?0:4)}function Xre(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return nA(e,t,0)}function Qre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n){var a=e.l;r[n]=e.read_shift(0,"lpwstr").replace(Pr,""),e.l-a&2&&(e.l+=2)}return r}function Jre(e){for(var t=e.read_shift(4),r=[],n=0;n!=t;++n)r[n]=e.read_shift(0,"lpstr-cp").replace(Pr,"");return r}function Zre(e){var t=e.l,r=Y0(e,Q4);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var n=Y0(e,Br);return[r,n]}function ene(e){for(var t=e.read_shift(4),r=[],n=0;n<t/2;++n)r.push(Zre(e));return r}function Ib(e,t){for(var r=e.read_shift(4),n={},a=0;a!=r;++a){var s=e.read_shift(4),i=e.read_shift(4);n[s]=e.read_shift(i,t===1200?"utf16le":"utf8").replace(Pr,"").replace(Dc,"!"),t===1200&&i%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),n}function aA(e){var t=e.read_shift(4),r=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),r}function tne(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function Y0(e,t,r){var n=e.read_shift(2),a,s=r||{};if(e.l+=2,t!==Fb&&n!==t&&Pre.indexOf(t)===-1&&!((t&65534)==4126&&(n&65534)==4126))throw new Error("Expected type "+t+" saw "+n);switch(t===Fb?n:t){case 2:return a=e.read_shift(2,"i"),s.raw||(e.l+=2),a;case 3:return a=e.read_shift(4,"i"),a;case 11:return e.read_shift(4)!==0;case 19:return a=e.read_shift(4),a;case 30:return tA(e,n,4).replace(Pr,"");case 31:return rA(e);case 64:return dy(e);case 65:return aA(e);case 71:return tne(e);case 80:return vg(e,n,!s.raw).replace(Pr,"");case 81:return Xre(e,n).replace(Pr,"");case 4108:return ene(e);case 4126:case 4127:return n==4127?Qre(e):Jre(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+n)}}function Lb(e,t){var r=e.l,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0,o=0,l=-1,c={};for(i=0;i!=a;++i){var f=e.read_shift(4),d=e.read_shift(4);s[i]=[f,d+r]}s.sort(function(y,x){return y[1]-x[1]});var h={};for(i=0;i!=a;++i){if(e.l!==s[i][1]){var p=!0;if(i>0&&t)switch(t[s[i-1][0]].t){case 2:e.l+2===s[i][1]&&(e.l+=2,p=!1);break;case 80:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break;case 4108:e.l<=s[i][1]&&(e.l=s[i][1],p=!1);break}if((!t||i==0)&&e.l<=s[i][1]&&(p=!1,e.l=s[i][1]),p)throw new Error("Read Error: Expected address "+s[i][1]+" at "+e.l+" :"+i)}if(t){var v=t[s[i][0]];if(h[v.n]=Y0(e,v.t,{raw:!0}),v.p==="version"&&(h[v.n]=String(h[v.n]>>16)+"."+("0000"+String(h[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(h[v.n]){case 0:h[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:qn(o=h[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+h[v.n])}}else if(s[i][0]===1){if(o=h.CodePage=Y0(e,fy),qn(o),l!==-1){var m=e.l;e.l=s[l][1],c=Ib(e,o),e.l=m}}else if(s[i][0]===0){if(o===0){l=i,e.l=s[i+1][1];continue}c=Ib(e,o)}else{var _=c[s[i][0]],g;switch(e[e.l]){case 65:e.l+=4,g=aA(e);break;case 30:e.l+=4,g=vg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,g=vg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,g=e.read_shift(4,"i");break;case 19:e.l+=4,g=e.read_shift(4);break;case 5:e.l+=4,g=e.read_shift(8,"f");break;case 11:e.l+=4,g=Ot(e,4);break;case 64:e.l+=4,g=er(dy(e));break;default:throw new Error("unparsed value: "+e[e.l])}h[_]=g}}return e.l=r+n,h}function $b(e,t,r){var n=e.content;if(!n)return{};nr(n,0);var a,s,i,o,l=0;n.chk("feff","Byte Order: "),n.read_shift(2);var c=n.read_shift(4),f=n.read_shift(16);if(f!==Ue.utils.consts.HEADER_CLSID&&f!==r)throw new Error("Bad PropertySet CLSID "+f);if(a=n.read_shift(4),a!==1&&a!==2)throw new Error("Unrecognized #Sets: "+a);if(s=n.read_shift(16),o=n.read_shift(4),a===1&&o!==n.l)throw new Error("Length mismatch: "+o+" !== "+n.l);a===2&&(i=n.read_shift(16),l=n.read_shift(4));var d=Lb(n,t),h={SystemIdentifier:c};for(var p in d)h[p]=d[p];if(h.FMTID=s,a===1)return h;if(l-n.l==2&&(n.l+=2),n.l!==l)throw new Error("Length mismatch 2: "+n.l+" !== "+l);var v;try{v=Lb(n,null)}catch{}for(p in v)h[p]=v[p];return h.FMTID=[s,i],h}function ks(e,t){return e.read_shift(t),null}function rne(e,t,r){for(var n=[],a=e.l+t;e.l<a;)n.push(r(e,a-e.l));if(a!==e.l)throw new Error("Slurp error");return n}function Ot(e,t){return e.read_shift(t)===1}function It(e){return e.read_shift(2,"u")}function sA(e,t){return rne(e,t,It)}function nne(e){var t=e.read_shift(1),r=e.read_shift(1);return r===1?t:t===1}function Nf(e,t,r){var n=e.read_shift(r&&r.biff>=12?2:1),a="sbcs-cont";if(r&&r.biff>=8,!r||r.biff==8){var s=e.read_shift(1);s&&(a="dbcs-cont")}else r.biff==12&&(a="wstr");r.biff>=2&&r.biff<=5&&(a="cpstr");var i=n?e.read_shift(n,a):"";return i}function ane(e){var t=e.read_shift(2),r=e.read_shift(1),n=r&4,a=r&8,s=1+(r&1),i=0,o,l={};a&&(i=e.read_shift(2)),n&&(o=e.read_shift(4));var c=s==2?"dbcs-cont":"sbcs-cont",f=t===0?"":e.read_shift(t,c);return a&&(e.l+=4*i),n&&(e.l+=o),l.t=f,a||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function ro(e,t,r){var n;if(r){if(r.biff>=2&&r.biff<=5)return e.read_shift(t,"cpstr");if(r.biff>=12)return e.read_shift(t,"dbcs-cont")}var a=e.read_shift(1);return a===0?n=e.read_shift(t,"sbcs-cont"):n=e.read_shift(t,"dbcs-cont"),n}function Af(e,t,r){var n=e.read_shift(r&&r.biff==2?1:2);return n===0?(e.l++,""):ro(e,n,r)}function xo(e,t,r){if(r.biff>5)return Af(e,t,r);var n=e.read_shift(1);return n===0?(e.l++,""):e.read_shift(n,r.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function sne(e){var t=e.read_shift(1);e.l++;var r=e.read_shift(2);return e.l+=2,[t,r]}function ine(e){var t=e.read_shift(4),r=e.l,n=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(n=!0),e.l=r);var a=e.read_shift((n?t-24:t)>>1,"utf16le").replace(Pr,"");return n&&(e.l+=24),a}function one(e){for(var t=e.read_shift(2),r="";t-- >0;)r+="../";var n=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var a=e.read_shift(4);if(a===0)return r+n.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var i=e.read_shift(s>>1,"utf16le").replace(Pr,"");return r+i}function lne(e,t){var r=e.read_shift(16);switch(r){case"e0c9ea79f9bace118c8200aa004ba90b":return ine(e);case"0303000000000000c000000000000046":return one(e);default:throw new Error("Unsupported Moniker "+r)}}function xd(e){var t=e.read_shift(4),r=t>0?e.read_shift(t,"utf16le").replace(Pr,""):"";return r}function cne(e,t){var r=e.l+t,n=e.read_shift(4);if(n!==2)throw new Error("Unrecognized streamVersion: "+n);var a=e.read_shift(2);e.l+=2;var s,i,o,l,c="",f,d;a&16&&(s=xd(e,r-e.l)),a&128&&(i=xd(e,r-e.l)),(a&257)===257&&(o=xd(e,r-e.l)),(a&257)===1&&(l=lne(e,r-e.l)),a&8&&(c=xd(e,r-e.l)),a&32&&(f=e.read_shift(16)),a&64&&(d=dy(e)),e.l=r;var h=i||o||l||"";h&&c&&(h+="#"+c),h||(h="#"+c),a&2&&h.charAt(0)=="/"&&h.charAt(1)!="/"&&(h="file://"+h);var p={Target:h};return f&&(p.guid=f),d&&(p.time=d),s&&(p.Tooltip=s),p}function iA(e){var t=e.read_shift(1),r=e.read_shift(1),n=e.read_shift(1),a=e.read_shift(1);return[t,r,n,a]}function oA(e,t){var r=iA(e);return r[3]=0,r}function Ia(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return{r:t,c:r,ixfe:n}}function une(e){var t=e.read_shift(2),r=e.read_shift(2);return e.l+=8,{type:t,flags:r}}function fne(e,t,r){return t===0?"":xo(e,t,r)}function dne(e,t,r){var n=r.biff>8?4:2,a=e.read_shift(n),s=e.read_shift(n,"i"),i=e.read_shift(n,"i");return[a,s,i]}function lA(e){var t=e.read_shift(2),r=uy(e);return[t,r]}function hne(e,t,r){e.l+=4,t-=4;var n=e.l+t,a=Nf(e,t,r),s=e.read_shift(2);if(n-=e.l,s!==n)throw new Error("Malformed AddinUdf: padding = "+n+" != "+s);return e.l+=s,a}function dp(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2);return{s:{c:n,r:t},e:{c:a,r}}}function cA(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(1),a=e.read_shift(1);return{s:{c:n,r:t},e:{c:a,r}}}var pne=cA;function uA(e){e.l+=4;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2);return e.l+=12,[r,t,n]}function mne(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function vne(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function pr(e){e.l+=2,e.l+=e.read_shift(2)}var gne={0:pr,4:pr,5:pr,6:pr,7:vne,8:pr,9:pr,10:pr,11:pr,12:pr,13:mne,14:pr,15:pr,16:pr,17:pr,18:pr,19:pr,20:pr,21:uA};function xne(e,t){for(var r=e.l+t,n=[];e.l<r;){var a=e.read_shift(2);e.l-=2;try{n.push(gne[a](e,r-e.l))}catch{return e.l=r,n}}return e.l!=r&&(e.l=r),n}function yd(e,t){var r={BIFFVer:0,dt:0};switch(r.BIFFVer=e.read_shift(2),t-=2,t>=2&&(r.dt=e.read_shift(2),e.l-=2),r.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+r.BIFFVer)}return e.read_shift(t),r}function yne(e,t){return t===0||e.read_shift(2),1200}function _ne(e,t,r){if(r.enc)return e.l+=t,"";var n=e.l,a=xo(e,0,r);return e.read_shift(t+n-e.l),a}function wne(e,t,r){var n=r&&r.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:n&16,fBelow:n&64,fRight:n&128}}function bne(e,t,r){var n=e.read_shift(4),a=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var i=Nf(e,0,r);return i.length===0&&(i="Sheet1"),{pos:n,hs:a,dt:s,name:i}}function Ene(e,t){for(var r=e.l+t,n=e.read_shift(4),a=e.read_shift(4),s=[],i=0;i!=a&&e.l<r;++i)s.push(ane(e));return s.Count=n,s.Unique=a,s}function Sne(e,t){var r={};return r.dsst=e.read_shift(2),e.l+=t-2,r}function kne(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var r=e.read_shift(2);e.l+=4;var n=e.read_shift(1);return e.l+=3,n&7&&(t.level=n&7),n&32&&(t.hidden=!0),n&64&&(t.hpt=r/20),t}function Tne(e){var t=une(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var r=e.read_shift(4);return r!==0}function Cne(e){return e.read_shift(2),e.read_shift(4)}function Bb(e,t,r){var n=0;r&&r.biff==2||(n=e.read_shift(2));var a=e.read_shift(2);r&&r.biff==2&&(n=1-(a>>15),a&=32767);var s={Unsynced:n&1,DyZero:(n&2)>>1,ExAsc:(n&4)>>2,ExDsc:(n&8)>>3};return[s,a]}function Nne(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),c=e.read_shift(2);return{Pos:[t,r],Dim:[n,a],Flags:s,CurTab:i,FirstTab:o,Selected:l,TabRatio:c}}function Ane(e,t,r){if(r&&r.biff>=2&&r.biff<5)return{};var n=e.read_shift(2);return{RTL:n&64}}function One(){}function Dne(e,t,r){var n={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(r&&r.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return n.name=Nf(e,0,r),n}function jne(e){var t=Ia(e);return t.isst=e.read_shift(4),t}function Pne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=e.l+t,a=Ia(e);r.biff==2&&e.l++;var s=Af(e,n-e.l,r);return a.val=s,a}function Fne(e,t,r){var n=e.read_shift(2),a=xo(e,0,r);return[n,a]}var Rne=xo;function Ub(e,t,r){var n=e.l+t,a=r.biff==8||!r.biff?4:2,s=e.read_shift(a),i=e.read_shift(a),o=e.read_shift(2),l=e.read_shift(2);return e.l=n,{s:{r:s,c:o},e:{r:i,c:l}}}function Mne(e){var t=e.read_shift(2),r=e.read_shift(2),n=lA(e);return{r:t,c:r,ixfe:n[0],rknum:n[1]}}function Ine(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(lA(e));if(e.l!==r)throw new Error("MulRK read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulRK length mismatch");return{r:n,c:a,C:i,rkrec:s}}function Lne(e,t){for(var r=e.l+t-2,n=e.read_shift(2),a=e.read_shift(2),s=[];e.l<r;)s.push(e.read_shift(2));if(e.l!==r)throw new Error("MulBlank read error");var i=e.read_shift(2);if(s.length!=i-a+1)throw new Error("MulBlank length mismatch");return{r:n,c:a,C:i,ixfe:s}}function $ne(e,t,r,n){var a={},s=e.read_shift(4),i=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return a.patternType=Mre[o>>26],n.cellStyles&&(a.alc=s&7,a.fWrap=s>>3&1,a.alcV=s>>4&7,a.fJustLast=s>>7&1,a.trot=s>>8&255,a.cIndent=s>>16&15,a.fShrinkToFit=s>>20&1,a.iReadOrder=s>>22&2,a.fAtrNum=s>>26&1,a.fAtrFnt=s>>27&1,a.fAtrAlc=s>>28&1,a.fAtrBdr=s>>29&1,a.fAtrPat=s>>30&1,a.fAtrProt=s>>31&1,a.dgLeft=i&15,a.dgRight=i>>4&15,a.dgTop=i>>8&15,a.dgBottom=i>>12&15,a.icvLeft=i>>16&127,a.icvRight=i>>23&127,a.grbitDiag=i>>30&3,a.icvTop=o&127,a.icvBottom=o>>7&127,a.icvDiag=o>>14&127,a.dgDiag=o>>21&15,a.icvFore=l&127,a.icvBack=l>>7&127,a.fsxButton=l>>14&1),a}function Bne(e,t,r){var n={};return n.ifnt=e.read_shift(2),n.numFmtId=e.read_shift(2),n.flags=e.read_shift(2),n.fStyle=n.flags>>2&1,t-=6,n.data=$ne(e,t,n.fStyle,r),n}function Une(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function Wb(e,t,r){var n=Ia(e);(r.biff==2||t==9)&&++e.l;var a=nne(e);return n.val=a,n.t=a===!0||a===!1?"b":"e",n}function Wne(e,t,r){r.biffguess&&r.biff==2&&(r.biff=5);var n=Ia(e),a=gr(e);return n.val=a,n}var Vb=fne;function Vne(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(2);if(r.sbcch=s,s==1025||s==14849)return[s,a];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var i=ro(e,s),o=[];n>e.l;)o.push(Af(e));return[s,a,i,o]}function Hb(e,t,r){var n=e.read_shift(2),a,s={fBuiltIn:n&1,fWantAdvise:n>>>1&1,fWantPict:n>>>2&1,fOle:n>>>3&1,fOleLink:n>>>4&1,cf:n>>>5&1023,fIcon:n>>>15&1};return r.sbcch===14849&&(a=hne(e,t-2,r)),s.body=a||e.read_shift(t-2),typeof a=="string"&&(s.Name=a),s}var Hne=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function zb(e,t,r){var n=e.l+t,a=e.read_shift(2),s=e.read_shift(1),i=e.read_shift(1),o=e.read_shift(r&&r.biff==2?1:2),l=0;(!r||r.biff>=5)&&(r.biff!=5&&(e.l+=2),l=e.read_shift(2),r.biff==5&&(e.l+=2),e.l+=4);var c=ro(e,i,r);a&32&&(c=Hne[c.charCodeAt(0)]);var f=n-e.l;r&&r.biff==2&&--f;var d=n==e.l||o===0||!(f>0)?[]:koe(e,f,r,o);return{chKey:s,Name:c,itab:l,rgce:d}}function fA(e,t,r){if(r.biff<8)return zne(e,t,r);for(var n=[],a=e.l+t,s=e.read_shift(r.biff>8?4:2);s--!==0;)n.push(dne(e,r.biff>8?12:6,r));if(e.l!=a)throw new Error("Bad ExternSheet: "+e.l+" != "+a);return n}function zne(e,t,r){e[e.l+1]==3&&e[e.l]++;var n=Nf(e,t,r);return n.charCodeAt(0)==3?n.slice(1):n}function Yne(e,t,r){if(r.biff<8){e.l+=t;return}var n=e.read_shift(2),a=e.read_shift(2),s=ro(e,n,r),i=ro(e,a,r);return[s,i]}function Gne(e,t,r){var n=cA(e);e.l++;var a=e.read_shift(1);return t-=8,[Toe(e,t,r),a,n]}function Yb(e,t,r){var n=pne(e);switch(r.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[n,Eoe(e,t,r)]}function Kne(e){var t=e.read_shift(4)!==0,r=e.read_shift(4)!==0,n=e.read_shift(4);return[t,r,n]}function qne(e,t,r){if(!(r.biff<8)){var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2),i=e.read_shift(2),o=xo(e,0,r);return r.biff<8&&e.read_shift(1),[{r:n,c:a},o,i,s]}}function Xne(e,t,r){return qne(e,t,r)}function Qne(e,t){for(var r=[],n=e.read_shift(2);n--;)r.push(dp(e));return r}function Jne(e,t,r){if(r&&r.biff<8)return eae(e,t,r);var n=uA(e),a=xne(e,t-22,n[1]);return{cmo:n,ft:a}}var Zne={8:function(e,t){var r=e.l+t;e.l+=10;var n=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var a=e.read_shift(1);return e.l+=a,e.l=r,{fmt:n}}};function eae(e,t,r){e.l+=4;var n=e.read_shift(2),a=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var i=[];return i.push((Zne[n]||br)(e,t,r)),{cmo:[a,n,s],ft:i}}function tae(e,t,r){var n=e.l,a="";try{e.l+=4;var s=(r.lastobj||{cmo:[0,0]}).cmo[1],i;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:i=sne(e,6,r);var o=e.read_shift(2);e.read_shift(2),It(e,2);var l=e.read_shift(2);e.l+=l;for(var c=1;c<e.lens.length-1;++c){if(e.l-n!=e.lens[c])throw new Error("TxO: bad continue record");var f=e[e.l],d=ro(e,e.lens[c+1]-e.lens[c]-1);if(a+=d,a.length>=(f?o:2*o))break}if(a.length!==o&&a.length!==o*2)throw new Error("cchText: "+o+" != "+a.length);return e.l=n+t,{t:a}}catch{return e.l=n+t,{t:a}}}function rae(e,t){var r=dp(e);e.l+=16;var n=cne(e,t-24);return[r,n]}function nae(e,t){e.read_shift(2);var r=dp(e),n=e.read_shift((t-10)/2,"dbcs-cont");return n=n.replace(Pr,""),[r,n]}function aae(e){var t=[0,0],r;return r=e.read_shift(2),t[0]=Rb[r]||r,r=e.read_shift(2),t[1]=Rb[r]||r,t}function sae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(oA(e));return r}function iae(e){for(var t=e.read_shift(2),r=[];t-- >0;)r.push(oA(e));return r}function oae(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function dA(e,t,r){if(!r.cellStyles)return br(e,t);var n=r&&r.biff>=12?4:2,a=e.read_shift(n),s=e.read_shift(n),i=e.read_shift(n),o=e.read_shift(n),l=e.read_shift(2);n==2&&(e.l+=2);var c={s:a,e:s,w:i,ixfe:o,flags:l};return(r.biff>=5||!r.biff)&&(c.level=l>>8&7),c}function lae(e,t){var r={};return t<32||(e.l+=16,r.header=gr(e),r.footer=gr(e),e.l+=2),r}function cae(e,t,r){var n={area:!1};if(r.biff!=5)return e.l+=t,n;var a=e.read_shift(1);return e.l+=3,a&16&&(n.area=!0),n}var uae=Ia,fae=sA,dae=Af;function hae(e){var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a={fmt:t,env:r,len:n,data:e.slice(e.l,e.l+n)};return e.l+=n,a}function pae(e,t,r){r.biffguess&&r.biff==5&&(r.biff=2);var n=Ia(e);++e.l;var a=xo(e,t-7,r);return n.t="str",n.val=a,n}function mae(e){var t=Ia(e);++e.l;var r=gr(e);return t.t="n",t.val=r,t}function vae(e){var t=Ia(e);++e.l;var r=e.read_shift(2);return t.t="n",t.val=r,t}function gae(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function xae(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function yae(e,t,r){var n=e.l+t,a=Ia(e),s=e.read_shift(2),i=ro(e,s,r);return e.l=n,a.t="str",a.val=i,a}var _ae=[2,3,48,49,131,139,140,245],Gb=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=ty({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function r(o,l){var c=[],f=ai(1);switch(l.type){case"base64":f=Gn(ln(o));break;case"binary":f=Gn(o);break;case"buffer":case"array":f=o;break}nr(f,0);var d=f.read_shift(1),h=!!(d&136),p=!1,v=!1;switch(d){case 2:break;case 3:break;case 48:p=!0,h=!0;break;case 49:p=!0,h=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+d.toString(16))}var m=0,_=521;d==2&&(m=f.read_shift(2)),f.l+=3,d!=2&&(m=f.read_shift(4)),m>1048576&&(m=1e6),d!=2&&(_=f.read_shift(2));var g=f.read_shift(2),y=l.codepage||1252;d!=2&&(f.l+=16,f.read_shift(1),f[f.l]!==0&&(y=e[f[f.l]]),f.l+=1,f.l+=2),v&&(f.l+=36);for(var x=[],w={},E=Math.min(f.length,d==2?521:_-10-(p?264:0)),S=v?32:11;f.l<E&&f[f.l]!=13;)switch(w={},w.name=dg.utils.decode(y,f.slice(f.l,f.l+S)).replace(/[\u0000\r\n].*$/g,""),f.l+=S,w.type=String.fromCharCode(f.read_shift(1)),d!=2&&!v&&(w.offset=f.read_shift(4)),w.len=f.read_shift(1),d==2&&(w.offset=f.read_shift(2)),w.dec=f.read_shift(1),w.name.length&&x.push(w),d!=2&&(f.l+=v?13:14),w.type){case"B":(!p||w.len!=8)&&l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+w.name+":"+w.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+w.type)}if(f[f.l]!==13&&(f.l=_-1),f.read_shift(1)!==13)throw new Error("DBF Terminator not found "+f.l+" "+f[f.l]);f.l=_;var b=0,j=0;for(c[0]=[],j=0;j!=x.length;++j)c[0][j]=x[j].name;for(;m-- >0;){if(f[f.l]===42){f.l+=g;continue}for(++f.l,c[++b]=[],j=0,j=0;j!=x.length;++j){var k=f.slice(f.l,f.l+x[j].len);f.l+=x[j].len,nr(k,0);var C=dg.utils.decode(y,k);switch(x[j].type){case"C":C.trim().length&&(c[b][j]=C.replace(/\s+$/,""));break;case"D":C.length===8?c[b][j]=new Date(+C.slice(0,4),+C.slice(4,6)-1,+C.slice(6,8)):c[b][j]=C;break;case"F":c[b][j]=parseFloat(C.trim());break;case"+":case"I":c[b][j]=v?k.read_shift(-4,"i")^2147483648:k.read_shift(4,"i");break;case"L":switch(C.trim().toUpperCase()){case"Y":case"T":c[b][j]=!0;break;case"N":case"F":c[b][j]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+C+"|")}break;case"M":if(!h)throw new Error("DBF Unexpected MEMO for type "+d.toString(16));c[b][j]="##MEMO##"+(v?parseInt(C.trim(),10):k.read_shift(4));break;case"N":C=C.replace(/\u0000/g,"").trim(),C&&C!="."&&(c[b][j]=+C||0);break;case"@":c[b][j]=new Date(k.read_shift(-8,"f")-621356832e5);break;case"T":c[b][j]=new Date((k.read_shift(4)-2440588)*864e5+k.read_shift(4));break;case"Y":c[b][j]=k.read_shift(4,"i")/1e4+k.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":c[b][j]=-k.read_shift(-8,"f");break;case"B":if(p&&x[j].len==8){c[b][j]=k.read_shift(8,"f");break}case"G":case"P":k.l+=x[j].len;break;case"0":if(x[j].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+x[j].type)}}}if(d!=2&&f.l<f.length&&f[f.l++]!=26)throw new Error("DBF EOF Marker missing "+(f.l-1)+" of "+f.length+" "+f[f.l-1].toString(16));return l&&l.sheetRows&&(c=c.slice(0,l.sheetRows)),l.DBF=x,c}function n(o,l){var c=l||{};c.dateNF||(c.dateNF="yyyymmdd");var f=rc(r(o,c),c);return f["!cols"]=c.DBF.map(function(d){return{wch:d.len,DBF:d}}),delete c.DBF,f}function a(o,l){try{return mi(n(o,l),l)}catch(c){if(l&&l.WTF)throw c}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function i(o,l){var c=l||{};if(+c.codepage>=0&&qn(+c.codepage),c.type=="string")throw new Error("Cannot write DBF to JS string");var f=hg(),d=Eg(o,{header:1,raw:!0,cellDates:!0}),h=d[0],p=d.slice(1),v=o["!cols"]||[],m=0,_=0,g=0,y=1;for(m=0;m<h.length;++m){if(((v[m]||{}).DBF||{}).name){h[m]=v[m].DBF.name,++g;continue}if(h[m]!=null){if(++g,typeof h[m]=="number"&&(h[m]=h[m].toString(10)),typeof h[m]!="string")throw new Error("DBF Invalid column name "+h[m]+" |"+typeof h[m]+"|");if(h.indexOf(h[m])!==m){for(_=0;_<1024;++_)if(h.indexOf(h[m]+"_"+_)==-1){h[m]+="_"+_;break}}}}var x=Nt(o["!ref"]),w=[],E=[],S=[];for(m=0;m<=x.e.c-x.s.c;++m){var b="",j="",k=0,C=[];for(_=0;_<p.length;++_)p[_][m]!=null&&C.push(p[_][m]);if(C.length==0||h[m]==null){w[m]="?";continue}for(_=0;_<C.length;++_){switch(typeof C[_]){case"number":j="B";break;case"string":j="C";break;case"boolean":j="L";break;case"object":j=C[_]instanceof Date?"D":"C";break;default:j="C"}k=Math.max(k,String(C[_]).length),b=b&&b!=j?"C":j}k>250&&(k=250),j=((v[m]||{}).DBF||{}).type,j=="C"&&v[m].DBF.len>k&&(k=v[m].DBF.len),b=="B"&&j=="N"&&(b="N",S[m]=v[m].DBF.dec,k=v[m].DBF.len),E[m]=b=="C"||j=="N"?k:s[b]||0,y+=E[m],w[m]=b}var P=f.next(32);for(P.write_shift(4,318902576),P.write_shift(4,p.length),P.write_shift(2,296+32*g),P.write_shift(2,y),m=0;m<4;++m)P.write_shift(4,0);for(P.write_shift(4,0|(+t[f4]||3)<<8),m=0,_=0;m<h.length;++m)if(h[m]!=null){var I=f.next(32),D=(h[m].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);I.write_shift(1,D,"sbcs"),I.write_shift(1,w[m]=="?"?"C":w[m],"sbcs"),I.write_shift(4,_),I.write_shift(1,E[m]||s[w[m]]||0),I.write_shift(1,S[m]||0),I.write_shift(1,2),I.write_shift(4,0),I.write_shift(1,0),I.write_shift(4,0),I.write_shift(4,0),_+=E[m]||s[w[m]]||0}var K=f.next(264);for(K.write_shift(4,13),m=0;m<65;++m)K.write_shift(4,0);for(m=0;m<p.length;++m){var Q=f.next(y);for(Q.write_shift(1,0),_=0;_<h.length;++_)if(h[_]!=null)switch(w[_]){case"L":Q.write_shift(1,p[m][_]==null?63:p[m][_]?84:70);break;case"B":Q.write_shift(8,p[m][_]||0,"f");break;case"N":var z="0";for(typeof p[m][_]=="number"&&(z=p[m][_].toFixed(S[_]||0)),g=0;g<E[_]-z.length;++g)Q.write_shift(1,32);Q.write_shift(1,z,"sbcs");break;case"D":p[m][_]?(Q.write_shift(4,("0000"+p[m][_].getFullYear()).slice(-4),"sbcs"),Q.write_shift(2,("00"+(p[m][_].getMonth()+1)).slice(-2),"sbcs"),Q.write_shift(2,("00"+p[m][_].getDate()).slice(-2),"sbcs")):Q.write_shift(8,"00000000","sbcs");break;case"C":var q=String(p[m][_]!=null?p[m][_]:"").slice(0,E[_]);for(Q.write_shift(1,q,"sbcs"),g=0;g<E[_]-q.length;++g)Q.write_shift(1,32);break}}return f.next(1).write_shift(1,26),f.end()}return{to_workbook:a,to_sheet:n,from_sheet:i}}(),wae=function(){var e={AA:"À",BA:"Á",CA:"Â",DA:195,HA:"Ä",JA:197,AE:"È",BE:"É",CE:"Ê",HE:"Ë",AI:"Ì",BI:"Í",CI:"Î",HI:"Ï",AO:"Ò",BO:"Ó",CO:"Ô",DO:213,HO:"Ö",AU:"Ù",BU:"Ú",CU:"Û",HU:"Ü",Aa:"à",Ba:"á",Ca:"â",Da:227,Ha:"ä",Ja:229,Ae:"è",Be:"é",Ce:"ê",He:"ë",Ai:"ì",Bi:"í",Ci:"î",Hi:"ï",Ao:"ò",Bo:"ó",Co:"ô",Do:245,Ho:"ö",Au:"ù",Bu:"ú",Cu:"û",Hu:"ü",KC:"Ç",Kc:"ç",q:"æ",z:"œ",a:"Æ",j:"Œ",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+Da(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),r=function(h,p){var v=e[p];return typeof v=="number"?cb(v):v},n=function(h,p,v){var m=p.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return m==59?h:cb(m)};e["|"]=254;function a(h,p){switch(p.type){case"base64":return s(ln(h),p);case"binary":return s(h,p);case"buffer":return s(Be&&Buffer.isBuffer(h)?h.toString("binary"):po(h),p);case"array":return s(to(h),p)}throw new Error("Unrecognized type "+p.type)}function s(h,p){var v=h.split(/[\n\r]+/),m=-1,_=-1,g=0,y=0,x=[],w=[],E=null,S={},b=[],j=[],k=[],C=0,P;for(+p.codepage>=0&&qn(+p.codepage);g!==v.length;++g){C=0;var I=v[g].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,n).replace(t,r),D=I.replace(/;;/g,"\0").split(";").map(function(R){return R.replace(/\u0000/g,";")}),K=D[0],Q;if(I.length>0)switch(K){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":D[1].charAt(0)=="P"&&w.push(I.slice(3).replace(/;;/g,";"));break;case"C":var z=!1,q=!1,ee=!1,H=!1,ce=-1,J=-1;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"A":break;case"X":_=parseInt(D[y].slice(1))-1,q=!0;break;case"Y":for(m=parseInt(D[y].slice(1))-1,q||(_=0),P=x.length;P<=m;++P)x[P]=[];break;case"K":Q=D[y].slice(1),Q.charAt(0)==='"'?Q=Q.slice(1,Q.length-1):Q==="TRUE"?Q=!0:Q==="FALSE"?Q=!1:isNaN(Zn(Q))?isNaN(Cl(Q).getDate())||(Q=er(Q)):(Q=Zn(Q),E!==null&&ec(E)&&(Q=fp(Q))),z=!0;break;case"E":H=!0;var N=cl(D[y].slice(1),{r:m,c:_});x[m][_]=[x[m][_],N];break;case"S":ee=!0,x[m][_]=[x[m][_],"S5S"];break;case"G":break;case"R":ce=parseInt(D[y].slice(1))-1;break;case"C":J=parseInt(D[y].slice(1))-1;break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}if(z&&(x[m][_]&&x[m][_].length==2?x[m][_][0]=Q:x[m][_]=Q,E=null),ee){if(H)throw new Error("SYLK shared formula cannot have own formula");var F=ce>-1&&x[ce][J];if(!F||!F[1])throw new Error("SYLK shared formula cannot find base");x[m][_][1]=bA(F[1],{r:m-ce,c:_-J})}break;case"F":var T=0;for(y=1;y<D.length;++y)switch(D[y].charAt(0)){case"X":_=parseInt(D[y].slice(1))-1,++T;break;case"Y":for(m=parseInt(D[y].slice(1))-1,P=x.length;P<=m;++P)x[P]=[];break;case"M":C=parseInt(D[y].slice(1))/20;break;case"F":break;case"G":break;case"P":E=w[parseInt(D[y].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(k=D[y].slice(1).split(" "),P=parseInt(k[0],10);P<=parseInt(k[1],10);++P)C=parseInt(k[2],10),j[P-1]=C===0?{hidden:!0}:{wch:C},Nl(j[P-1]);break;case"C":_=parseInt(D[y].slice(1))-1,j[_]||(j[_]={});break;case"R":m=parseInt(D[y].slice(1))-1,b[m]||(b[m]={}),C>0?(b[m].hpt=C,b[m].hpx=Xu(C)):C===0&&(b[m].hidden=!0);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}T<1&&(E=null);break;default:if(p&&p.WTF)throw new Error("SYLK bad record "+I)}}return b.length>0&&(S["!rows"]=b),j.length>0&&(S["!cols"]=j),p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),[x,S]}function i(h,p){var v=a(h,p),m=v[0],_=v[1],g=rc(m,p);return Da(_).forEach(function(y){g[y]=_[y]}),g}function o(h,p){return mi(i(h,p),p)}function l(h,p,v,m){var _="C;Y"+(v+1)+";X"+(m+1)+";K";switch(h.t){case"n":_+=h.v||0,h.f&&!h.F&&(_+=";E"+oie(h.f,{r:v,c:m}));break;case"b":_+=h.v?"TRUE":"FALSE";break;case"e":_+=h.w||h.v;break;case"d":_+='"'+(h.w||h.v)+'"';break;case"s":_+='"'+h.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return _}function c(h,p){p.forEach(function(v,m){var _="F;W"+(m+1)+" "+(m+1)+" ";v.hidden?_+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=K0(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=q0(v.wpx)),typeof v.wch=="number"&&(_+=Math.round(v.wch))),_.charAt(_.length-1)!=" "&&h.push(_)})}function f(h,p){p.forEach(function(v,m){var _="F;";v.hidden?_+="M0;":v.hpt?_+="M"+20*v.hpt+";":v.hpx&&(_+="M"+20*yA(v.hpx)+";"),_.length>2&&h.push(_+"R"+(m+1))})}function d(h,p){var v=["ID;PWXL;N;E"],m=[],_=Nt(h["!ref"]),g,y=Array.isArray(h),x=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),h["!cols"]&&c(v,h["!cols"]),h["!rows"]&&f(v,h["!rows"]),v.push("B;Y"+(_.e.r-_.s.r+1)+";X"+(_.e.c-_.s.c+1)+";D"+[_.s.c,_.s.r,_.e.c,_.e.r].join(" "));for(var w=_.s.r;w<=_.e.r;++w)for(var E=_.s.c;E<=_.e.c;++E){var S=Oe({r:w,c:E});g=y?(h[w]||[])[E]:h[S],!(!g||g.v==null&&(!g.f||g.F))&&m.push(l(g,h,w,E))}return v.join(x)+x+m.join(x)+x+"E"+x}return{to_workbook:o,to_sheet:i,from_sheet:d}}(),bae=function(){function e(s,i){switch(i.type){case"base64":return t(ln(s),i);case"binary":return t(s,i);case"buffer":return t(Be&&Buffer.isBuffer(s)?s.toString("binary"):po(s),i);case"array":return t(to(s),i)}throw new Error("Unrecognized type "+i.type)}function t(s,i){for(var o=s.split(`
`),l=-1,c=-1,f=0,d=[];f!==o.length;++f){if(o[f].trim()==="BOT"){d[++l]=[],c=0;continue}if(!(l<0)){var h=o[f].trim().split(","),p=h[0],v=h[1];++f;for(var m=o[f]||"";(m.match(/["]/g)||[]).length&1&&f<o.length-1;)m+=`
`+o[++f];switch(m=m.trim(),+p){case-1:if(m==="BOT"){d[++l]=[],c=0;continue}else if(m!=="EOD")throw new Error("Unrecognized DIF special command "+m);break;case 0:m==="TRUE"?d[l][c]=!0:m==="FALSE"?d[l][c]=!1:isNaN(Zn(v))?isNaN(Cl(v).getDate())?d[l][c]=v:d[l][c]=er(v):d[l][c]=Zn(v),++c;break;case 1:m=m.slice(1,m.length-1),m=m.replace(/""/g,'"'),m&&m.match(/^=".*"$/)&&(m=m.slice(2,-1)),d[l][c++]=m!==""?m:null;break}if(m==="EOD")break}}return i&&i.sheetRows&&(d=d.slice(0,i.sheetRows)),d}function r(s,i){return rc(e(s,i),i)}function n(s,i){return mi(r(s,i),i)}var a=function(){var s=function(l,c,f,d,h){l.push(c),l.push(f+","+d),l.push('"'+h.replace(/"/g,'""')+'"')},i=function(l,c,f,d){l.push(c+","+f),l.push(c==1?'"'+d.replace(/"/g,'""')+'"':d)};return function(l){var c=[],f=Nt(l["!ref"]),d,h=Array.isArray(l);s(c,"TABLE",0,1,"sheetjs"),s(c,"VECTORS",0,f.e.r-f.s.r+1,""),s(c,"TUPLES",0,f.e.c-f.s.c+1,""),s(c,"DATA",0,0,"");for(var p=f.s.r;p<=f.e.r;++p){i(c,-1,0,"BOT");for(var v=f.s.c;v<=f.e.c;++v){var m=Oe({r:p,c:v});if(d=h?(l[p]||[])[v]:l[m],!d){i(c,1,0,"");continue}switch(d.t){case"n":var _=d.w;!_&&d.v!=null&&(_=d.v),_==null?d.f&&!d.F?i(c,1,0,"="+d.f):i(c,1,0,""):i(c,0,_,"V");break;case"b":i(c,0,d.v?1:0,d.v?"TRUE":"FALSE");break;case"s":i(c,1,0,isNaN(d.v)?d.v:'="'+d.v+'"');break;case"d":d.w||(d.w=jn(d.z||je[14],Fr(er(d.v)))),i(c,0,d.w,"V");break;default:i(c,1,0,"")}}}i(c,-1,0,"EOD");var g=`\r
`,y=c.join(g);return y}}();return{to_workbook:n,to_sheet:r,from_sheet:a}}(),Eae=function(){function e(d){return d.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(d){return d.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function r(d,h){for(var p=d.split(`
`),v=-1,m=-1,_=0,g=[];_!==p.length;++_){var y=p[_].trim().split(":");if(y[0]==="cell"){var x=Dr(y[1]);if(g.length<=x.r)for(v=g.length;v<=x.r;++v)g[v]||(g[v]=[]);switch(v=x.r,m=x.c,y[2]){case"t":g[v][m]=e(y[3]);break;case"v":g[v][m]=+y[3];break;case"vtf":var w=y[y.length-1];case"vtc":switch(y[3]){case"nl":g[v][m]=!!+y[4];break;default:g[v][m]=+y[4];break}y[2]=="vtf"&&(g[v][m]=[g[v][m],w])}}}return h&&h.sheetRows&&(g=g.slice(0,h.sheetRows)),g}function n(d,h){return rc(r(d,h),h)}function a(d,h){return mi(n(d,h),h)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),i=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function c(d){if(!d||!d["!ref"])return"";for(var h=[],p=[],v,m="",_=tc(d["!ref"]),g=Array.isArray(d),y=_.s.r;y<=_.e.r;++y)for(var x=_.s.c;x<=_.e.c;++x)if(m=Oe({r:y,c:x}),v=g?(d[y]||[])[x]:d[m],!(!v||v.v==null||v.t==="z")){switch(p=["cell",m,"t"],v.t){case"s":case"str":p.push(t(v.v));break;case"n":v.f?(p[2]="vtf",p[3]="n",p[4]=v.v,p[5]=t(v.f)):(p[2]="v",p[3]=v.v);break;case"b":p[2]="vt"+(v.f?"f":"c"),p[3]="nl",p[4]=v.v?"1":"0",p[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var w=Fr(er(v.v));p[2]="vtc",p[3]="nd",p[4]=""+w,p[5]=v.w||jn(v.z||je[14],w);break;case"e":continue}h.push(p.join(":"))}return h.push("sheet:c:"+(_.e.c-_.s.c+1)+":r:"+(_.e.r-_.s.r+1)+":tvf:1"),h.push("valueformat:1:text-wiki"),h.join(`
`)}function f(d){return[s,i,o,i,c(d),l].join(`
`)}return{to_workbook:a,to_sheet:n,from_sheet:f}}(),Ku=function(){function e(f,d,h,p,v){v.raw?d[h][p]=f:f===""||(f==="TRUE"?d[h][p]=!0:f==="FALSE"?d[h][p]=!1:isNaN(Zn(f))?isNaN(Cl(f).getDate())?d[h][p]=f:d[h][p]=er(f):d[h][p]=Zn(f))}function t(f,d){var h=d||{},p=[];if(!f||f.length===0)return p;for(var v=f.split(/[\r\n]/),m=v.length-1;m>=0&&v[m].length===0;)--m;for(var _=10,g=0,y=0;y<=m;++y)g=v[y].indexOf(" "),g==-1?g=v[y].length:g++,_=Math.max(_,g);for(y=0;y<=m;++y){p[y]=[];var x=0;for(e(v[y].slice(0,_).trim(),p,y,x,h),x=1;x<=(v[y].length-_)/10+1;++x)e(v[y].slice(_+(x-1)*10,_+x*10).trim(),p,y,x,h)}return h.sheetRows&&(p=p.slice(0,h.sheetRows)),p}var r={44:",",9:"	",59:";",124:"|"},n={44:3,9:2,59:1,124:0};function a(f){for(var d={},h=!1,p=0,v=0;p<f.length;++p)(v=f.charCodeAt(p))==34?h=!h:!h&&v in r&&(d[v]=(d[v]||0)+1);v=[];for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p]);if(!v.length){d=n;for(p in d)Object.prototype.hasOwnProperty.call(d,p)&&v.push([d[p],p])}return v.sort(function(m,_){return m[0]-_[0]||n[m[1]]-n[_[1]]}),r[v.pop()[1]]||44}function s(f,d){var h=d||{},p="",v=h.dense?[]:{},m={s:{c:0,r:0},e:{c:0,r:0}};f.slice(0,4)=="sep="?f.charCodeAt(5)==13&&f.charCodeAt(6)==10?(p=f.charAt(4),f=f.slice(7)):f.charCodeAt(5)==13||f.charCodeAt(5)==10?(p=f.charAt(4),f=f.slice(6)):p=a(f.slice(0,1024)):h&&h.FS?p=h.FS:p=a(f.slice(0,1024));var _=0,g=0,y=0,x=0,w=0,E=p.charCodeAt(0),S=!1,b=0,j=f.charCodeAt(0);f=f.replace(/\r\n/mg,`
`);var k=h.dateNF!=null?Fte(h.dateNF):null;function C(){var P=f.slice(x,w),I={};if(P.charAt(0)=='"'&&P.charAt(P.length-1)=='"'&&(P=P.slice(1,-1).replace(/""/g,'"')),P.length===0)I.t="z";else if(h.raw)I.t="s",I.v=P;else if(P.trim().length===0)I.t="s",I.v=P;else if(P.charCodeAt(0)==61)P.charCodeAt(1)==34&&P.charCodeAt(P.length-1)==34?(I.t="s",I.v=P.slice(2,-1).replace(/""/g,'"')):cie(P)?(I.t="n",I.f=P.slice(1)):(I.t="s",I.v=P);else if(P=="TRUE")I.t="b",I.v=!0;else if(P=="FALSE")I.t="b",I.v=!1;else if(!isNaN(y=Zn(P)))I.t="n",h.cellText!==!1&&(I.w=P),I.v=y;else if(!isNaN(Cl(P).getDate())||k&&P.match(k)){I.z=h.dateNF||je[14];var D=0;k&&P.match(k)&&(P=Rte(P,h.dateNF,P.match(k)||[]),D=1),h.cellDates?(I.t="d",I.v=er(P,D)):(I.t="n",I.v=Fr(er(P,D))),h.cellText!==!1&&(I.w=jn(I.z,I.v instanceof Date?Fr(I.v):I.v)),h.cellNF||delete I.z}else I.t="s",I.v=P;if(I.t=="z"||(h.dense?(v[_]||(v[_]=[]),v[_][g]=I):v[Oe({c:g,r:_})]=I),x=w+1,j=f.charCodeAt(x),m.e.c<g&&(m.e.c=g),m.e.r<_&&(m.e.r=_),b==E)++g;else if(g=0,++_,h.sheetRows&&h.sheetRows<=_)return!0}e:for(;w<f.length;++w)switch(b=f.charCodeAt(w)){case 34:j===34&&(S=!S);break;case E:case 10:case 13:if(!S&&C())break e;break}return w-x>0&&C(),v["!ref"]=We(m),v}function i(f,d){return!(d&&d.PRN)||d.FS||f.slice(0,4)=="sep="||f.indexOf("	")>=0||f.indexOf(",")>=0||f.indexOf(";")>=0?s(f,d):rc(t(f,d),d)}function o(f,d){var h="",p=d.type=="string"?[0,0,0,0]:_y(f,d);switch(d.type){case"base64":h=ln(f);break;case"binary":h=f;break;case"buffer":d.codepage==65001?h=f.toString("utf8"):(d.codepage,h=Be&&Buffer.isBuffer(f)?f.toString("binary"):po(f));break;case"array":h=to(f);break;case"string":h=f;break;default:throw new Error("Unrecognized type "+d.type)}return p[0]==239&&p[1]==187&&p[2]==191?h=st(h.slice(3)):d.type!="string"&&d.type!="buffer"&&d.codepage==65001?h=st(h):d.type=="binary",h.slice(0,19)=="socialcalc:version:"?Eae.to_sheet(d.type=="string"?h:st(h),d):i(h,d)}function l(f,d){return mi(o(f,d),d)}function c(f){for(var d=[],h=Nt(f["!ref"]),p,v=Array.isArray(f),m=h.s.r;m<=h.e.r;++m){for(var _=[],g=h.s.c;g<=h.e.c;++g){var y=Oe({r:m,c:g});if(p=v?(f[m]||[])[g]:f[y],!p||p.v==null){_.push("          ");continue}for(var x=(p.w||(ps(p),p.w)||"").slice(0,10);x.length<10;)x+=" ";_.push(x+(g===0?" ":""))}d.push(_.join(""))}return d.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:c}}();function Sae(e,t){var r=t||{},n=!!r.WTF;r.WTF=!0;try{var a=wae.to_workbook(e,r);return r.WTF=n,a}catch(s){if(r.WTF=n,!s.message.match(/SYLK bad record ID/)&&n)throw s;return Ku.to_workbook(e,t)}}var tu=function(){function e(N,F,T){if(N){nr(N,N.l||0);for(var R=T.Enum||ce;N.l<N.length;){var G=N.read_shift(2),X=R[G]||R[65535],Y=N.read_shift(2),ae=N.l+Y,oe=X.f&&X.f(N,Y,T);if(N.l=ae,F(oe,X,G))return}}}function t(N,F){switch(F.type){case"base64":return r(Gn(ln(N)),F);case"binary":return r(Gn(N),F);case"buffer":case"array":return r(N,F)}throw"Unsupported type "+F.type}function r(N,F){if(!N)return N;var T=F||{},R=T.dense?[]:{},G="Sheet1",X="",Y=0,ae={},oe=[],ve=[],B={s:{r:0,c:0},e:{r:0,c:0}},Te=T.sheetRows||0;if(N[2]==0&&(N[3]==8||N[3]==9)&&N.length>=16&&N[14]==5&&N[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(N[2]==2)T.Enum=ce,e(N,function(me,Xe,$t){switch($t){case 0:T.vers=me,me>=4096&&(T.qpro=!0);break;case 6:B=me;break;case 204:me&&(X=me);break;case 222:X=me;break;case 15:case 51:T.qpro||(me[1].v=me[1].v.slice(1));case 13:case 14:case 16:$t==14&&(me[2]&112)==112&&(me[2]&15)>1&&(me[2]&15)<15&&(me[1].z=T.dateNF||je[14],T.cellDates&&(me[1].t="d",me[1].v=fp(me[1].v))),T.qpro&&me[3]>Y&&(R["!ref"]=We(B),ae[G]=R,oe.push(G),R=T.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Y=me[3],G=X||"Sheet"+(Y+1),X="");var gt=T.dense?(R[me[0].r]||[])[me[0].c]:R[Oe(me[0])];if(gt){gt.t=me[1].t,gt.v=me[1].v,me[1].z!=null&&(gt.z=me[1].z),me[1].f!=null&&(gt.f=me[1].f);break}T.dense?(R[me[0].r]||(R[me[0].r]=[]),R[me[0].r][me[0].c]=me[1]):R[Oe(me[0])]=me[1];break}},T);else if(N[2]==26||N[2]==14)T.Enum=J,N[2]==14&&(T.qpro=!0,N.l=0),e(N,function(me,Xe,$t){switch($t){case 204:G=me;break;case 22:me[1].v=me[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(me[3]>Y&&(R["!ref"]=We(B),ae[G]=R,oe.push(G),R=T.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},Y=me[3],G="Sheet"+(Y+1)),Te>0&&me[0].r>=Te)break;T.dense?(R[me[0].r]||(R[me[0].r]=[]),R[me[0].r][me[0].c]=me[1]):R[Oe(me[0])]=me[1],B.e.c<me[0].c&&(B.e.c=me[0].c),B.e.r<me[0].r&&(B.e.r=me[0].r);break;case 27:me[14e3]&&(ve[me[14e3][0]]=me[14e3][1]);break;case 1537:ve[me[0]]=me[1],me[0]==Y&&(G=me[1]);break}},T);else throw new Error("Unrecognized LOTUS BOF "+N[2]);if(R["!ref"]=We(B),ae[X||G]=R,oe.push(X||G),!ve.length)return{SheetNames:oe,Sheets:ae};for(var ke={},$e=[],Ne=0;Ne<ve.length;++Ne)ae[oe[Ne]]?($e.push(ve[Ne]||oe[Ne]),ke[ve[Ne]]=ae[ve[Ne]]||ae[oe[Ne]]):($e.push(ve[Ne]),ke[ve[Ne]]={"!ref":"A1"});return{SheetNames:$e,Sheets:ke}}function n(N,F){var T=F||{};if(+T.codepage>=0&&qn(+T.codepage),T.type=="string")throw new Error("Cannot write WK1 to JS string");var R=hg(),G=Nt(N["!ref"]),X=Array.isArray(N),Y=[];Wn(R,0,s(1030)),Wn(R,6,l(G));for(var ae=Math.min(G.e.r,8191),oe=G.s.r;oe<=ae;++oe)for(var ve=or(oe),B=G.s.c;B<=G.e.c;++B){oe===G.s.r&&(Y[B]=zt(B));var Te=Y[B]+ve,ke=X?(N[oe]||[])[B]:N[Te];if(!(!ke||ke.t=="z"))if(ke.t=="n")(ke.v|0)==ke.v&&ke.v>=-32768&&ke.v<=32767?Wn(R,13,p(oe,B,ke.v)):Wn(R,14,m(oe,B,ke.v));else{var $e=ps(ke);Wn(R,15,d(oe,B,$e.slice(0,239)))}}return Wn(R,1),R.end()}function a(N,F){var T=F||{};if(+T.codepage>=0&&qn(+T.codepage),T.type=="string")throw new Error("Cannot write WK3 to JS string");var R=hg();Wn(R,0,i(N));for(var G=0,X=0;G<N.SheetNames.length;++G)(N.Sheets[N.SheetNames[G]]||{})["!ref"]&&Wn(R,27,H(N.SheetNames[G],X++));var Y=0;for(G=0;G<N.SheetNames.length;++G){var ae=N.Sheets[N.SheetNames[G]];if(!(!ae||!ae["!ref"])){for(var oe=Nt(ae["!ref"]),ve=Array.isArray(ae),B=[],Te=Math.min(oe.e.r,8191),ke=oe.s.r;ke<=Te;++ke)for(var $e=or(ke),Ne=oe.s.c;Ne<=oe.e.c;++Ne){ke===oe.s.r&&(B[Ne]=zt(Ne));var me=B[Ne]+$e,Xe=ve?(ae[ke]||[])[Ne]:ae[me];if(!(!Xe||Xe.t=="z"))if(Xe.t=="n")Wn(R,23,C(ke,Ne,Y,Xe.v));else{var $t=ps(Xe);Wn(R,22,b(ke,Ne,Y,$t.slice(0,239)))}}++Y}}return Wn(R,1),R.end()}function s(N){var F=Ut(2);return F.write_shift(2,N),F}function i(N){var F=Ut(26);F.write_shift(2,4096),F.write_shift(2,4),F.write_shift(4,0);for(var T=0,R=0,G=0,X=0;X<N.SheetNames.length;++X){var Y=N.SheetNames[X],ae=N.Sheets[Y];if(!(!ae||!ae["!ref"])){++G;var oe=tc(ae["!ref"]);T<oe.e.r&&(T=oe.e.r),R<oe.e.c&&(R=oe.e.c)}}return T>8191&&(T=8191),F.write_shift(2,T),F.write_shift(1,G),F.write_shift(1,R),F.write_shift(2,0),F.write_shift(2,0),F.write_shift(1,1),F.write_shift(1,2),F.write_shift(4,0),F.write_shift(4,0),F}function o(N,F,T){var R={s:{c:0,r:0},e:{c:0,r:0}};return F==8&&T.qpro?(R.s.c=N.read_shift(1),N.l++,R.s.r=N.read_shift(2),R.e.c=N.read_shift(1),N.l++,R.e.r=N.read_shift(2),R):(R.s.c=N.read_shift(2),R.s.r=N.read_shift(2),F==12&&T.qpro&&(N.l+=2),R.e.c=N.read_shift(2),R.e.r=N.read_shift(2),F==12&&T.qpro&&(N.l+=2),R.s.c==65535&&(R.s.c=R.e.c=R.s.r=R.e.r=0),R)}function l(N){var F=Ut(8);return F.write_shift(2,N.s.c),F.write_shift(2,N.s.r),F.write_shift(2,N.e.c),F.write_shift(2,N.e.r),F}function c(N,F,T){var R=[{c:0,r:0},{t:"n",v:0},0,0];return T.qpro&&T.vers!=20768?(R[0].c=N.read_shift(1),R[3]=N.read_shift(1),R[0].r=N.read_shift(2),N.l+=2):(R[2]=N.read_shift(1),R[0].c=N.read_shift(2),R[0].r=N.read_shift(2)),R}function f(N,F,T){var R=N.l+F,G=c(N,F,T);if(G[1].t="s",T.vers==20768){N.l++;var X=N.read_shift(1);return G[1].v=N.read_shift(X,"utf8"),G}return T.qpro&&N.l++,G[1].v=N.read_shift(R-N.l,"cstr"),G}function d(N,F,T){var R=Ut(7+T.length);R.write_shift(1,255),R.write_shift(2,F),R.write_shift(2,N),R.write_shift(1,39);for(var G=0;G<R.length;++G){var X=T.charCodeAt(G);R.write_shift(1,X>=128?95:X)}return R.write_shift(1,0),R}function h(N,F,T){var R=c(N,F,T);return R[1].v=N.read_shift(2,"i"),R}function p(N,F,T){var R=Ut(7);return R.write_shift(1,255),R.write_shift(2,F),R.write_shift(2,N),R.write_shift(2,T,"i"),R}function v(N,F,T){var R=c(N,F,T);return R[1].v=N.read_shift(8,"f"),R}function m(N,F,T){var R=Ut(13);return R.write_shift(1,255),R.write_shift(2,F),R.write_shift(2,N),R.write_shift(8,T,"f"),R}function _(N,F,T){var R=N.l+F,G=c(N,F,T);if(G[1].v=N.read_shift(8,"f"),T.qpro)N.l=R;else{var X=N.read_shift(2);w(N.slice(N.l,N.l+X),G),N.l+=X}return G}function g(N,F,T){var R=F&32768;return F&=-32769,F=(R?N:0)+(F>=8192?F-16384:F),(R?"":"$")+(T?zt(F):or(F))}var y={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},x=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function w(N,F){nr(N,0);for(var T=[],R=0,G="",X="",Y="",ae="";N.l<N.length;){var oe=N[N.l++];switch(oe){case 0:T.push(N.read_shift(8,"f"));break;case 1:X=g(F[0].c,N.read_shift(2),!0),G=g(F[0].r,N.read_shift(2),!1),T.push(X+G);break;case 2:{var ve=g(F[0].c,N.read_shift(2),!0),B=g(F[0].r,N.read_shift(2),!1);X=g(F[0].c,N.read_shift(2),!0),G=g(F[0].r,N.read_shift(2),!1),T.push(ve+B+":"+X+G)}break;case 3:if(N.l<N.length){console.error("WK1 premature formula end");return}break;case 4:T.push("("+T.pop()+")");break;case 5:T.push(N.read_shift(2));break;case 6:{for(var Te="";oe=N[N.l++];)Te+=String.fromCharCode(oe);T.push('"'+Te.replace(/"/g,'""')+'"')}break;case 8:T.push("-"+T.pop());break;case 23:T.push("+"+T.pop());break;case 22:T.push("NOT("+T.pop()+")");break;case 20:case 21:ae=T.pop(),Y=T.pop(),T.push(["AND","OR"][oe-20]+"("+Y+","+ae+")");break;default:if(oe<32&&x[oe])ae=T.pop(),Y=T.pop(),T.push(Y+x[oe]+ae);else if(y[oe]){if(R=y[oe][1],R==69&&(R=N[N.l++]),R>T.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+T.join("|")+"|");return}var ke=T.slice(-R);T.length-=R,T.push(y[oe][0]+"("+ke.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}T.length==1?F[1].f=""+T[0]:console.error("WK1 bad formula parse |"+T.join("|")+"|")}function E(N){var F=[{c:0,r:0},{t:"n",v:0},0];return F[0].r=N.read_shift(2),F[3]=N[N.l++],F[0].c=N[N.l++],F}function S(N,F){var T=E(N);return T[1].t="s",T[1].v=N.read_shift(F-4,"cstr"),T}function b(N,F,T,R){var G=Ut(6+R.length);G.write_shift(2,N),G.write_shift(1,T),G.write_shift(1,F),G.write_shift(1,39);for(var X=0;X<R.length;++X){var Y=R.charCodeAt(X);G.write_shift(1,Y>=128?95:Y)}return G.write_shift(1,0),G}function j(N,F){var T=E(N);T[1].v=N.read_shift(2);var R=T[1].v>>1;if(T[1].v&1)switch(R&7){case 0:R=(R>>3)*5e3;break;case 1:R=(R>>3)*500;break;case 2:R=(R>>3)/20;break;case 3:R=(R>>3)/200;break;case 4:R=(R>>3)/2e3;break;case 5:R=(R>>3)/2e4;break;case 6:R=(R>>3)/16;break;case 7:R=(R>>3)/64;break}return T[1].v=R,T}function k(N,F){var T=E(N),R=N.read_shift(4),G=N.read_shift(4),X=N.read_shift(2);if(X==65535)return R===0&&G===3221225472?(T[1].t="e",T[1].v=15):R===0&&G===3489660928?(T[1].t="e",T[1].v=42):T[1].v=0,T;var Y=X&32768;return X=(X&32767)-16446,T[1].v=(1-Y*2)*(G*Math.pow(2,X+32)+R*Math.pow(2,X)),T}function C(N,F,T,R){var G=Ut(14);if(G.write_shift(2,N),G.write_shift(1,T),G.write_shift(1,F),R==0)return G.write_shift(4,0),G.write_shift(4,0),G.write_shift(2,65535),G;var X=0,Y=0,ae=0,oe=0;return R<0&&(X=1,R=-R),Y=Math.log2(R)|0,R/=Math.pow(2,Y-31),oe=R>>>0,oe&2147483648||(R/=2,++Y,oe=R>>>0),R-=oe,oe|=2147483648,oe>>>=0,R*=Math.pow(2,32),ae=R>>>0,G.write_shift(4,ae),G.write_shift(4,oe),Y+=16383+(X?32768:0),G.write_shift(2,Y),G}function P(N,F){var T=k(N);return N.l+=F-14,T}function I(N,F){var T=E(N),R=N.read_shift(4);return T[1].v=R>>6,T}function D(N,F){var T=E(N),R=N.read_shift(8,"f");return T[1].v=R,T}function K(N,F){var T=D(N);return N.l+=F-10,T}function Q(N,F){return N[N.l+F-1]==0?N.read_shift(F,"cstr"):""}function z(N,F){var T=N[N.l++];T>F-1&&(T=F-1);for(var R="";R.length<T;)R+=String.fromCharCode(N[N.l++]);return R}function q(N,F,T){if(!(!T.qpro||F<21)){var R=N.read_shift(1);N.l+=17,N.l+=1,N.l+=2;var G=N.read_shift(F-21,"cstr");return[R,G]}}function ee(N,F){for(var T={},R=N.l+F;N.l<R;){var G=N.read_shift(2);if(G==14e3){for(T[G]=[0,""],T[G][0]=N.read_shift(2);N[N.l];)T[G][1]+=String.fromCharCode(N[N.l]),N.l++;N.l++}}return T}function H(N,F){var T=Ut(5+N.length);T.write_shift(2,14e3),T.write_shift(2,F);for(var R=0;R<N.length;++R){var G=N.charCodeAt(R);T[T.l++]=G>127?95:G}return T[T.l++]=0,T}var ce={0:{n:"BOF",f:It},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:h},14:{n:"NUMBER",f:v},15:{n:"LABEL",f},16:{n:"FORMULA",f:_},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:Q},222:{n:"SHEETNAMELP",f:z},65535:{n:""}},J={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:k},24:{n:"NUMBER18",f:j},25:{n:"FORMULA19",f:P},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ee},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:I},38:{n:"??"},39:{n:"NUMBER27",f:D},40:{n:"FORMULA28",f:K},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:Q},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:q},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:n,book_to_wk3:a,to_workbook:t}}();function kae(e){var t={},r=e.match(Tr),n=0,a=!1;if(r)for(;n!=r.length;++n){var s=Ce(r[n]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=X1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(s[0].charCodeAt(1)!==47&&!a)throw new Error("Unrecognized rich format "+s[0])}}return t}var Tae=function(){var e=Yu("t"),t=Yu("rPr");function r(s){var i=s.match(e);if(!i)return{t:"s",v:""};var o={t:"s",v:ze(i[1])},l=s.match(t);return l&&(o.s=kae(l[1])),o}var n=/<(?:\w+:)?r>/g,a=/<\/(?:\w+:)?r>/;return function(i){return i.replace(n,"").split(a).map(r).filter(function(o){return o.v})}}(),Cae=function(){var t=/(\r\n|\n)/g;function r(a,s,i){var o=[];a.u&&o.push("text-decoration: underline;"),a.uval&&o.push("text-underline-style:"+a.uval+";"),a.sz&&o.push("font-size:"+a.sz+"pt;"),a.outline&&o.push("text-effect: outline;"),a.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),a.b&&(s.push("<b>"),i.push("</b>")),a.i&&(s.push("<i>"),i.push("</i>")),a.strike&&(s.push("<s>"),i.push("</s>"));var l=a.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),i.push("</"+l+">")),i.push("</span>"),a}function n(a){var s=[[],a.v,[]];return a.v?(a.s&&r(a.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(n).join("")}}(),Nae=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,Aae=/<(?:\w+:)?r>/,Oae=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function hy(e,t){var r=t?t.cellHTML:!0,n={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(n.t=ze(st(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),n.r=st(e),r&&(n.h=ny(n.t))):e.match(Aae)&&(n.r=st(e),n.t=ze(st((e.replace(Oae,"").match(Nae)||[]).join("").replace(Tr,""))),r&&(n.h=Cae(Tae(n.r)))),n):{t:""}}var Dae=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,jae=/<(?:\w+:)?(?:si|sstItem)>/g,Pae=/<\/(?:\w+:)?(?:si|sstItem)>/;function Fae(e,t){var r=[],n="";if(!e)return r;var a=e.match(Dae);if(a){n=a[2].replace(jae,"").split(Pae);for(var s=0;s!=n.length;++s){var i=hy(n[s].trim(),t);i!=null&&(r[r.length]=i)}a=Ce(a[1]),r.Count=a.count,r.Unique=a.uniqueCount}return r}function Rae(e){return[e.read_shift(4),e.read_shift(4)]}function Mae(e,t){var r=[],n=!1;return _s(e,function(s,i,o){switch(o){case 159:r.Count=s[0],r.Unique=s[1];break;case 19:r.push(s);break;case 160:return!0;case 35:n=!0;break;case 36:n=!1;break;default:if(i.T,!n||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function hA(e){for(var t=[],r=e.split(""),n=0;n<r.length;++n)t[n]=r[n].charCodeAt(0);return t}function ns(e,t){var r={};return r.Major=e.read_shift(2),r.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),r}function Iae(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=ns(e,4),t.U=ns(e,4),t.W=ns(e,4),t}function Lae(e){for(var t=e.read_shift(4),r=e.l+t-4,n={},a=e.read_shift(4),s=[];a-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(n.name=e.read_shift(0,"lpp4"),n.comps=s,e.l!=r)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+r);return n}function $ae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(Lae(e));return t}function Bae(e){var t=[];e.l+=4;for(var r=e.read_shift(4);r-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function Uae(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=ns(e,4),t.U=ns(e,4),t.W=ns(e,4),t}function Wae(e){var t=Uae(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function pA(e,t){var r=e.l+t,n={};n.Flags=e.read_shift(4)&63,e.l+=4,n.AlgID=e.read_shift(4);var a=!1;switch(n.AlgID){case 26126:case 26127:case 26128:a=n.Flags==36;break;case 26625:a=n.Flags==4;break;case 0:a=n.Flags==16||n.Flags==4||n.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+n.AlgID}if(!a)throw new Error("Encryption Flags/AlgID mismatch");return n.AlgIDHash=e.read_shift(4),n.KeySize=e.read_shift(4),n.ProviderType=e.read_shift(4),e.l+=8,n.CSPName=e.read_shift(r-e.l>>1,"utf16le"),e.l=r,n}function mA(e,t){var r={},n=e.l+t;return e.l+=4,r.Salt=e.slice(e.l,e.l+16),e.l+=16,r.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),r.VerifierHash=e.slice(e.l,n),e.l=n,r}function Vae(e){var t=ns(e);switch(t.Minor){case 2:return[t.Minor,Hae(e)];case 3:return[t.Minor,zae()];case 4:return[t.Minor,Yae(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function Hae(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var r=e.read_shift(4),n=pA(e,r),a=mA(e,e.length-e.l);return{t:"Std",h:n,v:a}}function zae(){throw new Error("File is password-protected: ECMA-376 Extensible")}function Yae(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var r=e.read_shift(e.length-e.l,"utf8"),n={};return r.replace(Tr,function(s){var i=Ce(s);switch(Ma(i[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){n[o]=i[o]});break;case"<dataIntegrity":n.encryptedHmacKey=i.encryptedHmacKey,n.encryptedHmacValue=i.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":n.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":n.uri=i.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":n.encs.push(i);break;default:throw i[0]}}),n}function Gae(e,t){var r={},n=r.EncryptionVersionInfo=ns(e,4);if(t-=4,n.Minor!=2)throw new Error("unrecognized minor version code: "+n.Minor);if(n.Major>4||n.Major<2)throw new Error("unrecognized major version code: "+n.Major);r.Flags=e.read_shift(4),t-=4;var a=e.read_shift(4);return t-=4,r.EncryptionHeader=pA(e,a),t-=a,r.EncryptionVerifier=mA(e,t),r}function Kae(e){var t={},r=t.EncryptionVersionInfo=ns(e,4);if(r.Major!=1||r.Minor!=1)throw"unrecognized version code "+r.Major+" : "+r.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function qae(e){var t=0,r,n=hA(e),a=n.length+1,s,i,o,l,c;for(r=ai(a),r[0]=n.length,s=1;s!=a;++s)r[s]=n[s-1];for(s=a-1;s>=0;--s)i=r[s],o=t&16384?1:0,l=t<<1&32767,c=o|l,t=c^i;return t^52811}var vA=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],r=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],n=function(i){return(i/2|i*128)&255},a=function(i,o){return n(i^o)},s=function(i){for(var o=t[i.length-1],l=104,c=i.length-1;c>=0;--c)for(var f=i[c],d=0;d!=7;++d)f&64&&(o^=r[l]),f*=2,--l;return o};return function(i){for(var o=hA(i),l=s(o),c=o.length,f=ai(16),d=0;d!=16;++d)f[d]=0;var h,p,v;for((c&1)===1&&(h=l>>8,f[c]=a(e[0],h),--c,h=l&255,p=o[o.length-1],f[c]=a(p,h));c>0;)--c,h=l>>8,f[c]=a(o[c],h),--c,h=l&255,f[c]=a(o[c],h);for(c=15,v=15-o.length;v>0;)h=l>>8,f[c]=a(e[v],h),--c,--v,h=l&255,f[c]=a(o[c],h),--c,--v;return f}}(),Xae=function(e,t,r,n,a){a||(a=t),n||(n=vA(e));var s,i;for(s=0;s!=t.length;++s)i=t[s],i^=n[r],i=(i>>5|i<<3)&255,a[s]=i,++r;return[a,r,n]},Qae=function(e){var t=0,r=vA(e);return function(n){var a=Xae("",n,t,r);return t=a[1],a[0]}};function Jae(e,t,r,n){var a={key:It(e),verificationBytes:It(e)};return r.password&&(a.verifier=qae(r.password)),n.valid=a.verificationBytes===a.verifier,n.valid&&(n.insitu=Qae(r.password)),a}function Zae(e,t,r){var n=r||{};return n.Info=e.read_shift(2),e.l-=2,n.Info===1?n.Data=Kae(e):n.Data=Gae(e,t),n}function ese(e,t,r){var n={Type:r.biff>=8?e.read_shift(2):0};return n.Type?Zae(e,t-2,n):Jae(e,r.biff>=8?t:t-2,r,n),n}var tse=function(){function e(a,s){switch(s.type){case"base64":return t(ln(a),s);case"binary":return t(a,s);case"buffer":return t(Be&&Buffer.isBuffer(a)?a.toString("binary"):po(a),s);case"array":return t(to(a),s)}throw new Error("Unrecognized type "+s.type)}function t(a,s){var i=s||{},o=i.dense?[]:{},l=a.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var c={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(f,d){Array.isArray(o)&&(o[d]=[]);for(var h=/\\\w+\b/g,p=0,v,m=-1;v=h.exec(f);){switch(v[0]){case"\\cell":var _=f.slice(p,h.lastIndex-v[0].length);if(_[0]==" "&&(_=_.slice(1)),++m,_.length){var g={v:_,t:"s"};Array.isArray(o)?o[d][m]=g:o[Oe({r:d,c:m})]=g}break}p=h.lastIndex}m>c.e.c&&(c.e.c=m)}),o["!ref"]=We(c),o}function r(a,s){return mi(e(a,s),s)}function n(a){for(var s=["{\\rtf1\\ansi"],i=Nt(a["!ref"]),o,l=Array.isArray(a),c=i.s.r;c<=i.e.r;++c){s.push("\\trowd\\trautofit1");for(var f=i.s.c;f<=i.e.c;++f)s.push("\\cellx"+(f+1));for(s.push("\\pard\\intbl"),f=i.s.c;f<=i.e.c;++f){var d=Oe({r:c,c:f});o=l?(a[c]||[])[f]:a[d],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(ps(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:r,to_sheet:e,from_sheet:n}}();function rse(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function qu(e){for(var t=0,r=1;t!=3;++t)r=r*256+(e[t]>255?255:e[t]<0?0:e[t]);return r.toString(16).toUpperCase().slice(1)}function nse(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,a=Math.max(t,r,n),s=Math.min(t,r,n),i=a-s;if(i===0)return[0,0,t];var o=0,l=0,c=a+s;switch(l=i/(c>1?2-c:c),a){case t:o=((r-n)/i+6)%6;break;case r:o=(n-t)/i+2;break;case n:o=(t-r)/i+4;break}return[o/6,l,c/2]}function ase(e){var t=e[0],r=e[1],n=e[2],a=r*2*(n<.5?n:1-n),s=n-a/2,i=[s,s,s],o=6*t,l;if(r!==0)switch(o|0){case 0:case 6:l=a*o,i[0]+=a,i[1]+=l;break;case 1:l=a*(2-o),i[0]+=l,i[1]+=a;break;case 2:l=a*(o-2),i[1]+=a,i[2]+=l;break;case 3:l=a*(4-o),i[1]+=l,i[2]+=a;break;case 4:l=a*(o-4),i[2]+=a,i[0]+=l;break;case 5:l=a*(6-o),i[2]+=l,i[0]+=a;break}for(var c=0;c!=3;++c)i[c]=Math.round(i[c]*255);return i}function G0(e,t){if(t===0)return e;var r=nse(rse(e));return t<0?r[2]=r[2]*(1+t):r[2]=1-(1-r[2])*(1-t),qu(ase(r))}var gA=6,sse=15,ise=1,Or=gA;function K0(e){return Math.floor((e+Math.round(128/Or)/256)*Or)}function q0(e){return Math.floor((e-5)/Or*100+.5)/100}function gg(e){return Math.round((e*Or+5)/Or*256)/256}function Nm(e){return gg(q0(K0(e)))}function py(e){var t=Math.abs(e-Nm(e)),r=Or;if(t>.005)for(Or=ise;Or<sse;++Or)Math.abs(e-Nm(e))<=t&&(t=Math.abs(e-Nm(e)),r=Or);Or=r}function Nl(e){e.width?(e.wpx=K0(e.width),e.wch=q0(e.wpx),e.MDW=Or):e.wpx?(e.wch=q0(e.wpx),e.width=gg(e.wch),e.MDW=Or):typeof e.wch=="number"&&(e.width=gg(e.wch),e.wpx=K0(e.width),e.MDW=Or),e.customWidth&&delete e.customWidth}var ose=96,xA=ose;function yA(e){return e*96/xA}function Xu(e){return e*xA/96}var lse={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function cse(e,t,r,n){t.Borders=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Ce(i);switch(Ma(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":a={},o.diagonalUp&&(a.diagonalUp=mt(o.diagonalUp)),o.diagonalDown&&(a.diagonalDown=mt(o.diagonalDown)),t.Borders.push(a);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function use(e,t,r,n){t.Fills=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Ce(i);switch(Ma(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":a={},t.Fills.push(a);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(a),a={};break;case"<patternFill":case"<patternFill>":o.patternType&&(a.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":a.bgColor||(a.bgColor={}),o.indexed&&(a.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(a.bgColor.theme=parseInt(o.theme,10)),o.tint&&(a.bgColor.tint=parseFloat(o.tint)),o.rgb&&(a.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":a.fgColor||(a.fgColor={}),o.theme&&(a.fgColor.theme=parseInt(o.theme,10)),o.tint&&(a.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(a.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function fse(e,t,r,n){t.Fonts=[];var a={},s=!1;(e[0].match(Tr)||[]).forEach(function(i){var o=Ce(i);switch(Ma(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(a),a={};break;case"<name":o.val&&(a.name=st(o.val));break;case"<name/>":case"</name>":break;case"<b":a.bold=o.val?mt(o.val):1;break;case"<b/>":a.bold=1;break;case"<i":a.italic=o.val?mt(o.val):1;break;case"<i/>":a.italic=1;break;case"<u":switch(o.val){case"none":a.underline=0;break;case"single":a.underline=1;break;case"double":a.underline=2;break;case"singleAccounting":a.underline=33;break;case"doubleAccounting":a.underline=34;break}break;case"<u/>":a.underline=1;break;case"<strike":a.strike=o.val?mt(o.val):1;break;case"<strike/>":a.strike=1;break;case"<outline":a.outline=o.val?mt(o.val):1;break;case"<outline/>":a.outline=1;break;case"<shadow":a.shadow=o.val?mt(o.val):1;break;case"<shadow/>":a.shadow=1;break;case"<condense":a.condense=o.val?mt(o.val):1;break;case"<condense/>":a.condense=1;break;case"<extend":a.extend=o.val?mt(o.val):1;break;case"<extend/>":a.extend=1;break;case"<sz":o.val&&(a.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(a.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(a.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(a.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=X1[parseInt(o.val,10)];break;case"<color":if(a.color||(a.color={}),o.auto&&(a.color.auto=mt(o.auto)),o.rgb)a.color.rgb=o.rgb.slice(-6);else if(o.indexed){a.color.index=parseInt(o.indexed,10);var l=$i[a.color.index];a.color.index==81&&(l=$i[1]),l||(l=$i[1]),a.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(a.color.theme=parseInt(o.theme,10),o.tint&&(a.color.tint=parseFloat(o.tint)),o.theme&&r.themeElements&&r.themeElements.clrScheme&&(a.color.rgb=G0(r.themeElements.clrScheme[a.color.theme].rgb,a.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(n&&n.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function dse(e,t,r){t.NumberFmt=[];for(var n=Da(je),a=0;a<n.length;++a)t.NumberFmt[n[a]]=je[n[a]];var s=e[0].match(Tr);if(s)for(a=0;a<s.length;++a){var i=Ce(s[a]);switch(Ma(i[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=ze(st(i.formatCode)),l=parseInt(i.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Li(o,l)}}break;case"</numFmt>":break;default:if(r.WTF)throw new Error("unrecognized "+i[0]+" in numFmts")}}}var _d=["numFmtId","fillId","fontId","borderId","xfId"],wd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hse(e,t,r){t.CellXf=[];var n,a=!1;(e[0].match(Tr)||[]).forEach(function(s){var i=Ce(s),o=0;switch(Ma(i[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(n=i,delete n[0],o=0;o<_d.length;++o)n[_d[o]]&&(n[_d[o]]=parseInt(n[_d[o]],10));for(o=0;o<wd.length;++o)n[wd[o]]&&(n[wd[o]]=mt(n[wd[o]]));if(t.NumberFmt&&n.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[n.numFmtId]==t.NumberFmt[o]){n.numFmtId=o;break}}t.CellXf.push(n);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};i.vertical&&(l.vertical=i.vertical),i.horizontal&&(l.horizontal=i.horizontal),i.textRotation!=null&&(l.textRotation=i.textRotation),i.indent&&(l.indent=i.indent),i.wrapText&&(l.wrapText=mt(i.wrapText)),n.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":a=!0;break;case"</AlternateContent>":a=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;default:if(r&&r.WTF&&!a)throw new Error("unrecognized "+i[0]+" in cellXfs")}})}var pse=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,r=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,n=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,a=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,c){var f={};if(!o)return f;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var d;return(d=o.match(t))&&dse(d,f,c),(d=o.match(a))&&fse(d,f,l,c),(d=o.match(n))&&use(d,f,l,c),(d=o.match(s))&&cse(d,f,l,c),(d=o.match(r))&&hse(d,f,c),f}}();function mse(e,t){var r=e.read_shift(2),n=_r(e);return[r,n]}function vse(e,t,r){var n={};n.sz=e.read_shift(2)/20;var a=Tre(e);a.fItalic&&(n.italic=1),a.fCondense&&(n.condense=1),a.fExtend&&(n.extend=1),a.fShadow&&(n.shadow=1),a.fOutline&&(n.outline=1),a.fStrikeout&&(n.strike=1);var s=e.read_shift(2);switch(s===700&&(n.bold=1),e.read_shift(2)){case 1:n.vertAlign="superscript";break;case 2:n.vertAlign="subscript";break}var i=e.read_shift(1);i!=0&&(n.underline=i);var o=e.read_shift(1);o>0&&(n.family=o);var l=e.read_shift(1);switch(l>0&&(n.charset=l),e.l++,n.color=kre(e),e.read_shift(1)){case 1:n.scheme="major";break;case 2:n.scheme="minor";break}return n.name=_r(e),n}var gse=br;function xse(e,t){var r=e.l+t,n=e.read_shift(2),a=e.read_shift(2);return e.l=r,{ixfe:n,numFmtId:a}}var yse=br;function _se(e,t,r){var n={};n.NumberFmt=[];for(var a in je)n.NumberFmt[a]=je[a];n.CellXf=[],n.Fonts=[];var s=[],i=!1;return _s(e,function(l,c,f){switch(f){case 44:n.NumberFmt[l[0]]=l[1],Li(l[1],l[0]);break;case 43:n.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=G0(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&n.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:s.push(f),i=!0;break;case 38:s.pop(),i=!1;break;default:if(c.T>0)s.push(f);else if(c.T<0)s.pop();else if(!i||r.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+f.toString(16))}}),n}var wse=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function bse(e,t,r){t.themeElements.clrScheme=[];var n={};(e[0].match(Tr)||[]).forEach(function(a){var s=Ce(a);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":n.rgb=s.val;break;case"<a:sysClr":n.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[wse.indexOf(s[0])]=n,n={}):n.name=s[0].slice(3,s[0].length-1);break;default:if(r&&r.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function Ese(){}function Sse(){}var kse=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,Tse=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,Cse=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function Nse(e,t,r){t.themeElements={};var n;[["clrScheme",kse,bse],["fontScheme",Tse,Ese],["fmtScheme",Cse,Sse]].forEach(function(a){if(!(n=e.match(a[1])))throw new Error(a[0]+" not found in themeElements");a[2](n,t,r)})}var Ase=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function _A(e,t){(!e||e.length===0)&&(e=Ose());var r,n={};if(!(r=e.match(Ase)))throw new Error("themeElements not found in theme");return Nse(r[0],n,t),n.raw=e,n}function Ose(e,t){var r=[D4];return r[r.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',r[r.length]="<a:themeElements>",r[r.length]='<a:clrScheme name="Office">',r[r.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',r[r.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',r[r.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',r[r.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',r[r.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',r[r.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',r[r.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',r[r.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',r[r.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',r[r.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',r[r.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',r[r.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',r[r.length]="</a:clrScheme>",r[r.length]='<a:fontScheme name="Office">',r[r.length]="<a:majorFont>",r[r.length]='<a:latin typeface="Cambria"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Times New Roman"/>',r[r.length]='<a:font script="Hebr" typeface="Times New Roman"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="MoolBoran"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Times New Roman"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:majorFont>",r[r.length]="<a:minorFont>",r[r.length]='<a:latin typeface="Calibri"/>',r[r.length]='<a:ea typeface=""/>',r[r.length]='<a:cs typeface=""/>',r[r.length]='<a:font script="Jpan" typeface="ＭＳ Ｐゴシック"/>',r[r.length]='<a:font script="Hang" typeface="맑은 고딕"/>',r[r.length]='<a:font script="Hans" typeface="宋体"/>',r[r.length]='<a:font script="Hant" typeface="新細明體"/>',r[r.length]='<a:font script="Arab" typeface="Arial"/>',r[r.length]='<a:font script="Hebr" typeface="Arial"/>',r[r.length]='<a:font script="Thai" typeface="Tahoma"/>',r[r.length]='<a:font script="Ethi" typeface="Nyala"/>',r[r.length]='<a:font script="Beng" typeface="Vrinda"/>',r[r.length]='<a:font script="Gujr" typeface="Shruti"/>',r[r.length]='<a:font script="Khmr" typeface="DaunPenh"/>',r[r.length]='<a:font script="Knda" typeface="Tunga"/>',r[r.length]='<a:font script="Guru" typeface="Raavi"/>',r[r.length]='<a:font script="Cans" typeface="Euphemia"/>',r[r.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',r[r.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',r[r.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',r[r.length]='<a:font script="Thaa" typeface="MV Boli"/>',r[r.length]='<a:font script="Deva" typeface="Mangal"/>',r[r.length]='<a:font script="Telu" typeface="Gautami"/>',r[r.length]='<a:font script="Taml" typeface="Latha"/>',r[r.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',r[r.length]='<a:font script="Orya" typeface="Kalinga"/>',r[r.length]='<a:font script="Mlym" typeface="Kartika"/>',r[r.length]='<a:font script="Laoo" typeface="DokChampa"/>',r[r.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',r[r.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',r[r.length]='<a:font script="Viet" typeface="Arial"/>',r[r.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',r[r.length]='<a:font script="Geor" typeface="Sylfaen"/>',r[r.length]="</a:minorFont>",r[r.length]="</a:fontScheme>",r[r.length]='<a:fmtScheme name="Office">',r[r.length]="<a:fillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="1"/>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:lin ang="16200000" scaled="0"/>',r[r.length]="</a:gradFill>",r[r.length]="</a:fillStyleLst>",r[r.length]="<a:lnStyleLst>",r[r.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',r[r.length]="</a:lnStyleLst>",r[r.length]="<a:effectStyleLst>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]="</a:effectStyle>",r[r.length]="<a:effectStyle>",r[r.length]="<a:effectLst>",r[r.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',r[r.length]="</a:effectLst>",r[r.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',r[r.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',r[r.length]="</a:effectStyle>",r[r.length]="</a:effectStyleLst>",r[r.length]="<a:bgFillStyleLst>",r[r.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]='<a:gradFill rotWithShape="1">',r[r.length]="<a:gsLst>",r[r.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',r[r.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',r[r.length]="</a:gsLst>",r[r.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',r[r.length]="</a:gradFill>",r[r.length]="</a:bgFillStyleLst>",r[r.length]="</a:fmtScheme>",r[r.length]="</a:themeElements>",r[r.length]="<a:objectDefaults>",r[r.length]="<a:spDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',r[r.length]="</a:spDef>",r[r.length]="<a:lnDef>",r[r.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',r[r.length]="</a:lnDef>",r[r.length]="</a:objectDefaults>",r[r.length]="<a:extraClrSchemeLst/>",r[r.length]="</a:theme>",r.join("")}function Dse(e,t,r){var n=e.l+t,a=e.read_shift(4);if(a!==124226){if(!r.cellStyles){e.l=n;return}var s=e.slice(e.l);e.l=n;var i;try{i=O4(s,{type:"array"})}catch{return}var o=en(i,"theme/theme/theme1.xml",!0);if(o)return _A(o,r)}}function jse(e){return e.read_shift(4)}function Pse(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=Fse(e,4);break;case 2:t.xclrValue=iA(e);break;case 3:t.xclrValue=jse(e);break;case 4:e.l+=4;break}return e.l+=8,t}function Fse(e,t){return br(e,t)}function Rse(e,t){return br(e,t)}function Mse(e){var t=e.read_shift(2),r=e.read_shift(2)-4,n=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:n[1]=Pse(e);break;case 6:n[1]=Rse(e,r);break;case 14:case 15:n[1]=e.read_shift(r===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+r)}return n}function Ise(e,t){var r=e.l+t;e.l+=2;var n=e.read_shift(2);e.l+=2;for(var a=e.read_shift(2),s=[];a-- >0;)s.push(Mse(e,r-e.l));return{ixfe:n,ext:s}}function Lse(e,t){t.forEach(function(r){switch(r[0]){}})}function $se(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:_r(e)}}function Bse(e){for(var t=[],r=e.read_shift(4);r-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function Use(e){return e.l+=4,e.read_shift(4)!=0}function Wse(e,t,r){var n={Types:[],Cell:[],Value:[]},a=r||{},s=[],i=!1,o=2;return _s(e,function(l,c,f){switch(f){case 335:n.Types.push({name:l.name});break;case 51:l.forEach(function(d){o==1?n.Cell.push({type:n.Types[d[0]-1].name,index:d[1]}):o==0&&n.Value.push({type:n.Types[d[0]-1].name,index:d[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(f),i=!0;break;case 36:s.pop(),i=!1;break;default:if(!c.T){if(!i||a.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}}),n}function Vse(e,t,r){var n={Types:[],Cell:[],Value:[]};if(!e)return n;var a=!1,s=2,i;return e.replace(Tr,function(o){var l=Ce(o);switch(Ma(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":n.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var c=0;c<n.Types.length;++c)n.Types[c].name==l.name&&(i=n.Types[c]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?n.Cell.push({type:n.Types[l.t-1].name,index:+l.v}):s==0&&n.Value.push({type:n.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":a=!0;break;case"</ext>":a=!1;break;case"<rvb":if(!i)break;i.offsets||(i.offsets=[]),i.offsets.push(+l.i);break;default:if(!a&&r.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),n}function Hse(e){var t=[];if(!e)return t;var r=1;return(e.match(Tr)||[]).forEach(function(n){var a=Ce(n);switch(a[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete a[0],a.i?r=a.i:a.i=r,t.push(a);break}}),t}function zse(e){var t={};t.i=e.read_shift(4);var r={};r.r=e.read_shift(4),r.c=e.read_shift(4),t.r=Oe(r);var n=e.read_shift(1);return n&2&&(t.l="1"),n&8&&(t.a="1"),t}function Yse(e,t,r){var n=[];return _s(e,function(s,i,o){switch(o){case 63:n.push(s);break;default:if(!i.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function Gse(e,t,r,n){if(!e)return e;var a=n||{},s=!1;_s(e,function(o,l,c){switch(c){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||a.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}},a)}function Kse(e,t){if(!e)return"??";var r=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][r].Target}function Kb(e,t,r,n){var a=Array.isArray(e),s;t.forEach(function(i){var o=Dr(i.ref);if(a?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[i.ref],!s){s={t:"z"},a?e[o.r][o.c]=s:e[i.ref]=s;var l=Nt(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var c=We(l);c!==e["!ref"]&&(e["!ref"]=c)}s.c||(s.c=[]);var f={a:i.author,t:i.t,r:i.r,T:r};i.h&&(f.h=i.h);for(var d=s.c.length-1;d>=0;--d){if(!r&&s.c[d].T)return;r&&!s.c[d].T&&s.c.splice(d,1)}if(r&&n){for(d=0;d<n.length;++d)if(f.a==n[d].id){f.a=n[d].name||f.a;break}}s.c.push(f)})}function qse(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var r=[],n=[],a=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);a&&a[1]&&a[1].split(/<\/\w*:?author>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&r.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(i){if(!(i===""||i.trim()==="")){var o=i.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=Ce(o[0]),c={author:l.authorId&&r[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},f=Dr(l.ref);if(!(t.sheetRows&&t.sheetRows<=f.r)){var d=i.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),h=!!d&&!!d[1]&&hy(d[1])||{r:"",t:"",h:""};c.r=h.r,h.r=="<t></t>"&&(h.t=h.h=""),c.t=(h.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(c.h=h.h),n.push(c)}}}}),n}function Xse(e,t){var r=[],n=!1,a={},s=0;return e.replace(Tr,function(o,l){var c=Ce(o);switch(Ma(c[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":a={author:c.personId,guid:c.id,ref:c.ref,T:1};break;case"</threadedComment>":a.t!=null&&r.push(a);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":a.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":n=!0;break;case"</mentions>":n=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+c[0]+" in threaded comments")}return o}),r}function Qse(e,t){var r=[],n=!1;return e.replace(Tr,function(s){var i=Ce(s);switch(Ma(i[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":r.push({name:i.displayname,id:i.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;default:if(!n&&t.WTF)throw new Error("unrecognized "+i[0]+" in threaded comments")}return s}),r}function Jse(e){var t={};t.iauthor=e.read_shift(4);var r=vo(e);return t.rfx=r.s,t.ref=Oe(r.s),e.l+=16,t}var Zse=_r;function eie(e,t){var r=[],n=[],a={},s=!1;return _s(e,function(o,l,c){switch(c){case 632:n.push(o);break;case 635:a=o;break;case 637:a.t=o.t,a.h=o.h,a.r=o.r;break;case 636:if(a.author=n[a.iauthor],delete a.iauthor,t.sheetRows&&a.rfx&&t.sheetRows<=a.rfx.r)break;a.t||(a.t=""),delete a.rfx,r.push(a);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}var tie="application/vnd.ms-office.vbaProject";function rie(e){var t=Ue.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(r,n){if(!(r.slice(-1)==="/"||!r.match(/_VBA_PROJECT_CUR/))){var a=r.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ue.utils.cfb_add(t,a,e.FileIndex[n].content)}}),Ue.write(t)}function nie(){return{"!type":"dialog"}}function aie(){return{"!type":"dialog"}}function sie(){return{"!type":"macro"}}function iie(){return{"!type":"macro"}}var cl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function r(n,a,s,i){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),i.length==0?o=!0:i.charAt(0)=="["&&(o=!0,i=i.slice(1,-1));var c=s.length>0?parseInt(s,10)|0:0,f=i.length>0?parseInt(i,10)|0:0;return o?f+=t.c:--f,l?c+=t.r:--c,a+(o?"":"$")+zt(f)+(l?"":"$")+or(c)}return function(a,s){return t=s,a.replace(e,r)}}(),wA=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,oie=function(){return function(t,r){return t.replace(wA,function(n,a,s,i,o,l){var c=oy(i)-(s?0:r.c),f=iy(l)-(o?0:r.r),d=f==0?"":o?f+1:"["+f+"]",h=c==0?"":s?c+1:"["+c+"]";return a+"R"+d+"C"+h})}}();function bA(e,t){return e.replace(wA,function(r,n,a,s,i,o){return n+(a=="$"?a+s:zt(oy(s)+t.c))+(i=="$"?i+o:or(iy(o)+t.r))})}function lie(e,t,r){var n=tc(t),a=n.s,s=Dr(r),i={r:s.r-a.r,c:s.c-a.c};return bA(e,i)}function cie(e){return e.length!=1}function qb(e){return e.replace(/_xlfn\./g,"")}function Rt(e){e.l+=1}function si(e,t){var r=e.read_shift(2);return[r&16383,r>>14&1,r>>15&1]}function EA(e,t,r){var n=2;if(r){if(r.biff>=2&&r.biff<=5)return SA(e);r.biff==12&&(n=4)}var a=e.read_shift(n),s=e.read_shift(n),i=si(e),o=si(e);return{s:{r:a,c:i[0],cRel:i[1],rRel:i[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function SA(e){var t=si(e),r=si(e),n=e.read_shift(1),a=e.read_shift(1);return{s:{r:t[0],c:n,cRel:t[1],rRel:t[2]},e:{r:r[0],c:a,cRel:r[1],rRel:r[2]}}}function uie(e,t,r){if(r.biff<8)return SA(e);var n=e.read_shift(r.biff==12?4:2),a=e.read_shift(r.biff==12?4:2),s=si(e),i=si(e);return{s:{r:n,c:s[0],cRel:s[1],rRel:s[2]},e:{r:a,c:i[0],cRel:i[1],rRel:i[2]}}}function kA(e,t,r){if(r&&r.biff>=2&&r.biff<=5)return fie(e);var n=e.read_shift(r&&r.biff==12?4:2),a=si(e);return{r:n,c:a[0],cRel:a[1],rRel:a[2]}}function fie(e){var t=si(e),r=e.read_shift(1);return{r:t[0],c:r,cRel:t[1],rRel:t[2]}}function die(e){var t=e.read_shift(2),r=e.read_shift(2);return{r:t,c:r&255,fQuoted:!!(r&16384),cRel:r>>15,rRel:r>>15}}function hie(e,t,r){var n=r&&r.biff?r.biff:8;if(n>=2&&n<=5)return pie(e);var a=e.read_shift(n>=12?4:2),s=e.read_shift(2),i=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;a>524287;)a-=1048576;if(i==1)for(;s>8191;)s=s-16384;return{r:a,c:s,cRel:i,rRel:o}}function pie(e){var t=e.read_shift(2),r=e.read_shift(1),n=(t&32768)>>15,a=(t&16384)>>14;return t&=16383,n==1&&t>=8192&&(t=t-16384),a==1&&r>=128&&(r=r-256),{r:t,c:r,cRel:a,rRel:n}}function mie(e,t,r){var n=(e[e.l++]&96)>>5,a=EA(e,r.biff>=2&&r.biff<=5?6:8,r);return[n,a]}function vie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2,"i"),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var i=EA(e,s,r);return[n,a,i]}function gie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r&&r.biff>8?12:r.biff<8?6:8,[n]}function xie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=8;if(r)switch(r.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[n,a]}function yie(e,t,r){var n=(e[e.l++]&96)>>5,a=uie(e,t-1,r);return[n,a]}function _ie(e,t,r){var n=(e[e.l++]&96)>>5;return e.l+=r.biff==2?6:r.biff==12?14:7,[n]}function Xb(e){var t=e[e.l+1]&1,r=1;return e.l+=4,[t,r]}function wie(e,t,r){e.l+=2;for(var n=e.read_shift(r&&r.biff==2?1:2),a=[],s=0;s<=n;++s)a.push(e.read_shift(r&&r.biff==2?1:2));return a}function bie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Eie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=2,[n,e.read_shift(r&&r.biff==2?1:2)]}function Sie(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function kie(e,t,r){var n=e[e.l+1]&255?1:0;return e.l+=r&&r.biff==2?3:4,[n]}function TA(e){var t=e.read_shift(1),r=e.read_shift(1);return[t,r]}function Tie(e){return e.read_shift(2),TA(e)}function Cie(e){return e.read_shift(2),TA(e)}function Nie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=kA(e,0,r);return[n,a]}function Aie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=hie(e,0,r);return[n,a]}function Oie(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(2);r&&r.biff==5&&(e.l+=12);var s=kA(e,0,r);return[n,a,s]}function Die(e,t,r){var n=(e[e.l]&96)>>5;e.l+=1;var a=e.read_shift(r&&r.biff<=3?1:2);return[joe[a],AA[a],n]}function jie(e,t,r){var n=e[e.l++],a=e.read_shift(1),s=r&&r.biff<=3?[n==88?-1:0,e.read_shift(1)]:Pie(e);return[a,(s[0]===0?AA:Doe)[s[1]]]}function Pie(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function Fie(e,t,r){e.l+=r&&r.biff==2?3:4}function Rie(e,t,r){if(e.l++,r&&r.biff==12)return[e.read_shift(4,"i"),0];var n=e.read_shift(2),a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Mie(e){return e.l++,go[e.read_shift(1)]}function Iie(e){return e.l++,e.read_shift(2)}function Lie(e){return e.l++,e.read_shift(1)!==0}function $ie(e){return e.l++,gr(e)}function Bie(e,t,r){return e.l++,Nf(e,t-1,r)}function Uie(e,t){var r=[e.read_shift(1)];if(t==12)switch(r[0]){case 2:r[0]=4;break;case 4:r[0]=16;break;case 0:r[0]=1;break;case 1:r[0]=2;break}switch(r[0]){case 4:r[1]=Ot(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:r[1]=go[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:r[1]=gr(e);break;case 2:r[1]=xo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+r[0])}return r}function Wie(e,t,r){for(var n=e.read_shift(r.biff==12?4:2),a=[],s=0;s!=n;++s)a.push((r.biff==12?vo:dp)(e));return a}function Vie(e,t,r){var n=0,a=0;r.biff==12?(n=e.read_shift(4),a=e.read_shift(4)):(a=1+e.read_shift(1),n=1+e.read_shift(2)),r.biff>=2&&r.biff<8&&(--n,--a==0&&(a=256));for(var s=0,i=[];s!=n&&(i[s]=[]);++s)for(var o=0;o!=a;++o)i[s][o]=Uie(e,r.biff);return i}function Hie(e,t,r){var n=e.read_shift(1)>>>5&3,a=!r||r.biff>=8?4:2,s=e.read_shift(a);switch(r.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[n,0,s]}function zie(e,t,r){if(r.biff==5)return Yie(e);var n=e.read_shift(1)>>>5&3,a=e.read_shift(2),s=e.read_shift(4);return[n,a,s]}function Yie(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2,"i");e.l+=8;var n=e.read_shift(2);return e.l+=12,[t,r,n]}function Gie(e,t,r){var n=e.read_shift(1)>>>5&3;e.l+=r&&r.biff==2?3:4;var a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function Kie(e,t,r){var n=e.read_shift(1)>>>5&3,a=e.read_shift(r&&r.biff==2?1:2);return[n,a]}function qie(e,t,r){var n=e.read_shift(1)>>>5&3;return e.l+=4,r.biff<8&&e.l--,r.biff==12&&(e.l+=2),[n]}function Xie(e,t,r){var n=(e[e.l++]&96)>>5,a=e.read_shift(2),s=4;if(r)switch(r.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[n,a]}var Qie=br,Jie=br,Zie=br;function Of(e,t,r){return e.l+=2,[die(e)]}function my(e){return e.l+=6,[]}var eoe=Of,toe=my,roe=my,noe=Of;function CA(e){return e.l+=2,[It(e),e.read_shift(2)&1]}var aoe=Of,soe=CA,ioe=my,ooe=Of,loe=Of,coe=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function uoe(e){e.l+=2;var t=e.read_shift(2),r=e.read_shift(2),n=e.read_shift(4),a=e.read_shift(2),s=e.read_shift(2),i=coe[r>>2&31];return{ixti:t,coltype:r&3,rt:i,idx:n,c:a,C:s}}function foe(e){return e.l+=2,[e.read_shift(4)]}function doe(e,t,r){return e.l+=5,e.l+=2,e.l+=r.biff==2?1:4,["PTGSHEET"]}function hoe(e,t,r){return e.l+=r.biff==2?4:5,["PTGENDSHEET"]}function poe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function moe(e){var t=e.read_shift(1)>>>5&3,r=e.read_shift(2);return[t,r]}function voe(e){return e.l+=4,[0,0]}var Qb={1:{n:"PtgExp",f:Rie},2:{n:"PtgTbl",f:Zie},3:{n:"PtgAdd",f:Rt},4:{n:"PtgSub",f:Rt},5:{n:"PtgMul",f:Rt},6:{n:"PtgDiv",f:Rt},7:{n:"PtgPower",f:Rt},8:{n:"PtgConcat",f:Rt},9:{n:"PtgLt",f:Rt},10:{n:"PtgLe",f:Rt},11:{n:"PtgEq",f:Rt},12:{n:"PtgGe",f:Rt},13:{n:"PtgGt",f:Rt},14:{n:"PtgNe",f:Rt},15:{n:"PtgIsect",f:Rt},16:{n:"PtgUnion",f:Rt},17:{n:"PtgRange",f:Rt},18:{n:"PtgUplus",f:Rt},19:{n:"PtgUminus",f:Rt},20:{n:"PtgPercent",f:Rt},21:{n:"PtgParen",f:Rt},22:{n:"PtgMissArg",f:Rt},23:{n:"PtgStr",f:Bie},26:{n:"PtgSheet",f:doe},27:{n:"PtgEndSheet",f:hoe},28:{n:"PtgErr",f:Mie},29:{n:"PtgBool",f:Lie},30:{n:"PtgInt",f:Iie},31:{n:"PtgNum",f:$ie},32:{n:"PtgArray",f:_ie},33:{n:"PtgFunc",f:Die},34:{n:"PtgFuncVar",f:jie},35:{n:"PtgName",f:Hie},36:{n:"PtgRef",f:Nie},37:{n:"PtgArea",f:mie},38:{n:"PtgMemArea",f:Gie},39:{n:"PtgMemErr",f:Qie},40:{n:"PtgMemNoMem",f:Jie},41:{n:"PtgMemFunc",f:Kie},42:{n:"PtgRefErr",f:qie},43:{n:"PtgAreaErr",f:gie},44:{n:"PtgRefN",f:Aie},45:{n:"PtgAreaN",f:yie},46:{n:"PtgMemAreaN",f:poe},47:{n:"PtgMemNoMemN",f:moe},57:{n:"PtgNameX",f:zie},58:{n:"PtgRef3d",f:Oie},59:{n:"PtgArea3d",f:vie},60:{n:"PtgRefErr3d",f:Xie},61:{n:"PtgAreaErr3d",f:xie},255:{}},goe={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},xoe={1:{n:"PtgElfLel",f:CA},2:{n:"PtgElfRw",f:ooe},3:{n:"PtgElfCol",f:eoe},6:{n:"PtgElfRwV",f:loe},7:{n:"PtgElfColV",f:noe},10:{n:"PtgElfRadical",f:aoe},11:{n:"PtgElfRadicalS",f:ioe},13:{n:"PtgElfColS",f:toe},15:{n:"PtgElfColSV",f:roe},16:{n:"PtgElfRadicalLel",f:soe},25:{n:"PtgList",f:uoe},29:{n:"PtgSxName",f:foe},255:{}},yoe={0:{n:"PtgAttrNoop",f:voe},1:{n:"PtgAttrSemi",f:kie},2:{n:"PtgAttrIf",f:Eie},4:{n:"PtgAttrChoose",f:wie},8:{n:"PtgAttrGoto",f:bie},16:{n:"PtgAttrSum",f:Fie},32:{n:"PtgAttrBaxcel",f:Xb},33:{n:"PtgAttrBaxcel",f:Xb},64:{n:"PtgAttrSpace",f:Tie},65:{n:"PtgAttrSpaceSemi",f:Cie},128:{n:"PtgAttrIfError",f:Sie},255:{}};function Df(e,t,r,n){if(n.biff<8)return br(e,t);for(var a=e.l+t,s=[],i=0;i!==r.length;++i)switch(r[i][0]){case"PtgArray":r[i][1]=Vie(e,0,n),s.push(r[i][1]);break;case"PtgMemArea":r[i][2]=Wie(e,r[i][1],n),s.push(r[i][2]);break;case"PtgExp":n&&n.biff==12&&(r[i][1][1]=e.read_shift(4),s.push(r[i][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+r[i][0]}return t=a-e.l,t!==0&&s.push(br(e,t)),s}function jf(e,t,r){for(var n=e.l+t,a,s,i=[];n!=e.l;)t=n-e.l,s=e[e.l],a=Qb[s]||Qb[goe[s]],(s===24||s===25)&&(a=(s===24?xoe:yoe)[e[e.l+1]]),!a||!a.f?br(e,t):i.push([a.n,a.f(e,t,r)]);return i}function _oe(e){for(var t=[],r=0;r<e.length;++r){for(var n=e[r],a=[],s=0;s<n.length;++s){var i=n[s];if(i)switch(i[0]){case 2:a.push('"'+i[1].replace(/"/g,'""')+'"');break;default:a.push(i[1])}else a.push("")}t.push(a.join(","))}return t.join(";")}var woe={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function boe(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function NA(e,t,r){if(!e)return"SH33TJSERR0";if(r.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var n=e.XTI[t];if(r.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!n)return"SH33TJSERR1";var a="";if(r.biff>8)switch(e[n[0]][0]){case 357:return a=n[1]==-1?"#REF":e.SheetNames[n[1]],n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 358:return r.SID!=null?e.SheetNames[r.SID]:"SH33TJSSAME"+e[n[0]][0];case 355:default:return"SH33TJSSRC"+e[n[0]][0]}switch(e[n[0]][0][0]){case 1025:return a=n[1]==-1?"#REF":e.SheetNames[n[1]]||"SH33TJSERR3",n[1]==n[2]?a:a+":"+e.SheetNames[n[2]];case 14849:return e[n[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[n[0]][0][3]?(a=n[1]==-1?"#REF":e[n[0]][0][3][n[1]]||"SH33TJSERR4",n[1]==n[2]?a:a+":"+e[n[0]][0][3][n[2]]):"SH33TJSERR2"}}function Jb(e,t,r){var n=NA(e,t,r);return n=="#REF"?n:boe(n,r)}function mr(e,t,r,n,a){var s=a&&a.biff||8,i={s:{c:0,r:0}},o=[],l,c,f,d=0,h=0,p,v="";if(!e[0]||!e[0][0])return"";for(var m=-1,_="",g=0,y=e[0].length;g<y;++g){var x=e[0][g];switch(x[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),c=o.pop(),m>=0){switch(e[0][m][1][0]){case 0:_=Tt(" ",e[0][m][1][1]);break;case 1:_=Tt("\r",e[0][m][1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}c=c+_,m=-1}o.push(c+woe[x[0]]+l);break;case"PtgIsect":l=o.pop(),c=o.pop(),o.push(c+" "+l);break;case"PtgUnion":l=o.pop(),c=o.pop(),o.push(c+","+l);break;case"PtgRange":l=o.pop(),c=o.pop(),o.push(c+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":f=Qc(x[1][1],i,a),o.push(Jc(f,s));break;case"PtgRefN":f=r?Qc(x[1][1],r,a):x[1][1],o.push(Jc(f,s));break;case"PtgRef3d":d=x[1][1],f=Qc(x[1][2],i,a),v=Jb(n,d,a),o.push(v+"!"+Jc(f,s));break;case"PtgFunc":case"PtgFuncVar":var w=x[1][0],E=x[1][1];w||(w=0),w&=127;var S=w==0?[]:o.slice(-w);o.length-=w,E==="User"&&(E=S.shift()),o.push(E+"("+S.join(",")+")");break;case"PtgBool":o.push(x[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(x[1]);break;case"PtgNum":o.push(String(x[1]));break;case"PtgStr":o.push('"'+x[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(x[1]);break;case"PtgAreaN":p=jb(x[1][1],r?{s:r}:i,a),o.push(Tm(p,a));break;case"PtgArea":p=jb(x[1][1],i,a),o.push(Tm(p,a));break;case"PtgArea3d":d=x[1][1],p=x[1][2],v=Jb(n,d,a),o.push(v+"!"+Tm(p,a));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":h=x[1][2];var b=(n.names||[])[h-1]||(n[0]||[])[h],j=b?b.Name:"SH33TJSNAME"+String(h);j&&j.slice(0,6)=="_xlfn."&&!a.xlfn&&(j=j.slice(6)),o.push(j);break;case"PtgNameX":var k=x[1][1];h=x[1][2];var C;if(a.biff<=5)k<0&&(k=-k),n[k]&&(C=n[k][h]);else{var P="";if(((n[k]||[])[0]||[])[0]==14849||(((n[k]||[])[0]||[])[0]==1025?n[k][h]&&n[k][h].itab>0&&(P=n.SheetNames[n[k][h].itab-1]+"!"):P=n.SheetNames[h-1]+"!"),n[k]&&n[k][h])P+=n[k][h].Name;else if(n[0]&&n[0][h])P+=n[0][h].Name;else{var I=(NA(n,k,a)||"").split(";;");I[h-1]?P=I[h-1]:P+="SH33TJSERRX"}o.push(P);break}C||(C={Name:"SH33TJSERRY"}),o.push(C.Name);break;case"PtgParen":var D="(",K=")";if(m>=0){switch(_="",e[0][m][1][0]){case 2:D=Tt(" ",e[0][m][1][1])+D;break;case 3:D=Tt("\r",e[0][m][1][1])+D;break;case 4:K=Tt(" ",e[0][m][1][1])+K;break;case 5:K=Tt("\r",e[0][m][1][1])+K;break;default:if(a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][m][1][0])}m=-1}o.push(D+o.pop()+K);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":f={c:x[1][1],r:x[1][0]};var Q={c:r.c,r:r.r};if(n.sharedf[Oe(f)]){var z=n.sharedf[Oe(f)];o.push(mr(z,i,Q,n,a))}else{var q=!1;for(l=0;l!=n.arrayf.length;++l)if(c=n.arrayf[l],!(f.c<c[0].s.c||f.c>c[0].e.c)&&!(f.r<c[0].s.r||f.r>c[0].e.r)){o.push(mr(c[1],i,Q,n,a)),q=!0;break}q||o.push(x[1])}break;case"PtgArray":o.push("{"+_oe(x[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":m=g;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+x[1].idx+"[#"+x[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(x));default:throw new Error("Unrecognized Formula Token: "+String(x))}var ee=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(a.biff!=3&&m>=0&&ee.indexOf(e[0][g][0])==-1){x=e[0][m];var H=!0;switch(x[1][0]){case 4:H=!1;case 0:_=Tt(" ",x[1][1]);break;case 5:H=!1;case 1:_=Tt("\r",x[1][1]);break;default:if(_="",a.WTF)throw new Error("Unexpected PtgAttrSpaceType "+x[1][0])}o.push((H?_:"")+o.pop()+(H?"":_)),m=-1}}if(o.length>1&&a.WTF)throw new Error("bad formula stack");return o[0]}function Eoe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=jf(e,i,r);return t!==i+a&&(s=Df(e,t-i-a,o,r)),e.l=n,[o,s]}function Soe(e,t,r){var n=e.l+t,a=r.biff==2?1:2,s,i=e.read_shift(a);if(i==65535)return[[],br(e,t-2)];var o=jf(e,i,r);return t!==i+a&&(s=Df(e,t-i-a,o,r)),e.l=n,[o,s]}function koe(e,t,r,n){var a=e.l+t,s=jf(e,n,r),i;return a!==e.l&&(i=Df(e,a-e.l,s,r)),[s,i]}function Toe(e,t,r){var n=e.l+t,a,s=e.read_shift(2),i=jf(e,s,r);return s==65535?[[],br(e,t-2)]:(t!==s+2&&(a=Df(e,n-s-2,i,r)),[i,a])}function Coe(e){var t;if(Ja(e,e.l+6)!==65535)return[gr(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function Am(e,t,r){var n=e.l+t,a=Ia(e);r.biff==2&&++e.l;var s=Coe(e),i=e.read_shift(1);r.biff!=2&&(e.read_shift(1),r.biff>=5&&e.read_shift(4));var o=Soe(e,n-e.l,r);return{cell:a,val:s[0],formula:o,shared:i>>3&1,tt:s[1]}}function hp(e,t,r){var n=e.read_shift(4),a=jf(e,n,r),s=e.read_shift(4),i=s>0?Df(e,s,a,r):null;return[a,i]}var Noe=hp,pp=hp,Aoe=hp,Ooe=hp,Doe={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},AA={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},joe={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function Zb(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,r){return r.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function Om(e){var t=e.split(":"),r=t[0].split(".")[0];return[r,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}var ru={},ul={};function nu(e,t){if(e){var r=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(r=[1,1,1,1,.5,.5]),e.left==null&&(e.left=r[0]),e.right==null&&(e.right=r[1]),e.top==null&&(e.top=r[2]),e.bottom==null&&(e.bottom=r[3]),e.header==null&&(e.header=r[4]),e.footer==null&&(e.footer=r[5])}}function OA(e,t,r,n,a,s){try{n.cellNF&&(e.z=je[t])}catch(o){if(n.WTF)throw o}if(!(e.t==="z"&&!n.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=er(e.v)),(!n||n.cellText!==!1)&&e.t!=="z")try{if(je[t]==null&&Li(Pte[t]||"General",t),e.t==="e")e.w=e.w||go[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zu(e.v);else if(e.t==="d"){var i=Fr(e.v);(i|0)===i?e.w=i.toString(10):e.w=zu(i)}else{if(e.v===void 0)return"";e.w=eo(e.v,ul)}else e.t==="d"?e.w=jn(t,Fr(e.v),ul):e.w=jn(t,e.v,ul)}catch(o){if(n.WTF)throw o}if(n.cellStyles&&r!=null)try{e.s=s.Fills[r],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=G0(a.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),n.WTF&&(e.s.fgColor.raw_rgb=a.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=G0(a.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),n.WTF&&(e.s.bgColor.raw_rgb=a.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(n.WTF&&s.Fills)throw o}}}function Poe(e,t){var r=Nt(t);r.s.r<=r.e.r&&r.s.c<=r.e.c&&r.s.r>=0&&r.s.c>=0&&(e["!ref"]=We(r))}var Foe=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,Roe=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,Moe=/<(?:\w:)?hyperlink [^>]*>/mg,Ioe=/"(\w*:\w*)"/,Loe=/<(?:\w:)?col\b[^>]*[\/]?>/g,$oe=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,Boe=/<(?:\w:)?pageMargins[^>]*\/>/g,DA=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,Uoe=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,Woe=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function Voe(e,t,r,n,a,s,i){if(!e)return e;n||(n={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},c="",f="",d=e.match(Roe);d?(c=e.slice(0,d.index),f=e.slice(d.index+d[0].length)):c=f=e;var h=c.match(DA);h?vy(h[0],o,a,r):(h=c.match(Uoe))&&Hoe(h[0],h[1]||"",o,a,r);var p=(c.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(p>0){var v=c.slice(p,p+50).match(Ioe);v&&Poe(o,v[1])}var m=c.match(Woe);m&&m[1]&&Xoe(m[1],a);var _=[];if(t.cellStyles){var g=c.match(Loe);g&&Goe(_,g)}d&&Qoe(d[1],o,t,l,s,i);var y=f.match($oe);y&&(o["!autofilter"]=Koe(y[0]));var x=[],w=f.match(Foe);if(w)for(p=0;p!=w.length;++p)x[p]=Nt(w[p].slice(w[p].indexOf('"')+1));var E=f.match(Moe);E&&zoe(o,E,n);var S=f.match(Boe);if(S&&(o["!margins"]=Yoe(Ce(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=We(l)),t.sheetRows>0&&o["!ref"]){var b=Nt(o["!ref"]);t.sheetRows<=+b.e.r&&(b.e.r=t.sheetRows-1,b.e.r>l.e.r&&(b.e.r=l.e.r),b.e.r<b.s.r&&(b.s.r=b.e.r),b.e.c>l.e.c&&(b.e.c=l.e.c),b.e.c<b.s.c&&(b.s.c=b.e.c),o["!fullref"]=o["!ref"],o["!ref"]=We(b))}return _.length>0&&(o["!cols"]=_),x.length>0&&(o["!merges"]=x),o}function vy(e,t,r,n){var a=Ce(e);r.Sheets[n]||(r.Sheets[n]={}),a.codeName&&(r.Sheets[n].CodeName=ze(st(a.codeName)))}function Hoe(e,t,r,n,a){vy(e.slice(0,e.indexOf(">")),r,n,a)}function zoe(e,t,r){for(var n=Array.isArray(e),a=0;a!=t.length;++a){var s=Ce(st(t[a]),!0);if(!s.ref)return;var i=((r||{})["!id"]||[])[s.id];i?(s.Target=i.Target,s.location&&(s.Target+="#"+ze(s.location))):(s.Target="#"+ze(s.location),i={Target:s.Target,TargetMode:"Internal"}),s.Rel=i,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=Nt(s.ref),l=o.s.r;l<=o.e.r;++l)for(var c=o.s.c;c<=o.e.c;++c){var f=Oe({c,r:l});n?(e[l]||(e[l]=[]),e[l][c]||(e[l][c]={t:"z",v:void 0}),e[l][c].l=s):(e[f]||(e[f]={t:"z",v:void 0}),e[f].l=s)}}}function Yoe(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(r){e[r]&&(t[r]=parseFloat(e[r]))}),t}function Goe(e,t){for(var r=!1,n=0;n!=t.length;++n){var a=Ce(t[n],!0);a.hidden&&(a.hidden=mt(a.hidden));var s=parseInt(a.min,10)-1,i=parseInt(a.max,10)-1;for(a.outlineLevel&&(a.level=+a.outlineLevel||0),delete a.min,delete a.max,a.width=+a.width,!r&&a.width&&(r=!0,py(a.width)),Nl(a);s<=i;)e[s++]=ir(a)}}function Koe(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}var qoe=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function Xoe(e,t){t.Views||(t.Views=[{}]),(e.match(qoe)||[]).forEach(function(r,n){var a=Ce(r);t.Views[n]||(t.Views[n]={}),+a.zoomScale&&(t.Views[n].zoom=+a.zoomScale),mt(a.rightToLeft)&&(t.Views[n].RTL=!0)})}var Qoe=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,r=/r=["']([^"']*)["']/,n=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,a=/ref=["']([^"']*)["']/,s=Yu("v"),i=Yu("f");return function(l,c,f,d,h,p){for(var v=0,m="",_=[],g=[],y=0,x=0,w=0,E="",S,b,j=0,k=0,C,P,I=0,D=0,K=Array.isArray(p.CellXf),Q,z=[],q=[],ee=Array.isArray(c),H=[],ce={},J=!1,N=!!f.sheetStubs,F=l.split(t),T=0,R=F.length;T!=R;++T){m=F[T].trim();var G=m.length;if(G!==0){var X=0;e:for(v=0;v<G;++v)switch(m[v]){case">":if(m[v-1]!="/"){++v;break e}if(f&&f.cellStyles){if(b=Ce(m.slice(X,v),!0),j=b.r!=null?parseInt(b.r,10):j+1,k=-1,f.sheetRows&&f.sheetRows<j)continue;ce={},J=!1,b.ht&&(J=!0,ce.hpt=parseFloat(b.ht),ce.hpx=Xu(ce.hpt)),b.hidden=="1"&&(J=!0,ce.hidden=!0),b.outlineLevel!=null&&(J=!0,ce.level=+b.outlineLevel),J&&(H[j-1]=ce)}break;case"<":X=v;break}if(X>=v)break;if(b=Ce(m.slice(X,v),!0),j=b.r!=null?parseInt(b.r,10):j+1,k=-1,!(f.sheetRows&&f.sheetRows<j)){d.s.r>j-1&&(d.s.r=j-1),d.e.r<j-1&&(d.e.r=j-1),f&&f.cellStyles&&(ce={},J=!1,b.ht&&(J=!0,ce.hpt=parseFloat(b.ht),ce.hpx=Xu(ce.hpt)),b.hidden=="1"&&(J=!0,ce.hidden=!0),b.outlineLevel!=null&&(J=!0,ce.level=+b.outlineLevel),J&&(H[j-1]=ce)),_=m.slice(v).split(e);for(var Y=0;Y!=_.length&&_[Y].trim().charAt(0)=="<";++Y);for(_=_.slice(Y),v=0;v!=_.length;++v)if(m=_[v].trim(),m.length!==0){if(g=m.match(r),y=v,x=0,w=0,m="<c "+(m.slice(0,1)=="<"?">":"")+m,g!=null&&g.length===2){for(y=0,E=g[1],x=0;x!=E.length&&!((w=E.charCodeAt(x)-64)<1||w>26);++x)y=26*y+w;--y,k=y}else++k;for(x=0;x!=m.length&&m.charCodeAt(x)!==62;++x);if(++x,b=Ce(m.slice(0,x),!0),b.r||(b.r=Oe({r:j-1,c:k})),E=m.slice(x),S={t:""},(g=E.match(s))!=null&&g[1]!==""&&(S.v=ze(g[1])),f.cellFormula){if((g=E.match(i))!=null&&g[1]!==""){if(S.f=ze(st(g[1])).replace(/\r\n/g,`
`),f.xlfn||(S.f=qb(S.f)),g[0].indexOf('t="array"')>-1)S.F=(E.match(a)||[])[1],S.F.indexOf(":")>-1&&z.push([Nt(S.F),S.F]);else if(g[0].indexOf('t="shared"')>-1){P=Ce(g[0]);var ae=ze(st(g[1]));f.xlfn||(ae=qb(ae)),q[parseInt(P.si,10)]=[P,ae,b.r]}}else(g=E.match(/<f[^>]*\/>/))&&(P=Ce(g[0]),q[P.si]&&(S.f=lie(q[P.si][1],q[P.si][2],b.r)));var oe=Dr(b.r);for(x=0;x<z.length;++x)oe.r>=z[x][0].s.r&&oe.r<=z[x][0].e.r&&oe.c>=z[x][0].s.c&&oe.c<=z[x][0].e.c&&(S.F=z[x][1])}if(b.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(N)S.t="z";else continue;else S.t=b.t||"n";switch(d.s.c>k&&(d.s.c=k),d.e.c<k&&(d.e.c=k),S.t){case"n":if(S.v==""||S.v==null){if(!N)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!N)continue;S.t="z"}else C=ru[parseInt(S.v,10)],S.v=C.t,S.r=C.r,f.cellHTML&&(S.h=C.h);break;case"str":S.t="s",S.v=S.v!=null?st(S.v):"",f.cellHTML&&(S.h=ny(S.v));break;case"inlineStr":g=E.match(n),S.t="s",g!=null&&(C=hy(g[1]))?(S.v=C.t,f.cellHTML&&(S.h=C.h)):S.v="";break;case"b":S.v=mt(S.v);break;case"d":f.cellDates?S.v=er(S.v,1):(S.v=Fr(er(S.v,1)),S.t="n");break;case"e":(!f||f.cellText!==!1)&&(S.w=S.v),S.v=J4[S.v];break}if(I=D=0,Q=null,K&&b.s!==void 0&&(Q=p.CellXf[b.s],Q!=null&&(Q.numFmtId!=null&&(I=Q.numFmtId),f.cellStyles&&Q.fillId!=null&&(D=Q.fillId))),OA(S,I,D,f,h,p),f.cellDates&&K&&S.t=="n"&&ec(je[I])&&(S.t="d",S.v=fp(S.v)),b.cm&&f.xlmeta){var ve=(f.xlmeta.Cell||[])[+b.cm-1];ve&&ve.type=="XLDAPR"&&(S.D=!0)}if(ee){var B=Dr(b.r);c[B.r]||(c[B.r]=[]),c[B.r][B.c]=S}else c[b.r]=S}}}}H.length>0&&(c["!rows"]=H)}}();function Joe(e,t){var r={},n=e.l+t;r.r=e.read_shift(4),e.l+=4;var a=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=n,s&7&&(r.level=s&7),s&16&&(r.hidden=!0),s&32&&(r.hpt=a/20),r}var Zoe=vo;function ele(){}function tle(e,t){var r={},n=e[e.l];return++e.l,r.above=!(n&64),r.left=!(n&128),e.l+=18,r.name=Ere(e),r}function rle(e){var t=In(e);return[t]}function nle(e){var t=mo(e);return[t]}function ale(e){var t=In(e),r=e.read_shift(1);return[t,r,"b"]}function sle(e){var t=mo(e),r=e.read_shift(1);return[t,r,"b"]}function ile(e){var t=In(e),r=e.read_shift(1);return[t,r,"e"]}function ole(e){var t=mo(e),r=e.read_shift(1);return[t,r,"e"]}function lle(e){var t=In(e),r=e.read_shift(4);return[t,r,"s"]}function cle(e){var t=mo(e),r=e.read_shift(4);return[t,r,"s"]}function ule(e){var t=In(e),r=gr(e);return[t,r,"n"]}function jA(e){var t=mo(e),r=gr(e);return[t,r,"n"]}function fle(e){var t=In(e),r=uy(e);return[t,r,"n"]}function dle(e){var t=mo(e),r=uy(e);return[t,r,"n"]}function hle(e){var t=In(e),r=ly(e);return[t,r,"is"]}function ple(e){var t=In(e),r=_r(e);return[t,r,"str"]}function mle(e){var t=mo(e),r=_r(e);return[t,r,"str"]}function vle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"b"];if(r.cellFormula){e.l+=2;var o=pp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function gle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=e.read_shift(1),i=[a,s,"e"];if(r.cellFormula){e.l+=2;var o=pp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function xle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=gr(e),i=[a,s,"n"];if(r.cellFormula){e.l+=2;var o=pp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}function yle(e,t,r){var n=e.l+t,a=In(e);a.r=r["!row"];var s=_r(e),i=[a,s,"str"];if(r.cellFormula){e.l+=2;var o=pp(e,n-e.l,r);i[3]=mr(o,null,a,r.supbooks,r)}else e.l=n;return i}var _le=vo;function wle(e,t){var r=e.l+t,n=vo(e),a=cy(e),s=_r(e),i=_r(e),o=_r(e);e.l=r;var l={rfx:n,relId:a,loc:s,display:o};return i&&(l.Tooltip=i),l}function ble(){}function Ele(e,t,r){var n=e.l+t,a=q4(e),s=e.read_shift(1),i=[a];if(i[2]=s,r.cellFormula){var o=Noe(e,n-e.l,r);i[1]=o}else e.l=n;return i}function Sle(e,t,r){var n=e.l+t,a=vo(e),s=[a];if(r.cellFormula){var i=Ooe(e,n-e.l,r);s[1]=i,e.l=n}else e.l=n;return s}var kle=["left","right","top","bottom","header","footer"];function Tle(e){var t={};return kle.forEach(function(r){t[r]=gr(e)}),t}function Cle(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function Nle(){}function Ale(){}function Ole(e,t,r,n,a,s,i){if(!e)return e;var o=t||{};n||(n={"!id":{}});var l=o.dense?[]:{},c,f={s:{r:2e6,c:2e6},e:{r:0,c:0}},d=!1,h=!1,p,v,m,_,g,y,x,w,E,S=[];o.biff=12,o["!row"]=0;var b=0,j=!1,k=[],C={},P=o.supbooks||a.supbooks||[[]];if(P.sharedf=C,P.arrayf=k,P.SheetNames=a.SheetNames||a.Sheets.map(function(ee){return ee.name}),!o.supbooks&&(o.supbooks=P,a.Names))for(var I=0;I<a.Names.length;++I)P[0][I+1]=a.Names[I];var D=[],K=[],Q=!1;X0[16]={n:"BrtShortReal",f:jA};var z;if(_s(e,function(H,ce,J){if(!h)switch(J){case 148:c=H;break;case 0:p=H,o.sheetRows&&o.sheetRows<=p.r&&(h=!0),w=or(_=p.r),o["!row"]=p.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=Xu(H.hpt)),K[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:H[2]},H[2]){case"n":v.v=H[1];break;case"s":x=ru[H[1]],v.v=x.t,v.r=x.r;break;case"b":v.v=!!H[1];break;case"e":v.v=H[1],o.cellText!==!1&&(v.w=go[v.v]);break;case"str":v.t="s",v.v=H[1];break;case"is":v.t="s",v.v=H[1].t;break}if((m=i.CellXf[H[0].iStyleRef])&&OA(v,m.numFmtId,null,o,s,i),g=H[0].c==-1?g+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][g]=v):l[zt(g)+w]=v,o.cellFormula){for(j=!1,b=0;b<k.length;++b){var N=k[b];p.r>=N[0].s.r&&p.r<=N[0].e.r&&g>=N[0].s.c&&g<=N[0].e.c&&(v.F=We(N[0]),j=!0)}!j&&H.length>3&&(v.f=H[3])}if(f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),o.cellDates&&m&&v.t=="n"&&ec(je[m.numFmtId])){var F=ji(v.v);F&&(v.t="d",v.v=new Date(F.y,F.m-1,F.d,F.H,F.M,F.S,F.u))}z&&(z.type=="XLDAPR"&&(v.D=!0),z=void 0);break;case 1:case 12:if(!o.sheetStubs||d)break;v={t:"z",v:void 0},g=H[0].c==-1?g+1:H[0].c,o.dense?(l[_]||(l[_]=[]),l[_][g]=v):l[zt(g)+w]=v,f.s.r>p.r&&(f.s.r=p.r),f.s.c>g&&(f.s.c=g),f.e.r<p.r&&(f.e.r=p.r),f.e.c<g&&(f.e.c=g),z&&(z.type=="XLDAPR"&&(v.D=!0),z=void 0);break;case 176:S.push(H);break;case 49:z=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var T=n["!id"][H.relId];for(T?(H.Target=T.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=T):H.relId==""&&(H.Target="#"+H.loc),_=H.rfx.s.r;_<=H.rfx.e.r;++_)for(g=H.rfx.s.c;g<=H.rfx.e.c;++g)o.dense?(l[_]||(l[_]=[]),l[_][g]||(l[_][g]={t:"z",v:void 0}),l[_][g].l=H):(y=Oe({c:g,r:_}),l[y]||(l[y]={t:"z",v:void 0}),l[y].l=H);break;case 426:if(!o.cellFormula)break;k.push(H),E=o.dense?l[_][g]:l[zt(g)+w],E.f=mr(H[1],f,{r:p.r,c:g},P,o),E.F=We(H[0]);break;case 427:if(!o.cellFormula)break;C[Oe(H[0].s)]=H[1],E=o.dense?l[_][g]:l[zt(g)+w],E.f=mr(H[1],f,{r:p.r,c:g},P,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)D[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},Q||(Q=!0,py(H.w/256)),Nl(D[H.e+1]);break;case 161:l["!autofilter"]={ref:We(H)};break;case 476:l["!margins"]=H;break;case 147:a.Sheets[r]||(a.Sheets[r]={}),H.name&&(a.Sheets[r].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:a.Views||(a.Views=[{}]),a.Views[0]||(a.Views[0]={}),H.RTL&&(a.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:d=!0;break;case 36:d=!1;break;case 37:d=!0;break;case 38:d=!1;break;default:if(!ce.T){if(!d||o.WTF)throw new Error("Unexpected record 0x"+J.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(f.s.r<2e6||c&&(c.e.r>0||c.e.c>0||c.s.r>0||c.s.c>0))&&(l["!ref"]=We(c||f)),o.sheetRows&&l["!ref"]){var q=Nt(l["!ref"]);o.sheetRows<=+q.e.r&&(q.e.r=o.sheetRows-1,q.e.r>f.e.r&&(q.e.r=f.e.r),q.e.r<q.s.r&&(q.s.r=q.e.r),q.e.c>f.e.c&&(q.e.c=f.e.c),q.e.c<q.s.c&&(q.s.c=q.e.c),l["!fullref"]=l["!ref"],l["!ref"]=We(q))}return S.length>0&&(l["!merges"]=S),D.length>0&&(l["!cols"]=D),K.length>0&&(l["!rows"]=K),l}function Dle(e){var t=[],r=e.match(/^<c:numCache>/),n;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var i=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);i&&(t[+i[1]]=r?+i[2]:i[2])});var a=ze((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){n=s.replace(/<.*?>/g,"")}),[t,a,n]}function jle(e,t,r,n,a,s){var i=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,c="A",f={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(d){var h=Dle(d);f.s.r=f.s.c=0,f.e.c=o,c=zt(o),h[0].forEach(function(p,v){i[c+or(v)]={t:"n",v:p,z:h[1]},l=v}),f.e.r<l&&(f.e.r=l),++o}),o>0&&(i["!ref"]=We(f)),i}function Ple(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i,o=e.match(DA);return o&&vy(o[0],s,a,r),(i=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=i[1]),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}function Fle(e,t){e.l+=10;var r=_r(e);return{name:r}}function Rle(e,t,r,n,a){if(!e)return e;n||(n={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},i=!1;return _s(e,function(l,c,f){switch(f){case 550:s["!rel"]=l;break;case 651:a.Sheets[r]||(a.Sheets[r]={}),l.name&&(a.Sheets[r].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:i=!0;break;case 36:i=!1;break;case 37:break;case 38:break;default:if(!(c.T>0)){if(!(c.T<0)){if(!i||t.WTF)throw new Error("Unexpected record 0x"+f.toString(16))}}}},t),n["!id"][s["!rel"]]&&(s["!drawel"]=n["!id"][s["!rel"]]),s}var PA=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],Mle=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],Ile=[],Lle=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function eE(e,t){for(var r=0;r!=e.length;++r)for(var n=e[r],a=0;a!=t.length;++a){var s=t[a];if(n[s[0]]==null)n[s[0]]=s[1];else switch(s[2]){case"bool":typeof n[s[0]]=="string"&&(n[s[0]]=mt(n[s[0]]));break;case"int":typeof n[s[0]]=="string"&&(n[s[0]]=parseInt(n[s[0]],10));break}}}function tE(e,t){for(var r=0;r!=t.length;++r){var n=t[r];if(e[n[0]]==null)e[n[0]]=n[1];else switch(n[2]){case"bool":typeof e[n[0]]=="string"&&(e[n[0]]=mt(e[n[0]]));break;case"int":typeof e[n[0]]=="string"&&(e[n[0]]=parseInt(e[n[0]],10));break}}}function FA(e){tE(e.WBProps,PA),tE(e.CalcPr,Lle),eE(e.WBView,Mle),eE(e.Sheets,Ile),ul.date1904=mt(e.WBProps.date1904)}var $le="][*?/\\".split("");function Ble(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var r=!0;return $le.forEach(function(n){if(e.indexOf(n)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),r}var Ule=/<\w+:workbook/;function Wle(e,t){if(!e)throw new Error("Could not find file");var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},n=!1,a="xmlns",s={},i=0;if(e.replace(Tr,function(l,c){var f=Ce(l);switch(Ma(f[0])){case"<?xml":break;case"<workbook":l.match(Ule)&&(a="xmlns"+l.match(/<(\w+):/)[1]),r.xmlns=f[a];break;case"</workbook>":break;case"<fileVersion":delete f[0],r.AppVersion=f;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":PA.forEach(function(d){if(f[d[0]]!=null)switch(d[2]){case"bool":r.WBProps[d[0]]=mt(f[d[0]]);break;case"int":r.WBProps[d[0]]=parseInt(f[d[0]],10);break;default:r.WBProps[d[0]]=f[d[0]]}}),f.codeName&&(r.WBProps.CodeName=st(f.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete f[0],r.WBView.push(f);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(f.state){case"hidden":f.Hidden=1;break;case"veryHidden":f.Hidden=2;break;default:f.Hidden=0}delete f.state,f.name=ze(st(f.name)),delete f[0],r.Sheets.push(f);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":n=!0;break;case"</definedNames>":n=!1;break;case"<definedName":s={},s.Name=st(f.name),f.comment&&(s.Comment=f.comment),f.localSheetId&&(s.Sheet=+f.localSheetId),mt(f.hidden||"0")&&(s.Hidden=!0),i=c+l.length;break;case"</definedName>":s.Ref=ze(st(e.slice(i,c))),r.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete f[0],r.CalcPr=f;break;case"<calcPr/>":delete f[0],r.CalcPr=f;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":n=!0;break;case"</ext>":n=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":n=!0;break;case"</AlternateContent>":n=!1;break;case"<revisionPtr":break;default:if(!n&&t.WTF)throw new Error("unrecognized "+f[0]+" in workbook")}return l}),ire.indexOf(r.xmlns)===-1)throw new Error("Unknown Namespace: "+r.xmlns);return FA(r),r}function Vle(e,t){var r={};return r.Hidden=e.read_shift(4),r.iTabID=e.read_shift(4),r.strRelID=pg(e),r.name=_r(e),r}function Hle(e,t){var r={},n=e.read_shift(4);r.defaultThemeVersion=e.read_shift(4);var a=t>8?_r(e):"";return a.length>0&&(r.CodeName=a),r.autoCompressPictures=!!(n&65536),r.backupFile=!!(n&64),r.checkCompatibility=!!(n&4096),r.date1904=!!(n&1),r.filterPrivacy=!!(n&8),r.hidePivotFieldList=!!(n&1024),r.promptedSolutions=!!(n&16),r.publishItems=!!(n&2048),r.refreshAllConnections=!!(n&262144),r.saveExternalLinkValues=!!(n&128),r.showBorderUnselectedTables=!!(n&4),r.showInkAnnotation=!!(n&32),r.showObjects=["all","placeholders","none"][n>>13&3],r.showPivotChartFilter=!!(n&32768),r.updateLinks=["userSet","never","always"][n>>8&3],r}function zle(e,t){var r={};return e.read_shift(4),r.ArchID=e.read_shift(4),e.l+=t-8,r}function Yle(e,t,r){var n=e.l+t;e.l+=4,e.l+=1;var a=e.read_shift(4),s=Sre(e),i=Aoe(e,0,r),o=cy(e);e.l=n;var l={Name:s,Ptg:i};return a<268435455&&(l.Sheet=a),o&&(l.Comment=o),l}function Gle(e,t){var r={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},n=[],a=!1;t||(t={}),t.biff=12;var s=[],i=[[]];return i.SheetNames=[],i.XTI=[],X0[16]={n:"BrtFRTArchID$",f:zle},_s(e,function(l,c,f){switch(f){case 156:i.SheetNames.push(l.name),r.Sheets.push(l);break;case 153:r.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=mr(l.Ptg,null,null,i,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:i[0].length?i.push([f,l]):i[0]=[f,l],i[i.length-1].XTI=[];break;case 362:i.length===0&&(i[0]=[],i[0].XTI=[]),i[i.length-1].XTI=i[i.length-1].XTI.concat(l),i.XTI=i.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:n.push(f),a=!0;break;case 36:n.pop(),a=!1;break;case 37:n.push(f),a=!0;break;case 38:n.pop(),a=!1;break;case 16:break;default:if(!c.T){if(!a||t.WTF&&n[n.length-1]!=37&&n[n.length-1]!=35)throw new Error("Unexpected record 0x"+f.toString(16))}}},t),FA(r),r.Names=s,r.supbooks=i,r}function Kle(e,t,r){return t.slice(-4)===".bin"?Gle(e,r):Wle(e,r)}function qle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Ole(e,n,r,a,s,i,o):Voe(e,n,r,a,s,i,o)}function Xle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?Rle(e,n,r,a,s):Ple(e,n,r,a,s)}function Qle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?sie():iie()}function Jle(e,t,r,n,a,s,i,o){return t.slice(-4)===".bin"?nie():aie()}function Zle(e,t,r,n){return t.slice(-4)===".bin"?_se(e,r,n):pse(e,r,n)}function ece(e,t,r){return _A(e,r)}function tce(e,t,r){return t.slice(-4)===".bin"?Mae(e,r):Fae(e,r)}function rce(e,t,r){return t.slice(-4)===".bin"?eie(e,r):qse(e,r)}function nce(e,t,r){return t.slice(-4)===".bin"?Yse(e):Hse(e)}function ace(e,t,r,n){return r.slice(-4)===".bin"?Gse(e,t,r,n):void 0}function sce(e,t,r){return t.slice(-4)===".bin"?Wse(e,t,r):Vse(e,t,r)}var RA=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,MA=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Un(e,t){var r=e.split(/\s+/),n=[];if(n[0]=r[0],r.length===1)return n;var a=e.match(RA),s,i,o,l;if(a)for(l=0;l!=a.length;++l)s=a[l].match(MA),(i=s[1].indexOf(":"))===-1?n[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(i+1),n[o]=s[2].slice(1,s[2].length-1));return n}function ice(e){var t=e.split(/\s+/),r={};if(t.length===1)return r;var n=e.match(RA),a,s,i,o;if(n)for(o=0;o!=n.length;++o)a=n[o].match(MA),(s=a[1].indexOf(":"))===-1?r[a[1]]=a[2].slice(1,a[2].length-1):(a[1].slice(0,6)==="xmlns:"?i="xmlns"+a[1].slice(6):i=a[1].slice(s+1),r[i]=a[2].slice(1,a[2].length-1));return r}var au;function oce(e,t){var r=au[e]||ze(e);return r==="General"?eo(t):jn(r,t)}function lce(e,t,r,n){var a=n;switch((r[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":a=mt(n);break;case"i2":case"int":a=parseInt(n,10);break;case"r4":case"float":a=parseFloat(n);break;case"date":case"dateTime.tz":a=er(n);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+r[0])}e[ze(t)]=a}function cce(e,t,r){if(e.t!=="z"){if(!r||r.cellText!==!1)try{e.t==="e"?e.w=e.w||go[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zu(e.v):e.w=eo(e.v):e.w=oce(t||"General",e.v)}catch(s){if(r.WTF)throw s}try{var n=au[t]||t||"General";if(r.cellNF&&(e.z=n),r.cellDates&&e.t=="n"&&ec(n)){var a=ji(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}catch(s){if(r.WTF)throw s}}}function uce(e,t,r){if(r.cellStyles&&t.Interior){var n=t.Interior;n.Pattern&&(n.patternType=lse[n.Pattern]||n.Pattern)}e[t.ID]=t}function fce(e,t,r,n,a,s,i,o,l,c){var f="General",d=n.StyleID,h={};c=c||{};var p=[],v=0;for(d===void 0&&o&&(d=o.StyleID),d===void 0&&i&&(d=i.StyleID);s[d]!==void 0&&(s[d].nf&&(f=s[d].nf),s[d].Interior&&p.push(s[d].Interior),!!s[d].Parent);)d=s[d].Parent;switch(r.Type){case"Boolean":n.t="b",n.v=mt(e);break;case"String":n.t="s",n.r=Eb(ze(e)),n.v=e.indexOf("<")>-1?ze(t||e).replace(/<.*?>/g,""):n.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),n.v=(er(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),n.v!==n.v?n.v=ze(e):n.v<60&&(n.v=n.v-1),(!f||f=="General")&&(f="yyyy-mm-dd");case"Number":n.v===void 0&&(n.v=+e),n.t||(n.t="n");break;case"Error":n.t="e",n.v=J4[e],c.cellText!==!1&&(n.w=e);break;default:e==""&&t==""?n.t="z":(n.t="s",n.v=Eb(t||e));break}if(cce(n,f,c),c.cellFormula!==!1)if(n.Formula){var m=ze(n.Formula);m.charCodeAt(0)==61&&(m=m.slice(1)),n.f=cl(m,a),delete n.Formula,n.ArrayRange=="RC"?n.F=cl("RC:RC",a):n.ArrayRange&&(n.F=cl(n.ArrayRange,a),l.push([Nt(n.F),n.F]))}else for(v=0;v<l.length;++v)a.r>=l[v][0].s.r&&a.r<=l[v][0].e.r&&a.c>=l[v][0].s.c&&a.c<=l[v][0].e.c&&(n.F=l[v][1]);c.cellStyles&&(p.forEach(function(_){!h.patternType&&_.patternType&&(h.patternType=_.patternType)}),n.s=h),n.StyleID!==void 0&&(n.ixfe=n.StyleID)}function dce(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function Dm(e,t){var r=t||{};S4();var n=Oc(ay(e));(r.type=="binary"||r.type=="array"||r.type=="base64")&&(n=st(n));var a=n.slice(0,1024).toLowerCase(),s=!1;if(a=a.replace(/".*?"/g,""),(a.indexOf(">")&1023)>Math.min(a.indexOf(",")&1023,a.indexOf(";")&1023)){var i=ir(r);return i.type="string",Ku.to_workbook(n,i)}if(a.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(Xe){a.indexOf("<"+Xe)>=0&&(s=!0)}),s)return wce(n,r);au={"General Number":"General","General Date":je[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":je[15],"Short Date":je[14],"Long Time":je[19],"Medium Time":je[18],"Short Time":je[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:je[2],Standard:je[4],Percent:je[10],Scientific:je[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],c,f={},d=[],h=r.dense?[]:{},p="",v={},m={},_=Un('<Data ss:Type="String">'),g=0,y=0,x=0,w={s:{r:2e6,c:2e6},e:{r:0,c:0}},E={},S={},b="",j=0,k=[],C={},P={},I=0,D=[],K=[],Q={},z=[],q,ee=!1,H=[],ce=[],J={},N=0,F=0,T={Sheets:[],WBProps:{date1904:!1}},R={};Gu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"");for(var G="";o=Gu.exec(n);)switch(o[3]=(G=o[3]).toLowerCase()){case"data":if(G=="data"){if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?fce(n.slice(g,o.index),b,_,l[l.length-1][0]=="comment"?Q:v,{c:y,r:x},E,z[y],m,H,r):(b="",_=Un(o[0]),g=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(K.length>0&&(v.c=K),(!r.sheetRows||r.sheetRows>x)&&v.v!==void 0&&(r.dense?(h[x]||(h[x]=[]),h[x][y]=v):h[zt(y)+or(x)]=v),v.HRef&&(v.l={Target:ze(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(N=y+(parseInt(v.MergeAcross,10)|0),F=x+(parseInt(v.MergeDown,10)|0),k.push({s:{c:y,r:x},e:{c:N,r:F}})),!r.sheetStubs)v.MergeAcross?y=N+1:++y;else if(v.MergeAcross||v.MergeDown){for(var X=y;X<=N;++X)for(var Y=x;Y<=F;++Y)(X>y||Y>x)&&(r.dense?(h[Y]||(h[Y]=[]),h[Y][X]={t:"z"}):h[zt(X)+or(Y)]={t:"z"});y=N+1}else++y;else v=ice(o[0]),v.Index&&(y=+v.Index-1),y<w.s.c&&(w.s.c=y),y>w.e.c&&(w.e.c=y),o[0].slice(-2)==="/>"&&++y,K=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(x<w.s.r&&(w.s.r=x),x>w.e.r&&(w.e.r=x),o[0].slice(-2)==="/>"&&(m=Un(o[0]),m.Index&&(x=+m.Index-1)),y=0,++x):(m=Un(o[0]),m.Index&&(x=+m.Index-1),J={},(m.AutoFitHeight=="0"||m.Height)&&(J.hpx=parseInt(m.Height,10),J.hpt=yA(J.hpx),ce[x]=J),m.Hidden=="1"&&(J.hidden=!0,ce[x]=J));break;case"worksheet":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));d.push(p),w.s.r<=w.e.r&&w.s.c<=w.e.c&&(h["!ref"]=We(w),r.sheetRows&&r.sheetRows<=w.e.r&&(h["!fullref"]=h["!ref"],w.e.r=r.sheetRows-1,h["!ref"]=We(w))),k.length&&(h["!merges"]=k),z.length>0&&(h["!cols"]=z),ce.length>0&&(h["!rows"]=ce),f[p]=h}else w={s:{r:2e6,c:2e6},e:{r:0,c:0}},x=y=0,l.push([o[3],!1]),c=Un(o[0]),p=ze(c.Name),h=r.dense?[]:{},k=[],H=[],ce=[],R={name:p,Hidden:0},T.Sheets.push(R);break;case"table":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),z=[],ee=!1}break;case"style":o[1]==="/"?uce(E,S,r):S=Un(o[0]);break;case"numberformat":S.nf=ze(Un(o[0]).Format||"General"),au[S.nf]&&(S.nf=au[S.nf]);for(var ae=0;ae!=392&&je[ae]!=S.nf;++ae);if(ae==392){for(ae=57;ae!=392;++ae)if(je[ae]==null){Li(S.nf,ae);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(q=Un(o[0]),q.Hidden&&(q.hidden=!0,delete q.Hidden),q.Width&&(q.wpx=parseInt(q.Width,10)),!ee&&q.wpx>10){ee=!0,Or=gA;for(var oe=0;oe<z.length;++oe)z[oe]&&Nl(z[oe])}ee&&Nl(q),z[q.Index-1||z.length]=q;for(var ve=0;ve<+q.Span;++ve)z[z.length]=ir(q);break;case"namedrange":if(o[1]==="/")break;T.Names||(T.Names=[]);var B=Ce(o[0]),Te={Name:B.Name,Ref:cl(B.RefersTo.slice(1),{r:0,c:0})};T.Sheets.length>0&&(Te.Sheet=T.Sheets.length-1),T.Names.push(Te);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?b+=n.slice(j,o.index):j=o.index+o[0].length;break;case"interior":if(!r.cellStyles)break;S.Interior=Un(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?qre(C,G,n.slice(I,o.index)):I=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"));dce(Q),K.push(Q)}else l.push([o[3],!1]),c=Un(o[0]),Q={a:c.Author};break;case"autofilter":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var ke=Un(o[0]);h["!autofilter"]={ref:cl(ke.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((c=l.pop())[0]!==o[3])throw new Error("Bad state: "+c.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return oE(n,r);var $e=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:$e=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:$e=!1}break;case"excelworkbook":switch(o[3]){case"date1904":T.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:$e=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:$e=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(n.slice(I,o.index)){case"SheetHidden":R.Hidden=1;break;case"SheetVeryHidden":R.Hidden=2;break}else I=o.index+o[0].length;break;case"header":h["!margins"]||nu(h["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(h["!margins"].header=+Ce(o[0]).Margin);break;case"footer":h["!margins"]||nu(h["!margins"]={},"xlml"),isNaN(+Ce(o[0]).Margin)||(h["!margins"].footer=+Ce(o[0]).Margin);break;case"pagemargins":var Ne=Ce(o[0]);h["!margins"]||nu(h["!margins"]={},"xlml"),isNaN(+Ne.Top)||(h["!margins"].top=+Ne.Top),isNaN(+Ne.Left)||(h["!margins"].left=+Ne.Left),isNaN(+Ne.Right)||(h["!margins"].right=+Ne.Right),isNaN(+Ne.Bottom)||(h["!margins"].bottom=+Ne.Bottom);break;case"displayrighttoleft":T.Views||(T.Views=[]),T.Views[0]||(T.Views[0]={}),T.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":h["!outline"]||(h["!outline"]={}),h["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:$e=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:$e=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:$e=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:$e=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:$e=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:$e=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:$e=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:$e=!1}break;case"smarttags":break;default:$e=!1;break}if($e||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?lce(P,G,D,n.slice(I,o.index)):(D=o,I=o.index+o[0].length);break}if(r.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var me={};return!r.bookSheets&&!r.bookProps&&(me.Sheets=f),me.SheetNames=d,me.Workbook=T,me.SSF=ir(je),me.Props=C,me.Custprops=P,me}function xg(e,t){switch(yy(t=t||{}),t.type||"base64"){case"base64":return Dm(ln(e),t);case"binary":case"buffer":case"file":return Dm(e,t);case"array":return Dm(po(e),t)}}function hce(e){var t={},r=e.content;if(r.l=28,t.AnsiUserType=r.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=Cre(r),r.length-r.l<=4)return t;var n=r.read_shift(4);if(n==0||n>40||(r.l-=4,t.Reserved1=r.read_shift(0,"lpstr-ansi"),r.length-r.l<=4)||(n=r.read_shift(4),n!==1907505652)||(t.UnicodeClipboardFormat=Nre(r),n=r.read_shift(4),n==0||n>40))return t;r.l-=4,t.Reserved2=r.read_shift(0,"lpwstr")}var pce=[60,1084,2066,2165,2175];function mce(e,t,r,n,a){var s=n,i=[],o=r.slice(r.l,r.l+s);if(a&&a.enc&&a.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:a.enc.insitu(o)}i.push(o),r.l+=s;for(var l=Ja(r,r.l),c=yg[l],f=0;c!=null&&pce.indexOf(l)>-1;)s=Ja(r,r.l+2),f=r.l+4,l==2066?f+=4:(l==2165||l==2175)&&(f+=12),o=r.slice(f,r.l+4+s),i.push(o),r.l+=4+s,c=yg[l=Ja(r,r.l)];var d=Fs(i);nr(d,0);var h=0;d.lens=[];for(var p=0;p<i.length;++p)d.lens.push(h),h+=i[p].length;if(d.length<n)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+d.length+" < "+n;return t.f(d,d.length,a)}function ha(e,t,r){if(e.t!=="z"&&e.XF){var n=0;try{n=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=je[n])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||go[e.v]:n===0||n=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=zu(e.v):e.w=eo(e.v):e.w=jn(n,e.v,{date1904:!!r,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&n&&e.t=="n"&&ec(je[n]||String(n))){var a=ji(e.v);a&&(e.t="d",e.v=new Date(a.y,a.m-1,a.d,a.H,a.M,a.S,a.u))}}}function bd(e,t,r){return{v:e,ixfe:t,t:r}}function vce(e,t){var r={opts:{}},n={},a=t.dense?[]:{},s={},i={},o=null,l=[],c="",f={},d,h="",p,v,m,_,g={},y=[],x,w,E=[],S=[],b={Sheets:[],WBProps:{date1904:!1},Views:[{}]},j={},k=function(Re){return Re<8?$i[Re]:Re<64&&S[Re-8]||$i[Re]},C=function(Re,At,pn){var Bt=At.XF.data;if(!(!Bt||!Bt.patternType||!pn||!pn.cellStyles)){At.s={},At.s.patternType=Bt.patternType;var gi;(gi=qu(k(Bt.icvFore)))&&(At.s.fgColor={rgb:gi}),(gi=qu(k(Bt.icvBack)))&&(At.s.bgColor={rgb:gi})}},P=function(Re,At,pn){if(!(J>1)&&!(pn.sheetRows&&Re.r>=pn.sheetRows)){if(pn.cellStyles&&At.XF&&At.XF.data&&C(Re,At,pn),delete At.ixfe,delete At.XF,d=Re,h=Oe(Re),(!i||!i.s||!i.e)&&(i={s:{r:0,c:0},e:{r:0,c:0}}),Re.r<i.s.r&&(i.s.r=Re.r),Re.c<i.s.c&&(i.s.c=Re.c),Re.r+1>i.e.r&&(i.e.r=Re.r+1),Re.c+1>i.e.c&&(i.e.c=Re.c+1),pn.cellFormula&&At.f){for(var Bt=0;Bt<y.length;++Bt)if(!(y[Bt][0].s.c>Re.c||y[Bt][0].s.r>Re.r)&&!(y[Bt][0].e.c<Re.c||y[Bt][0].e.r<Re.r)){At.F=We(y[Bt][0]),(y[Bt][0].s.c!=Re.c||y[Bt][0].s.r!=Re.r)&&delete At.f,At.f&&(At.f=""+mr(y[Bt][1],i,Re,H,I));break}}pn.dense?(a[Re.r]||(a[Re.r]=[]),a[Re.r][Re.c]=At):a[h]=At}},I={enc:!1,sbcch:0,snames:[],sharedf:g,arrayf:y,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(I.password=t.password);var D,K=[],Q=[],z=[],q=[],ee=!1,H=[];H.SheetNames=I.snames,H.sharedf=I.sharedf,H.arrayf=I.arrayf,H.names=[],H.XTI=[];var ce=0,J=0,N=0,F=[],T=[],R;I.codepage=1200,qn(1200);for(var G=!1;e.l<e.length-1;){var X=e.l,Y=e.read_shift(2);if(Y===0&&ce===10)break;var ae=e.l===e.length?0:e.read_shift(2),oe=yg[Y];if(oe&&oe.f){if(t.bookSheets&&ce===133&&Y!==133)break;if(ce=Y,oe.r===2||oe.r==12){var ve=e.read_shift(2);if(ae-=2,!I.enc&&ve!==Y&&((ve&255)<<8|ve>>8)!==Y)throw new Error("rt mismatch: "+ve+"!="+Y);oe.r==12&&(e.l+=10,ae-=10)}var B={};if(Y===10?B=oe.f(e,ae,I):B=mce(Y,oe,e,ae,I),J==0&&[9,521,1033,2057].indexOf(ce)===-1)continue;switch(Y){case 34:r.opts.Date1904=b.WBProps.date1904=B;break;case 134:r.opts.WriteProtect=!0;break;case 47:if(I.enc||(e.l=0),I.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:I.lastuser=B;break;case 66:var Te=Number(B);switch(Te){case 21010:Te=1200;break;case 32768:Te=1e4;break;case 32769:Te=1252;break}qn(I.codepage=Te),G=!0;break;case 317:I.rrtabid=B;break;case 25:I.winlocked=B;break;case 439:r.opts.RefreshAll=B;break;case 12:r.opts.CalcCount=B;break;case 16:r.opts.CalcDelta=B;break;case 17:r.opts.CalcIter=B;break;case 13:r.opts.CalcMode=B;break;case 14:r.opts.CalcPrecision=B;break;case 95:r.opts.CalcSaveRecalc=B;break;case 15:I.CalcRefMode=B;break;case 2211:r.opts.FullCalc=B;break;case 129:B.fDialog&&(a["!type"]="dialog"),B.fBelow||((a["!outline"]||(a["!outline"]={})).above=!0),B.fRight||((a["!outline"]||(a["!outline"]={})).left=!0);break;case 224:E.push(B);break;case 430:H.push([B]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(B);break;case 24:case 536:R={Name:B.Name,Ref:mr(B.rgce,i,null,H,I)},B.itab>0&&(R.Sheet=B.itab-1),H.names.push(R),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(T[B.itab-1]={ref:We(B.rgce[0][0][1][2])});break;case 22:I.ExternCount=B;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(B),H.XTI=H.XTI.concat(B);break;case 2196:if(I.biff<8)break;R!=null&&(R.Comment=B[1]);break;case 18:a["!protect"]=B;break;case 19:B!==0&&I.WTF&&console.error("Password verifier: "+B);break;case 133:s[B.pos]=B,I.snames.push(B.name);break;case 10:{if(--J)break;if(i.e){if(i.e.r>0&&i.e.c>0){if(i.e.r--,i.e.c--,a["!ref"]=We(i),t.sheetRows&&t.sheetRows<=i.e.r){var ke=i.e.r;i.e.r=t.sheetRows-1,a["!fullref"]=a["!ref"],a["!ref"]=We(i),i.e.r=ke}i.e.r++,i.e.c++}K.length>0&&(a["!merges"]=K),Q.length>0&&(a["!objects"]=Q),z.length>0&&(a["!cols"]=z),q.length>0&&(a["!rows"]=q),b.Sheets.push(j)}c===""?f=a:n[c]=a,a=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(I.biff===8&&(I.biff={9:2,521:3,1033:4}[Y]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),I.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(I.biff=5,G=!0,qn(I.codepage=28591)),I.biff==8&&B.BIFFVer==0&&B.dt==16&&(I.biff=2),J++)break;if(a=t.dense?[]:{},I.biff<8&&!G&&(G=!0,qn(I.codepage=t.codepage||1252)),I.biff<5||B.BIFFVer==0&&B.dt==4096){c===""&&(c="Sheet1"),i={s:{r:0,c:0},e:{r:0,c:0}};var $e={pos:e.l-ae,name:c};s[$e.pos]=$e,I.snames.push(c)}else c=(s[X]||{name:""}).name;B.dt==32&&(a["!type"]="chart"),B.dt==64&&(a["!type"]="macro"),K=[],Q=[],I.arrayf=y=[],z=[],q=[],ee=!1,j={Hidden:(s[X]||{hs:0}).hs,name:c}}break;case 515:case 3:case 2:a["!type"]=="chart"&&(t.dense?(a[B.r]||[])[B.c]:a[Oe({c:B.c,r:B.r})])&&++B.c,x={ixfe:B.ixfe,XF:E[B.ixfe]||{},v:B.val,t:"n"},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t);break;case 5:case 517:x={ixfe:B.ixfe,XF:E[B.ixfe],v:B.val,t:B.t},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t);break;case 638:x={ixfe:B.ixfe,XF:E[B.ixfe],v:B.rknum,t:"n"},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t);break;case 189:for(var Ne=B.c;Ne<=B.C;++Ne){var me=B.rkrec[Ne-B.c][0];x={ixfe:me,XF:E[me],v:B.rkrec[Ne-B.c][1],t:"n"},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:Ne,r:B.r},x,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){o=B;break}if(x=bd(B.val,B.cell.ixfe,B.tt),x.XF=E[x.ixfe],t.cellFormula){var Xe=B.formula;if(Xe&&Xe[0]&&Xe[0][0]&&Xe[0][0][0]=="PtgExp"){var $t=Xe[0][0][1][0],gt=Xe[0][0][1][1],Ir=Oe({r:$t,c:gt});g[Ir]?x.f=""+mr(B.formula,i,B.cell,H,I):x.F=((t.dense?(a[$t]||[])[gt]:a[Ir])||{}).F}else x.f=""+mr(B.formula,i,B.cell,H,I)}N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P(B.cell,x,t),o=B}break;case 7:case 519:if(o)o.val=B,x=bd(B,o.cell.ixfe,"s"),x.XF=E[x.ixfe],t.cellFormula&&(x.f=""+mr(o.formula,i,o.cell,H,I)),N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P(o.cell,x,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{y.push(B);var ws=Oe(B[0].s);if(p=t.dense?(a[B[0].s.r]||[])[B[0].s.c]:a[ws],t.cellFormula&&p){if(!o||!ws||!p)break;p.f=""+mr(B[1],i,B[0],H,I),p.F=We(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(h){if(!o)break;g[Oe(o.cell)]=B[0],p=t.dense?(a[o.cell.r]||[])[o.cell.c]:a[Oe(o.cell)],(p||{}).f=""+mr(B[0],i,d,H,I)}}break;case 253:x=bd(l[B.isst].t,B.ixfe,"s"),l[B.isst].h&&(x.h=l[B.isst].h),x.XF=E[x.ixfe],N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t);break;case 513:t.sheetStubs&&(x={ixfe:B.ixfe,XF:E[B.ixfe],t:"z"},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t));break;case 190:if(t.sheetStubs)for(var Ln=B.c;Ln<=B.C;++Ln){var tr=B.ixfe[Ln-B.c];x={ixfe:tr,XF:E[tr],t:"z"},N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:Ln,r:B.r},x,t)}break;case 214:case 516:case 4:x=bd(B.val,B.ixfe,"s"),x.XF=E[x.ixfe],N>0&&(x.z=F[x.ixfe>>8&63]),ha(x,t,r.opts.Date1904),P({c:B.c,r:B.r},x,t);break;case 0:case 512:J===1&&(i=B);break;case 252:l=B;break;case 1054:if(I.biff==4){F[N++]=B[1];for(var hn=0;hn<N+163&&je[hn]!=B[1];++hn);hn>=163&&Li(B[1],N+163)}else Li(B[1],B[0]);break;case 30:{F[N++]=B;for(var $n=0;$n<N+163&&je[$n]!=B;++$n);$n>=163&&Li(B,N+163)}break;case 229:K=K.concat(B);break;case 93:Q[B.cmo[0]]=I.lastobj=B;break;case 438:I.lastobj.TxO=B;break;case 127:I.lastobj.ImData=B;break;case 440:for(_=B[0].s.r;_<=B[0].e.r;++_)for(m=B[0].s.c;m<=B[0].e.c;++m)p=t.dense?(a[_]||[])[m]:a[Oe({c:m,r:_})],p&&(p.l=B[1]);break;case 2048:for(_=B[0].s.r;_<=B[0].e.r;++_)for(m=B[0].s.c;m<=B[0].e.c;++m)p=t.dense?(a[_]||[])[m]:a[Oe({c:m,r:_})],p&&p.l&&(p.l.Tooltip=B[1]);break;case 28:{if(I.biff<=5&&I.biff>=2)break;p=t.dense?(a[B[0].r]||[])[B[0].c]:a[Oe(B[0])];var bs=Q[B[2]];p||(t.dense?(a[B[0].r]||(a[B[0].r]=[]),p=a[B[0].r][B[0].c]={t:"z"}):p=a[Oe(B[0])]={t:"z"},i.e.r=Math.max(i.e.r,B[0].r),i.s.r=Math.min(i.s.r,B[0].r),i.e.c=Math.max(i.e.c,B[0].c),i.s.c=Math.min(i.s.c,B[0].c)),p.c||(p.c=[]),v={a:B[1],t:bs.TxO.t},p.c.push(v)}break;case 2173:Lse(E[B.ixfe],B.ext);break;case 125:{if(!I.cellStyles)break;for(;B.e>=B.s;)z[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},ee||(ee=!0,py(B.w/256)),Nl(z[B.e+1])}break;case 520:{var qt={};B.level!=null&&(q[B.r]=qt,qt.level=B.level),B.hidden&&(q[B.r]=qt,qt.hidden=!0),B.hpt&&(q[B.r]=qt,qt.hpt=B.hpt,qt.hpx=Xu(B.hpt))}break;case 38:case 39:case 40:case 41:a["!margins"]||nu(a["!margins"]={}),a["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[Y]]=B;break;case 161:a["!margins"]||nu(a["!margins"]={}),a["!margins"].header=B.header,a["!margins"].footer=B.footer;break;case 574:B.RTL&&(b.Views[0].RTL=!0);break;case 146:S=B;break;case 2198:D=B;break;case 140:w=B;break;case 442:c?j.CodeName=B||j.name:b.WBProps.CodeName=B||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+Y.toString(16)),e.l+=ae}return r.SheetNames=Da(s).sort(function(fa,Re){return Number(fa)-Number(Re)}).map(function(fa){return s[fa].name}),t.bookSheets||(r.Sheets=n),!r.SheetNames.length&&f["!ref"]?(r.SheetNames.push("Sheet1"),r.Sheets&&(r.Sheets.Sheet1=f)):r.Preamble=f,r.Sheets&&T.forEach(function(fa,Re){r.Sheets[r.SheetNames[Re]]["!autofilter"]=fa}),r.Strings=l,r.SSF=ir(je),I.enc&&(r.Encryption=I.enc),D&&(r.Themes=D),r.Metadata={},w!==void 0&&(r.Metadata.Country=w),H.names.length>0&&(b.Names=H.names),r.Workbook=b,r}var rE={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function gce(e,t,r){var n=Ue.find(e,"/!DocumentSummaryInformation");if(n&&n.size>0)try{var a=$b(n,Fre,rE.DSI);for(var s in a)t[s]=a[s]}catch(c){if(r.WTF)throw c}var i=Ue.find(e,"/!SummaryInformation");if(i&&i.size>0)try{var o=$b(i,Rre,rE.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(c){if(r.WTF)throw c}t.HeadingPairs&&t.TitlesOfParts&&(eA(t.HeadingPairs,t.TitlesOfParts,t,r),delete t.HeadingPairs,delete t.TitlesOfParts)}function IA(e,t){t||(t={}),yy(t),d4(),t.codepage&&Q1(t.codepage);var r,n;if(e.FullPaths){if(Ue.find(e,"/encryption"))throw new Error("File is password-protected");r=Ue.find(e,"!CompObj"),n=Ue.find(e,"/Workbook")||Ue.find(e,"/Book")}else{switch(t.type){case"base64":e=Gn(ln(e));break;case"binary":e=Gn(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}nr(e,0),n={content:e}}var a,s;if(r&&hce(r),t.bookProps&&!t.bookSheets)a={};else{var i=Be?"buffer":"array";if(n&&n.content)a=vce(n.content,t);else if((s=Ue.find(e,"PerfectOffice_MAIN"))&&s.content)a=tu.to_workbook(s.content,(t.type=i,t));else if((s=Ue.find(e,"NativeContent_MAIN"))&&s.content)a=tu.to_workbook(s.content,(t.type=i,t));else throw(s=Ue.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ue.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(a.vbaraw=rie(e))}var o={};return e.FullPaths&&gce(e,o,t),a.Props=a.Custprops=o,t.bookFiles&&(a.cfb=e),a}var X0={0:{f:Joe},1:{f:rle},2:{f:fle},3:{f:ile},4:{f:ale},5:{f:ule},6:{f:ple},7:{f:lle},8:{f:yle},9:{f:xle},10:{f:vle},11:{f:gle},12:{f:nle},13:{f:dle},14:{f:ole},15:{f:sle},16:{f:jA},17:{f:mle},18:{f:cle},19:{f:ly},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:Yle},40:{},42:{},43:{f:vse},44:{f:mse},45:{f:gse},46:{f:yse},47:{f:xse},48:{},49:{f:_re},50:{},51:{f:Bse},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:dA},62:{f:hle},63:{f:zse},64:{f:Nle},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:br,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:Cle},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:tle},148:{f:Zoe,p:16},151:{f:ble},152:{},153:{f:Hle},154:{},155:{},156:{f:Vle},157:{},158:{},159:{T:1,f:Rae},160:{T:-1},161:{T:1,f:vo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:_le},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:$se},336:{T:-1},337:{f:Use,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:pg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:fA},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:Ele},427:{f:Sle},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:Tle},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:ele},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:wle},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:pg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:Zse},633:{T:1},634:{T:-1},635:{T:1,f:Jse},636:{T:-1},637:{f:bre},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:Fle},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:Ale},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},yg={6:{f:Am},10:{f:ks},12:{f:It},13:{f:It},14:{f:Ot},15:{f:Ot},16:{f:gr},17:{f:Ot},18:{f:Ot},19:{f:It},20:{f:Vb},21:{f:Vb},23:{f:fA},24:{f:zb},25:{f:Ot},26:{},27:{},28:{f:Xne},29:{},34:{f:Ot},35:{f:Hb},38:{f:gr},39:{f:gr},40:{f:gr},41:{f:gr},42:{f:Ot},43:{f:Ot},47:{f:ese},49:{f:Dne},51:{f:It},60:{},61:{f:Nne},64:{f:Ot},65:{f:One},66:{f:It},77:{},80:{},81:{},82:{},85:{f:It},89:{},90:{},91:{},92:{f:_ne},93:{f:Jne},94:{},95:{f:Ot},96:{},97:{},99:{f:Ot},125:{f:dA},128:{f:Une},129:{f:wne},130:{f:It},131:{f:Ot},132:{f:Ot},133:{f:bne},134:{},140:{f:aae},141:{f:It},144:{},146:{f:iae},151:{},152:{},153:{},154:{},155:{},156:{f:It},157:{},158:{},160:{f:fae},161:{f:lae},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:Ine},190:{f:Lne},193:{f:ks},197:{},198:{},199:{},200:{},201:{},202:{f:Ot},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:It},220:{},221:{f:Ot},222:{},224:{f:Bne},225:{f:yne},226:{f:ks},227:{},229:{f:Qne},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:Ene},253:{f:jne},255:{f:Sne},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:sA},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:Ot},353:{f:ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:Vne},431:{f:Ot},432:{},433:{},434:{},437:{},438:{f:tae},439:{f:Ot},440:{f:rae},441:{},442:{f:Af},443:{},444:{f:It},445:{},446:{},448:{f:ks},449:{f:Cne,r:2},450:{f:ks},512:{f:Ub},513:{f:uae},515:{f:Wne},516:{f:Pne},517:{f:Wb},519:{f:dae},520:{f:kne},523:{},545:{f:Yb},549:{f:Bb},566:{},574:{f:Ane},638:{f:Mne},659:{},1048:{},1054:{f:Fne},1084:{},1212:{f:Gne},2048:{f:nae},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:yd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:oae,r:12},2173:{f:Ise,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:Ot,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:Yne,r:12},2197:{},2198:{f:Dse,r:12},2199:{},2200:{},2201:{},2202:{f:Kne,r:12},2203:{f:ks},2204:{},2205:{},2206:{},2207:{},2211:{f:Tne},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:It},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:cae},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:sae},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:Ub},1:{},2:{f:vae},3:{f:mae},4:{f:pae},5:{f:Wb},7:{f:gae},8:{},9:{f:yd},11:{},22:{f:It},30:{f:Rne},31:{},32:{},33:{f:Yb},36:{},37:{f:Bb},50:{f:xae},62:{},52:{},67:{},68:{f:It},69:{},86:{},126:{},127:{f:hae},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:yae},223:{},234:{},354:{},421:{},518:{f:Am},521:{f:yd},536:{f:zb},547:{f:Hb},561:{},579:{},1030:{f:Am},1033:{f:yd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Wn(e,t,r,n){var a=t;if(!isNaN(a)){var s=(r||[]).length||0,i=e.next(4);i.write_shift(2,a),i.write_shift(2,s),s>0&&Y4(r)&&e.push(r)}}function nE(e,t){var r=t||{},n=r.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var a=e.match(/<table/i);if(!a)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),i=a.index,o=s&&s.index||e.length,l=Wte(e.slice(i,o),/(:?<tr[^>]*>)/i,"<tr>"),c=-1,f=0,d=0,h=0,p={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(i=0;i<l.length;++i){var m=l[i].trim(),_=m.slice(0,3).toLowerCase();if(_=="<tr"){if(++c,r.sheetRows&&r.sheetRows<=c){--c;break}f=0;continue}if(!(_!="<td"&&_!="<th")){var g=m.split(/<\/t[dh]>/i);for(o=0;o<g.length;++o){var y=g[o].trim();if(y.match(/<t[dh]/i)){for(var x=y,w=0;x.charAt(0)=="<"&&(w=x.indexOf(">"))>-1;)x=x.slice(w+1);for(var E=0;E<v.length;++E){var S=v[E];S.s.c==f&&S.s.r<c&&c<=S.e.r&&(f=S.e.c+1,E=-1)}var b=Ce(y.slice(0,y.indexOf(">")));h=b.colspan?+b.colspan:1,((d=+b.rowspan)>1||h>1)&&v.push({s:{r:c,c:f},e:{r:c+(d||1)-1,c:f+h-1}});var j=b.t||b["data-t"]||"";if(!x.length){f+=h;continue}if(x=P4(x),p.s.r>c&&(p.s.r=c),p.e.r<c&&(p.e.r=c),p.s.c>f&&(p.s.c=f),p.e.c<f&&(p.e.c=f),!x.length){f+=h;continue}var k={t:"s",v:x};r.raw||!x.trim().length||j=="s"||(x==="TRUE"?k={t:"b",v:!0}:x==="FALSE"?k={t:"b",v:!1}:isNaN(Zn(x))?isNaN(Cl(x).getDate())||(k={t:"d",v:er(x)},r.cellDates||(k={t:"n",v:Fr(k.v)}),k.z=r.dateNF||je[14]):k={t:"n",v:Zn(x)}),r.dense?(n[c]||(n[c]=[]),n[c][f]=k):n[Oe({r:c,c:f})]=k,f+=h}}}}return n["!ref"]=We(p),v.length&&(n["!merges"]=v),n}function xce(e,t,r,n){for(var a=e["!merges"]||[],s=[],i=t.s.c;i<=t.e.c;++i){for(var o=0,l=0,c=0;c<a.length;++c)if(!(a[c].s.r>r||a[c].s.c>i)&&!(a[c].e.r<r||a[c].e.c<i)){if(a[c].s.r<r||a[c].s.c<i){o=-1;break}o=a[c].e.r-a[c].s.r+1,l=a[c].e.c-a[c].s.c+1;break}if(!(o<0)){var f=Oe({r,c:i}),d=n.dense?(e[r]||[])[i]:e[f],h=d&&d.v!=null&&(d.h||ny(d.w||(ps(d),d.w)||""))||"",p={};o>1&&(p.rowspan=o),l>1&&(p.colspan=l),n.editable?h='<span contenteditable="true">'+h+"</span>":d&&(p["data-t"]=d&&d.t||"z",d.v!=null&&(p["data-v"]=d.v),d.z!=null&&(p["data-z"]=d.z),d.l&&(d.l.Target||"#").charAt(0)!="#"&&(h='<a href="'+d.l.Target+'">'+h+"</a>")),p.id=(n.id||"sjs")+"-"+f,s.push(are("td",h,p))}}var v="<tr>";return v+s.join("")+"</tr>"}var yce='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',_ce="</body></html>";function wce(e,t){var r=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!r||r.length==0)throw new Error("Invalid HTML: could not find <table>");if(r.length==1)return mi(nE(r[0],t),t);var n=wy();return r.forEach(function(a,s){by(n,nE(a,t),"Sheet"+(s+1))}),n}function bce(e,t,r){var n=[];return n.join("")+"<table"+(r&&r.id?' id="'+r.id+'"':"")+">"}function Ece(e,t){var r=t||{},n=r.header!=null?r.header:yce,a=r.footer!=null?r.footer:_ce,s=[n],i=tc(e["!ref"]);r.dense=Array.isArray(e),s.push(bce(e,i,r));for(var o=i.s.r;o<=i.e.r;++o)s.push(xce(e,i,o,r));return s.push("</table>"+a),s.join("")}function LA(e,t,r){var n=r||{},a=0,s=0;if(n.origin!=null)if(typeof n.origin=="number")a=n.origin;else{var i=typeof n.origin=="string"?Dr(n.origin):n.origin;a=i.r,s=i.c}var o=t.getElementsByTagName("tr"),l=Math.min(n.sheetRows||1e7,o.length),c={s:{r:0,c:0},e:{r:a,c:s}};if(e["!ref"]){var f=tc(e["!ref"]);c.s.r=Math.min(c.s.r,f.s.r),c.s.c=Math.min(c.s.c,f.s.c),c.e.r=Math.max(c.e.r,f.e.r),c.e.c=Math.max(c.e.c,f.e.c),a==-1&&(c.e.r=a=f.e.r+1)}var d=[],h=0,p=e["!rows"]||(e["!rows"]=[]),v=0,m=0,_=0,g=0,y=0,x=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&m<l;++v){var w=o[v];if(aE(w)){if(n.display)continue;p[m]={hidden:!0}}var E=w.children;for(_=g=0;_<E.length;++_){var S=E[_];if(!(n.display&&aE(S))){var b=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):P4(S.innerHTML),j=S.getAttribute("data-z")||S.getAttribute("z");for(h=0;h<d.length;++h){var k=d[h];k.s.c==g+s&&k.s.r<m+a&&m+a<=k.e.r&&(g=k.e.c+1-s,h=-1)}x=+S.getAttribute("colspan")||1,((y=+S.getAttribute("rowspan")||1)>1||x>1)&&d.push({s:{r:m+a,c:g+s},e:{r:m+a+(y||1)-1,c:g+s+(x||1)-1}});var C={t:"s",v:b},P=S.getAttribute("data-t")||S.getAttribute("t")||"";b!=null&&(b.length==0?C.t=P||"z":n.raw||b.trim().length==0||P=="s"||(b==="TRUE"?C={t:"b",v:!0}:b==="FALSE"?C={t:"b",v:!1}:isNaN(Zn(b))?isNaN(Cl(b).getDate())||(C={t:"d",v:er(b)},n.cellDates||(C={t:"n",v:Fr(C.v)}),C.z=n.dateNF||je[14]):C={t:"n",v:Zn(b)})),C.z===void 0&&j!=null&&(C.z=j);var I="",D=S.getElementsByTagName("A");if(D&&D.length)for(var K=0;K<D.length&&!(D[K].hasAttribute("href")&&(I=D[K].getAttribute("href"),I.charAt(0)!="#"));++K);I&&I.charAt(0)!="#"&&(C.l={Target:I}),n.dense?(e[m+a]||(e[m+a]=[]),e[m+a][g+s]=C):e[Oe({c:g+s,r:m+a})]=C,c.e.c<g+s&&(c.e.c=g+s),g+=x}}++m}return d.length&&(e["!merges"]=(e["!merges"]||[]).concat(d)),c.e.r=Math.max(c.e.r,m-1+a),e["!ref"]=We(c),m>=l&&(e["!fullref"]=We((c.e.r=o.length-v+m-1+a,c))),e}function $A(e,t){var r=t||{},n=r.dense?[]:{};return LA(n,e,t)}function Sce(e,t){return mi($A(e,t),t)}function aE(e){var t="",r=kce(e);return r&&(t=r(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function kce(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function Tce(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(n,a){return Array(parseInt(a,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),r=ze(t.replace(/<[^>]*>/g,""));return[r]}var sE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function BA(e,t){var r=t||{},n=ay(e),a=[],s,i,o={name:""},l="",c=0,f,d,h={},p=[],v=r.dense?[]:{},m,_,g={value:""},y="",x=0,w=[],E=-1,S=-1,b={s:{r:1e6,c:1e7},e:{r:0,c:0}},j=0,k={},C=[],P={},I=0,D=0,K=[],Q=1,z=1,q=[],ee={Names:[]},H={},ce=["",""],J=[],N={},F="",T=0,R=!1,G=!1,X=0;for(Gu.lastIndex=0,n=n.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");m=Gu.exec(n);)switch(m[3]=m[3].replace(/_.*$/,"")){case"table":case"工作表":m[1]==="/"?(b.e.c>=b.s.c&&b.e.r>=b.s.r?v["!ref"]=We(b):v["!ref"]="A1:A1",r.sheetRows>0&&r.sheetRows<=b.e.r&&(v["!fullref"]=v["!ref"],b.e.r=r.sheetRows-1,v["!ref"]=We(b)),C.length&&(v["!merges"]=C),K.length&&(v["!rows"]=K),f.name=f.名称||f.name,typeof JSON<"u"&&JSON.stringify(f),p.push(f.name),h[f.name]=v,G=!1):m[0].charAt(m[0].length-2)!=="/"&&(f=Ce(m[0],!1),E=S=-1,b.s.r=b.s.c=1e7,b.e.r=b.e.c=0,v=r.dense?[]:{},C=[],K=[],G=!0);break;case"table-row-group":m[1]==="/"?--j:++j;break;case"table-row":case"行":if(m[1]==="/"){E+=Q,Q=1;break}if(d=Ce(m[0],!1),d.行号?E=d.行号-1:E==-1&&(E=0),Q=+d["number-rows-repeated"]||1,Q<10)for(X=0;X<Q;++X)j>0&&(K[E+X]={level:j});S=-1;break;case"covered-table-cell":m[1]!=="/"&&++S,r.sheetStubs&&(r.dense?(v[E]||(v[E]=[]),v[E][S]={t:"z"}):v[Oe({r:E,c:S})]={t:"z"}),y="",w=[];break;case"table-cell":case"数据":if(m[0].charAt(m[0].length-2)==="/")++S,g=Ce(m[0],!1),z=parseInt(g["number-columns-repeated"]||"1",10),_={t:"z",v:null},g.formula&&r.cellFormula!=!1&&(_.f=Zb(ze(g.formula))),(g.数据类型||g["value-type"])=="string"&&(_.t="s",_.v=ze(g["string-value"]||""),r.dense?(v[E]||(v[E]=[]),v[E][S]=_):v[Oe({r:E,c:S})]=_),S+=z-1;else if(m[1]!=="/"){++S,y="",x=0,w=[],z=1;var Y=Q?E+Q-1:E;if(S>b.e.c&&(b.e.c=S),S<b.s.c&&(b.s.c=S),E<b.s.r&&(b.s.r=E),Y>b.e.r&&(b.e.r=Y),g=Ce(m[0],!1),J=[],N={},_={t:g.数据类型||g["value-type"],v:null},r.cellFormula)if(g.formula&&(g.formula=ze(g.formula)),g["number-matrix-columns-spanned"]&&g["number-matrix-rows-spanned"]&&(I=parseInt(g["number-matrix-rows-spanned"],10)||0,D=parseInt(g["number-matrix-columns-spanned"],10)||0,P={s:{r:E,c:S},e:{r:E+I-1,c:S+D-1}},_.F=We(P),q.push([P,_.F])),g.formula)_.f=Zb(g.formula);else for(X=0;X<q.length;++X)E>=q[X][0].s.r&&E<=q[X][0].e.r&&S>=q[X][0].s.c&&S<=q[X][0].e.c&&(_.F=q[X][1]);switch((g["number-columns-spanned"]||g["number-rows-spanned"])&&(I=parseInt(g["number-rows-spanned"],10)||0,D=parseInt(g["number-columns-spanned"],10)||0,P={s:{r:E,c:S},e:{r:E+I-1,c:S+D-1}},C.push(P)),g["number-columns-repeated"]&&(z=parseInt(g["number-columns-repeated"],10)),_.t){case"boolean":_.t="b",_.v=mt(g["boolean-value"]);break;case"float":_.t="n",_.v=parseFloat(g.value);break;case"percentage":_.t="n",_.v=parseFloat(g.value);break;case"currency":_.t="n",_.v=parseFloat(g.value);break;case"date":_.t="d",_.v=er(g["date-value"]),r.cellDates||(_.t="n",_.v=Fr(_.v)),_.z="m/d/yy";break;case"time":_.t="n",_.v=$te(g["time-value"])/86400,r.cellDates&&(_.t="d",_.v=fp(_.v)),_.z="HH:MM:SS";break;case"number":_.t="n",_.v=parseFloat(g.数据数值);break;default:if(_.t==="string"||_.t==="text"||!_.t)_.t="s",g["string-value"]!=null&&(y=ze(g["string-value"]),w=[]);else throw new Error("Unsupported value type "+_.t)}}else{if(R=!1,_.t==="s"&&(_.v=y||"",w.length&&(_.R=w),R=x==0),H.Target&&(_.l=H),J.length>0&&(_.c=J,J=[]),y&&r.cellText!==!1&&(_.w=y),R&&(_.t="z",delete _.v),(!R||r.sheetStubs)&&!(r.sheetRows&&r.sheetRows<=E))for(var ae=0;ae<Q;++ae){if(z=parseInt(g["number-columns-repeated"]||"1",10),r.dense)for(v[E+ae]||(v[E+ae]=[]),v[E+ae][S]=ae==0?_:ir(_);--z>0;)v[E+ae][S+z]=ir(_);else for(v[Oe({r:E+ae,c:S})]=_;--z>0;)v[Oe({r:E+ae,c:S+z})]=ir(_);b.e.c<=S&&(b.e.c=S)}z=parseInt(g["number-columns-repeated"]||"1",10),S+=z-1,z=0,_={},y="",w=[]}H={};break;case"document":case"document-content":case"电子表格文档":case"spreadsheet":case"主体":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!0]);break;case"annotation":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s;N.t=y,w.length&&(N.R=w),N.a=F,J.push(N)}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);F="",T=0,y="",x=0,w=[];break;case"creator":m[1]==="/"?F=n.slice(T,m.index):T=m.index+m[0].length;break;case"meta":case"元数据":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(m[1]==="/"){if((s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&a.push([m[3],!1]);y="",x=0,w=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(m[1]==="/"){if(k[o.name]=l,(s=a.pop())[0]!==m[3])throw"Bad state: "+s}else m[0].charAt(m[0].length-2)!=="/"&&(l="",o=Ce(m[0],!1),a.push([m[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ce(m[0],!1),l+=sE[m[3]][i.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(a[a.length-1][0]){case"time-style":case"date-style":i=Ce(m[0],!1),l+=sE[m[3]][i.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(m[0].slice(-2)==="/>")break;if(m[1]==="/")switch(a[a.length-1][0]){case"number-style":case"date-style":case"time-style":l+=n.slice(c,m.index);break}else c=m.index+m[0].length;break;case"named-range":i=Ce(m[0],!1),ce=Om(i["cell-range-address"]);var oe={Name:i.name,Ref:ce[0]+"!"+ce[1]};G&&(oe.Sheet=p.length),ee.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"电子表格":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"文本串":if(["master-styles"].indexOf(a[a.length-1][0])>-1)break;if(m[1]==="/"&&(!g||!g["string-value"])){var ve=Tce(n.slice(x,m.index));y=(y.length>0?y+`
`:"")+ve[0]}else Ce(m[0],!1),x=m.index+m[0].length;break;case"s":break;case"database-range":if(m[1]==="/")break;try{ce=Om(Ce(m[0])["target-range-address"]),h[ce[0]]["!autofilter"]={ref:ce[1]}}catch{}break;case"date":break;case"object":break;case"title":case"标题":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(m[1]!=="/"){if(H=Ce(m[0],!1),!H.href)break;H.Target=ze(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(ce=Om(H.Target.slice(1)),H.Target="#"+ce[0]+"!"+ce[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(m[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case"表:":case"字:":break;default:if(r.WTF)throw new Error(m)}}var B={Sheets:h,SheetNames:p,Workbook:ee};return r.bookSheets&&delete B.Sheets,B}function iE(e,t){t=t||{},gn(e,"META-INF/manifest.xml")&&Wre(Mt(e,"META-INF/manifest.xml"),t);var r=en(e,"content.xml");if(!r)throw new Error("Missing content.xml in ODS / UOF file");var n=BA(st(r),t);return gn(e,"meta.xml")&&(n.Props=Z4(Mt(e,"meta.xml"))),n}function oE(e,t){return BA(e,t)}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function gy(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function _g(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):st(po(e))}function wg(e){var t=e.reduce(function(a,s){return a+s.length},0),r=new Uint8Array(t),n=0;return e.forEach(function(a){r.set(a,n),n+=a.length}),r}function lE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function Cce(e,t){for(var r=(e[t+15]&127)<<7|e[t+14]>>1,n=e[t+14]&1,a=t+13;a>=t;--a)n=n*256+e[a];return(e[t+15]&128?-n:n)*Math.pow(10,r-6176)}function Qu(e,t){var r=t?t[0]:0,n=e[r]&127;e:if(e[r++]>=128&&(n|=(e[r]&127)<<7,e[r++]<128||(n|=(e[r]&127)<<14,e[r++]<128)||(n|=(e[r]&127)<<21,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,28),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,35),++r,e[r++]<128)||(n+=(e[r]&127)*Math.pow(2,42),++r,e[r++]<128)))break e;return t&&(t[0]=r),n}function Yt(e){var t=0,r=e[t]&127;e:if(e[t++]>=128){if(r|=(e[t]&127)<<7,e[t++]<128||(r|=(e[t]&127)<<14,e[t++]<128)||(r|=(e[t]&127)<<21,e[t++]<128))break e;r|=(e[t]&127)<<28}return r}function xr(e){for(var t=[],r=[0];r[0]<e.length;){var n=r[0],a=Qu(e,r),s=a&7;a=Math.floor(a/8);var i=0,o;if(a==0)break;switch(s){case 0:{for(var l=r[0];e[r[0]++]>=128;);o=e.slice(l,r[0])}break;case 5:i=4,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 1:i=8,o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 2:i=Qu(e,r),o=e.slice(r[0],r[0]+i),r[0]+=i;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(a," at offset ").concat(n))}var c={data:o,type:s};t[a]==null?t[a]=[c]:t[a].push(c)}return t}function xy(e,t){return(e==null?void 0:e.map(function(r){return t(r.data)}))||[]}function Nce(e){for(var t,r=[],n=[0];n[0]<e.length;){var a=Qu(e,n),s=xr(e.slice(n[0],n[0]+a));n[0]+=a;var i={id:Yt(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=xr(o.data),c=Yt(l[3][0].data);i.messages.push({meta:l,data:e.slice(n[0],n[0]+c)}),n[0]+=c}),(t=s[3])!=null&&t[0]&&(i.merge=Yt(s[3][0].data)>>>0>0),r.push(i)}return r}function Ace(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var r=[0],n=Qu(t,r),a=[];r[0]<t.length;){var s=t[r[0]]&3;if(s==0){var i=t[r[0]++]>>2;if(i<60)++i;else{var o=i-59;i=t[r[0]],o>1&&(i|=t[r[0]+1]<<8),o>2&&(i|=t[r[0]+2]<<16),o>3&&(i|=t[r[0]+3]<<24),i>>>=0,i++,r[0]+=o}a.push(t.slice(r[0],r[0]+i)),r[0]+=i;continue}else{var l=0,c=0;if(s==1?(c=(t[r[0]]>>2&7)+4,l=(t[r[0]++]&224)<<3,l|=t[r[0]++]):(c=(t[r[0]++]>>2)+1,s==2?(l=t[r[0]]|t[r[0]+1]<<8,r[0]+=2):(l=(t[r[0]]|t[r[0]+1]<<8|t[r[0]+2]<<16|t[r[0]+3]<<24)>>>0,r[0]+=4)),a=[wg(a)],l==0)throw new Error("Invalid offset 0");if(l>a[0].length)throw new Error("Invalid offset beyond length");if(c>=l)for(a.push(a[0].slice(-l)),c-=l;c>=a[a.length-1].length;)a.push(a[a.length-1]),c-=a[a.length-1].length;a.push(a[0].slice(-l,-l+c))}}var f=wg(a);if(f.length!=n)throw new Error("Unexpected length: ".concat(f.length," != ").concat(n));return f}function Oce(e){for(var t=[],r=0;r<e.length;){var n=e[r++],a=e[r]|e[r+1]<<8|e[r+2]<<16;r+=3,t.push(Ace(n,e.slice(r,r+a))),r+=a}if(r!==e.length)throw new Error("data is not a valid framed stream!");return wg(t)}function Dce(e,t,r,n){var a=gy(e),s=a.getUint32(4,!0),i=(n>1?12:8)+lE(s&(n>1?3470:398))*4,o=-1,l=-1,c=NaN,f=new Date(2001,0,1);s&512&&(o=a.getUint32(i,!0),i+=4),i+=lE(s&(n>1?12288:4096))*4,s&16&&(l=a.getUint32(i,!0),i+=4),s&32&&(c=a.getFloat64(i,!0),i+=8),s&64&&(f.setTime(f.getTime()+a.getFloat64(i,!0)*1e3),i+=8);var d;switch(e[2]){case 0:break;case 2:d={t:"n",v:c};break;case 3:d={t:"s",v:t[l]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(o>-1)d={t:"s",v:r[o]};else if(l>-1)d={t:"s",v:t[l]};else if(!isNaN(c))d={t:"n",v:c};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return d}function jce(e,t,r){var n=gy(e),a=n.getUint32(8,!0),s=12,i=-1,o=-1,l=NaN,c=NaN,f=new Date(2001,0,1);a&1&&(l=Cce(e,s),s+=16),a&2&&(c=n.getFloat64(s,!0),s+=8),a&4&&(f.setTime(f.getTime()+n.getFloat64(s,!0)*1e3),s+=8),a&8&&(o=n.getUint32(s,!0),s+=4),a&16&&(i=n.getUint32(s,!0),s+=4);var d;switch(e[1]){case 0:break;case 2:d={t:"n",v:l};break;case 3:d={t:"s",v:t[o]};break;case 5:d={t:"d",v:f};break;case 6:d={t:"b",v:c>0};break;case 7:d={t:"n",v:c/86400};break;case 8:d={t:"e",v:0};break;case 9:if(i>-1)d={t:"s",v:r[i]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)));break;case 10:d={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(a&31," : ").concat(e.slice(0,4)))}return d}function Pce(e,t,r){switch(e[0]){case 0:case 1:case 2:case 3:return Dce(e,t,r,e[0]);case 5:return jce(e,t,r);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function Zs(e){var t=xr(e);return Qu(t[1][0].data)}function cE(e,t){var r=xr(t.data),n=Yt(r[1][0].data),a=r[3],s=[];return(a||[]).forEach(function(i){var o=xr(i.data),l=Yt(o[1][0].data)>>>0;switch(n){case 1:s[l]=_g(o[3][0].data);break;case 8:{var c=e[Zs(o[9][0].data)][0],f=xr(c.data),d=e[Zs(f[1][0].data)][0],h=Yt(d.meta[1][0].data);if(h!=2001)throw new Error("2000 unexpected reference to ".concat(h));var p=xr(d.data);s[l]=p[3].map(function(v){return _g(v.data)}).join("")}break}}),s}function Fce(e,t){var r,n,a,s,i,o,l,c,f,d,h,p,v,m,_=xr(e),g=Yt(_[1][0].data)>>>0,y=Yt(_[2][0].data)>>>0,x=((n=(r=_[8])==null?void 0:r[0])==null?void 0:n.data)&&Yt(_[8][0].data)>0||!1,w,E;if((s=(a=_[7])==null?void 0:a[0])!=null&&s.data&&t!=0)w=(o=(i=_[7])==null?void 0:i[0])==null?void 0:o.data,E=(c=(l=_[6])==null?void 0:l[0])==null?void 0:c.data;else if((d=(f=_[4])==null?void 0:f[0])!=null&&d.data&&t!=1)w=(p=(h=_[4])==null?void 0:h[0])==null?void 0:p.data,E=(m=(v=_[3])==null?void 0:v[0])==null?void 0:m.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=x?4:1,b=gy(w),j=[],k=0;k<w.length/2;++k){var C=b.getUint16(k*2,!0);C<65535&&j.push([k,C])}if(j.length!=y)throw"Expected ".concat(y," cells, found ").concat(j.length);var P=[];for(k=0;k<j.length-1;++k)P[j[k][0]]=E.subarray(j[k][1]*S,j[k+1][1]*S);return j.length>=1&&(P[j[j.length-1][0]]=E.subarray(j[j.length-1][1]*S)),{R:g,cells:P}}function Rce(e,t){var r,n=xr(t.data),a=(r=n==null?void 0:n[7])!=null&&r[0]?Yt(n[7][0].data)>>>0>0?1:0:-1,s=xy(n[5],function(i){return Fce(i,a)});return{nrows:Yt(n[4][0].data)>>>0,data:s.reduce(function(i,o){return i[o.R]||(i[o.R]=[]),o.cells.forEach(function(l,c){if(i[o.R][c])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(c));i[o.R][c]=l}),i},[])}}function Mce(e,t,r){var n,a=xr(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(Yt(a[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(a[6][0].data));if(s.e.c=(Yt(a[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(a[7][0].data));r["!ref"]=We(s);var i=xr(a[4][0].data),o=cE(e,e[Zs(i[4][0].data)][0]),l=(n=i[17])!=null&&n[0]?cE(e,e[Zs(i[17][0].data)][0]):[],c=xr(i[3][0].data),f=0;c[1].forEach(function(d){var h=xr(d.data),p=e[Zs(h[2][0].data)][0],v=Yt(p.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var m=Rce(e,p);m.data.forEach(function(_,g){_.forEach(function(y,x){var w=Oe({r:f+g,c:x}),E=Pce(y,o,l);E&&(r[w]=E)})}),f+=m.nrows})}function Ice(e,t){var r=xr(t.data),n={"!ref":"A1"},a=e[Zs(r[2][0].data)],s=Yt(a[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return Mce(e,a[0],n),n}function Lce(e,t){var r,n=xr(t.data),a={name:(r=n[1])!=null&&r[0]?_g(n[1][0].data):"",sheets:[]},s=xy(n[2],Zs);return s.forEach(function(i){e[i].forEach(function(o){var l=Yt(o.meta[1][0].data);l==6e3&&a.sheets.push(Ice(e,o))})}),a}function $ce(e,t){var r=wy(),n=xr(t.data),a=xy(n[1],Zs);if(a.forEach(function(s){e[s].forEach(function(i){var o=Yt(i.meta[1][0].data);if(o==2){var l=Lce(e,i);l.sheets.forEach(function(c,f){by(r,c,f==0?l.name:l.name+"_"+f,!0)})}})}),r.SheetNames.length==0)throw new Error("Empty NUMBERS file");return r}function jm(e){var t,r,n,a,s={},i=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var c;try{c=Oce(l.content)}catch(d){return console.log("?? "+l.content.length+" "+(d.message||d))}var f;try{f=Nce(c)}catch(d){return console.log("## "+(d.message||d))}f.forEach(function(d){s[d.id]=d.messages,i.push(d.id)})}}),!i.length)throw new Error("File has no messages");var o=((a=(n=(r=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:r.meta)==null?void 0:n[1])==null?void 0:a[0].data)&&Yt(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||i.forEach(function(l){s[l].forEach(function(c){var f=Yt(c.meta[1][0].data)>>>0;if(f==1)if(!o)o=c;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return $ce(s,o)}function Bce(e){return function(r){for(var n=0;n!=e.length;++n){var a=e[n];r[a[0]]===void 0&&(r[a[0]]=a[1]),a[2]==="n"&&(r[a[0]]=Number(r[a[0]]))}}}function yy(e){Bce([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function Uce(e){return Go.WS.indexOf(e)>-1?"sheet":e==Go.CS?"chart":e==Go.DS?"dialog":e==Go.MS?"macro":e&&e.length?e:"sheet"}function Wce(e,t){if(!e)return 0;try{e=t.map(function(n){return n.id||(n.id=n.strRelID),[n.name,e["!id"][n.id].Target,Uce(e["!id"][n.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function Vce(e,t,r,n,a,s,i,o,l,c,f,d){try{s[n]=Zc(en(e,r,!0),t);var h=Mt(e,t),p;switch(o){case"sheet":p=qle(h,t,a,l,s[n],c,f,d);break;case"chart":if(p=Xle(h,t,a,l,s[n],c,f,d),!p||!p["!drawel"])break;var v=jc(p["!drawel"].Target,t),m=mg(v),_=Kse(en(e,v,!0),Zc(en(e,m,!0),v)),g=jc(_,v),y=mg(g);p=jle(en(e,g,!0),g,l,Zc(en(e,y,!0),g),c,p);break;case"macro":p=Qle(h,t,a,l,s[n],c,f,d);break;case"dialog":p=Jle(h,t,a,l,s[n],c,f,d);break;default:throw new Error("Unrecognized sheet type "+o)}i[n]=p;var x=[];s&&s[n]&&Da(s[n]).forEach(function(w){var E="";if(s[n][w].Type==Go.CMNT){E=jc(s[n][w].Target,t);var S=rce(Mt(e,E,!0),E,l);if(!S||!S.length)return;Kb(p,S,!1)}s[n][w].Type==Go.TCMNT&&(E=jc(s[n][w].Target,t),x=x.concat(Xse(Mt(e,E,!0),l)))}),x&&x.length&&Kb(p,x,!0,l.people||[])}catch(w){if(l.WTF)throw w}}function mn(e){return e.charAt(0)=="/"?e.slice(1):e}function Hce(e,t){if(S4(),t=t||{},yy(t),gn(e,"META-INF/manifest.xml")||gn(e,"objectdata.xml"))return iE(e,t);if(gn(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof jm<"u"){if(e.FileIndex)return jm(e);var r=Ue.utils.cfb_new();return wb(e).forEach(function(K){zte(r,K,Hte(e,K))}),jm(r)}throw new Error("Unsupported NUMBERS file")}if(!gn(e,"[Content_Types].xml"))throw gn(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):gn(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var n=wb(e),a=Bre(en(e,"[Content_Types].xml")),s=!1,i,o;if(a.workbooks.length===0&&(o="xl/workbook.xml",Mt(e,o,!0)&&a.workbooks.push(o)),a.workbooks.length===0){if(o="xl/workbook.bin",!Mt(e,o,!0))throw new Error("Could not find workbook");a.workbooks.push(o),s=!0}a.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},c={};if(!t.bookSheets&&!t.bookProps){if(ru=[],a.sst)try{ru=tce(Mt(e,mn(a.sst)),a.sst,t)}catch(K){if(t.WTF)throw K}t.cellStyles&&a.themes.length&&(l=ece(en(e,a.themes[0].replace(/^\//,""),!0)||"",a.themes[0],t)),a.style&&(c=Zle(Mt(e,mn(a.style)),a.style,l,t))}a.links.map(function(K){try{var Q=Zc(en(e,mg(mn(K))),K);return ace(Mt(e,mn(K)),Q,K,t)}catch{}});var f=Kle(Mt(e,mn(a.workbooks[0])),a.workbooks[0],t),d={},h="";a.coreprops.length&&(h=Mt(e,mn(a.coreprops[0]),!0),h&&(d=Z4(h)),a.extprops.length!==0&&(h=Mt(e,mn(a.extprops[0]),!0),h&&zre(h,d,t)));var p={};(!t.bookSheets||t.bookProps)&&a.custprops.length!==0&&(h=en(e,mn(a.custprops[0]),!0),h&&(p=Gre(h,t)));var v={};if((t.bookSheets||t.bookProps)&&(f.Sheets?i=f.Sheets.map(function(Q){return Q.name}):d.Worksheets&&d.SheetNames.length>0&&(i=d.SheetNames),t.bookProps&&(v.Props=d,v.Custprops=p),t.bookSheets&&typeof i<"u"&&(v.SheetNames=i),t.bookSheets?v.SheetNames:t.bookProps))return v;i={};var m={};t.bookDeps&&a.calcchain&&(m=nce(Mt(e,mn(a.calcchain)),a.calcchain));var _=0,g={},y,x;{var w=f.Sheets;d.Worksheets=w.length,d.SheetNames=[];for(var E=0;E!=w.length;++E)d.SheetNames[E]=w[E].name}var S=s?"bin":"xml",b=a.workbooks[0].lastIndexOf("/"),j=(a.workbooks[0].slice(0,b+1)+"_rels/"+a.workbooks[0].slice(b+1)+".rels").replace(/^\//,"");gn(e,j)||(j="xl/_rels/workbook."+S+".rels");var k=Zc(en(e,j,!0),j.replace(/_rels.*/,"s5s"));(a.metadata||[]).length>=1&&(t.xlmeta=sce(Mt(e,mn(a.metadata[0])),a.metadata[0],t)),(a.people||[]).length>=1&&(t.people=Qse(Mt(e,mn(a.people[0])),t)),k&&(k=Wce(k,f.Sheets));var C=Mt(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(_=0;_!=d.Worksheets;++_){var P="sheet";if(k&&k[_]?(y="xl/"+k[_][1].replace(/[\/]?xl\//,""),gn(e,y)||(y=k[_][1]),gn(e,y)||(y=j.replace(/_rels\/.*$/,"")+k[_][1]),P=k[_][2]):(y="xl/worksheets/sheet"+(_+1-C)+"."+S,y=y.replace(/sheet0\./,"sheet.")),x=y.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(_!=t.sheets)continue e;break;case"string":if(d.SheetNames[_].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var I=!1,D=0;D!=t.sheets.length;++D)typeof t.sheets[D]=="number"&&t.sheets[D]==_&&(I=1),typeof t.sheets[D]=="string"&&t.sheets[D].toLowerCase()==d.SheetNames[_].toLowerCase()&&(I=1);if(!I)continue e}}Vce(e,y,x,d.SheetNames[_],_,g,i,P,t,f,l,c)}return v={Directory:a,Workbook:f,Props:d,Custprops:p,Deps:m,Sheets:i,SheetNames:d.SheetNames,Strings:ru,Styles:c,Themes:l,SSF:ir(je)},t&&t.bookFiles&&(e.files?(v.keys=n,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(K,Q){K=K.replace(/^Root Entry[\/]/,""),v.keys.push(K),v.files[K]=e.FileIndex[Q]}))),t&&t.bookVBA&&(a.vba.length>0?v.vbaraw=Mt(e,mn(a.vba[0]),!0):a.defaults&&a.defaults.bin===tie&&(v.vbaraw=Mt(e,"xl/vbaProject.bin",!0))),v}function zce(e,t){var r=t||{},n="Workbook",a=Ue.find(e,n);try{if(n="/!DataSpaces/Version",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(Iae(a.content),n="/!DataSpaces/DataSpaceMap",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var s=$ae(a.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var i=Bae(a.content);if(i.length!=1||i[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+n);if(n="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);Wae(a.content)}catch{}if(n="/EncryptionInfo",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);var o=Vae(a.content);if(n="/EncryptedPackage",a=Ue.find(e,n),!a||!a.content)throw new Error("ECMA-376 Encrypted file missing "+n);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],a.content,r.password||"",r);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],a.content,r.password||"",r);throw new Error("File is password-protected")}function _y(e,t){var r="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":r=ln(e.slice(0,12));break;case"binary":r=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[r.charCodeAt(0),r.charCodeAt(1),r.charCodeAt(2),r.charCodeAt(3),r.charCodeAt(4),r.charCodeAt(5),r.charCodeAt(6),r.charCodeAt(7)]}function Yce(e,t){return Ue.find(e,"EncryptedPackage")?zce(e,t):IA(e,t)}function Gce(e,t){var r,n=e,a=t||{};return a.type||(a.type=Be&&Buffer.isBuffer(e)?"buffer":"base64"),r=O4(n,a),Hce(r,a)}function UA(e,t){var r=0;e:for(;r<e.length;)switch(e.charCodeAt(r)){case 10:case 13:case 32:++r;break;case 60:return xg(e.slice(r),t);default:break e}return Ku.to_workbook(e,t)}function Kce(e,t){var r="",n=_y(e,t);switch(t.type){case"base64":r=ln(e);break;case"binary":r=e;break;case"buffer":r=e.toString("binary");break;case"array":r=to(e);break;default:throw new Error("Unrecognized type "+t.type)}return n[0]==239&&n[1]==187&&n[2]==191&&(r=st(r)),t.type="binary",UA(r,t)}function qce(e,t){var r=e;return t.type=="base64"&&(r=ln(r)),r=dg.utils.decode(1200,r.slice(2),"str"),t.type="binary",UA(r,t)}function Xce(e){return e.match(/[^\x00-\x7F]/)?Pc(e):e}function Pm(e,t,r,n){return n?(r.type="string",Ku.to_workbook(e,r)):Ku.to_workbook(t,r)}function bg(e,t){d4();var r=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return bg(new Uint8Array(e),(r=ir(r),r.type="array",r));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!r.type&&(r.type=typeof Deno<"u"?"buffer":"array");var n=e,a=[0,0,0,0],s=!1;if(r.cellStyles&&(r.cellNF=!0,r.sheetStubs=!0),ul={},r.dateNF&&(ul.dateNF=r.dateNF),r.type||(r.type=Be&&Buffer.isBuffer(e)?"buffer":"base64"),r.type=="file"&&(r.type=Be?"buffer":"binary",n=Ite(e),typeof Uint8Array<"u"&&!Be&&(r.type="array")),r.type=="string"&&(s=!0,r.type="binary",r.codepage=65001,n=Xce(e)),r.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var i=new ArrayBuffer(3),o=new Uint8Array(i);if(o.foo="bar",!o.foo)return r=ir(r),r.type="array",bg(J1(n),r)}switch((a=_y(n,r))[0]){case 208:if(a[1]===207&&a[2]===17&&a[3]===224&&a[4]===161&&a[5]===177&&a[6]===26&&a[7]===225)return Yce(Ue.read(n,r),r);break;case 9:if(a[1]<=8)return IA(n,r);break;case 60:return xg(n,r);case 73:if(a[1]===73&&a[2]===42&&a[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(a[1]===68)return Sae(n,r);break;case 84:if(a[1]===65&&a[2]===66&&a[3]===76)return bae.to_workbook(n,r);break;case 80:return a[1]===75&&a[2]<9&&a[3]<9?Gce(n,r):Pm(e,n,r,s);case 239:return a[3]===60?xg(n,r):Pm(e,n,r,s);case 255:if(a[1]===254)return qce(n,r);if(a[1]===0&&a[2]===2&&a[3]===0)return tu.to_workbook(n,r);break;case 0:if(a[1]===0&&(a[2]>=2&&a[3]===0||a[2]===0&&(a[3]===8||a[3]===9)))return tu.to_workbook(n,r);break;case 3:case 131:case 139:case 140:return Gb.to_workbook(n,r);case 123:if(a[1]===92&&a[2]===114&&a[3]===116)return tse.to_workbook(n,r);break;case 10:case 13:case 32:return Kce(n,r);case 137:if(a[1]===80&&a[2]===78&&a[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return _ae.indexOf(a[0])>-1&&a[2]<=12&&a[3]<=31?Gb.to_workbook(n,r):Pm(e,n,r,s)}function Qce(e,t,r,n,a,s,i,o){var l=or(r),c=o.defval,f=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),d=!0,h=a===1?[]:{};if(a!==1)if(Object.defineProperty)try{Object.defineProperty(h,"__rowNum__",{value:r,enumerable:!1})}catch{h.__rowNum__=r}else h.__rowNum__=r;if(!i||e[r])for(var p=t.s.c;p<=t.e.c;++p){var v=i?e[r][p]:e[n[p]+l];if(v===void 0||v.t===void 0){if(c===void 0)continue;s[p]!=null&&(h[s[p]]=c);continue}var m=v.v;switch(v.t){case"z":if(m==null)break;continue;case"e":m=m==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[p]!=null){if(m==null)if(v.t=="e"&&m===null)h[s[p]]=null;else if(c!==void 0)h[s[p]]=c;else if(f&&m===null)h[s[p]]=null;else continue;else h[s[p]]=f&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?m:ps(v,m,o);m!=null&&(d=!1)}}return{row:h,isempty:d}}function Eg(e,t){if(e==null||e["!ref"]==null)return[];var r={t:"n",v:0},n=0,a=1,s=[],i=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},c=t||{},f=c.range!=null?c.range:e["!ref"];switch(c.header===1?n=1:c.header==="A"?n=2:Array.isArray(c.header)?n=3:c.header==null&&(n=0),typeof f){case"string":l=Nt(f);break;case"number":l=Nt(e["!ref"]),l.s.r=f;break;default:l=f}n>0&&(a=0);var d=or(l.s.r),h=[],p=[],v=0,m=0,_=Array.isArray(e),g=l.s.r,y=0,x={};_&&!e[g]&&(e[g]=[]);var w=c.skipHidden&&e["!cols"]||[],E=c.skipHidden&&e["!rows"]||[];for(y=l.s.c;y<=l.e.c;++y)if(!(w[y]||{}).hidden)switch(h[y]=zt(y),r=_?e[g][y]:e[h[y]+d],n){case 1:s[y]=y-l.s.c;break;case 2:s[y]=h[y];break;case 3:s[y]=c.header[y-l.s.c];break;default:if(r==null&&(r={w:"__EMPTY",t:"s"}),o=i=ps(r,null,c),m=x[i]||0,!m)x[i]=1;else{do o=i+"_"+m++;while(x[o]);x[i]=m,x[o]=1}s[y]=o}for(g=l.s.r+a;g<=l.e.r;++g)if(!(E[g]||{}).hidden){var S=Qce(e,l,g,h,n,s,_,c);(S.isempty===!1||(n===1?c.blankrows!==!1:c.blankrows))&&(p[v++]=S.row)}return p.length=v,p}var uE=/"/g;function Jce(e,t,r,n,a,s,i,o){for(var l=!0,c=[],f="",d=or(r),h=t.s.c;h<=t.e.c;++h)if(n[h]){var p=o.dense?(e[r]||[])[h]:e[n[h]+d];if(p==null)f="";else if(p.v!=null){l=!1,f=""+(o.rawNumbers&&p.t=="n"?p.v:ps(p,null,o));for(var v=0,m=0;v!==f.length;++v)if((m=f.charCodeAt(v))===a||m===s||m===34||o.forceQuotes){f='"'+f.replace(uE,'""')+'"';break}f=="ID"&&(f='"ID"')}else p.f!=null&&!p.F?(l=!1,f="="+p.f,f.indexOf(",")>=0&&(f='"'+f.replace(uE,'""')+'"')):f="";c.push(f)}return o.blankrows===!1&&l?null:c.join(i)}function WA(e,t){var r=[],n=t??{};if(e==null||e["!ref"]==null)return"";var a=Nt(e["!ref"]),s=n.FS!==void 0?n.FS:",",i=s.charCodeAt(0),o=n.RS!==void 0?n.RS:`
`,l=o.charCodeAt(0),c=new RegExp((s=="|"?"\\|":s)+"+$"),f="",d=[];n.dense=Array.isArray(e);for(var h=n.skipHidden&&e["!cols"]||[],p=n.skipHidden&&e["!rows"]||[],v=a.s.c;v<=a.e.c;++v)(h[v]||{}).hidden||(d[v]=zt(v));for(var m=0,_=a.s.r;_<=a.e.r;++_)(p[_]||{}).hidden||(f=Jce(e,a,_,d,i,l,s,n),f!=null&&(n.strip&&(f=f.replace(c,"")),(f||n.blankrows!==!1)&&r.push((m++?o:"")+f)));return delete n.dense,r.join("")}function Zce(e,t){t||(t={}),t.FS="	",t.RS=`
`;var r=WA(e,t);return r}function eue(e){var t="",r,n="";if(e==null||e["!ref"]==null)return[];var a=Nt(e["!ref"]),s="",i=[],o,l=[],c=Array.isArray(e);for(o=a.s.c;o<=a.e.c;++o)i[o]=zt(o);for(var f=a.s.r;f<=a.e.r;++f)for(s=or(f),o=a.s.c;o<=a.e.c;++o)if(t=i[o]+s,r=c?(e[f]||[])[o]:e[t],n="",r!==void 0){if(r.F!=null){if(t=r.F,!r.f)continue;n=r.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(r.f!=null)n=r.f;else{if(r.t=="z")continue;if(r.t=="n"&&r.v!=null)n=""+r.v;else if(r.t=="b")n=r.v?"TRUE":"FALSE";else if(r.w!==void 0)n="'"+r.w;else{if(r.v===void 0)continue;r.t=="s"?n="'"+r.v:n=""+r.v}}l[l.length]=t+"="+n}return l}function VA(e,t,r){var n=r||{},a=+!n.skipHeader,s=e||{},i=0,o=0;if(s&&n.origin!=null)if(typeof n.origin=="number")i=n.origin;else{var l=typeof n.origin=="string"?Dr(n.origin):n.origin;i=l.r,o=l.c}var c,f={s:{c:0,r:0},e:{c:o,r:i+t.length-1+a}};if(s["!ref"]){var d=Nt(s["!ref"]);f.e.c=Math.max(f.e.c,d.e.c),f.e.r=Math.max(f.e.r,d.e.r),i==-1&&(i=d.e.r+1,f.e.r=i+t.length-1+a)}else i==-1&&(i=0,f.e.r=t.length-1+a);var h=n.header||[],p=0;t.forEach(function(m,_){Da(m).forEach(function(g){(p=h.indexOf(g))==-1&&(h[p=h.length]=g);var y=m[g],x="z",w="",E=Oe({c:o+p,r:i+_+a});c=Ju(s,E),y&&typeof y=="object"&&!(y instanceof Date)?s[E]=y:(typeof y=="number"?x="n":typeof y=="boolean"?x="b":typeof y=="string"?x="s":y instanceof Date?(x="d",n.cellDates||(x="n",y=Fr(y)),w=n.dateNF||je[14]):y===null&&n.nullError&&(x="e",y=0),c?(c.t=x,c.v=y,delete c.w,delete c.R,w&&(c.z=w)):s[E]=c={t:x,v:y},w&&(c.z=w))})}),f.e.c=Math.max(f.e.c,o+h.length-1);var v=or(i);if(a)for(p=0;p<h.length;++p)s[zt(p+o)+v]={t:"s",v:h[p]};return s["!ref"]=We(f),s}function tue(e,t){return VA(null,e,t)}function Ju(e,t,r){if(typeof t=="string"){if(Array.isArray(e)){var n=Dr(t);return e[n.r]||(e[n.r]=[]),e[n.r][n.c]||(e[n.r][n.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ju(e,Oe(t)):Ju(e,Oe({r:t,c:r||0}))}function rue(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var r=e.SheetNames.indexOf(t);if(r>-1)return r;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function wy(){return{SheetNames:[],Sheets:{}}}function by(e,t,r,n){var a=1;if(!r)for(;a<=65535&&e.SheetNames.indexOf(r="Sheet"+a)!=-1;++a,r=void 0);if(!r||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(n&&e.SheetNames.indexOf(r)>=0){var s=r.match(/(^.*?)(\d+)$/);a=s&&+s[2]||0;var i=s&&s[1]||r;for(++a;a<=65535&&e.SheetNames.indexOf(r=i+a)!=-1;++a);}if(Ble(r),e.SheetNames.indexOf(r)>=0)throw new Error("Worksheet with name |"+r+"| already exists!");return e.SheetNames.push(r),e.Sheets[r]=t,r}function nue(e,t,r){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var n=rue(e,t);switch(e.Workbook.Sheets[n]||(e.Workbook.Sheets[n]={}),r){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+r)}e.Workbook.Sheets[n].Hidden=r}function aue(e,t){return e.z=t,e}function HA(e,t,r){return t?(e.l={Target:t},r&&(e.l.Tooltip=r)):delete e.l,e}function sue(e,t,r){return HA(e,"#"+t,r)}function iue(e,t,r){e.c||(e.c=[]),e.c.push({t,a:r||"SheetJS"})}function oue(e,t,r,n){for(var a=typeof t!="string"?t:Nt(t),s=typeof t=="string"?t:We(t),i=a.s.r;i<=a.e.r;++i)for(var o=a.s.c;o<=a.e.c;++o){var l=Ju(e,i,o);l.t="n",l.F=s,delete l.v,i==a.s.r&&o==a.s.c&&(l.f=r,n&&(l.D=!0))}return e}var lue={encode_col:zt,encode_row:or,encode_cell:Oe,encode_range:We,decode_col:oy,decode_row:iy,split_cell:yre,decode_cell:Dr,decode_range:tc,format_cell:ps,sheet_add_aoa:K4,sheet_add_json:VA,sheet_add_dom:LA,aoa_to_sheet:rc,json_to_sheet:tue,table_to_sheet:$A,table_to_book:Sce,sheet_to_csv:WA,sheet_to_txt:Zce,sheet_to_json:Eg,sheet_to_html:Ece,sheet_to_formulae:eue,sheet_to_row_object_array:Eg,sheet_get_cell:Ju,book_new:wy,book_append_sheet:by,book_set_sheet_visibility:nue,cell_set_number_format:aue,cell_set_hyperlink:HA,cell_set_internal_link:sue,cell_add_comment:iue,sheet_set_array_formula:oue,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};function cue(){const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,s]=O.useState(null),[i,o]=O.useState(!1);O.useEffect(()=>{(async()=>{try{n(!0);const{data:h,error:p}=await ie.from("contacts").select("*").eq("status","open");if(p)throw p;t(h||[])}catch(h){console.error("Error fetching contacts:",h)}finally{n(!1)}})()},[]);const l=d=>{d.target.files&&d.target.files.length>0&&s(d.target.files[0])},c=async()=>{if(a){o(!0);try{const d=await a.arrayBuffer(),h=bg(d),p=h.Sheets[h.SheetNames[0]],m=lue.sheet_to_json(p).map(y=>({client:y.Client||y.client||"",name:y.Name||y.name||"",contact_name:y["Contact Name"]||y.contact_name||y.Contact||"",email:y.Email||y.email||"",phone_number:y["Phone Number"]||y.phone_number||y.Phone||"",status:"open"})),{data:_,error:g}=await ie.from("contacts").insert(m).select();if(g)throw g;t([...e,..._]),alert(`${_.length} contacts imported successfully!`),s(null)}catch(d){console.error("Error processing file:",d),alert("Error importing contacts. Please check the file format.")}finally{o(!1)}}},f=async d=>{try{const{error:h}=await ie.from("contacts").update({status:"close"}).eq("id",d);if(h)throw h;t(e.filter(p=>p.id!==d)),alert("Call Done")}catch(h){console.error("Error updating contact:",h),alert("Failed to update contact")}};return r?u.jsx("div",{className:"text-center py-8",children:"Loading contacts..."}):u.jsxs("div",{className:"container mx-auto p-4",children:[u.jsx("h1",{className:"text-2xl font-bold mb-6",children:"Excel Data Import"}),u.jsxs("div",{className:"bg-white p-4 rounded-lg shadow-md mb-6",children:[u.jsx("h2",{className:"text-lg font-semibold mb-3",children:"Upload Excel File"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center",children:[u.jsxs("div",{className:"flex-1 w-full",children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Select Excel File"}),u.jsx("input",{type:"file",accept:".xlsx, .xls, .csv",onChange:l,className:`block w-full text-sm text-gray-500
                file:mr-4 file:py-2 file:px-4
                file:rounded-md file:border-0
                file:text-sm file:font-semibold
                file:bg-blue-50 file:text-blue-700
                hover:file:bg-blue-100`,disabled:i})]}),u.jsx("button",{onClick:c,disabled:!a||i,className:"bg-blue-600 hover:bg-blue-700 text-white font-medium py-2 px-4 rounded disabled:opacity-50 disabled:cursor-not-allowed mt-6 sm:mt-0",children:i?"Uploading...":"Import Data"})]}),u.jsx("p",{className:"mt-2 text-sm text-gray-500",children:"Supported formats: .xlsx, .xls, .csv. File should contain columns for Client, Name, Contact Name, Email, and Phone Number."})]}),e.length>0?u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contact"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Email"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Phone"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:e.map(d=>u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.client}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.contact_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.email}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:d.phone_number}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:u.jsx("button",{onClick:()=>d.id&&f(d.id),className:"text-blue-600 hover:text-blue-900",children:"Mark Done"})})]},d.id))})]})})}):u.jsx("div",{className:"bg-white p-8 rounded-lg shadow-md text-center",children:u.jsx("p",{className:"text-gray-500",children:"No contacts found. Upload an Excel file to get started."})})]})}function uue(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[f,d]=O.useState(null),[h,p]=O.useState([]),[v,m]=O.useState(""),[_,g]=O.useState([]),y=Pn(),x=Qe(C=>C.role),w=Qe(C=>C.user);O.useEffect(()=>{E(),(x==="e.head"||x==="e.employee")&&b()},[x,w==null?void 0:w.id]),O.useEffect(()=>{S()},[e,r]);async function E(){try{if(x==="e.employee"&&(w!=null&&w.id)){const{data:C,error:P}=await ie.from("client_assignments").select("client:clients(*, client_assignments(employee_id))").eq("employee_id",w.id).eq("client.status","poreceived");if(P)throw P;const I=(C==null?void 0:C.map(D=>D.client).filter(D=>D!==null))||[];t(I)}else if(x==="e.head"||x==="admin"){const{data:C,error:P}=await ie.from("clients").select("*, client_assignments(employee_id)").eq("status","poreceived");if(P)throw P;t(C||[])}}catch(C){console.error("Error loading clients:",C)}}const S=()=>{if(!r){s(e);return}const C=e.filter(P=>{var I,D,K;return((I=P==null?void 0:P.name)==null?void 0:I.toLowerCase().includes(r.toLowerCase()))||((D=P==null?void 0:P.company)==null?void 0:D.toLowerCase().includes(r.toLowerCase()))||((K=P==null?void 0:P.address)==null?void 0:K.toLowerCase().includes(r.toLowerCase()))});s(C)};async function b(){const{data:C,error:P}=await ie.from("employees").select("*").eq("role","e.employee");if(P){console.error("Error loading employees:",P);return}p(C||[])}async function j(){if(f)try{const C=_.map(I=>({client_id:f.id,employee_id:I}));await ie.from("client_assignments").delete().eq("client_id",f.id);const{error:P}=await ie.from("client_assignments").insert(C);if(P)throw P;c(!1),E()}catch(C){console.error("Error assigning employees:",C)}}const k=h.filter(C=>{var P;return(P=C==null?void 0:C.full_name)==null?void 0:P.toLowerCase().includes(v.toLowerCase())});return u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"PO Received Clients"}),u.jsx("div",{className:"flex items-center space-x-4",children:u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Clients",value:r,onChange:C=>n(C.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]})})]}),a.length===0?u.jsx("div",{className:"text-center py-12",children:u.jsx("p",{className:"text-gray-500",children:"No PO received clients found"})}):u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(C=>C&&u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:C.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:C.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:C.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>y(`/eclients/${C.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),(x==="e.head"||x==="admin")&&u.jsxs("button",{onClick:()=>{var P;d(C),g(((P=C.client_assignments)==null?void 0:P.map(I=>I.employee_id))||[]),c(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Yi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},C.id))}),l&&f&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsxs("h2",{className:"text-xl font-bold mb-4",children:["Assign Employees to ",f.name]}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:v,onChange:C=>m(C.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:_,onChange:C=>{const P=Array.from(C.target.selectedOptions,I=>I.value);g(P)},className:"w-full p-2 border rounded h-40",size:5,children:k.map(C=>u.jsx("option",{value:C.id,children:C.full_name},C.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:j,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}function fue(){const[e,t]=O.useState([]),[r,n]=O.useState(""),[a,s]=O.useState([]),[i,o]=O.useState(!1),[l,c]=O.useState(!1),[f,d]=O.useState(null),[h,p]=O.useState([]),[v,m]=O.useState(""),[_,g]=O.useState([]),y=Pn(),x=Qe(k=>k.role);Qe(k=>k.user),O.useEffect(()=>{w(),x==="finance.employee"&&S()},[x]),O.useEffect(()=>{E()},[e,r]);async function w(){const{data:k,error:C}=await ie.from("clients").select("*, client_assignments(employee_id)").eq("status","ecomplete");if(C){console.error("Error loading clients:",C);return}t(k||[])}const E=()=>{if(!r){s(e);return}const k=e.filter(C=>C.name.toLowerCase().includes(r.toLowerCase())||C.company.toLowerCase().includes(r.toLowerCase())||C.address.toLowerCase().includes(r.toLowerCase()));s(k)};async function S(){const{data:k,error:C}=await ie.from("employees").select("*").eq("role","finance.employee");if(C){console.error("Error loading employees:",C);return}p(k||[])}async function b(){if(!f)return;const k=_.map(P=>({client_id:f.id,employee_id:P})),{error:C}=await ie.from("client_assignments").insert(k);if(C){console.error("Error assigning employees:",C);return}c(!1),w()}const j=h.filter(k=>k.full_name.toLowerCase().includes(v.toLowerCase()));return u.jsxs("div",{className:"container mx-auto px-4",children:[u.jsxs("div",{className:"flex justify-between items-center mb-6",children:[u.jsx("h1",{className:"text-2xl font-bold text-white-800",children:"FClients"}),u.jsx("div",{className:"flex items-center",children:u.jsxs("div",{className:"relative mr-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search FClients",value:r,onChange:k=>n(k.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]})})]}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(k=>u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[u.jsx("h3",{className:"text-xl font-semibold text-gray-800 mb-2",children:k.name}),u.jsx("p",{className:"text-gray-600 mb-4",children:k.company}),u.jsx("p",{className:"text-gray-500 text-sm mb-4",children:k.address}),u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsx("button",{onClick:()=>y(`/fclients/${k.id}`),className:"text-blue-600 hover:text-blue-800",children:"View Details"}),x==="head"&&u.jsxs("button",{onClick:()=>{d(k),c(!0)},className:"flex items-center text-gray-600 hover:text-gray-800",children:[u.jsx(Yi,{className:"w-4 h-4 mr-1"}),"Assign"]})]})]},k.id))}),l&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Assign Employees"}),u.jsxs("div",{className:"relative mb-4",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search Employees",value:v,onChange:k=>m(k.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-white-50 focus:ring-blue-500 focus:border-blue-500 dark:bg-white-700 dark:border-gray-600 dark:placeholder-gray-800 dark:text-white dark:focus:ring-blue-500 dark:focus:border-blue-500"})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Select Employees"}),u.jsx("select",{multiple:!0,value:_,onChange:k=>{const C=Array.from(k.target.selectedOptions,P=>P.value);g(C)},className:"w-full p-2 border rounded",children:j.map(k=>u.jsx("option",{value:k.id,children:k.full_name},k.id))})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>c(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Cancel"}),u.jsx("button",{onClick:b,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Assign"})]})]})})]})}const due=()=>{const[e,t]=O.useState({client_id:"",employee_id:"",document_type:"",description:"",file:null}),[r,n]=O.useState(!1),[a,s]=O.useState(0),[i,o]=O.useState(null),[l,c]=O.useState(!1),[f,d]=O.useState([]),[h,p]=O.useState(!0),v=Qe(x=>x.user);O.useEffect(()=>{(async()=>{try{const{data:w,error:E}=await ie.from("clients").select("id, name").eq("status","ecomplete").order("name",{ascending:!0});if(E)throw E;d(w||[])}catch(w){console.error("Error fetching clients:",w),o("Failed to load client list")}finally{p(!1)}})()},[]);const m=x=>{const{name:w,value:E}=x.target;t({...e,[w]:E})},_=x=>{x.target.files&&x.target.files[0]&&t({...e,file:x.target.files[0]})},g=()=>{t({...e,file:null})},y=async x=>{if(x.preventDefault(),!e.file){o("Please select a file to upload");return}n(!0),o(null),c(!1);try{const w=e.file.name.split(".").pop(),S=`documents/${`${e.client_id}_${Date.now()}.${w}`}`,{error:b}=await ie.storage.from("documents").upload(S,e.file,{cacheControl:"3600",upsert:!1,contentType:e.file.type});if(b)throw b;const{data:j}=ie.storage.from("documents").getPublicUrl(S),{error:k}=await ie.from("documents").insert([{client_id:e.client_id,employee_id:(v==null?void 0:v.id)||e.employee_id,document_type:e.document_type,description:e.description,file_name:e.file.name,file_url:j.publicUrl,file_path:S,file_type:e.file.type,file_size:e.file.size}]);if(k)throw k;c(!0),t({client_id:"",employee_id:"",document_type:"",description:"",file:null})}catch(w){console.error("Error uploading document:",w),o(w instanceof Error?w.message:"Failed to upload document")}finally{n(!1)}};return u.jsxs("div",{className:"max-w-3xl mx-auto p-6 bg-white rounded-lg shadow-md",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Documents Upload"}),u.jsxs("form",{onSubmit:y,className:"space-y-4",children:[u.jsxs("div",{children:[u.jsx("label",{htmlFor:"client_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Client"}),h?u.jsx("select",{disabled:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm bg-gray-100",children:u.jsx("option",{children:"Loading clients..."})}):u.jsxs("select",{id:"client_id",name:"client_id",value:e.client_id,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select a client"}),f.map(x=>u.jsx("option",{value:x.id,children:x.name},x.id))]})]}),!(v!=null&&v.id)&&u.jsxs("div",{children:[u.jsx("label",{htmlFor:"employee_id",className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee ID"}),u.jsx("input",{type:"text",id:"employee_id",name:"employee_id",value:e.employee_id,onChange:m,required:!(v!=null&&v.id),className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"document_type",className:"block text-sm font-medium text-gray-700 mb-1",children:"Document Type"}),u.jsxs("select",{id:"document_type",name:"document_type",value:e.document_type,onChange:m,required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500",children:[u.jsx("option",{value:"",children:"Select document type"}),u.jsx("option",{value:"invoice",children:"Invoice"}),u.jsx("option",{value:"contract",children:"Contract"}),u.jsx("option",{value:"proposal",children:"Proposal"}),u.jsx("option",{value:"report",children:"Report"}),u.jsx("option",{value:"other",children:"Other"})]})]}),u.jsxs("div",{children:[u.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),u.jsx("textarea",{id:"description",name:"description",value:e.description,onChange:m,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Document File"}),e.file?u.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-300 rounded-md bg-gray-50",children:[u.jsxs("div",{className:"flex items-center",children:[u.jsx(al,{className:"h-5 w-5 text-gray-400 mr-2"}),u.jsx("span",{className:"text-sm font-medium text-gray-700",children:e.file.name})]}),u.jsx("button",{type:"button",onClick:g,className:"text-gray-500 hover:text-gray-700",children:u.jsx(Bl,{className:"h-5 w-5"})})]}):u.jsx("div",{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md",children:u.jsxs("div",{className:"space-y-1 text-center",children:[u.jsx("div",{className:"flex justify-center",children:u.jsx(Bx,{className:"mx-auto h-12 w-12 text-gray-400"})}),u.jsxs("div",{className:"flex text-sm text-gray-600",children:[u.jsxs("label",{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-blue-600 hover:text-blue-500 focus-within:outline-none",children:[u.jsx("span",{children:"Upload a file"}),u.jsx("input",{id:"file-upload",name:"file-upload",type:"file",onChange:_,className:"sr-only",required:!0})]}),u.jsx("p",{className:"pl-1",children:"or drag and drop"})]}),u.jsx("p",{className:"text-xs text-gray-500",children:"PDF, DOCX, XLSX, JPG, PNG up to 10MB"})]})})]}),r&&u.jsxs("div",{className:"pt-1",children:[u.jsxs("div",{className:"flex justify-between text-sm text-gray-600 mb-1",children:[u.jsx("span",{children:"Uploading..."}),u.jsxs("span",{children:[a,"%"]})]}),u.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:u.jsx("div",{className:"bg-blue-600 h-2.5 rounded-full",style:{width:`${a}%`}})})]}),i&&u.jsx("div",{className:"p-3 text-sm text-red-700 bg-red-100 rounded-md",children:i}),l&&u.jsx("div",{className:"p-3 text-sm text-green-700 bg-green-100 rounded-md",children:"Document uploaded successfully!"}),u.jsx("div",{className:"flex justify-end",children:u.jsx("button",{type:"submit",disabled:r,className:`px-4 py-2 rounded-md text-white ${r?"bg-blue-400":"bg-blue-600 hover:bg-blue-700"} focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500`,children:r?"Uploading...":"Upload Document"})})]})]})};function hue(){const{id:e}=Ml(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState([]),[c,f]=O.useState([]);Qe(p=>p.user),O.useEffect(()=>{e&&(d(),h())},[e]);async function d(){const{data:p}=await ie.from("clients").select("*").eq("id",e).single();r(p);const{data:v}=await ie.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(v||[]);const{data:m}=await ie.from("quotations").select(`
                *,
                employees (
                    full_name
                ),
                quotation_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});i(m||[]);const{data:_}=await ie.from("site_visits").select(`
                *,
                employees (
                    full_name
                ),
                site_visit_assets (
                    asset_id,
                    quantity,
                    assets (
                        item
                    )
                )
            `).eq("client_id",e).order("created_at",{ascending:!1});l(_||[])}async function h(){const{data:p}=await ie.from("assets").select("*").order("item");f(p||[])}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsx("div",{className:"flex justify-between items-start",children:u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]})})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(p=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:p.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:p.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),p.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(uf,{className:"w-4 h-4 mr-2"}),p.phone]})]})]},p.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Quotations"}),u.jsx("div",{className:"space-y-4",children:s.map(p=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"font-semibold text-gray-800",children:["Amount: $",p.amount]}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",p.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm",children:p.description}),u.jsx("div",{className:"mt-2",children:u.jsxs("p",{className:"text-sm text-gray-600",children:["Period: ",new Date(p.start_date).toLocaleDateString()," - ",new Date(p.end_date).toLocaleDateString()]})}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:p.quotation_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]})]}),u.jsx("div",{className:"flex flex-col gap-2",children:u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${p.status==="approved"?"bg-green-100 text-green-800":p.status==="rejected"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:p.status.charAt(0).toUpperCase()+p.status.slice(1)})})]})},p.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Site Visits"}),u.jsx("div",{className:"space-y-4",children:o.map(p=>u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between",children:[u.jsxs("div",{children:[u.jsx("p",{className:"font-semibold text-gray-800",children:p.address}),u.jsxs("p",{className:"text-gray-600 text-sm",children:["By: ",p.employees.full_name]}),u.jsx("p",{className:"text-gray-500 text-sm mt-2",children:p.notes}),u.jsxs("div",{className:"mt-2",children:[u.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Assets Used:"}),u.jsx("ul",{className:"list-disc list-inside text-sm text-gray-600",children:p.site_visit_assets.map(v=>u.jsxs("li",{children:[v.assets.item," (Qty: ",v.quantity,")"]},v.asset_id))})]}),u.jsxs("p",{className:"text-gray-600 text-sm mt-2",children:["Exit Location: ",p.exit_location]})]}),u.jsx("div",{className:"text-sm text-gray-500",children:new Date(p.created_at).toLocaleDateString()})]})},p.id))})]})]}):null}function pue(){const e=Pn(),[t,r]=O.useState([]),[n,a]=O.useState(!0),[s,i]=O.useState(""),[o,l]=O.useState(""),[c,f]=O.useState(""),[d,h]=O.useState("all"),[p,v]=O.useState(!1),[m,_]=O.useState({});O.useEffect(()=>{(async()=>{try{a(!0);const{data:b,error:j}=await ie.from("pd_kit_uploads").select(`
            id,
            file_path,
            uploaded_at,
            upload_type,
            visit_id
          `).order("uploaded_at",{ascending:!1});if(j)throw j;if(!b)return;const k=[...new Set(b.map(D=>D.visit_id))],{data:C,error:P}=await ie.from("site_visit").select(`
            id,
            created_at,
            client_Id,
            employee_Id,
            clients (id, name, company),
            employees (id, full_name)
          `).in("id",k);if(P)throw P;const I=b.map(D=>{var Q,z,q;const K=C==null?void 0:C.find(ee=>ee.id===D.visit_id);return K?{id:D.id,file_path:D.file_path,uploaded_at:D.uploaded_at,upload_type:D.upload_type,visit:{id:K.id,created_at:K.created_at,client:{id:K.client_id,name:((Q=K.clients)==null?void 0:Q.name)||"Unknown Client",company:((z=K.clients)==null?void 0:z.company)||""},employee:{id:K.employee_id,name:((q=K.employees)==null?void 0:q.full_name)||"Unknown Employee"}}}:{id:D.id,file_path:D.file_path,uploaded_at:D.uploaded_at,upload_type:D.upload_type,visit:{id:"",created_at:"",client:{id:"",name:"Unknown Client",company:""},employee:{id:"",name:"Unknown Employee"}}}});r(I)}catch(b){console.error("Error fetching PD kits:",b),i(b.message||"Failed to load PD kits")}finally{a(!1)}})()},[]);const g=async(S,b,j)=>{var k;try{a(!0);const{data:C,error:P}=await ie.storage.from("pd-kits").download(S);if(P)throw P;if(!C)throw new Error("No data received");const I=URL.createObjectURL(C),D=document.createElement("a");D.href=I;const K=((k=S.split(".").pop())==null?void 0:k.toLowerCase())||"jpg",Q=`pd-kit-${b}-${j}.${K}`;D.download=Q,document.body.appendChild(D),D.click(),setTimeout(()=>{document.body.removeChild(D),URL.revokeObjectURL(I)},100)}catch(C){console.error("Error downloading file:",C),i(C.message||"Failed to download file")}finally{a(!1)}},y=S=>{_(b=>({...b,[S]:!0}))},x=t.filter(S=>{const b=S.visit.client.name.toLowerCase().includes(o.toLowerCase())||S.visit.client.company.toLowerCase().includes(o.toLowerCase())||S.visit.employee.name.toLowerCase().includes(o.toLowerCase()),j=c?new Date(S.uploaded_at).toISOString().split("T")[0]===c:!0,k=d==="all"||S.upload_type===d;return b&&j&&k}),w=()=>{l(""),f(""),h("all")},E=S=>[".jpg",".jpeg",".png",".gif",".webp"].some(j=>S.toLowerCase().endsWith(j));return n?u.jsx("div",{className:"flex items-center justify-center h-screen",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):s?u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsx("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded relative",children:s}),u.jsxs("button",{onClick:()=>e(-1),className:"mt-4 px-4 py-2 bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(y6,{className:"w-4 h-4"}),"Go Back"]})]}):u.jsxs("div",{className:"container mx-auto px-4 py-8",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"All PD Kits"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, company or employee...",value:o,onChange:S=>l(S.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>v(!p),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(AT,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),p&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:w,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Bl,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dh,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:c,onChange:S=>f(S.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Type"}),u.jsxs("select",{value:d,onChange:S=>h(S.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"all",children:"All Types"}),u.jsx("option",{value:"start",children:"Start of Visit"}),u.jsx("option",{value:"end",children:"End of Visit"})]})]})]})]}),x.length===0?u.jsxs("div",{className:"bg-white rounded-lg shadow p-8 text-center",children:[u.jsx("p",{className:"text-gray-500",children:"No PD Kits found"}),(o||c||d!=="all")&&u.jsx("button",{onClick:w,className:"text-blue-600 hover:underline mt-2",children:"Clear filters"})]}):u.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:x.map(S=>u.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden hover:shadow-lg transition-shadow",children:[u.jsx("div",{className:"p-4 border-b border-gray-200",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h3",{className:"font-medium text-gray-800 line-clamp-1",children:S.visit.client.name}),u.jsx("p",{className:"text-sm text-gray-500",children:S.visit.client.company})]}),u.jsx("span",{className:`px-2 py-1 text-xs rounded-full ${S.upload_type==="start"?"bg-blue-100 text-blue-800":"bg-green-100 text-green-800"}`,children:S.upload_type==="start"?"Start":"End"})]})}),u.jsxs("div",{className:"w-full h-48 bg-gray-100 flex items-center justify-center relative",children:[E(S.file_path)&&!m[S.id]?u.jsx("img",{src:`${ie.storage.from("pd-kits").getPublicUrl(S.file_path).data.publicUrl}`,alt:`PD Kit for ${S.visit.client.name}`,className:"w-full h-full object-contain",onError:()=>y(S.id)}):u.jsxs("div",{className:"flex flex-col items-center justify-center p-4 text-center",children:[E(S.file_path)?u.jsx(w6,{className:"w-16 h-16 text-gray-400 mb-2"}):u.jsx(al,{className:"w-16 h-16 text-gray-400 mb-2"}),u.jsxs("p",{className:"text-sm text-gray-500",children:[E(S.file_path)?"Image preview":"Document preview"," not available"]})]}),u.jsxs("button",{onClick:()=>g(S.file_path,S.visit.client.name,S.upload_type),className:"absolute bottom-4 right-4 px-3 py-1 bg-blue-600 text-white rounded-lg flex items-center gap-1 hover:bg-blue-700 transition-colors text-sm",children:[u.jsx(_w,{className:"w-3 h-3"}),"Download"]})]}),u.jsx("div",{className:"p-4",children:u.jsxs("div",{className:"flex justify-between items-center",children:[u.jsxs("div",{children:[u.jsxs("p",{className:"text-sm text-gray-600 flex items-center gap-1",children:[u.jsx(Vv,{className:"w-4 h-4"}),S.visit.employee.name]}),u.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(S.uploaded_at).toLocaleString()})]}),u.jsxs("button",{onClick:()=>g(S.file_path,S.visit.client.name,S.upload_type),className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(_w,{className:"w-4 h-4"}),"Download"]})]})})]},S.id))})]})}function mue(){const{role:e}=Qe(),[t,r]=O.useState(!0),n=()=>{r(!t)};return u.jsxs("div",{className:"min-h-screen bg-gray-100 flex",children:[u.jsx("button",{onClick:n,className:"p-2 bg-gray-200 rounded-md shadow-md m-2 focus:outline-none z-50 fixed top-22 left-0",children:u.jsx(OT,{className:"w-4 h-4"})}),u.jsx("div",{className:`w-64 bg-white shadow-lg ${t?"block":"hidden"}`,children:u.jsxs("nav",{className:"mt-8",children:[u.jsxs(Xr,{to:"/dashboard",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(b6,{className:"w-5 h-5 mr-3"}),"Dashboard"]}),(e==="head"||e==="e.head")&&u.jsxs(Xr,{to:"/employees",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yi,{className:"w-5 h-5 mr-3"}),"Employees"]}),(e==="head"||e==="admin"||e==="employee")&&u.jsxs(Xr,{to:"/clients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),(e==="e.employee"||e==="e.head")&&u.jsxs(Xr,{to:"/eclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="finance.employee"&&u.jsxs(Xr,{to:"/fclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Yc,{className:"w-5 h-5 mr-3"}),"My Clients"]}),e==="e.head"&&u.jsxs(Xr,{to:"/pd-kits",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(xw,{className:"w-5 h-5 mr-3"}),"PD Kits"]}),(e==="employee"||e==="e.employee")&&u.jsxs(Xr,{to:"/site-visit",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(xw,{className:"w-5 h-5 mr-3"}),"Site Visit"]}),e==="finance.employee"&&u.jsx(u.Fragment,{children:u.jsxs(Xr,{to:"/documents-upload",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(id,{className:"w-5 h-5 mr-3"}),"Documents Upload"]})}),u.jsxs(Xr,{to:"/allclients",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(id,{className:"w-5 h-5 mr-3"}),"All Clients"]}),(e==="head"||e==="e.head"||e==="admin")&&u.jsxs(Xr,{to:"/time-insights",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(id,{className:"w-5 h-5 mr-3"}),"Site Visit Time"]}),u.jsxs(Xr,{to:"/xldata",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(id,{className:"w-5 h-5 mr-3"}),"XL Data"]}),u.jsxs(Xr,{to:"/Notifications",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(Wv,{className:"w-5 h-5 mr-3"}),"Notifications"]}),u.jsxs(Xr,{to:"/clients-history",className:"flex items-center px-6 py-3 text-gray-700 hover:bg-gray-100",children:[u.jsx(_6,{className:"w-5 h-5 mr-3"}),"Clients History"]})]})}),u.jsx("div",{className:"flex-1 overflow-auto",children:u.jsx("div",{className:"p-8",children:u.jsx(mP,{})})})]})}function Ye(e){for(var t=arguments.length,r=new Array(t>1?t-1:0),n=1;n<t;n++)r[n-1]=arguments[n];throw new Error(typeof e=="number"?"[MobX] minified error nr: "+e+(r.length?" "+r.map(String).join(","):"")+". Find the full error at: https://github.com/mobxjs/mobx/blob/main/packages/mobx/src/errors.ts":"[MobX] "+e)}var vue={};function mp(){return typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:vue}var zA=Object.assign,Q0=Object.getOwnPropertyDescriptor,Ta=Object.defineProperty,vp=Object.prototype,Sg=[];Object.freeze(Sg);var YA={};Object.freeze(YA);var gue=typeof Proxy<"u",xue=Object.toString();function GA(){gue||Ye("Proxy not available")}function KA(e){var t=!1;return function(){if(!t)return t=!0,e.apply(this,arguments)}}var Ko=function(){};function oa(e){return typeof e=="function"}function no(e){var t=typeof e;switch(t){case"string":case"symbol":case"number":return!0}return!1}function gp(e){return e!==null&&typeof e=="object"}function ii(e){if(!gp(e))return!1;var t=Object.getPrototypeOf(e);if(t==null)return!0;var r=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return typeof r=="function"&&r.toString()===xue}function qA(e){var t=e==null?void 0:e.constructor;return t?t.name==="GeneratorFunction"||t.displayName==="GeneratorFunction":!1}function xp(e,t,r){Ta(e,t,{enumerable:!1,writable:!0,configurable:!0,value:r})}function XA(e,t,r){Ta(e,t,{enumerable:!1,writable:!1,configurable:!0,value:r})}function yo(e,t){var r="isMobX"+e;return t.prototype[r]=!0,function(n){return gp(n)&&n[r]===!0}}function nc(e){return e!=null&&Object.prototype.toString.call(e)==="[object Map]"}function yue(e){var t=Object.getPrototypeOf(e),r=Object.getPrototypeOf(t),n=Object.getPrototypeOf(r);return n===null}function Ya(e){return e!=null&&Object.prototype.toString.call(e)==="[object Set]"}var QA=typeof Object.getOwnPropertySymbols<"u";function _ue(e){var t=Object.keys(e);if(!QA)return t;var r=Object.getOwnPropertySymbols(e);return r.length?[].concat(t,r.filter(function(n){return vp.propertyIsEnumerable.call(e,n)})):t}var yp=typeof Reflect<"u"&&Reflect.ownKeys?Reflect.ownKeys:QA?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames;function JA(e){return e===null?null:typeof e=="object"?""+e:e}function as(e,t){return vp.hasOwnProperty.call(e,t)}var wue=Object.getOwnPropertyDescriptors||function(t){var r={};return yp(t).forEach(function(n){r[n]=Q0(t,n)}),r};function tn(e,t){return!!(e&t)}function rn(e,t,r){return r?e|=t:e&=~t,e}function fE(e,t){(t==null||t>e.length)&&(t=e.length);for(var r=0,n=Array(t);r<t;r++)n[r]=e[r];return n}function bue(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,Sue(n.key),n)}}function ac(e,t,r){return t&&bue(e.prototype,t),Object.defineProperty(e,"prototype",{writable:!1}),e}function qo(e,t){var r=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(r)return(r=r.call(e)).next.bind(r);if(Array.isArray(e)||(r=kue(e))||t){r&&(e=r);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ao(){return ao=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)({}).hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},ao.apply(null,arguments)}function ZA(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,kg(e,t)}function kg(e,t){return kg=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(r,n){return r.__proto__=n,r},kg(e,t)}function Eue(e,t){if(typeof e!="object"||!e)return e;var r=e[Symbol.toPrimitive];if(r!==void 0){var n=r.call(e,t);if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}function Sue(e){var t=Eue(e,"string");return typeof t=="symbol"?t:t+""}function kue(e,t){if(e){if(typeof e=="string")return fE(e,t);var r={}.toString.call(e).slice(8,-1);return r==="Object"&&e.constructor&&(r=e.constructor.name),r==="Map"||r==="Set"?Array.from(e):r==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?fE(e,t):void 0}}var wa=Symbol("mobx-stored-annotations");function Ca(e){function t(r,n){if(Ff(n))return e.decorate_20223_(r,n);Pf(r,n,e)}return Object.assign(t,e)}function Pf(e,t,r){as(e,wa)||xp(e,wa,ao({},e[wa])),jue(r)||(e[wa][t]=r)}function Tue(e){return as(e,wa)||xp(e,wa,ao({},e[wa])),e[wa]}function Ff(e){return typeof e=="object"&&typeof e.kind=="string"}var Ae=Symbol("mobx administration"),vi=function(){function e(r){r===void 0&&(r="Atom"),this.name_=void 0,this.flags_=0,this.observers_=new Set,this.lastAccessedBy_=0,this.lowestObserverState_=Ge.NOT_TRACKING_,this.onBOL=void 0,this.onBUOL=void 0,this.name_=r}var t=e.prototype;return t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.reportObserved=function(){return mO(this)},t.reportChanged=function(){kn(),vO(this),Tn()},t.toString=function(){return this.name_},ac(e,[{key:"isBeingObserved",get:function(){return tn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return tn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=rn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();vi.isBeingObservedMask_=1;vi.isPendingUnobservationMask_=2;vi.diffValueMask_=4;var Ey=yo("Atom",vi);function eO(e,t,r){t===void 0&&(t=Ko),r===void 0&&(r=Ko);var n=new vi(e);return t!==Ko&&Mfe(n,t),r!==Ko&&wO(n,r),n}function Cue(e,t){return PO(e,t)}function Nue(e,t){return Object.is?Object.is(e,t):e===t?e!==0||1/e===1/t:e!==e&&t!==t}var J0={structural:Cue,default:Nue};function so(e,t,r){return kO(e)?e:Array.isArray(e)?ar.array(e,{name:r}):ii(e)?ar.object(e,void 0,{name:r}):nc(e)?ar.map(e,{name:r}):Ya(e)?ar.set(e,{name:r}):typeof e=="function"&&!ef(e)&&!tf(e)?qA(e)?Al(e):Zu(r,e):e}function Aue(e,t,r){if(e==null||kp(e)||Sp(e)||wo(e)||_a(e))return e;if(Array.isArray(e))return ar.array(e,{name:r,deep:!1});if(ii(e))return ar.object(e,void 0,{name:r,deep:!1});if(nc(e))return ar.map(e,{name:r,deep:!1});if(Ya(e))return ar.set(e,{name:r,deep:!1})}function _p(e){return e}function Oue(e,t){return PO(e,t)?t:e}var Due="override";function jue(e){return e.annotationType_===Due}function Rf(e,t){return{annotationType_:e,options_:t,make_:Pue,extend_:Fue,decorate_20223_:Rue}}function Pue(e,t,r,n){var a;if((a=this.options_)!=null&&a.bound)return this.extend_(e,t,r,!1)===null?0:1;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if(ef(r.value))return 1;var s=tO(e,this,t,r,!1);return Ta(n,t,s),2}function Fue(e,t,r,n){var a=tO(e,this,t,r);return e.defineProperty_(t,a,n)}function Rue(e,t){var r=t.kind,n=t.name,a=t.addInitializer,s=this,i=function(c){var f,d,h,p;return io((f=(d=s.options_)==null?void 0:d.name)!=null?f:n.toString(),c,(h=(p=s.options_)==null?void 0:p.autoAction)!=null?h:!1)};if(r=="field")return function(l){var c,f=l;return ef(f)||(f=i(f)),(c=s.options_)!=null&&c.bound&&(f=f.bind(this),f.isMobxAction=!0),f};if(r=="method"){var o;return ef(e)||(e=i(e)),(o=this.options_)!=null&&o.bound&&a(function(){var l=this,c=l[n].bind(l);c.isMobxAction=!0,l[n]=c}),e}Ye("Cannot apply '"+s.annotationType_+"' to '"+String(n)+"' (kind: "+r+"):"+(`
'`+s.annotationType_+"' can only be used on properties with a function value."))}function Mue(e,t,r,n){t.annotationType_,n.value}function tO(e,t,r,n,a){var s,i,o,l,c,f,d;a===void 0&&(a=xe.safeDescriptors),Mue(e,t,r,n);var h=n.value;if((s=t.options_)!=null&&s.bound){var p;h=h.bind((p=e.proxy_)!=null?p:e.target_)}return{value:io((i=(o=t.options_)==null?void 0:o.name)!=null?i:r.toString(),h,(l=(c=t.options_)==null?void 0:c.autoAction)!=null?l:!1,(f=t.options_)!=null&&f.bound?(d=e.proxy_)!=null?d:e.target_:void 0),configurable:a?e.isPlainObject_:!0,enumerable:!1,writable:!a}}function rO(e,t){return{annotationType_:e,options_:t,make_:Iue,extend_:Lue,decorate_20223_:$ue}}function Iue(e,t,r,n){var a;if(n===e.target_)return this.extend_(e,t,r,!1)===null?0:2;if((a=this.options_)!=null&&a.bound&&(!as(e.target_,t)||!tf(e.target_[t]))&&this.extend_(e,t,r,!1)===null)return 0;if(tf(r.value))return 1;var s=nO(e,this,t,r,!1,!1);return Ta(n,t,s),2}function Lue(e,t,r,n){var a,s=nO(e,this,t,r,(a=this.options_)==null?void 0:a.bound);return e.defineProperty_(t,s,n)}function $ue(e,t){var r,n=t.name,a=t.addInitializer;return tf(e)||(e=Al(e)),(r=this.options_)!=null&&r.bound&&a(function(){var s=this,i=s[n].bind(s);i.isMobXFlow=!0,s[n]=i}),e}function Bue(e,t,r,n){t.annotationType_,n.value}function nO(e,t,r,n,a,s){s===void 0&&(s=xe.safeDescriptors),Bue(e,t,r,n);var i=n.value;if(tf(i)||(i=Al(i)),a){var o;i=i.bind((o=e.proxy_)!=null?o:e.target_),i.isMobXFlow=!0}return{value:i,configurable:s?e.isPlainObject_:!0,enumerable:!1,writable:!s}}function Sy(e,t){return{annotationType_:e,options_:t,make_:Uue,extend_:Wue,decorate_20223_:Vue}}function Uue(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function Wue(e,t,r,n){return Hue(e,this,t,r),e.defineComputedProperty_(t,ao({},this.options_,{get:r.get,set:r.set}),n)}function Vue(e,t){var r=this,n=t.name,a=t.addInitializer;return a(function(){var s=sc(this)[Ae],i=ao({},r.options_,{get:e,context:this});i.name||(i.name="ObservableObject."+n.toString()),s.values_.set(n,new la(i))}),function(){return this[Ae].getObservablePropValue_(n)}}function Hue(e,t,r,n){t.annotationType_,n.get}function wp(e,t){return{annotationType_:e,options_:t,make_:zue,extend_:Yue,decorate_20223_:Gue}}function zue(e,t,r){return this.extend_(e,t,r,!1)===null?0:1}function Yue(e,t,r,n){var a,s;return Kue(e,this),e.defineObservableProperty_(t,r.value,(a=(s=this.options_)==null?void 0:s.enhancer)!=null?a:so,n)}function Gue(e,t){var r=this,n=t.kind,a=t.name,s=new WeakSet;function i(o,l){var c,f,d=sc(o)[Ae],h=new Bi(l,(c=(f=r.options_)==null?void 0:f.enhancer)!=null?c:so,"ObservableObject."+a.toString(),!1);d.values_.set(a,h),s.add(o)}if(n=="accessor")return{get:function(){return s.has(this)||i(this,e.get.call(this)),this[Ae].getObservablePropValue_(a)},set:function(l){return s.has(this)||i(this,l),this[Ae].setObservablePropValue_(a,l)},init:function(l){return s.has(this)||i(this,l),l}}}function Kue(e,t,r,n){t.annotationType_}var que="true",Xue=aO();function aO(e){return{annotationType_:que,options_:e,make_:Que,extend_:Jue,decorate_20223_:Zue}}function Que(e,t,r,n){var a,s;if(r.get)return bp.make_(e,t,r,n);if(r.set){var i=io(t.toString(),r.set);return n===e.target_?e.defineProperty_(t,{configurable:xe.safeDescriptors?e.isPlainObject_:!0,set:i})===null?0:2:(Ta(n,t,{configurable:!0,set:i}),2)}if(n!==e.target_&&typeof r.value=="function"){var o;if(qA(r.value)){var l,c=(l=this.options_)!=null&&l.autoBind?Al.bound:Al;return c.make_(e,t,r,n)}var f=(o=this.options_)!=null&&o.autoBind?Zu.bound:Zu;return f.make_(e,t,r,n)}var d=((a=this.options_)==null?void 0:a.deep)===!1?ar.ref:ar;if(typeof r.value=="function"&&(s=this.options_)!=null&&s.autoBind){var h;r.value=r.value.bind((h=e.proxy_)!=null?h:e.target_)}return d.make_(e,t,r,n)}function Jue(e,t,r,n){var a,s;if(r.get)return bp.extend_(e,t,r,n);if(r.set)return e.defineProperty_(t,{configurable:xe.safeDescriptors?e.isPlainObject_:!0,set:io(t.toString(),r.set)},n);if(typeof r.value=="function"&&(a=this.options_)!=null&&a.autoBind){var i;r.value=r.value.bind((i=e.proxy_)!=null?i:e.target_)}var o=((s=this.options_)==null?void 0:s.deep)===!1?ar.ref:ar;return o.extend_(e,t,r,n)}function Zue(e,t){Ye("'"+this.annotationType_+"' cannot be used as a decorator")}var efe="observable",tfe="observable.ref",rfe="observable.shallow",nfe="observable.struct",sO={deep:!0,name:void 0,defaultDecorator:void 0,proxy:!0};Object.freeze(sO);function Ed(e){return e||sO}var Tg=wp(efe),afe=wp(tfe,{enhancer:_p}),sfe=wp(rfe,{enhancer:Aue}),ife=wp(nfe,{enhancer:Oue}),iO=Ca(Tg);function Sd(e){return e.deep===!0?so:e.deep===!1?_p:lfe(e.defaultDecorator)}function ofe(e){var t;return e?(t=e.defaultDecorator)!=null?t:aO(e):void 0}function lfe(e){var t,r;return e&&(t=(r=e.options_)==null?void 0:r.enhancer)!=null?t:so}function oO(e,t,r){if(Ff(t))return Tg.decorate_20223_(e,t);if(no(t)){Pf(e,t,Tg);return}return kO(e)?e:ii(e)?ar.object(e,t,r):Array.isArray(e)?ar.array(e,t):nc(e)?ar.map(e,t):Ya(e)?ar.set(e,t):typeof e=="object"&&e!==null?e:ar.box(e,t)}zA(oO,iO);var cfe={box:function(t,r){var n=Ed(r);return new Bi(t,Sd(n),n.name,!0,n.equals)},array:function(t,r){var n=Ed(r);return(xe.useProxies===!1||n.proxy===!1?ode:Qfe)(t,Sd(n),n.name)},map:function(t,r){var n=Ed(r);return new CO(t,Sd(n),n.name)},set:function(t,r){var n=Ed(r);return new NO(t,Sd(n),n.name)},object:function(t,r,n){return bo(function(){return Bfe(xe.useProxies===!1||(n==null?void 0:n.proxy)===!1?sc({},n):Gfe({},n),t,r)})},ref:Ca(afe),shallow:Ca(sfe),deep:iO,struct:Ca(ife)},ar=zA(oO,cfe),lO="computed",ufe="computed.struct",Cg=Sy(lO),ffe=Sy(ufe,{equals:J0.structural}),bp=function(t,r){if(Ff(r))return Cg.decorate_20223_(t,r);if(no(r))return Pf(t,r,Cg);if(ii(t))return Ca(Sy(lO,t));var n=ii(r)?r:{};return n.get=t,n.name||(n.name=t.name||""),new la(n)};Object.assign(bp,Cg);bp.struct=Ca(ffe);var dE,hE,Z0=0,dfe=1,hfe=(dE=(hE=Q0(function(){},"name"))==null?void 0:hE.configurable)!=null?dE:!1,pE={value:"action",configurable:!0,writable:!1,enumerable:!1};function io(e,t,r,n){r===void 0&&(r=!1);function a(){return pfe(e,r,t,n||this,arguments)}return a.isMobxAction=!0,a.toString=function(){return t.toString()},hfe&&(pE.value=e,Ta(a,"name",pE)),a}function pfe(e,t,r,n,a){var s=mfe(e,t);try{return r.apply(n,a)}catch(i){throw s.error_=i,i}finally{vfe(s)}}function mfe(e,t,r,n){var a=!1,s=0,i=xe.trackingDerivation,o=!t||!i;kn();var l=xe.allowStateChanges;o&&(_o(),l=ky(!0));var c=Cy(!0),f={runAsAction_:o,prevDerivation_:i,prevAllowStateChanges_:l,prevAllowStateReads_:c,notifySpy_:a,startTime_:s,actionId_:dfe++,parentActionId_:Z0};return Z0=f.actionId_,f}function vfe(e){Z0!==e.actionId_&&Ye(30),Z0=e.parentActionId_,e.error_!==void 0&&(xe.suppressReactionErrors=!0),Ty(e.prevAllowStateChanges_),su(e.prevAllowStateReads_),Tn(),e.runAsAction_&&ss(e.prevDerivation_),xe.suppressReactionErrors=!1}function ky(e){var t=xe.allowStateChanges;return xe.allowStateChanges=e,t}function Ty(e){xe.allowStateChanges=e}var Bi=function(e){function t(n,a,s,i,o){var l;return s===void 0&&(s="ObservableValue"),o===void 0&&(o=J0.default),l=e.call(this,s)||this,l.enhancer=void 0,l.name_=void 0,l.equals=void 0,l.hasUnreportedChange_=!1,l.interceptors_=void 0,l.changeListeners_=void 0,l.value_=void 0,l.dehancer=void 0,l.enhancer=a,l.name_=s,l.equals=o,l.value_=a(n,void 0,s),l}ZA(t,e);var r=t.prototype;return r.dehanceValue=function(a){return this.dehancer!==void 0?this.dehancer(a):a},r.set=function(a){this.value_,a=this.prepareNewValue_(a),a!==xe.UNCHANGED&&this.setNewValue_(a)},r.prepareNewValue_=function(a){if(bn(this)){var s=En(this,{object:this,type:Na,newValue:a});if(!s)return xe.UNCHANGED;a=s.newValue}return a=this.enhancer(a,this.value_,this.name_),this.equals(this.value_,a)?xe.UNCHANGED:a},r.setNewValue_=function(a){var s=this.value_;this.value_=a,this.reportChanged(),ea(this)&&ta(this,{type:Na,object:this,newValue:a,oldValue:s})},r.get=function(){return this.reportObserved(),this.dehanceValue(this.value_)},r.intercept_=function(a){return Mf(this,a)},r.observe_=function(a,s){return s&&a({observableKind:"value",debugObjectName:this.name_,object:this,type:Na,newValue:this.value_,oldValue:void 0}),If(this,a)},r.raw=function(){return this.value_},r.toJSON=function(){return this.get()},r.toString=function(){return this.name_+"["+this.value_+"]"},r.valueOf=function(){return JA(this.get())},r[Symbol.toPrimitive]=function(){return this.valueOf()},t}(vi),la=function(){function e(r){this.dependenciesState_=Ge.NOT_TRACKING_,this.observing_=[],this.newObserving_=null,this.observers_=new Set,this.runId_=0,this.lastAccessedBy_=0,this.lowestObserverState_=Ge.UP_TO_DATE_,this.unboundDepsCount_=0,this.value_=new th(null),this.name_=void 0,this.triggeredBy_=void 0,this.flags_=0,this.derivation=void 0,this.setter_=void 0,this.isTracing_=eh.NONE,this.scope_=void 0,this.equals_=void 0,this.requiresReaction_=void 0,this.keepAlive_=void 0,this.onBOL=void 0,this.onBUOL=void 0,r.get||Ye(31),this.derivation=r.get,this.name_=r.name||"ComputedValue",r.set&&(this.setter_=io("ComputedValue-setter",r.set)),this.equals_=r.equals||(r.compareStructural||r.struct?J0.structural:J0.default),this.scope_=r.context,this.requiresReaction_=r.requiresReaction,this.keepAlive_=!!r.keepAlive}var t=e.prototype;return t.onBecomeStale_=function(){wfe(this)},t.onBO=function(){this.onBOL&&this.onBOL.forEach(function(n){return n()})},t.onBUO=function(){this.onBUOL&&this.onBUOL.forEach(function(n){return n()})},t.get=function(){if(this.isComputing&&Ye(32,this.name_,this.derivation),xe.inBatch===0&&this.observers_.size===0&&!this.keepAlive_)Ng(this)&&(this.warnAboutUntrackedRead_(),kn(),this.value_=this.computeValue_(!1),Tn());else if(mO(this),Ng(this)){var n=xe.trackingContext;this.keepAlive_&&!n&&(xe.trackingContext=this),this.trackAndCompute()&&_fe(this),xe.trackingContext=n}var a=this.value_;if(Yd(a))throw a.cause;return a},t.set=function(n){if(this.setter_){this.isRunningSetter&&Ye(33,this.name_),this.isRunningSetter=!0;try{this.setter_.call(this.scope_,n)}finally{this.isRunningSetter=!1}}else Ye(34,this.name_)},t.trackAndCompute=function(){var n=this.value_,a=this.dependenciesState_===Ge.NOT_TRACKING_,s=this.computeValue_(!0),i=a||Yd(n)||Yd(s)||!this.equals_(n,s);return i&&(this.value_=s),i},t.computeValue_=function(n){this.isComputing=!0;var a=ky(!1),s;if(n)s=cO(this,this.derivation,this.scope_);else if(xe.disableErrorBoundaries===!0)s=this.derivation.call(this.scope_);else try{s=this.derivation.call(this.scope_)}catch(i){s=new th(i)}return Ty(a),this.isComputing=!1,s},t.suspend_=function(){this.keepAlive_||(Ag(this),this.value_=void 0)},t.observe_=function(n,a){var s=this,i=!0,o=void 0;return Dfe(function(){var l=s.get();if(!i||a){var c=_o();n({observableKind:"computed",debugObjectName:s.name_,type:Na,object:s,newValue:l,oldValue:o}),ss(c)}i=!1,o=l})},t.warnAboutUntrackedRead_=function(){},t.toString=function(){return this.name_+"["+this.derivation.toString()+"]"},t.valueOf=function(){return JA(this.get())},t[Symbol.toPrimitive]=function(){return this.valueOf()},ac(e,[{key:"isComputing",get:function(){return tn(this.flags_,e.isComputingMask_)},set:function(n){this.flags_=rn(this.flags_,e.isComputingMask_,n)}},{key:"isRunningSetter",get:function(){return tn(this.flags_,e.isRunningSetterMask_)},set:function(n){this.flags_=rn(this.flags_,e.isRunningSetterMask_,n)}},{key:"isBeingObserved",get:function(){return tn(this.flags_,e.isBeingObservedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isBeingObservedMask_,n)}},{key:"isPendingUnobservation",get:function(){return tn(this.flags_,e.isPendingUnobservationMask_)},set:function(n){this.flags_=rn(this.flags_,e.isPendingUnobservationMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();la.isComputingMask_=1;la.isRunningSetterMask_=2;la.isBeingObservedMask_=4;la.isPendingUnobservationMask_=8;la.diffValueMask_=16;var Ep=yo("ComputedValue",la),Ge;(function(e){e[e.NOT_TRACKING_=-1]="NOT_TRACKING_",e[e.UP_TO_DATE_=0]="UP_TO_DATE_",e[e.POSSIBLY_STALE_=1]="POSSIBLY_STALE_",e[e.STALE_=2]="STALE_"})(Ge||(Ge={}));var eh;(function(e){e[e.NONE=0]="NONE",e[e.LOG=1]="LOG",e[e.BREAK=2]="BREAK"})(eh||(eh={}));var th=function(t){this.cause=void 0,this.cause=t};function Yd(e){return e instanceof th}function Ng(e){switch(e.dependenciesState_){case Ge.UP_TO_DATE_:return!1;case Ge.NOT_TRACKING_:case Ge.STALE_:return!0;case Ge.POSSIBLY_STALE_:{for(var t=Cy(!0),r=_o(),n=e.observing_,a=n.length,s=0;s<a;s++){var i=n[s];if(Ep(i)){if(xe.disableErrorBoundaries)i.get();else try{i.get()}catch{return ss(r),su(t),!0}if(e.dependenciesState_===Ge.STALE_)return ss(r),su(t),!0}}return fO(e),ss(r),su(t),!1}}}function cO(e,t,r){var n=Cy(!0);fO(e),e.newObserving_=new Array(e.runId_===0?100:e.observing_.length),e.unboundDepsCount_=0,e.runId_=++xe.runId;var a=xe.trackingDerivation;xe.trackingDerivation=e,xe.inBatch++;var s;if(xe.disableErrorBoundaries===!0)s=t.call(r);else try{s=t.call(r)}catch(i){s=new th(i)}return xe.inBatch--,xe.trackingDerivation=a,gfe(e),su(n),s}function gfe(e){for(var t=e.observing_,r=e.observing_=e.newObserving_,n=Ge.UP_TO_DATE_,a=0,s=e.unboundDepsCount_,i=0;i<s;i++){var o=r[i];o.diffValue===0&&(o.diffValue=1,a!==i&&(r[a]=o),a++),o.dependenciesState_>n&&(n=o.dependenciesState_)}for(r.length=a,e.newObserving_=null,s=t.length;s--;){var l=t[s];l.diffValue===0&&hO(l,e),l.diffValue=0}for(;a--;){var c=r[a];c.diffValue===1&&(c.diffValue=0,yfe(c,e))}n!==Ge.UP_TO_DATE_&&(e.dependenciesState_=n,e.onBecomeStale_())}function Ag(e){var t=e.observing_;e.observing_=[];for(var r=t.length;r--;)hO(t[r],e);e.dependenciesState_=Ge.NOT_TRACKING_}function uO(e){var t=_o();try{return e()}finally{ss(t)}}function _o(){var e=xe.trackingDerivation;return xe.trackingDerivation=null,e}function ss(e){xe.trackingDerivation=e}function Cy(e){var t=xe.allowStateReads;return xe.allowStateReads=e,t}function su(e){xe.allowStateReads=e}function fO(e){if(e.dependenciesState_!==Ge.UP_TO_DATE_){e.dependenciesState_=Ge.UP_TO_DATE_;for(var t=e.observing_,r=t.length;r--;)t[r].lowestObserverState_=Ge.UP_TO_DATE_}}var Gd=function(){this.version=6,this.UNCHANGED={},this.trackingDerivation=null,this.trackingContext=null,this.runId=0,this.mobxGuid=0,this.inBatch=0,this.pendingUnobservations=[],this.pendingReactions=[],this.isRunningReactions=!1,this.allowStateChanges=!1,this.allowStateReads=!0,this.enforceActions=!0,this.spyListeners=[],this.globalReactionErrorHandlers=[],this.computedRequiresReaction=!1,this.reactionRequiresObservable=!1,this.observableRequiresReaction=!1,this.disableErrorBoundaries=!1,this.suppressReactionErrors=!1,this.useProxies=!0,this.verifyProxies=!1,this.safeDescriptors=!0},Kd=!0,dO=!1,xe=function(){var e=mp();return e.__mobxInstanceCount>0&&!e.__mobxGlobals&&(Kd=!1),e.__mobxGlobals&&e.__mobxGlobals.version!==new Gd().version&&(Kd=!1),Kd?e.__mobxGlobals?(e.__mobxInstanceCount+=1,e.__mobxGlobals.UNCHANGED||(e.__mobxGlobals.UNCHANGED={}),e.__mobxGlobals):(e.__mobxInstanceCount=1,e.__mobxGlobals=new Gd):(setTimeout(function(){dO||Ye(35)},1),new Gd)}();function xfe(){if((xe.pendingReactions.length||xe.inBatch||xe.isRunningReactions)&&Ye(36),dO=!0,Kd){var e=mp();--e.__mobxInstanceCount===0&&(e.__mobxGlobals=void 0),xe=new Gd}}function yfe(e,t){e.observers_.add(t),e.lowestObserverState_>t.dependenciesState_&&(e.lowestObserverState_=t.dependenciesState_)}function hO(e,t){e.observers_.delete(t),e.observers_.size===0&&pO(e)}function pO(e){e.isPendingUnobservation===!1&&(e.isPendingUnobservation=!0,xe.pendingUnobservations.push(e))}function kn(){xe.inBatch++}function Tn(){if(--xe.inBatch===0){gO();for(var e=xe.pendingUnobservations,t=0;t<e.length;t++){var r=e[t];r.isPendingUnobservation=!1,r.observers_.size===0&&(r.isBeingObserved&&(r.isBeingObserved=!1,r.onBUO()),r instanceof la&&r.suspend_())}xe.pendingUnobservations=[]}}function mO(e){var t=xe.trackingDerivation;return t!==null?(t.runId_!==e.lastAccessedBy_&&(e.lastAccessedBy_=t.runId_,t.newObserving_[t.unboundDepsCount_++]=e,!e.isBeingObserved&&xe.trackingContext&&(e.isBeingObserved=!0,e.onBO())),e.isBeingObserved):(e.observers_.size===0&&xe.inBatch>0&&pO(e),!1)}function vO(e){e.lowestObserverState_!==Ge.STALE_&&(e.lowestObserverState_=Ge.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.UP_TO_DATE_&&t.onBecomeStale_(),t.dependenciesState_=Ge.STALE_}))}function _fe(e){e.lowestObserverState_!==Ge.STALE_&&(e.lowestObserverState_=Ge.STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.POSSIBLY_STALE_?t.dependenciesState_=Ge.STALE_:t.dependenciesState_===Ge.UP_TO_DATE_&&(e.lowestObserverState_=Ge.UP_TO_DATE_)}))}function wfe(e){e.lowestObserverState_===Ge.UP_TO_DATE_&&(e.lowestObserverState_=Ge.POSSIBLY_STALE_,e.observers_.forEach(function(t){t.dependenciesState_===Ge.UP_TO_DATE_&&(t.dependenciesState_=Ge.POSSIBLY_STALE_,t.onBecomeStale_())}))}var ms=function(){function e(r,n,a,s){r===void 0&&(r="Reaction"),this.name_=void 0,this.onInvalidate_=void 0,this.errorHandler_=void 0,this.requiresObservable_=void 0,this.observing_=[],this.newObserving_=[],this.dependenciesState_=Ge.NOT_TRACKING_,this.runId_=0,this.unboundDepsCount_=0,this.flags_=0,this.isTracing_=eh.NONE,this.name_=r,this.onInvalidate_=n,this.errorHandler_=a,this.requiresObservable_=s}var t=e.prototype;return t.onBecomeStale_=function(){this.schedule_()},t.schedule_=function(){this.isScheduled||(this.isScheduled=!0,xe.pendingReactions.push(this),gO())},t.runReaction_=function(){if(!this.isDisposed){kn(),this.isScheduled=!1;var n=xe.trackingContext;if(xe.trackingContext=this,Ng(this)){this.isTrackPending=!0;try{this.onInvalidate_()}catch(a){this.reportExceptionInDerivation_(a)}}xe.trackingContext=n,Tn()}},t.track=function(n){if(!this.isDisposed){kn(),this.isRunning=!0;var a=xe.trackingContext;xe.trackingContext=this;var s=cO(this,n,void 0);xe.trackingContext=a,this.isRunning=!1,this.isTrackPending=!1,this.isDisposed&&Ag(this),Yd(s)&&this.reportExceptionInDerivation_(s.cause),Tn()}},t.reportExceptionInDerivation_=function(n){var a=this;if(this.errorHandler_){this.errorHandler_(n,this);return}if(xe.disableErrorBoundaries)throw n;var s="[mobx] uncaught error in '"+this+"'";xe.suppressReactionErrors||console.error(s,n),xe.globalReactionErrorHandlers.forEach(function(i){return i(n,a)})},t.dispose=function(){this.isDisposed||(this.isDisposed=!0,this.isRunning||(kn(),Ag(this),Tn()))},t.getDisposer_=function(n){var a=this,s=function i(){a.dispose(),n==null||n.removeEventListener==null||n.removeEventListener("abort",i)};return n==null||n.addEventListener==null||n.addEventListener("abort",s),s[Ae]=this,s},t.toString=function(){return"Reaction["+this.name_+"]"},t.trace=function(n){},ac(e,[{key:"isDisposed",get:function(){return tn(this.flags_,e.isDisposedMask_)},set:function(n){this.flags_=rn(this.flags_,e.isDisposedMask_,n)}},{key:"isScheduled",get:function(){return tn(this.flags_,e.isScheduledMask_)},set:function(n){this.flags_=rn(this.flags_,e.isScheduledMask_,n)}},{key:"isTrackPending",get:function(){return tn(this.flags_,e.isTrackPendingMask_)},set:function(n){this.flags_=rn(this.flags_,e.isTrackPendingMask_,n)}},{key:"isRunning",get:function(){return tn(this.flags_,e.isRunningMask_)},set:function(n){this.flags_=rn(this.flags_,e.isRunningMask_,n)}},{key:"diffValue",get:function(){return tn(this.flags_,e.diffValueMask_)?1:0},set:function(n){this.flags_=rn(this.flags_,e.diffValueMask_,n===1)}}])}();ms.isDisposedMask_=1;ms.isScheduledMask_=2;ms.isTrackPendingMask_=4;ms.isRunningMask_=8;ms.diffValueMask_=16;var bfe=100,Og=function(t){return t()};function gO(){xe.inBatch>0||xe.isRunningReactions||Og(Efe)}function Efe(){xe.isRunningReactions=!0;for(var e=xe.pendingReactions,t=0;e.length>0;){++t===bfe&&(console.error("[mobx] cycle in reaction: "+e[0]),e.splice(0));for(var r=e.splice(0),n=0,a=r.length;n<a;n++)r[n].runReaction_()}xe.isRunningReactions=!1}var rh=yo("Reaction",ms);function Sfe(e){var t=Og;Og=function(n){return e(function(){return t(n)})}}function iu(){return!1}function kfe(e){return console.warn("[mobx.spy] Is a no-op in production builds"),function(){}}var xO="action",Tfe="action.bound",yO="autoAction",Cfe="autoAction.bound",Nfe="<unnamed action>",Dg=Rf(xO),Afe=Rf(Tfe,{bound:!0}),jg=Rf(yO,{autoAction:!0}),Ofe=Rf(Cfe,{autoAction:!0,bound:!0});function _O(e){var t=function(n,a){if(oa(n))return io(n.name||Nfe,n,e);if(oa(a))return io(n,a,e);if(Ff(a))return(e?jg:Dg).decorate_20223_(n,a);if(no(a))return Pf(n,a,e?jg:Dg);if(no(n))return Ca(Rf(e?yO:xO,{name:n,autoAction:e}))};return t}var Xo=_O(!1);Object.assign(Xo,Dg);var Zu=_O(!0);Object.assign(Zu,jg);Xo.bound=Ca(Afe);Zu.bound=Ca(Ofe);function ef(e){return oa(e)&&e.isMobxAction===!0}function Dfe(e,t){var r,n,a,s;t===void 0&&(t=YA);var i=(r=(n=t)==null?void 0:n.name)!=null?r:"Autorun",o=!t.scheduler&&!t.delay,l;if(o)l=new ms(i,function(){this.track(d)},t.onError,t.requiresObservable);else{var c=Pfe(t),f=!1;l=new ms(i,function(){f||(f=!0,c(function(){f=!1,l.isDisposed||l.track(d)}))},t.onError,t.requiresObservable)}function d(){e(l)}return(a=t)!=null&&(a=a.signal)!=null&&a.aborted||l.schedule_(),l.getDisposer_((s=t)==null?void 0:s.signal)}var jfe=function(t){return t()};function Pfe(e){return e.scheduler?e.scheduler:e.delay?function(t){return setTimeout(t,e.delay)}:jfe}var Ffe="onBO",Rfe="onBUO";function Mfe(e,t,r){return bO(Ffe,e,t,r)}function wO(e,t,r){return bO(Rfe,e,t,r)}function bO(e,t,r,n){var a=sh(t),s=oa(n)?n:r,i=e+"L";return a[i]?a[i].add(s):a[i]=new Set([s]),function(){var o=a[i];o&&(o.delete(s),o.size===0&&delete a[i])}}var Ife="never",kd="always",Lfe="observed";function $fe(e){e.isolateGlobalState===!0&&xfe();var t=e.useProxies,r=e.enforceActions;if(t!==void 0&&(xe.useProxies=t===kd?!0:t===Ife?!1:typeof Proxy<"u"),t==="ifavailable"&&(xe.verifyProxies=!0),r!==void 0){var n=r===kd?kd:r===Lfe;xe.enforceActions=n,xe.allowStateChanges=!(n===!0||n===kd)}["computedRequiresReaction","reactionRequiresObservable","observableRequiresReaction","disableErrorBoundaries","safeDescriptors"].forEach(function(a){a in e&&(xe[a]=!!e[a])}),xe.allowStateReads=!xe.observableRequiresReaction,e.reactionScheduler&&Sfe(e.reactionScheduler)}function Bfe(e,t,r,n){var a=wue(t);return bo(function(){var s=sc(e,n)[Ae];yp(a).forEach(function(i){s.extend_(i,a[i],r&&i in r?r[i]:!0)})}),e}function Ufe(e,t){return EO(sh(e,t))}function EO(e){var t={name:e.name_};return e.observing_&&e.observing_.length>0&&(t.dependencies=Wfe(e.observing_).map(EO)),t}function Wfe(e){return Array.from(new Set(e))}var Vfe=0;function SO(){this.message="FLOW_CANCELLED"}SO.prototype=Object.create(Error.prototype);var Fm=rO("flow"),Hfe=rO("flow.bound",{bound:!0}),Al=Object.assign(function(t,r){if(Ff(r))return Fm.decorate_20223_(t,r);if(no(r))return Pf(t,r,Fm);var n=t,a=n.name||"<unnamed flow>",s=function(){var o=this,l=arguments,c=++Vfe,f=Xo(a+" - runid: "+c+" - init",n).apply(o,l),d,h=void 0,p=new Promise(function(v,m){var _=0;d=m;function g(w){h=void 0;var E;try{E=Xo(a+" - runid: "+c+" - yield "+_++,f.next).call(f,w)}catch(S){return m(S)}x(E)}function y(w){h=void 0;var E;try{E=Xo(a+" - runid: "+c+" - yield "+_++,f.throw).call(f,w)}catch(S){return m(S)}x(E)}function x(w){if(oa(w==null?void 0:w.then)){w.then(x,m);return}return w.done?v(w.value):(h=Promise.resolve(w.value),h.then(g,y))}g(void 0)});return p.cancel=Xo(a+" - runid: "+c+" - cancel",function(){try{h&&mE(h);var v=f.return(void 0),m=Promise.resolve(v.value);m.then(Ko,Ko),mE(m),d(new SO)}catch(_){d(_)}}),p};return s.isMobXFlow=!0,s},Fm);Al.bound=Ca(Hfe);function mE(e){oa(e.cancel)&&e.cancel()}function tf(e){return(e==null?void 0:e.isMobXFlow)===!0}function zfe(e,t){return e?kp(e)||!!e[Ae]||Ey(e)||rh(e)||Ep(e):!1}function kO(e){return zfe(e)}function Ga(e,t){t===void 0&&(t=void 0),kn();try{return e.apply(t)}finally{Tn()}}function Ao(e){return e[Ae]}var Yfe={has:function(t,r){return Ao(t).has_(r)},get:function(t,r){return Ao(t).get_(r)},set:function(t,r,n){var a;return no(r)?(a=Ao(t).set_(r,n,!0))!=null?a:!0:!1},deleteProperty:function(t,r){var n;return no(r)?(n=Ao(t).delete_(r,!0))!=null?n:!0:!1},defineProperty:function(t,r,n){var a;return(a=Ao(t).defineProperty_(r,n))!=null?a:!0},ownKeys:function(t){return Ao(t).ownKeys_()},preventExtensions:function(t){Ye(13)}};function Gfe(e,t){var r,n;return GA(),e=sc(e,t),(n=(r=e[Ae]).proxy_)!=null?n:r.proxy_=new Proxy(e,Yfe)}function bn(e){return e.interceptors_!==void 0&&e.interceptors_.length>0}function Mf(e,t){var r=e.interceptors_||(e.interceptors_=[]);return r.push(t),KA(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function En(e,t){var r=_o();try{for(var n=[].concat(e.interceptors_||[]),a=0,s=n.length;a<s&&(t=n[a](t),t&&!t.type&&Ye(14),!!t);a++);return t}finally{ss(r)}}function ea(e){return e.changeListeners_!==void 0&&e.changeListeners_.length>0}function If(e,t){var r=e.changeListeners_||(e.changeListeners_=[]);return r.push(t),KA(function(){var n=r.indexOf(t);n!==-1&&r.splice(n,1)})}function ta(e,t){var r=_o(),n=e.changeListeners_;if(n){n=n.slice();for(var a=0,s=n.length;a<s;a++)n[a](t);ss(r)}}function Kfe(e,t,r){return bo(function(){var n,a=sc(e,r)[Ae];(n=t)!=null||(t=Tue(e)),yp(t).forEach(function(s){return a.make_(s,t[s])})}),e}var vE="splice",Na="update",qfe=1e4,Xfe={get:function(t,r){var n=t[Ae];return r===Ae?n:r==="length"?n.getArrayLength_():typeof r=="string"&&!isNaN(r)?n.get_(parseInt(r)):as(nh,r)?nh[r]:t[r]},set:function(t,r,n){var a=t[Ae];return r==="length"&&a.setArrayLength_(n),typeof r=="symbol"||isNaN(r)?t[r]=n:a.set_(parseInt(r),n),!0},preventExtensions:function(){Ye(15)}},Ny=function(){function e(r,n,a,s){r===void 0&&(r="ObservableArray"),this.owned_=void 0,this.legacyMode_=void 0,this.atom_=void 0,this.values_=[],this.interceptors_=void 0,this.changeListeners_=void 0,this.enhancer_=void 0,this.dehancer=void 0,this.proxy_=void 0,this.lastKnownLength_=0,this.owned_=a,this.legacyMode_=s,this.atom_=new vi(r),this.enhancer_=function(i,o){return n(i,o,"ObservableArray[..]")}}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.dehanceValues_=function(n){return this.dehancer!==void 0&&n.length>0?n.map(this.dehancer):n},t.intercept_=function(n){return Mf(this,n)},t.observe_=function(n,a){return a===void 0&&(a=!1),a&&n({observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:"splice",index:0,added:this.values_.slice(),addedCount:this.values_.length,removed:[],removedCount:0}),If(this,n)},t.getArrayLength_=function(){return this.atom_.reportObserved(),this.values_.length},t.setArrayLength_=function(n){(typeof n!="number"||isNaN(n)||n<0)&&Ye("Out of range: "+n);var a=this.values_.length;if(n!==a)if(n>a){for(var s=new Array(n-a),i=0;i<n-a;i++)s[i]=void 0;this.spliceWithArray_(a,0,s)}else this.spliceWithArray_(n,a-n)},t.updateArrayLength_=function(n,a){n!==this.lastKnownLength_&&Ye(16),this.lastKnownLength_+=a,this.legacyMode_&&a>0&&jO(n+a+1)},t.spliceWithArray_=function(n,a,s){var i=this;this.atom_;var o=this.values_.length;if(n===void 0?n=0:n>o?n=o:n<0&&(n=Math.max(0,o+n)),arguments.length===1?a=o-n:a==null?a=0:a=Math.max(0,Math.min(a,o-n)),s===void 0&&(s=Sg),bn(this)){var l=En(this,{object:this.proxy_,type:vE,index:n,removedCount:a,added:s});if(!l)return Sg;a=l.removedCount,s=l.added}if(s=s.length===0?s:s.map(function(d){return i.enhancer_(d,void 0)}),this.legacyMode_){var c=s.length-a;this.updateArrayLength_(o,c)}var f=this.spliceItemsIntoValues_(n,a,s);return(a!==0||s.length!==0)&&this.notifyArraySplice_(n,s,f),this.dehanceValues_(f)},t.spliceItemsIntoValues_=function(n,a,s){if(s.length<qfe){var i;return(i=this.values_).splice.apply(i,[n,a].concat(s))}else{var o=this.values_.slice(n,n+a),l=this.values_.slice(n+a);this.values_.length+=s.length-a;for(var c=0;c<s.length;c++)this.values_[n+c]=s[c];for(var f=0;f<l.length;f++)this.values_[n+s.length+f]=l[f];return o}},t.notifyArrayChildUpdate_=function(n,a,s){var i=!this.owned_&&iu(),o=ea(this),l=o||i?{observableKind:"array",object:this.proxy_,type:Na,debugObjectName:this.atom_.name_,index:n,newValue:a,oldValue:s}:null;this.atom_.reportChanged(),o&&ta(this,l)},t.notifyArraySplice_=function(n,a,s){var i=!this.owned_&&iu(),o=ea(this),l=o||i?{observableKind:"array",object:this.proxy_,debugObjectName:this.atom_.name_,type:vE,index:n,removed:s,added:a,removedCount:s.length,addedCount:a.length}:null;this.atom_.reportChanged(),o&&ta(this,l)},t.get_=function(n){if(this.legacyMode_&&n>=this.values_.length){console.warn("[mobx] Out of bounds read: "+n);return}return this.atom_.reportObserved(),this.dehanceValue_(this.values_[n])},t.set_=function(n,a){var s=this.values_;if(this.legacyMode_&&n>s.length&&Ye(17,n,s.length),n<s.length){this.atom_;var i=s[n];if(bn(this)){var o=En(this,{type:Na,object:this.proxy_,index:n,newValue:a});if(!o)return;a=o.newValue}a=this.enhancer_(a,i);var l=a!==i;l&&(s[n]=a,this.notifyArrayChildUpdate_(n,a,i))}else{for(var c=new Array(n+1-s.length),f=0;f<c.length-1;f++)c[f]=void 0;c[c.length-1]=a,this.spliceWithArray_(s.length,0,c)}},e}();function Qfe(e,t,r,n){return r===void 0&&(r="ObservableArray"),n===void 0&&(n=!1),GA(),bo(function(){var a=new Ny(r,t,n,!1);XA(a.values_,Ae,a);var s=new Proxy(a.values_,Xfe);return a.proxy_=s,e&&e.length&&a.spliceWithArray_(0,0,e),s})}var nh={clear:function(){return this.splice(0)},replace:function(t){var r=this[Ae];return r.spliceWithArray_(0,r.values_.length,t)},toJSON:function(){return this.slice()},splice:function(t,r){for(var n=arguments.length,a=new Array(n>2?n-2:0),s=2;s<n;s++)a[s-2]=arguments[s];var i=this[Ae];switch(arguments.length){case 0:return[];case 1:return i.spliceWithArray_(t);case 2:return i.spliceWithArray_(t,r)}return i.spliceWithArray_(t,r,a)},spliceWithArray:function(t,r,n){return this[Ae].spliceWithArray_(t,r,n)},push:function(){for(var t=this[Ae],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(t.values_.length,0,n),t.values_.length},pop:function(){return this.splice(Math.max(this[Ae].values_.length-1,0),1)[0]},shift:function(){return this.splice(0,1)[0]},unshift:function(){for(var t=this[Ae],r=arguments.length,n=new Array(r),a=0;a<r;a++)n[a]=arguments[a];return t.spliceWithArray_(0,0,n),t.values_.length},reverse:function(){return xe.trackingDerivation&&Ye(37,"reverse"),this.replace(this.slice().reverse()),this},sort:function(){xe.trackingDerivation&&Ye(37,"sort");var t=this.slice();return t.sort.apply(t,arguments),this.replace(t),this},remove:function(t){var r=this[Ae],n=r.dehanceValues_(r.values_).indexOf(t);return n>-1?(this.splice(n,1),!0):!1}};it("at",dn);it("concat",dn);it("flat",dn);it("includes",dn);it("indexOf",dn);it("join",dn);it("lastIndexOf",dn);it("slice",dn);it("toString",dn);it("toLocaleString",dn);it("toSorted",dn);it("toSpliced",dn);it("with",dn);it("every",ua);it("filter",ua);it("find",ua);it("findIndex",ua);it("findLast",ua);it("findLastIndex",ua);it("flatMap",ua);it("forEach",ua);it("map",ua);it("some",ua);it("toReversed",ua);it("reduce",TO);it("reduceRight",TO);function it(e,t){typeof Array.prototype[e]=="function"&&(nh[e]=t(e))}function dn(e){return function(){var t=this[Ae];t.atom_.reportObserved();var r=t.dehanceValues_(t.values_);return r[e].apply(r,arguments)}}function ua(e){return function(t,r){var n=this,a=this[Ae];a.atom_.reportObserved();var s=a.dehanceValues_(a.values_);return s[e](function(i,o){return t.call(r,i,o,n)})}}function TO(e){return function(){var t=this,r=this[Ae];r.atom_.reportObserved();var n=r.dehanceValues_(r.values_),a=arguments[0];return arguments[0]=function(s,i,o){return a(s,i,o,t)},n[e].apply(n,arguments)}}var Jfe=yo("ObservableArrayAdministration",Ny);function Sp(e){return gp(e)&&Jfe(e[Ae])}var Zfe={},Ws="add",ah="delete",CO=function(){function e(r,n,a){var s=this;n===void 0&&(n=so),a===void 0&&(a="ObservableMap"),this.enhancer_=void 0,this.name_=void 0,this[Ae]=Zfe,this.data_=void 0,this.hasMap_=void 0,this.keysAtom_=void 0,this.interceptors_=void 0,this.changeListeners_=void 0,this.dehancer=void 0,this.enhancer_=n,this.name_=a,oa(Map)||Ye(18),bo(function(){s.keysAtom_=eO("ObservableMap.keys()"),s.data_=new Map,s.hasMap_=new Map,r&&s.merge(r)})}var t=e.prototype;return t.has_=function(n){return this.data_.has(n)},t.has=function(n){var a=this;if(!xe.trackingDerivation)return this.has_(n);var s=this.hasMap_.get(n);if(!s){var i=s=new Bi(this.has_(n),_p,"ObservableMap.key?",!1);this.hasMap_.set(n,i),wO(i,function(){return a.hasMap_.delete(n)})}return s.get()},t.set=function(n,a){var s=this.has_(n);if(bn(this)){var i=En(this,{type:s?Na:Ws,object:this,newValue:a,name:n});if(!i)return this;a=i.newValue}return s?this.updateValue_(n,a):this.addValue_(n,a),this},t.delete=function(n){var a=this;if(this.keysAtom_,bn(this)){var s=En(this,{type:ah,object:this,name:n});if(!s)return!1}if(this.has_(n)){var i=iu(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:ah,object:this,oldValue:this.data_.get(n).value_,name:n}:null;return Ga(function(){var c;a.keysAtom_.reportChanged(),(c=a.hasMap_.get(n))==null||c.setNewValue_(!1);var f=a.data_.get(n);f.setNewValue_(void 0),a.data_.delete(n)}),o&&ta(this,l),!0}return!1},t.updateValue_=function(n,a){var s=this.data_.get(n);if(a=s.prepareNewValue_(a),a!==xe.UNCHANGED){var i=iu(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:Na,object:this,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&ta(this,l)}},t.addValue_=function(n,a){var s=this;this.keysAtom_,Ga(function(){var c,f=new Bi(a,s.enhancer_,"ObservableMap.key",!1);s.data_.set(n,f),a=f.value_,(c=s.hasMap_.get(n))==null||c.setNewValue_(!0),s.keysAtom_.reportChanged()});var i=iu(),o=ea(this),l=o||i?{observableKind:"map",debugObjectName:this.name_,type:Ws,object:this,name:n,newValue:a}:null;o&&ta(this,l)},t.get=function(n){return this.has(n)?this.dehanceValue_(this.data_.get(n).get()):this.dehanceValue_(void 0)},t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.keys=function(){return this.keysAtom_.reportObserved(),this.data_.keys()},t.values=function(){var n=this,a=this.keys();return gE({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:n.get(l)}}})},t.entries=function(){var n=this,a=this.keys();return gE({next:function(){var i=a.next(),o=i.done,l=i.value;return{done:o,value:o?void 0:[l,n.get(l)]}}})},t[Symbol.iterator]=function(){return this.entries()},t.forEach=function(n,a){for(var s=qo(this),i;!(i=s()).done;){var o=i.value,l=o[0],c=o[1];n.call(a,c,l,this)}},t.merge=function(n){var a=this;return wo(n)&&(n=new Map(n)),Ga(function(){ii(n)?_ue(n).forEach(function(s){return a.set(s,n[s])}):Array.isArray(n)?n.forEach(function(s){var i=s[0],o=s[1];return a.set(i,o)}):nc(n)?(yue(n)||Ye(19,n),n.forEach(function(s,i){return a.set(i,s)})):n!=null&&Ye(20,n)}),this},t.clear=function(){var n=this;Ga(function(){uO(function(){for(var a=qo(n.keys()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.replace=function(n){var a=this;return Ga(function(){for(var s=ede(n),i=new Map,o=!1,l=qo(a.data_.keys()),c;!(c=l()).done;){var f=c.value;if(!s.has(f)){var d=a.delete(f);if(d)o=!0;else{var h=a.data_.get(f);i.set(f,h)}}}for(var p=qo(s.entries()),v;!(v=p()).done;){var m=v.value,_=m[0],g=m[1],y=a.data_.has(_);if(a.set(_,g),a.data_.has(_)){var x=a.data_.get(_);i.set(_,x),y||(o=!0)}}if(!o)if(a.data_.size!==i.size)a.keysAtom_.reportChanged();else for(var w=a.data_.keys(),E=i.keys(),S=w.next(),b=E.next();!S.done;){if(S.value!==b.value){a.keysAtom_.reportChanged();break}S=w.next(),b=E.next()}a.data_=i}),this},t.toString=function(){return"[object ObservableMap]"},t.toJSON=function(){return Array.from(this)},t.observe_=function(n,a){return If(this,n)},t.intercept_=function(n){return Mf(this,n)},ac(e,[{key:"size",get:function(){return this.keysAtom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Map"}}])}(),wo=yo("ObservableMap",CO);function gE(e){return e[Symbol.toStringTag]="MapIterator",Oy(e)}function ede(e){if(nc(e)||wo(e))return e;if(Array.isArray(e))return new Map(e);if(ii(e)){var t=new Map;for(var r in e)t.set(r,e[r]);return t}else return Ye(21,e)}var tde={},NO=function(){function e(r,n,a){var s=this;n===void 0&&(n=so),a===void 0&&(a="ObservableSet"),this.name_=void 0,this[Ae]=tde,this.data_=new Set,this.atom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.dehancer=void 0,this.enhancer_=void 0,this.name_=a,oa(Set)||Ye(22),this.enhancer_=function(i,o){return n(i,o,a)},bo(function(){s.atom_=eO(s.name_),r&&s.replace(r)})}var t=e.prototype;return t.dehanceValue_=function(n){return this.dehancer!==void 0?this.dehancer(n):n},t.clear=function(){var n=this;Ga(function(){uO(function(){for(var a=qo(n.data_.values()),s;!(s=a()).done;){var i=s.value;n.delete(i)}})})},t.forEach=function(n,a){for(var s=qo(this),i;!(i=s()).done;){var o=i.value;n.call(a,o,o,this)}},t.add=function(n){var a=this;if(this.atom_,bn(this)){var s=En(this,{type:Ws,object:this,newValue:n});if(!s)return this;n=s.newValue}if(!this.has(n)){Ga(function(){a.data_.add(a.enhancer_(n,void 0)),a.atom_.reportChanged()});var i=!1,o=ea(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:Ws,object:this,newValue:n}:null;o&&ta(this,l)}return this},t.delete=function(n){var a=this;if(bn(this)){var s=En(this,{type:ah,object:this,oldValue:n});if(!s)return!1}if(this.has(n)){var i=!1,o=ea(this),l=o||i?{observableKind:"set",debugObjectName:this.name_,type:ah,object:this,oldValue:n}:null;return Ga(function(){a.atom_.reportChanged(),a.data_.delete(n)}),o&&ta(this,l),!0}return!1},t.has=function(n){return this.atom_.reportObserved(),this.data_.has(this.dehanceValue_(n))},t.entries=function(){var n=this.values();return xE({next:function(){var s=n.next(),i=s.value,o=s.done;return o?{value:void 0,done:o}:{value:[i,i],done:o}}})},t.keys=function(){return this.values()},t.values=function(){this.atom_.reportObserved();var n=this,a=this.data_.values();return xE({next:function(){var i=a.next(),o=i.value,l=i.done;return l?{value:void 0,done:l}:{value:n.dehanceValue_(o),done:l}}})},t.intersection=function(n){if(Ya(n)&&!_a(n))return n.intersection(this);var a=new Set(this);return a.intersection(n)},t.union=function(n){if(Ya(n)&&!_a(n))return n.union(this);var a=new Set(this);return a.union(n)},t.difference=function(n){return new Set(this).difference(n)},t.symmetricDifference=function(n){if(Ya(n)&&!_a(n))return n.symmetricDifference(this);var a=new Set(this);return a.symmetricDifference(n)},t.isSubsetOf=function(n){return new Set(this).isSubsetOf(n)},t.isSupersetOf=function(n){return new Set(this).isSupersetOf(n)},t.isDisjointFrom=function(n){if(Ya(n)&&!_a(n))return n.isDisjointFrom(this);var a=new Set(this);return a.isDisjointFrom(n)},t.replace=function(n){var a=this;return _a(n)&&(n=new Set(n)),Ga(function(){Array.isArray(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):Ya(n)?(a.clear(),n.forEach(function(s){return a.add(s)})):n!=null&&Ye("Cannot initialize set from "+n)}),this},t.observe_=function(n,a){return If(this,n)},t.intercept_=function(n){return Mf(this,n)},t.toJSON=function(){return Array.from(this)},t.toString=function(){return"[object ObservableSet]"},t[Symbol.iterator]=function(){return this.values()},ac(e,[{key:"size",get:function(){return this.atom_.reportObserved(),this.data_.size}},{key:Symbol.toStringTag,get:function(){return"Set"}}])}(),_a=yo("ObservableSet",NO);function xE(e){return e[Symbol.toStringTag]="SetIterator",Oy(e)}var yE=Object.create(null),_E="remove",AO=function(){function e(r,n,a,s){n===void 0&&(n=new Map),s===void 0&&(s=Xue),this.target_=void 0,this.values_=void 0,this.name_=void 0,this.defaultAnnotation_=void 0,this.keysAtom_=void 0,this.changeListeners_=void 0,this.interceptors_=void 0,this.proxy_=void 0,this.isPlainObject_=void 0,this.appliedAnnotations_=void 0,this.pendingKeys_=void 0,this.target_=r,this.values_=n,this.name_=a,this.defaultAnnotation_=s,this.keysAtom_=new vi("ObservableObject.keys"),this.isPlainObject_=ii(this.target_)}var t=e.prototype;return t.getObservablePropValue_=function(n){return this.values_.get(n).get()},t.setObservablePropValue_=function(n,a){var s=this.values_.get(n);if(s instanceof la)return s.set(a),!0;if(bn(this)){var i=En(this,{type:Na,object:this.proxy_||this.target_,name:n,newValue:a});if(!i)return null;a=i.newValue}if(a=s.prepareNewValue_(a),a!==xe.UNCHANGED){var o=ea(this),l=!1,c=o||l?{type:Na,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,oldValue:s.value_,name:n,newValue:a}:null;s.setNewValue_(a),o&&ta(this,c)}return!0},t.get_=function(n){return xe.trackingDerivation&&!as(this.target_,n)&&this.has_(n),this.target_[n]},t.set_=function(n,a,s){return s===void 0&&(s=!1),as(this.target_,n)?this.values_.has(n)?this.setObservablePropValue_(n,a):s?Reflect.set(this.target_,n,a):(this.target_[n]=a,!0):this.extend_(n,{value:a,enumerable:!0,writable:!0,configurable:!0},this.defaultAnnotation_,s)},t.has_=function(n){if(!xe.trackingDerivation)return n in this.target_;this.pendingKeys_||(this.pendingKeys_=new Map);var a=this.pendingKeys_.get(n);return a||(a=new Bi(n in this.target_,_p,"ObservableObject.key?",!1),this.pendingKeys_.set(n,a)),a.get()},t.make_=function(n,a){if(a===!0&&(a=this.defaultAnnotation_),a!==!1){if(!(n in this.target_)){var s;if((s=this.target_[wa])!=null&&s[n])return;Ye(1,a.annotationType_,this.name_+"."+n.toString())}for(var i=this.target_;i&&i!==vp;){var o=Q0(i,n);if(o){var l=a.make_(this,n,o,i);if(l===0)return;if(l===1)break}i=Object.getPrototypeOf(i)}bE(this,a,n)}},t.extend_=function(n,a,s,i){if(i===void 0&&(i=!1),s===!0&&(s=this.defaultAnnotation_),s===!1)return this.defineProperty_(n,a,i);var o=s.extend_(this,n,a,i);return o&&bE(this,s,n),o},t.defineProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{kn();var i=this.delete_(n);if(!i)return i;if(bn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:Ws,newValue:a.value});if(!o)return null;var l=o.newValue;a.value!==l&&(a=ao({},a,{value:l}))}if(s){if(!Reflect.defineProperty(this.target_,n,a))return!1}else Ta(this.target_,n,a);this.notifyPropertyAddition_(n,a.value)}finally{Tn()}return!0},t.defineObservableProperty_=function(n,a,s,i){i===void 0&&(i=!1),this.keysAtom_;try{kn();var o=this.delete_(n);if(!o)return o;if(bn(this)){var l=En(this,{object:this.proxy_||this.target_,name:n,type:Ws,newValue:a});if(!l)return null;a=l.newValue}var c=wE(n),f={configurable:xe.safeDescriptors?this.isPlainObject_:!0,enumerable:!0,get:c.get,set:c.set};if(i){if(!Reflect.defineProperty(this.target_,n,f))return!1}else Ta(this.target_,n,f);var d=new Bi(a,s,"ObservableObject.key",!1);this.values_.set(n,d),this.notifyPropertyAddition_(n,d.value_)}finally{Tn()}return!0},t.defineComputedProperty_=function(n,a,s){s===void 0&&(s=!1),this.keysAtom_;try{kn();var i=this.delete_(n);if(!i)return i;if(bn(this)){var o=En(this,{object:this.proxy_||this.target_,name:n,type:Ws,newValue:void 0});if(!o)return null}a.name||(a.name="ObservableObject.key"),a.context=this.proxy_||this.target_;var l=wE(n),c={configurable:xe.safeDescriptors?this.isPlainObject_:!0,enumerable:!1,get:l.get,set:l.set};if(s){if(!Reflect.defineProperty(this.target_,n,c))return!1}else Ta(this.target_,n,c);this.values_.set(n,new la(a)),this.notifyPropertyAddition_(n,void 0)}finally{Tn()}return!0},t.delete_=function(n,a){if(a===void 0&&(a=!1),this.keysAtom_,!as(this.target_,n))return!0;if(bn(this)){var s=En(this,{object:this.proxy_||this.target_,name:n,type:_E});if(!s)return null}try{var i;kn();var o=ea(this),l=!1,c=this.values_.get(n),f=void 0;if(!c&&(o||l)){var d;f=(d=Q0(this.target_,n))==null?void 0:d.value}if(a){if(!Reflect.deleteProperty(this.target_,n))return!1}else delete this.target_[n];if(c&&(this.values_.delete(n),c instanceof Bi&&(f=c.value_),vO(c)),this.keysAtom_.reportChanged(),(i=this.pendingKeys_)==null||(i=i.get(n))==null||i.set(n in this.target_),o||l){var h={type:_E,observableKind:"object",object:this.proxy_||this.target_,debugObjectName:this.name_,oldValue:f,name:n};o&&ta(this,h)}}finally{Tn()}return!0},t.observe_=function(n,a){return If(this,n)},t.intercept_=function(n){return Mf(this,n)},t.notifyPropertyAddition_=function(n,a){var s,i=ea(this),o=!1;if(i||o){var l=i||o?{type:Ws,observableKind:"object",debugObjectName:this.name_,object:this.proxy_||this.target_,name:n,newValue:a}:null;i&&ta(this,l)}(s=this.pendingKeys_)==null||(s=s.get(n))==null||s.set(!0),this.keysAtom_.reportChanged()},t.ownKeys_=function(){return this.keysAtom_.reportObserved(),yp(this.target_)},t.keys_=function(){return this.keysAtom_.reportObserved(),Object.keys(this.target_)},e}();function sc(e,t){var r;if(as(e,Ae))return e;var n=(r=t==null?void 0:t.name)!=null?r:"ObservableObject",a=new AO(e,new Map,String(n),ofe(t));return xp(e,Ae,a),e}var rde=yo("ObservableObjectAdministration",AO);function wE(e){return yE[e]||(yE[e]={get:function(){return this[Ae].getObservablePropValue_(e)},set:function(r){return this[Ae].setObservablePropValue_(e,r)}})}function kp(e){return gp(e)?rde(e[Ae]):!1}function bE(e,t,r){var n;(n=e.target_[wa])==null||delete n[r]}var nde=DO(0),ade=function(){var e=!1,t={};return Object.defineProperty(t,"0",{set:function(){e=!0}}),Object.create(t)[0]=1,e===!1}(),Rm=0,OO=function(){};function sde(e,t){Object.setPrototypeOf?Object.setPrototypeOf(e.prototype,t):e.prototype.__proto__!==void 0?e.prototype.__proto__=t:e.prototype=t}sde(OO,Array.prototype);var Ay=function(e){function t(n,a,s,i){var o;return s===void 0&&(s="ObservableArray"),i===void 0&&(i=!1),o=e.call(this)||this,bo(function(){var l=new Ny(s,a,i,!0);l.proxy_=o,XA(o,Ae,l),n&&n.length&&o.spliceWithArray(0,0,n),ade&&Object.defineProperty(o,"0",nde)}),o}ZA(t,e);var r=t.prototype;return r.concat=function(){this[Ae].atom_.reportObserved();for(var a=arguments.length,s=new Array(a),i=0;i<a;i++)s[i]=arguments[i];return Array.prototype.concat.apply(this.slice(),s.map(function(o){return Sp(o)?o.slice():o}))},r[Symbol.iterator]=function(){var n=this,a=0;return Oy({next:function(){return a<n.length?{value:n[a++],done:!1}:{done:!0,value:void 0}}})},ac(t,[{key:"length",get:function(){return this[Ae].getArrayLength_()},set:function(a){this[Ae].setArrayLength_(a)}},{key:Symbol.toStringTag,get:function(){return"Array"}}])}(OO);Object.entries(nh).forEach(function(e){var t=e[0],r=e[1];t!=="concat"&&xp(Ay.prototype,t,r)});function DO(e){return{enumerable:!1,configurable:!0,get:function(){return this[Ae].get_(e)},set:function(r){this[Ae].set_(e,r)}}}function ide(e){Ta(Ay.prototype,""+e,DO(e))}function jO(e){if(e>Rm){for(var t=Rm;t<e+100;t++)ide(t);Rm=e}}jO(1e3);function ode(e,t,r){return new Ay(e,t,r)}function sh(e,t){if(typeof e=="object"&&e!==null){if(Sp(e))return t!==void 0&&Ye(23),e[Ae].atom_;if(_a(e))return e.atom_;if(wo(e)){if(t===void 0)return e.keysAtom_;var r=e.data_.get(t)||e.hasMap_.get(t);return r||Ye(25,t,Pg(e)),r}if(kp(e)){if(!t)return Ye(26);var n=e[Ae].values_.get(t);return n||Ye(27,t,Pg(e)),n}if(Ey(e)||Ep(e)||rh(e))return e}else if(oa(e)&&rh(e[Ae]))return e[Ae];Ye(28)}function lde(e,t){if(e||Ye(29),Ey(e)||Ep(e)||rh(e)||wo(e)||_a(e))return e;if(e[Ae])return e[Ae];Ye(24,e)}function Pg(e,t){var r;if(t!==void 0)r=sh(e,t);else{if(ef(e))return e.name;kp(e)||wo(e)||_a(e)?r=lde(e):r=sh(e)}return r.name_}function bo(e){var t=_o(),r=ky(!0);kn();try{return e()}finally{Tn(),Ty(r),ss(t)}}var EE=vp.toString;function PO(e,t,r){return r===void 0&&(r=-1),Fg(e,t,r)}function Fg(e,t,r,n,a){if(e===t)return e!==0||1/e===1/t;if(e==null||t==null)return!1;if(e!==e)return t!==t;var s=typeof e;if(s!=="function"&&s!=="object"&&typeof t!="object")return!1;var i=EE.call(e);if(i!==EE.call(t))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+e==""+t;case"[object Number]":return+e!=+e?+t!=+t:+e==0?1/+e===1/t:+e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object Symbol]":return typeof Symbol<"u"&&Symbol.valueOf.call(e)===Symbol.valueOf.call(t);case"[object Map]":case"[object Set]":r>=0&&r++;break}e=SE(e),t=SE(t);var o=i==="[object Array]";if(!o){if(typeof e!="object"||typeof t!="object")return!1;var l=e.constructor,c=t.constructor;if(l!==c&&!(oa(l)&&l instanceof l&&oa(c)&&c instanceof c)&&"constructor"in e&&"constructor"in t)return!1}if(r===0)return!1;r<0&&(r=-1),n=n||[],a=a||[];for(var f=n.length;f--;)if(n[f]===e)return a[f]===t;if(n.push(e),a.push(t),o){if(f=e.length,f!==t.length)return!1;for(;f--;)if(!Fg(e[f],t[f],r-1,n,a))return!1}else{var d=Object.keys(e),h=d.length;if(Object.keys(t).length!==h)return!1;for(var p=0;p<h;p++){var v=d[p];if(!(as(t,v)&&Fg(e[v],t[v],r-1,n,a)))return!1}}return n.pop(),a.pop(),!0}function SE(e){return Sp(e)?e.slice():nc(e)||wo(e)||Ya(e)||_a(e)?Array.from(e.entries()):e}var kE,cde=((kE=mp().Iterator)==null?void 0:kE.prototype)||{};function Oy(e){return e[Symbol.iterator]=ude,Object.assign(Object.create(cde),e)}function ude(){return this}["Symbol","Map","Set"].forEach(function(e){var t=mp();typeof t[e]>"u"&&Ye("MobX requires global '"+e+"' to be available or polyfilled")});typeof __MOBX_DEVTOOLS_GLOBAL_HOOK__=="object"&&__MOBX_DEVTOOLS_GLOBAL_HOOK__.injectMobx({spy:kfe,extras:{getDebugName:Pg},$mobx:Ae});if(!O.useState)throw new Error("mobx-react-lite requires React with Hooks support");if(!Kfe)throw new Error("mobx-react-lite@3 requires mobx at least version 6 to be available");function fde(e){e()}function dde(e){e||(e=fde),$fe({reactionScheduler:e})}function hde(e){return Ufe(e)}var pde=1e4,mde=1e4,vde=function(){function e(t){var r=this;Object.defineProperty(this,"finalize",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"registrations",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"sweepTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sweep",{enumerable:!0,configurable:!0,writable:!0,value:function(n){n===void 0&&(n=pde),clearTimeout(r.sweepTimeout),r.sweepTimeout=void 0;var a=Date.now();r.registrations.forEach(function(s,i){a-s.registeredAt>=n&&(r.finalize(s.value),r.registrations.delete(i))}),r.registrations.size>0&&r.scheduleSweep()}}),Object.defineProperty(this,"finalizeAllImmediately",{enumerable:!0,configurable:!0,writable:!0,value:function(){r.sweep(0)}})}return Object.defineProperty(e.prototype,"register",{enumerable:!1,configurable:!0,writable:!0,value:function(t,r,n){this.registrations.set(n,{value:r,registeredAt:Date.now()}),this.scheduleSweep()}}),Object.defineProperty(e.prototype,"unregister",{enumerable:!1,configurable:!0,writable:!0,value:function(t){this.registrations.delete(t)}}),Object.defineProperty(e.prototype,"scheduleSweep",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.sweepTimeout===void 0&&(this.sweepTimeout=setTimeout(this.sweep,mde))}}),e}(),gde=typeof FinalizationRegistry<"u"?FinalizationRegistry:vde,Rg=new gde(function(e){var t;(t=e.reaction)===null||t===void 0||t.dispose(),e.reaction=null});function TE(e){e.reaction=new ms("observer".concat(e.name),function(){var t;e.stateVersion=Symbol(),(t=e.onStoreChange)===null||t===void 0||t.call(e)})}function xde(e,t){t===void 0&&(t="observed");var r=Z.useRef(null);if(!r.current){var n={reaction:null,onStoreChange:null,stateVersion:Symbol(),name:t,subscribe:function(o){return Rg.unregister(n),n.onStoreChange=o,n.reaction||(TE(n),n.stateVersion=Symbol()),function(){var l;n.onStoreChange=null,(l=n.reaction)===null||l===void 0||l.dispose(),n.reaction=null}},getSnapshot:function(){return n.stateVersion}};r.current=n}var a=r.current;a.reaction||(TE(a),Rg.register(r,a,a)),Z.useDebugValue(a.reaction,hde),nT.useSyncExternalStore(a.subscribe,a.getSnapshot,a.getSnapshot);var s,i;if(a.reaction.track(function(){try{s=e()}catch(o){i=o}}),i)throw i;return s}var Mm,Im,FO=typeof Symbol=="function"&&Symbol.for,yde=(Im=(Mm=Object.getOwnPropertyDescriptor(function(){},"name"))===null||Mm===void 0?void 0:Mm.configurable)!==null&&Im!==void 0?Im:!1,CE=FO?Symbol.for("react.forward_ref"):typeof O.forwardRef=="function"&&O.forwardRef(function(e){return null}).$$typeof,NE=FO?Symbol.for("react.memo"):typeof O.memo=="function"&&O.memo(function(e){return null}).$$typeof;function _de(e,t){var r;if(NE&&e.$$typeof===NE)throw new Error("[mobx-react-lite] You are trying to use `observer` on a function component wrapped in either another `observer` or `React.memo`. The observer already applies 'React.memo' for you.");var n=(r=void 0)!==null&&r!==void 0?r:!1,a=e,s=e.displayName||e.name;if(CE&&e.$$typeof===CE&&(n=!0,a=e.render,typeof a!="function"))throw new Error("[mobx-react-lite] `render` property of ForwardRef was not a function");var i=function(o,l){return xde(function(){return a(o,l)},s)};return i.displayName=e.displayName,yde&&Object.defineProperty(i,"name",{value:e.name,writable:!0,configurable:!0}),e.contextTypes&&(i.contextTypes=e.contextTypes),n&&(i=O.forwardRef(i)),i=O.memo(i),bde(e,i),i}var wde={$$typeof:!0,render:!0,compare:!0,type:!0,displayName:!0};function bde(e,t){Object.keys(e).forEach(function(r){wde[r]||Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))})}var Lm;dde(Ox.unstable_batchedUpdates);Lm=Rg.finalizeAllImmediately;const Ede=_de(()=>{const e=Qe(),t=Pn(),[r,n]=O.useState(new Date);O.useEffect(()=>{const s=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(s)},[]);const a=()=>{e.logout(),localStorage.clear(),sessionStorage.clear(),t("/login")};return u.jsxs("nav",{className:"bg-White-800 text-Black shadow-lg py-4 px-6 flex items-center justify-between",children:[u.jsxs("div",{className:"text-left",children:[u.jsxs("p",{className:"text-sm",children:["Date: ",r.toLocaleDateString()]}),u.jsxs("p",{className:"text-sm",children:["Time: ",r.toLocaleTimeString()]})]}),u.jsxs("div",{className:"flex items-center",children:[u.jsxs("span",{className:"mr-4",children:["Role: ",e.role]}),u.jsx("button",{onClick:a,className:"bg-red-500 hover:bg-red-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",children:"Logout"})]})]})});function Sde(){const{id:e}=Ml(),[t,r]=O.useState(null),[n,a]=O.useState([]),[s,i]=O.useState([]),[o,l]=O.useState(!1),[c,f]=O.useState(!1),[d,h]=O.useState(null),[p,v]=O.useState(!1),[m,_]=O.useState(!1),[g,y]=O.useState(null),[x,w]=O.useState(!1),[E,S]=O.useState({contact:!1,status:!1,quotation:!1,document:!1}),[b,j]=O.useState({document_type:"quotation",description:"",file:null}),k=Qe(F=>F.role),C=Qe(F=>F.user),[P,I]=O.useState({name:"",position:"",email:"",phone:""});O.useEffect(()=>{e&&(D(),Q(),K(),z())},[e,x]);async function D(){try{const{data:F}=await ie.from("clients").select("*").eq("id",e).single();r(F);const{data:T}=await ie.from("contact_persons").select("*").eq("client_id",e).order("created_at",{ascending:!1});a(T||[]);const R=ie.from("quotations").select(`
                    *,
                    employees (
                        full_name,
                        role
                    ),
                    quotation_assets (
                        asset_id,
                        quantity,
                        assets (
                            item
                        )
                    )
                `).eq("client_id",e);k!=="admin"&&k!=="head"&&R.eq("status","approved")}catch(F){console.error("Error loading client data:",F)}}async function K(){try{S(R=>({...R,document:!0}));const{data:F,error:T}=await ie.from("documents").select(`
                    *,
                    employees (
                        full_name
                    )
                `).eq("client_id",e).order("created_at",{ascending:!1});if(T)throw T;console.log("Documents loaded:",F),i(F||[])}catch(F){console.error("Error loading documents:",F)}finally{S(F=>({...F,document:!1}))}}async function Q(){try{const{data:F}=await ie.from("assets").select("*").order("item")}catch(F){console.error("Error loading assets:",F)}}async function z(){try{if(k==="admin"||k==="finance.employee"){w(!0);return}if(!(C!=null&&C.id)||!e){w(!1);return}const{data:F,error:T}=await ie.from("client_assignments").select("*").eq("client_id",e).eq("employee_id",C.id).single();w(!!F)}catch(F){console.error("Error checking assignment:",F)}}async function q(F){F.preventDefault(),S({...E,contact:!0});try{const{error:T}=await ie.from("contact_persons").insert([{...P,client_id:e}]);if(T)throw T;I({name:"",position:"",email:"",phone:""}),l(!1),await D()}catch(T){console.error("Error adding contact person:",T)}finally{S({...E,contact:!1})}}async function ee(F){F.preventDefault(),S({...E,contact:!0});try{const{error:T}=await ie.from("contact_persons").update({name:g.name,position:g.position,email:g.email,phone:g.phone}).eq("id",g.id);if(T)throw T;y(null),await D()}catch(T){console.error("Error updating contact person:",T)}finally{S({...E,contact:!1})}}async function H(F){S({...E,status:!0});try{const{error:T}=await ie.from("clients").update({status:F}).eq("id",e);if(T)throw T;v(!1),_(!1),await D()}catch(T){console.error("Error updating client status:",T)}finally{S({...E,status:!1})}}async function ce(F){if(F.preventDefault(),!(!b.file||!(C!=null&&C.id))){S({...E,document:!0});try{const{data:T}=await ie.storage.listBuckets();T!=null&&T.find(oe=>oe.name==="documents")||await ie.storage.createBucket("documents",{public:!1});const R=b.file.name.split(".").pop(),G=`${C.id}/${Date.now()}.${R}`,{error:X}=await ie.storage.from("documents").upload(G,b.file,{cacheControl:"3600",upsert:!1});if(X)throw X;const{data:{publicUrl:Y}}=ie.storage.from("documents").getPublicUrl(G),{error:ae}=await ie.from("documents").insert([{client_id:e,employee_id:C.id,document_type:b.document_type,description:b.description,file_name:b.file.name,file_url:Y,file_path:G,file_type:b.file.type,file_size:b.file.size}]);if(ae)throw ae;j({document_type:"quotation",description:"",file:null}),f(!1),await K()}catch(T){console.error("Error uploading document:",T),T instanceof Error?alert(`Upload failed: ${T.message}`):alert("Upload failed: An unknown error occurred.")}finally{S({...E,document:!1})}}}async function J(F,T){if(confirm("Are you sure you want to delete this document?")){S({...E,document:!0});try{const{error:R}=await ie.storage.from("documents").remove([T]);if(R)throw R;const{error:G}=await ie.from("documents").delete().eq("id",F);if(G)throw G;await K()}catch(R){console.error("Error deleting document:",R)}finally{S({...E,document:!1})}}}function N(F,T){const R=encodeURIComponent(`Document: ${F.file_name}`),G=encodeURIComponent(`Dear Client,

Please find attached the document you requested.

Document Type: ${F.document_type}
Description: ${F.description||"N/A"}

Best regards,
${(C==null?void 0:C.full_name)||"Your Representative"}
${(C==null?void 0:C.email)||""}`);window.open(`https://mail.google.com/mail/?view=cm&fs=1&to=${T}&su=${R}&body=${G}`)}return t?u.jsxs("div",{className:"space-y-6",children:[u.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:t.name}),u.jsx("p",{className:"text-gray-600",children:t.company}),u.jsx("p",{className:"text-gray-500 mt-2",children:t.address})]}),u.jsxs("div",{className:"flex gap-2",children:[u.jsx("button",{onClick:()=>l(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.contact,children:E.contact?"Adding...":u.jsxs(u.Fragment,{children:[u.jsx(us,{className:"w-4 h-4 mr-2"}),"Add Contact"]})}),u.jsx("button",{onClick:()=>f(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.document,children:E.document?"Loading...":u.jsxs(u.Fragment,{children:[u.jsx(bw,{className:"w-4 h-4 mr-2"}),"Upload Document"]})})]})]})}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Contact Persons"}),u.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:n.map(F=>u.jsxs("div",{className:"border rounded-lg p-4",children:[u.jsx("h3",{className:"font-semibold text-gray-800",children:F.name}),u.jsx("p",{className:"text-gray-600 text-sm",children:F.position}),u.jsxs("div",{className:"mt-2 space-y-1",children:[u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx($l,{className:"w-4 h-4 mr-2"}),F.email]}),u.jsxs("div",{className:"flex items-center text-gray-600 text-sm",children:[u.jsx(uf,{className:"w-4 h-4 mr-2"}),F.phone]})]}),k==="finance.employee"&&u.jsx("button",{onClick:()=>y(F),className:"mt-2 px-3 py-1 bg-gray-200 text-sm rounded hover:bg-gray-300",children:"Edit"})]},F.id))})]}),u.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[u.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4",children:"Documents"}),s.length===0?u.jsx("p",{className:"text-gray-500",children:"No documents found"}):u.jsx("div",{className:"space-y-4",children:s.map(F=>{var T;return u.jsx("div",{className:"border rounded-lg p-4",children:u.jsxs("div",{className:"flex justify-between items-start",children:[u.jsxs("div",{children:[u.jsxs("div",{className:"flex items-center gap-2",children:[u.jsx(bw,{className:"w-4 h-4 text-gray-500"}),u.jsx("a",{href:F.file_url,target:"_blank",rel:"noopener noreferrer",className:"font-medium text-blue-600 hover:underline",children:F.file_name})]}),u.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Type: ",F.document_type]}),F.description&&u.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Description: ",F.description]}),u.jsxs("p",{className:"text-xs text-gray-400 mt-2",children:["Uploaded by ",(T=F.employees)==null?void 0:T.full_name," on ",new Date(F.created_at).toLocaleDateString()]})]}),u.jsxs("div",{className:"flex gap-2",children:[n.length>0&&u.jsx("button",{onClick:()=>N(F,n[0].email),className:"p-2 text-blue-600 hover:text-blue-800",title:"Send to client",children:u.jsx(DT,{className:"w-4 h-4"})}),(k==="admin"||k==="finance.employee")&&u.jsx("button",{onClick:()=>J(F.id,F.file_path),className:"p-2 text-red-600 hover:text-red-800",title:"Delete document",disabled:E.document,children:u.jsx(E6,{className:"w-4 h-4"})})]})]})},F.id)})})]}),c&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Upload Document"}),u.jsxs("form",{onSubmit:ce,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Document Type"}),u.jsxs("select",{value:b.document_type,onChange:F=>j({...b,document_type:F.target.value}),className:"w-full p-2 border rounded",required:!0,children:[u.jsx("option",{value:"quotation",children:"Quotation"}),u.jsx("option",{value:"contract",children:"Contract"}),u.jsx("option",{value:"invoice",children:"Invoice"}),u.jsx("option",{value:"proposal",children:"Proposal"}),u.jsx("option",{value:"other",children:"Other"})]})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Description (Optional)"}),u.jsx("textarea",{value:b.description,onChange:F=>j({...b,description:F.target.value}),className:"w-full p-2 border rounded",rows:3})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"File"}),u.jsx("input",{type:"file",onChange:F=>{F.target.files&&F.target.files[0]&&j({...b,file:F.target.files[0]})},className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>f(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.document,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.document||!b.file,children:E.document?"Uploading...":"Upload Document"})]})]})]})}),k==="finance.employee"&&u.jsx("button",{onClick:()=>_(!0),className:"bg-red-600 text-white px-4 py-2 rounded-lg flex items-center",disabled:E.status,children:E.status?"Processing...":u.jsxs(u.Fragment,{children:[u.jsx(b0,{className:"w-4 h-4 mr-2"}),"Completed"]})}),p&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"End Client"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>v(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.status,children:"Cancel"}),u.jsx("button",{onClick:()=>H("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:E.status,children:"Confirm"})]})]})}),m&&u.jsx("div",{className:"fixed top-0 left-0 w-full h-full bg-gray-800 bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Completed"}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{onClick:()=>_(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.status,children:"Cancel"}),u.jsx("button",{onClick:()=>H("completed"),className:"px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700",disabled:E.status,children:"Confirm"})]})]})}),o&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Add Contact Person"}),u.jsxs("form",{onSubmit:q,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:P.name,onChange:F=>I({...P,name:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:P.position,onChange:F=>I({...P,position:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:P.email,onChange:F=>I({...P,email:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:P.phone,onChange:F=>I({...P,phone:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>l(!1),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.contact,children:E.contact?"Adding...":"Add Contact"})]})]})]})}),g&&u.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center",children:u.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[u.jsx("h2",{className:"text-xl font-bold mb-4",children:"Edit Contact Person"}),u.jsxs("form",{onSubmit:ee,children:[u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Name"}),u.jsx("input",{type:"text",value:g.name,onChange:F=>y({...g,name:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Position"}),u.jsx("input",{type:"text",value:g.position,onChange:F=>y({...g,position:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Email"}),u.jsx("input",{type:"email",value:g.email,onChange:F=>y({...g,email:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"mb-4",children:[u.jsx("label",{className:"block text-gray-700 mb-2",children:"Phone"}),u.jsx("input",{type:"tel",value:g.phone,onChange:F=>y({...g,phone:F.target.value}),className:"w-full p-2 border rounded",required:!0})]}),u.jsxs("div",{className:"flex justify-end gap-2",children:[u.jsx("button",{type:"button",onClick:()=>y(null),className:"px-4 py-2 text-gray-600 hover:text-gray-800",disabled:E.contact,children:"Cancel"}),u.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",disabled:E.contact,children:E.contact?"Saving...":"Save Changes"})]})]})]})})]}):u.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading client data..."})}function kde(){const[e,t]=O.useState([]),[r,n]=O.useState(!0),[a,s]=O.useState(""),[i,o]=O.useState(""),[l,c]=O.useState(""),[f,d]=O.useState(!1);O.useEffect(()=>{h()},[]);async function h(){n(!0);try{const{data:g,error:y}=await ie.from("site_visit").select(`
          id,
          created_at,
          status,
          employee:employee_Id (full_name),
          client:client_Id (name, address),
          form:site_visit_form (
            address,
            created_at
          )
        `).order("created_at",{ascending:!1});if(y)throw y;const x=p(g||[]);t(x)}catch(g){console.error("Error fetching time insights:",g)}finally{n(!1)}}function p(g){return g.filter(y=>{var x,w;return y.status==="end"&&((w=(x=y.form)==null?void 0:x[0])==null?void 0:w.created_at)}).map(y=>{var k,C,P,I,D;const x=new Date(y.created_at),E=(new Date(y.form[0].created_at).getTime()-x.getTime())/(1e3*60),S=Math.floor(E/(60*24)),b=Math.floor(E%(60*24)/60),j=Math.floor(E%60);return{id:y.id,client_name:((k=y.client)==null?void 0:k.name)||"Unknown",employee_name:((C=y.employee)==null?void 0:C.full_name)||"Unknown",date:x.toLocaleDateString(),raw_date:x,address:((I=(P=y.form)==null?void 0:P[0])==null?void 0:I.address)||((D=y.client)==null?void 0:D.address)||"N/A",duration:{days:S,hours:b,minutes:j}}})}const v=e.filter(g=>{const y=g.client_name.toLowerCase().includes(a.toLowerCase())||g.employee_name.toLowerCase().includes(a.toLowerCase())||g.address.toLowerCase().includes(a.toLowerCase()),x=i?g.raw_date.toISOString().split("T")[0]===i:!0,w=l?g.employee_name.toLowerCase().includes(l.toLowerCase()):!0;return y&&x&&w}),m=()=>{s(""),o(""),c("")},_=[...new Set(e.map(g=>g.employee_name))];return u.jsxs("div",{className:"container mx-auto px-4 py-6",children:[u.jsxs("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4",children:[u.jsx("h1",{className:"text-2xl font-bold text-gray-800",children:"Time Insights"}),u.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 w-full md:w-auto",children:[u.jsxs("div",{className:"relative w-full",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(na,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"search",placeholder:"Search by client, employee or address...",value:a,onChange:g=>s(g.target.value),className:"block w-full p-2 pl-10 text-sm text-gray-900 border border-gray-300 rounded-lg bg-gray-50 focus:ring-blue-500 focus:border-blue-500"})]}),u.jsxs("button",{onClick:()=>d(!f),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 rounded-lg flex items-center gap-2",children:[u.jsx(AT,{className:"w-4 h-4"}),u.jsx("span",{children:"Filters"})]})]})]}),f&&u.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[u.jsxs("div",{className:"flex justify-between items-center mb-3",children:[u.jsx("h3",{className:"font-medium",children:"Filters"}),u.jsxs("button",{onClick:m,className:"text-sm text-blue-600 hover:underline flex items-center gap-1",children:[u.jsx(Bl,{className:"w-4 h-4"}),"Clear all"]})]}),u.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Visit Date"}),u.jsxs("div",{className:"relative",children:[u.jsx("div",{className:"absolute inset-y-0 left-0 flex items-center pl-3 pointer-events-none",children:u.jsx(Dh,{className:"w-5 h-5 text-gray-400"})}),u.jsx("input",{type:"date",value:i,onChange:g=>o(g.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2"})]})]}),u.jsxs("div",{children:[u.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Employee"}),u.jsxs("select",{value:l,onChange:g=>c(g.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full p-2",children:[u.jsx("option",{value:"",children:"All Employees"}),_.map(g=>u.jsx("option",{value:g,children:g},g))]})]})]})]}),r?u.jsx("div",{className:"flex justify-center items-center h-64",children:u.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"})}):u.jsx("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:u.jsx("div",{className:"overflow-x-auto",children:u.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[u.jsx("thead",{className:"bg-gray-50",children:u.jsxs("tr",{children:[u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Client"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Employee"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Address"}),u.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Duration"})]})}),u.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.length>0?v.map(g=>{const y=g.duration.days*1440+g.duration.hours*60+g.duration.minutes;return u.jsxs("tr",{className:"hover:bg-gray-50",children:[u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:g.client_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.employee_name}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.date}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:g.address}),u.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:u.jsxs("span",{className:`px-2 py-1 rounded-full text-xs ${y>120?"bg-red-100 text-red-800":y>60?"bg-yellow-100 text-yellow-800":"bg-green-100 text-green-800"}`,children:[`${g.duration.days>0?`${g.duration.days}d `:""}${g.duration.hours}h ${g.duration.minutes}m`,y>0&&` (${y.toFixed(0)} mins)`]})})]},g.id)}):u.jsx("tr",{children:u.jsxs("td",{colSpan:5,className:"px-6 py-4 text-center text-sm text-gray-500",children:["No matching time tracking data found",(a||i||l)&&u.jsx("button",{onClick:m,className:"text-blue-600 hover:underline ml-2",children:"Clear filters"})]})})})]})})})]})}function Ec({children:e,requiredRoles:t}){const r=Qe(n=>n.role);return t.includes(r||"")?e:u.jsx(_0,{to:"/dashboard"})}function Tde({children:e}){return Qe(r=>r.user)?e:u.jsx(_0,{to:"/login"})}function Cde(){return u.jsx(SP,{children:u.jsx(Nde,{})})}function Nde(){const t=Rl().pathname!=="/login";return Qe(r=>r.role),u.jsxs(u.Fragment,{children:[t&&u.jsx(Ede,{}),u.jsxs(gP,{children:[u.jsx(ht,{path:"/login",element:u.jsx(S6,{})}),u.jsxs(ht,{path:"/",element:u.jsx(Tde,{children:u.jsx(mue,{})}),children:[u.jsx(ht,{path:"/",element:u.jsx(_0,{to:"/dashboard"})}),u.jsx(ht,{path:"/dashboard",element:u.jsx(Xee,{})}),u.jsx(ht,{path:"/clients",element:u.jsx(Jee,{})}),u.jsx(ht,{path:"/clients-history",element:u.jsx(ste,{})}),u.jsx(ht,{path:"/notifications",element:u.jsx(ite,{})}),u.jsx(ht,{path:"/AllClients",element:u.jsx(Zee,{})}),u.jsx(ht,{path:"/xldata",element:u.jsx(cue,{})}),u.jsx(ht,{path:"/time-insights",element:u.jsx(kde,{})}),u.jsx(ht,{path:"/clientshistoryprofile/:id",element:u.jsx(hue,{})}),u.jsx(ht,{path:"/clients/:id",element:u.jsx(tte,{})}),u.jsx(ht,{path:"/eclients/:id",element:u.jsx(rte,{})}),u.jsx(ht,{path:"/allclients/:id",element:u.jsx(ete,{})}),u.jsx(ht,{path:"/site-visits/:id",element:u.jsx(ate,{})}),u.jsx(ht,{path:"/fclients/:id",element:u.jsx(Sde,{})}),u.jsx(ht,{path:"/pd-kits",element:u.jsx(pue,{})}),u.jsx(ht,{path:"/employees",element:u.jsx(Ec,{requiredRoles:["head","e.head"],children:u.jsx(Qee,{})})}),u.jsx(ht,{path:"/site-visit",element:u.jsx(Ec,{requiredRoles:["employee","e.employee"],children:u.jsx(nte,{})})}),u.jsx(ht,{path:"/eclients",element:u.jsx(Ec,{requiredRoles:["e.head","e.employee"],children:u.jsx(uue,{})})}),u.jsx(ht,{path:"/fclients",element:u.jsx(Ec,{requiredRoles:["finance.employee"],children:u.jsx(fue,{})})}),u.jsx(ht,{path:"/documents-upload",element:u.jsx(Ec,{requiredRoles:["finance.employee"],children:u.jsx(due,{})})})]}),u.jsx(ht,{path:"*",element:u.jsx(_0,{to:"/dashboard"})})]})]})}Wk(document.getElementById("root")).render(u.jsx(O.StrictMode,{children:u.jsx(Cde,{})}));export{Er as g};
